<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>ip_var.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">ip_var.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 *
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 *
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)ip_var.h	8.2 (Berkeley) 1/9/95
 */</span>
<span class="enscript-comment">/*
 * NOTICE: This file was modified by SPARTA, Inc. in 2007 to introduce
 * support for mandatory and extensible security protections.  This notice
 * is included in support of clause 2.2 (b) of the Apple Public License,
 * Version 2.0.
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NETINET_IP_VAR_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_NETINET_IP_VAR_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>

<span class="enscript-comment">/*
 * Overlay for ip header used by other protocols (tcp, udp).
 */</span>
<span class="enscript-type">struct</span> ipovly {
	u_char	ih_x1[9];		<span class="enscript-comment">/* (unused) */</span>
	u_char	ih_pr;			<span class="enscript-comment">/* protocol */</span>
	u_short	ih_len;			<span class="enscript-comment">/* protocol length */</span>
	<span class="enscript-type">struct</span>	in_addr ih_src;		<span class="enscript-comment">/* source internet address */</span>
	<span class="enscript-type">struct</span>	in_addr ih_dst;		<span class="enscript-comment">/* destination internet address */</span>
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_MACF_NET</span>
<span class="enscript-type">struct</span> label;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* CONFIG_MACF_NET */</span>
<span class="enscript-comment">/*
 * Ip reassembly queue structure.  Each fragment
 * being reassembled is attached to one of these structures.
 * They are timed out after ipq_ttl drops to 0, and may also
 * be reclaimed if memory becomes tight.
 */</span>
<span class="enscript-type">struct</span> ipq {
	TAILQ_ENTRY(ipq) ipq_list;	<span class="enscript-comment">/* to other reass headers */</span>
	<span class="enscript-type">struct</span> mbuf *ipq_frags;		<span class="enscript-comment">/* to ip headers of fragments */</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_MACF_NET</span>
	<span class="enscript-type">struct</span> label *ipq_label;	<span class="enscript-comment">/* MAC label */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* CONFIG_MACF_NET */</span>
	u_char	ipq_ttl;		<span class="enscript-comment">/* time for reass q to live */</span>
	u_char	ipq_p;			<span class="enscript-comment">/* protocol of this fragment */</span>
	u_short	ipq_id;			<span class="enscript-comment">/* sequence id for reassembly */</span>
	<span class="enscript-type">struct</span>	in_addr ipq_src, ipq_dst;
	u_int32_t	ipq_nfrags;	<span class="enscript-comment">/* # frags in this packet */</span>
	uint32_t ipq_csum_flags;	<span class="enscript-comment">/* checksum flags */</span>
	uint32_t ipq_csum;		<span class="enscript-comment">/* partial checksum value */</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">IPDIVERT</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">IPDIVERT_44</span>
	u_int32_t ipq_div_info;		<span class="enscript-comment">/* ipfw divert port &amp; flags */</span>
#<span class="enscript-reference">else</span> <span class="enscript-comment">/* !IPDIVERT_44 */</span>
	u_int16_t ipq_divert;		<span class="enscript-comment">/* ipfw divert port (legacy) */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !IPDIVERT_44 */</span>
	u_int16_t ipq_div_cookie;	<span class="enscript-comment">/* ipfw divert cookie */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* IPDIVERT */</span>
};

<span class="enscript-comment">/*
 * Structure stored in mbuf in inpcb.ip_options
 * and passed to ip_output when ip options are in use.
 * The actual length of the options (including ipopt_dst)
 * is in m_len.
 */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MAX_IPOPTLEN</span>	40
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-type">struct</span> ipoption {
	<span class="enscript-type">struct</span>	in_addr ipopt_dst;	<span class="enscript-comment">/* first-hop dst if source routed */</span>
	<span class="enscript-type">char</span>	ipopt_list[MAX_IPOPTLEN];	<span class="enscript-comment">/* options proper */</span>
};

<span class="enscript-comment">/*
 * Structure attached to inpcb.ip_moptions and
 * passed to ip_output when IP multicast options are in use.
 */</span>
<span class="enscript-type">struct</span> ip_moptions {
	decl_lck_mtx_data(, imo_lock);
	uint32_t imo_refcnt;		<span class="enscript-comment">/* ref count */</span>
	uint32_t imo_debug;		<span class="enscript-comment">/* see ifa_debug flags */</span>
	<span class="enscript-type">struct</span>	ifnet *imo_multicast_ifp; <span class="enscript-comment">/* ifp for outgoing multicasts */</span>
	u_char	imo_multicast_ttl;	<span class="enscript-comment">/* TTL for outgoing multicasts */</span>
	u_char	imo_multicast_loop;	<span class="enscript-comment">/* 1 =&gt; hear sends if a member */</span>
	u_short	imo_num_memberships;	<span class="enscript-comment">/* no. memberships this socket */</span>
	u_short	imo_max_memberships;	<span class="enscript-comment">/* max memberships this socket */</span>
	<span class="enscript-type">struct</span>	in_multi **imo_membership;	<span class="enscript-comment">/* group memberships */</span>
	<span class="enscript-type">struct</span>	in_mfilter *imo_mfilters;	<span class="enscript-comment">/* source filters */</span>
	u_int32_t imo_multicast_vif;	<span class="enscript-comment">/* vif num outgoing multicasts */</span>
	<span class="enscript-type">struct</span>	in_addr imo_multicast_addr; <span class="enscript-comment">/* ifindex/addr on MULTICAST_IF */</span>
	<span class="enscript-type">void</span> (*imo_trace)		<span class="enscript-comment">/* callback fn for tracing refs */</span>
	    (<span class="enscript-type">struct</span> ip_moptions *, <span class="enscript-type">int</span>);
};

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_LOCK_ASSERT_HELD</span>(_imo)					\
	lck_mtx_assert(&amp;(_imo)-&gt;imo_lock, LCK_MTX_ASSERT_OWNED)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_LOCK_ASSERT_NOTHELD</span>(_imo)					\
	lck_mtx_assert(&amp;(_imo)-&gt;imo_lock, LCK_MTX_ASSERT_NOTOWNED)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_LOCK</span>(_imo)							\
	lck_mtx_lock(&amp;(_imo)-&gt;imo_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_LOCK_SPIN</span>(_imo)						\
	lck_mtx_lock_spin(&amp;(_imo)-&gt;imo_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_CONVERT_LOCK</span>(_imo) do {					\
	IMO_LOCK_ASSERT_HELD(_imo);					\
	lck_mtx_convert_spin(&amp;(_imo)-&gt;imo_lock);			\
} <span class="enscript-keyword">while</span> (0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_UNLOCK</span>(_imo)						\
	lck_mtx_unlock(&amp;(_imo)-&gt;imo_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_ADDREF</span>(_imo)						\
	imo_addref(_imo, 0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_ADDREF_LOCKED</span>(_imo)						\
	imo_addref(_imo, 1)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IMO_REMREF</span>(_imo)						\
	imo_remref(_imo)

<span class="enscript-comment">/* mbuf tag for ip_forwarding info */</span>
<span class="enscript-type">struct</span> ip_fwd_tag {
	<span class="enscript-type">struct</span> sockaddr_in *next_hop;	<span class="enscript-comment">/* next_hop */</span>
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-type">struct</span>	ipstat {
	u_int32_t ips_total;		<span class="enscript-comment">/* total packets received */</span>
	u_int32_t ips_badsum;		<span class="enscript-comment">/* checksum bad */</span>
	u_int32_t ips_tooshort;		<span class="enscript-comment">/* packet too short */</span>
	u_int32_t ips_toosmall;		<span class="enscript-comment">/* not enough data */</span>
	u_int32_t ips_badhlen;		<span class="enscript-comment">/* ip header length &lt; data size */</span>
	u_int32_t ips_badlen;		<span class="enscript-comment">/* ip length &lt; ip header length */</span>
	u_int32_t ips_fragments;	<span class="enscript-comment">/* fragments received */</span>
	u_int32_t ips_fragdropped;	<span class="enscript-comment">/* frags dropped (dups, out of space) */</span>
	u_int32_t ips_fragtimeout;	<span class="enscript-comment">/* fragments timed out */</span>
	u_int32_t ips_forward;		<span class="enscript-comment">/* packets forwarded */</span>
	u_int32_t ips_fastforward;	<span class="enscript-comment">/* packets fast forwarded */</span>
	u_int32_t ips_cantforward;	<span class="enscript-comment">/* packets rcvd for unreachable dest */</span>
	u_int32_t ips_redirectsent;	<span class="enscript-comment">/* packets forwarded on same net */</span>
	u_int32_t ips_noproto;		<span class="enscript-comment">/* unknown or unsupported protocol */</span>
	u_int32_t ips_delivered;	<span class="enscript-comment">/* datagrams delivered to upper level */</span>
	u_int32_t ips_localout;		<span class="enscript-comment">/* total ip packets generated here */</span>
	u_int32_t ips_odropped;		<span class="enscript-comment">/* lost packets due to nobufs, etc. */</span>
	u_int32_t ips_reassembled;	<span class="enscript-comment">/* total packets reassembled ok */</span>
	u_int32_t ips_fragmented;	<span class="enscript-comment">/* datagrams successfully fragmented */</span>
	u_int32_t ips_ofragments;	<span class="enscript-comment">/* output fragments created */</span>
	u_int32_t ips_cantfrag;		<span class="enscript-comment">/* don't fragment flag was set, etc. */</span>
	u_int32_t ips_badoptions;	<span class="enscript-comment">/* error in option processing */</span>
	u_int32_t ips_noroute;		<span class="enscript-comment">/* packets discarded due to no route */</span>
	u_int32_t ips_badvers;		<span class="enscript-comment">/* ip version != 4 */</span>
	u_int32_t ips_rawout;		<span class="enscript-comment">/* total raw ip packets generated */</span>
	u_int32_t ips_toolong;		<span class="enscript-comment">/* ip length &gt; max ip packet size */</span>
	u_int32_t ips_notmember;	<span class="enscript-comment">/* multicasts for unregistered grps */</span>
	u_int32_t ips_nogif;		<span class="enscript-comment">/* no match gif found */</span>
	u_int32_t ips_badaddr;		<span class="enscript-comment">/* invalid address on header */</span>
	u_int32_t ips_pktdropcntrl;	<span class="enscript-comment">/* pkt dropped, no mbufs for ctl data */</span>
	u_int32_t ips_rcv_swcsum;	<span class="enscript-comment">/* ip hdr swcksum (inbound), packets */</span>
	u_int32_t ips_rcv_swcsum_bytes;	<span class="enscript-comment">/* ip hdr swcksum (inbound), bytes */</span>
	u_int32_t ips_snd_swcsum;	<span class="enscript-comment">/* ip hdr swcksum (outbound), packets */</span>
	u_int32_t ips_snd_swcsum_bytes;	<span class="enscript-comment">/* ip hdr swcksum (outbound), bytes */</span>
	u_int32_t ips_adj;		<span class="enscript-comment">/* total packets trimmed/adjusted */</span>
	u_int32_t ips_adj_hwcsum_clr;	<span class="enscript-comment">/* hwcksum discarded during adj */</span>
	u_int32_t ips_rxc_collisions;	<span class="enscript-comment">/* rx chaining collisions */</span>
	u_int32_t ips_rxc_chained;	<span class="enscript-comment">/* rx chains */</span>
	u_int32_t ips_rxc_notchain;	<span class="enscript-comment">/* rx bypassed chaining */</span>
	u_int32_t ips_rxc_chainsz_gt2;	<span class="enscript-comment">/* rx chain size greater than 2 */</span>
	u_int32_t ips_rxc_chainsz_gt4;  <span class="enscript-comment">/* rx chain size greater than 4 */</span>
	u_int32_t ips_rxc_notlist;	<span class="enscript-comment">/* count of pkts through ip_input */</span>

};

<span class="enscript-type">struct</span> ip_linklocal_stat {
	u_int32_t	iplls_in_total;
	u_int32_t	iplls_in_badttl;
	u_int32_t	iplls_out_total;
	u_int32_t	iplls_out_badttl;
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-comment">/* forward declarations for ip_output() */</span>
<span class="enscript-type">struct</span> ip_out_args;
<span class="enscript-type">struct</span> ip_moptions;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-comment">/* flags passed to ip_output as last parameter */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FORWARDING</span>	0x1		<span class="enscript-comment">/* most of ip header exists */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_RAWOUTPUT</span>	0x2		<span class="enscript-comment">/* raw ip header exists */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_NOIPSEC</span>	0x4		<span class="enscript-comment">/* No IPSec processing */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_ROUTETOIF</span>	SO_DONTROUTE	<span class="enscript-comment">/* bypass routing tables (0x0010) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_ALLOWBROADCAST</span> SO_BROADCAST	<span class="enscript-comment">/* can send broadcast pkts (0x0020) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OUTARGS</span>	0x100		<span class="enscript-comment">/* has ancillary output info */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IP_HDR_ALIGNED_P</span>(_ip)	((((uintptr_t)(_ip)) &amp; ((uintptr_t)3)) == 0)

<span class="enscript-comment">/*
 * On platforms which require strict alignment (currently for anything but
 * i386 or x86_64), this macro checks whether the pointer to the IP header
 * is 32-bit aligned, and assert otherwise.
 */</span>
#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__i386__</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__x86_64__</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IP_HDR_STRICT_ALIGNMENT_CHECK</span>(_ip) do { } while (0)
#<span class="enscript-reference">else</span> <span class="enscript-comment">/* !__i386__ &amp;&amp; !__x86_64__ */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IP_HDR_STRICT_ALIGNMENT_CHECK</span>(_ip) do {				\
	<span class="enscript-keyword">if</span> (!IP_HDR_ALIGNED_P(_ip)) {					\
		panic_plain(<span class="enscript-string">&quot;\n%s: Unaligned IP header %p\n&quot;</span>,		\
		    __func__, _ip);					\
	}								\
} <span class="enscript-keyword">while</span> (0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !__i386__ &amp;&amp; !__x86_64__ */</span>

<span class="enscript-type">struct</span> ip;
<span class="enscript-type">struct</span> inpcb;
<span class="enscript-type">struct</span> route;
<span class="enscript-type">struct</span> sockopt;

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/flowadv.h&gt;</span>

<span class="enscript-comment">/*
 * Extra information passed to ip_output when IP_OUTARGS is set.
 *
 * Upon returning an error to the caller, ip_output may indicate through
 * ipoa_retflags any additional information regarding the error.
 */</span>
<span class="enscript-type">struct</span> ip_out_args {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	ipoa_boundif;	<span class="enscript-comment">/* boundif interface index */</span>
	<span class="enscript-type">struct</span> flowadv	ipoa_flowadv;	<span class="enscript-comment">/* flow advisory code */</span>
	u_int32_t	ipoa_flags;	<span class="enscript-comment">/* IPOAF output flags (see below) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPOAF_SELECT_SRCIF</span>	0x00000001	<span class="enscript-comment">/* src interface selection */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPOAF_BOUND_IF</span>		0x00000002	<span class="enscript-comment">/* boundif value is valid */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPOAF_BOUND_SRCADDR</span>	0x00000004	<span class="enscript-comment">/* bound to src address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPOAF_NO_CELLULAR</span>	0x00000010	<span class="enscript-comment">/* skip IFT_CELLULAR */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPOAF_NO_EXPENSIVE</span>	0x00000020	<span class="enscript-comment">/* skip IFT_EXPENSIVE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPOAF_AWDL_UNRESTRICTED</span>	0x00000040	<span class="enscript-comment">/* can send over 
						   AWDL_RESTRICTED */</span>
	u_int32_t	ipoa_retflags;	<span class="enscript-comment">/* IPOARF return flags (see below) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPOARF_IFDENIED</span>	0x00000001	<span class="enscript-comment">/* denied access to interface */</span>
};

<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> ipstat ipstat;
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip_use_randomid;
<span class="enscript-type">extern</span> u_short ip_id;			<span class="enscript-comment">/* ip packet ctr, for ids */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip_defttl;			<span class="enscript-comment">/* default IP ttl */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ipforwarding;		<span class="enscript-comment">/* ip forwarding */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> protosw *ip_protox[];
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> pr_usrreqs rip_usrreqs;
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip_doscopedroute;

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_moptions_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> ip_moptions *<span class="enscript-function-name">ip_allocmoptions</span>(<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inp_getmoptions</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inp_setmoptions</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">imo_addref</span>(<span class="enscript-type">struct</span> ip_moptions *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">imo_remref</span>(<span class="enscript-type">struct</span> ip_moptions *);

<span class="enscript-type">struct</span> protosw;
<span class="enscript-type">struct</span> domain;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_checkrouteralert</span>(<span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_ctloutput</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *sopt);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_drain</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_init</span>(<span class="enscript-type">struct</span> protosw *, <span class="enscript-type">struct</span> domain *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_output</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> route *, <span class="enscript-type">int</span>,
    <span class="enscript-type">struct</span> ip_moptions *, <span class="enscript-type">struct</span> ip_out_args *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_output_list</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> route *,
    <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> ip_moptions *, <span class="enscript-type">struct</span> ip_out_args *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_output_checksum</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>,
    uint32_t *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in_ifaddr *<span class="enscript-function-name">ip_rtaddr</span>(<span class="enscript-type">struct</span> in_addr);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_savecontrol</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">struct</span> ip *,
    <span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> mbuf *<span class="enscript-function-name">ip_srcroute</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span>  <span class="enscript-function-name">ip_stripoptions</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_initid</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> u_int16_t <span class="enscript-function-name">ip_randomid</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_proto_dispatch_in_wrapper</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, u_int8_t);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_fragment</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">unsigned</span> <span class="enscript-type">long</span>, <span class="enscript-type">int</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_setsrcifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, <span class="enscript-type">struct</span> in_ifaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip_setdstifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, <span class="enscript-type">struct</span> in_ifaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_getsrcifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t *, uint32_t *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_getdstifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t *, uint32_t *);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip_ctloutput</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">rip_ctlinput</span>(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">void</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">rip_init</span>(<span class="enscript-type">struct</span> protosw *, <span class="enscript-type">struct</span> domain *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">rip_input</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip_output</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> socket *, u_int32_t, <span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip_unlock</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>, <span class="enscript-type">void</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip_send</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> sockaddr *,
    <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> proc *);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">tcp_in_cksum_stats</span>(u_int32_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">tcp_out_cksum_stats</span>(u_int32_t);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">udp_in_cksum_stats</span>(u_int32_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">udp_out_cksum_stats</span>(u_int32_t);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">INET6</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">tcp_in6_cksum_stats</span>(u_int32_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">tcp_out6_cksum_stats</span>(u_int32_t);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">udp_in6_cksum_stats</span>(u_int32_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">udp_out6_cksum_stats</span>(u_int32_t);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* INET6 */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-comment">/* for PPP/PPTP */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_gre_output</span>(<span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> mbuf *(*gre_input_func_t)(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip_gre_register_input</span>(gre_input_func_t);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_NETINET_IP_VAR_H_ */</span>
</pre>
<hr />
</body></html>