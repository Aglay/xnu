<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>icmp6.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">icmp6.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2013 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*	$KAME: icmp6.h,v 1.46 2001/04/27 15:09:48 itojun Exp $	*/</span>

<span class="enscript-comment">/*
 * Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the project nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */</span>

<span class="enscript-comment">/*
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)ip_icmp.h	8.1 (Berkeley) 6/10/93
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NETINET_ICMP6_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_NETINET_ICMP6_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6_PLD_MAXLEN</span>	1232	<span class="enscript-comment">/* IPV6_MMTU - sizeof(struct ip6_hdr)
					   - sizeof(struct icmp6_hdr) */</span>

<span class="enscript-type">struct</span> icmp6_hdr {
	u_int8_t	icmp6_type;	<span class="enscript-comment">/* type field */</span>
	u_int8_t	icmp6_code;	<span class="enscript-comment">/* code field */</span>
	u_int16_t	icmp6_cksum;	<span class="enscript-comment">/* checksum field */</span>
	<span class="enscript-type">union</span> {
		u_int32_t	icmp6_un_data32[1]; <span class="enscript-comment">/* type-specific field */</span>
		u_int16_t	icmp6_un_data16[2]; <span class="enscript-comment">/* type-specific field */</span>
		u_int8_t	icmp6_un_data8[4];  <span class="enscript-comment">/* type-specific field */</span>
	} icmp6_dataun;
} __attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_data32</span>	icmp6_dataun.icmp6_un_data32
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_data16</span>	icmp6_dataun.icmp6_un_data16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_data8</span>	icmp6_dataun.icmp6_un_data8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_pptr</span>	icmp6_data32[0]		<span class="enscript-comment">/* parameter prob */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_mtu</span>	icmp6_data32[0]		<span class="enscript-comment">/* packet too big */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_id</span>	icmp6_data16[0]		<span class="enscript-comment">/* echo request/reply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_seq</span>	icmp6_data16[1]		<span class="enscript-comment">/* echo request/reply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icmp6_maxdelay</span>	icmp6_data16[0]		<span class="enscript-comment">/* mcast group membership */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_DST_UNREACH</span>		1	<span class="enscript-comment">/* dest unreachable, codes: */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_PACKET_TOO_BIG</span>		2	<span class="enscript-comment">/* packet too big */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_TIME_EXCEEDED</span>		3	<span class="enscript-comment">/* time exceeded, code: */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_PARAM_PROB</span>		4	<span class="enscript-comment">/* ip6 header bad */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_ECHO_REQUEST</span>		128	<span class="enscript-comment">/* echo service */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_ECHO_REPLY</span>		129	<span class="enscript-comment">/* echo reply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD_LISTENER_QUERY</span>		130 	<span class="enscript-comment">/* multicast listener query */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD_LISTENER_REPORT</span>		131	<span class="enscript-comment">/* multicast listener report */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD_LISTENER_DONE</span>		132	<span class="enscript-comment">/* multicast listener done */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD_LISTENER_REDUCTION</span> MLD_LISTENER_DONE <span class="enscript-comment">/* RFC3542 definition */</span>

<span class="enscript-comment">/* RFC2292 decls */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_MEMBERSHIP_QUERY</span>		130	<span class="enscript-comment">/* group membership query */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_MEMBERSHIP_REPORT</span>		131	<span class="enscript-comment">/* group membership report */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_MEMBERSHIP_REDUCTION</span>	132	<span class="enscript-comment">/* group membership termination */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/* the followings are for backward compatibility to old KAME apps. */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD6_LISTENER_QUERY</span>	MLD_LISTENER_QUERY
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD6_LISTENER_REPORT</span>	MLD_LISTENER_REPORT
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD6_LISTENER_DONE</span>	MLD_LISTENER_DONE
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_ROUTER_SOLICIT</span>		133	<span class="enscript-comment">/* router solicitation */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_ROUTER_ADVERT</span>		134	<span class="enscript-comment">/* router advertisement */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NEIGHBOR_SOLICIT</span>		135	<span class="enscript-comment">/* neighbor solicitation */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NEIGHBOR_ADVERT</span>		136	<span class="enscript-comment">/* neighbor advertisement */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_REDIRECT</span>			137	<span class="enscript-comment">/* redirect */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_ROUTER_RENUMBERING</span>	138	<span class="enscript-comment">/* router renumbering */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_WRUREQUEST</span>		139	<span class="enscript-comment">/* who are you request */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_WRUREPLY</span>			140	<span class="enscript-comment">/* who are you reply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_FQDN_QUERY</span>		139	<span class="enscript-comment">/* FQDN query */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_FQDN_REPLY</span>		140	<span class="enscript-comment">/* FQDN reply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_QUERY</span>			139	<span class="enscript-comment">/* node information request */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_REPLY</span>			140	<span class="enscript-comment">/* node information reply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLDV2_LISTENER_REPORT</span>	143	<span class="enscript-comment">/* RFC3810 listener report */</span>

<span class="enscript-comment">/* The definitions below are experimental. TBA */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD_MTRACE_RESP</span>			200	<span class="enscript-comment">/* mtrace resp (to sender) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD_MTRACE</span>			201	<span class="enscript-comment">/* mtrace messages */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD6_MTRACE_RESP</span>	MLD_MTRACE_RESP
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MLD6_MTRACE</span>		MLD_MTRACE
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_MAXTYPE</span>			201

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_DST_UNREACH_NOROUTE</span>	0	<span class="enscript-comment">/* no route to destination */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_DST_UNREACH_ADMIN</span>	 	1	<span class="enscript-comment">/* administratively prohibited */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_DST_UNREACH_NOTNEIGHBOR</span>	2	<span class="enscript-comment">/* not a neighbor(obsolete) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_DST_UNREACH_BEYONDSCOPE</span>	2	<span class="enscript-comment">/* beyond scope of source address */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_DST_UNREACH_ADDR</span>		3	<span class="enscript-comment">/* address unreachable */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_DST_UNREACH_NOPORT</span>	4	<span class="enscript-comment">/* port unreachable */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_TIME_EXCEED_TRANSIT</span> 	0	<span class="enscript-comment">/* ttl==0 in transit */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_TIME_EXCEED_REASSEMBLY</span>	1	<span class="enscript-comment">/* ttl==0 in reass */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_PARAMPROB_HEADER</span> 	 	0	<span class="enscript-comment">/* erroneous header field */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_PARAMPROB_NEXTHEADER</span>	1	<span class="enscript-comment">/* unrecognized next header */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_PARAMPROB_OPTION</span>		2	<span class="enscript-comment">/* unrecognized option */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_INFOMSG_MASK</span>		0x80	<span class="enscript-comment">/* all informational messages */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_SUBJ_IPV6</span>	0	<span class="enscript-comment">/* Query Subject is an IPv6 address */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_SUBJ_FQDN</span>	1	<span class="enscript-comment">/* Query Subject is a Domain name */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_SUBJ_IPV4</span>	2	<span class="enscript-comment">/* Query Subject is an IPv4 address */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_SUCCESS</span>	0	<span class="enscript-comment">/* node information successful reply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_REFUSED</span>	1	<span class="enscript-comment">/* node information request is refused */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NI_UNKNOWN</span>	2	<span class="enscript-comment">/* unknown Qtype */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_ROUTER_RENUMBERING_COMMAND</span>  0	<span class="enscript-comment">/* rr command */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_ROUTER_RENUMBERING_RESULT</span>   1	<span class="enscript-comment">/* rr result */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_ROUTER_RENUMBERING_SEQNUM_RESET</span>   255	<span class="enscript-comment">/* rr seq num reset */</span>

<span class="enscript-comment">/* Used in kernel only */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_REDIRECT_ONLINK</span>	0	<span class="enscript-comment">/* redirect to an on-link node */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_REDIRECT_ROUTER</span>	1	<span class="enscript-comment">/* redirect to a better router */</span>

<span class="enscript-comment">/*
 * Multicast Listener Discovery
 */</span>
<span class="enscript-type">struct</span> mld_hdr {
	<span class="enscript-type">struct</span> icmp6_hdr	mld_icmp6_hdr;
	<span class="enscript-type">struct</span> in6_addr		mld_addr; <span class="enscript-comment">/* multicast address */</span>
} __attribute__((__packed__));

<span class="enscript-comment">/* definitions to provide backward compatibility to old KAME applications */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld6_hdr</span>	mld_hdr
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld6_type</span>	mld_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld6_code</span>	mld_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld6_cksum</span>	mld_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld6_maxdelay</span>	mld_maxdelay
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld6_reserved</span>	mld_reserved
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld6_addr</span>	mld_addr
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* shortcut macro definitions */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld_type</span>	mld_icmp6_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld_code</span>	mld_icmp6_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld_cksum</span>	mld_icmp6_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld_maxdelay</span>	mld_icmp6_hdr.icmp6_data16[0]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld_reserved</span>	mld_icmp6_hdr.icmp6_data16[1]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld_v2_reserved</span>	mld_icmp6_hdr.icmp6_data16[0]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">mld_v2_numrecs</span>	mld_icmp6_hdr.icmp6_data16[1]

<span class="enscript-comment">/*
 * Neighbor Discovery
 */</span>

<span class="enscript-type">struct</span> nd_router_solicit {	<span class="enscript-comment">/* router solicitation */</span>
	<span class="enscript-type">struct</span> icmp6_hdr 	nd_rs_hdr;
	<span class="enscript-comment">/* could be followed by options */</span>
}__attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rs_type</span>	nd_rs_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rs_code</span>	nd_rs_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rs_cksum</span>	nd_rs_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rs_reserved</span>	nd_rs_hdr.icmp6_data32[0]

<span class="enscript-type">struct</span> nd_router_advert {	<span class="enscript-comment">/* router advertisement */</span>
	<span class="enscript-type">struct</span> icmp6_hdr	nd_ra_hdr;
	u_int32_t		nd_ra_reachable;	<span class="enscript-comment">/* reachable time */</span>
	u_int32_t		nd_ra_retransmit;	<span class="enscript-comment">/* retransmit timer */</span>
	<span class="enscript-comment">/* could be followed by options */</span>
} __attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ra_type</span>		nd_ra_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ra_code</span>		nd_ra_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ra_cksum</span>		nd_ra_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ra_curhoplimit</span>	nd_ra_hdr.icmp6_data8[0]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ra_flags_reserved</span>	nd_ra_hdr.icmp6_data8[1]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_MANAGED</span>	0x80
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_OTHER</span>	0x40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_HA</span>		0x20

<span class="enscript-comment">/*
 * Router preference values based on draft-draves-ipngwg-router-selection-01.
 * These are non-standard definitions.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_RTPREF_MASK</span>	0x18 <span class="enscript-comment">/* 00011000 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_RTPREF_HIGH</span>	0x08 <span class="enscript-comment">/* 00001000 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_RTPREF_MEDIUM</span>	0x00 <span class="enscript-comment">/* 00000000 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_RTPREF_LOW</span>	0x18 <span class="enscript-comment">/* 00011000 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_RA_FLAG_RTPREF_RSV</span>	0x10 <span class="enscript-comment">/* 00010000 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ra_router_lifetime</span>	nd_ra_hdr.icmp6_data16[1]

<span class="enscript-type">struct</span> nd_neighbor_solicit {	<span class="enscript-comment">/* neighbor solicitation */</span>
	<span class="enscript-type">struct</span> icmp6_hdr	nd_ns_hdr;
	<span class="enscript-type">struct</span> in6_addr		nd_ns_target;	<span class="enscript-comment">/*target address */</span>
	<span class="enscript-comment">/* could be followed by options */</span>
}__attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ns_type</span>		nd_ns_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ns_code</span>		nd_ns_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ns_cksum</span>		nd_ns_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_ns_reserved</span>		nd_ns_hdr.icmp6_data32[0]

<span class="enscript-type">struct</span> nd_neighbor_advert {	<span class="enscript-comment">/* neighbor advertisement */</span>
	<span class="enscript-type">struct</span> icmp6_hdr	nd_na_hdr;
	<span class="enscript-type">struct</span> in6_addr		nd_na_target;	<span class="enscript-comment">/* target address */</span>
	<span class="enscript-comment">/* could be followed by options */</span>
}__attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_na_type</span>		nd_na_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_na_code</span>		nd_na_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_na_cksum</span>		nd_na_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_na_flags_reserved</span>	nd_na_hdr.icmp6_data32[0]
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">BIG_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NA_FLAG_ROUTER</span>		0x80000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NA_FLAG_SOLICITED</span>		0x40000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NA_FLAG_OVERRIDE</span>		0x20000000
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">LITTLE_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NA_FLAG_ROUTER</span>		0x80
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NA_FLAG_SOLICITED</span>		0x40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_NA_FLAG_OVERRIDE</span>		0x20
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-type">struct</span> nd_redirect {		<span class="enscript-comment">/* redirect */</span>
	<span class="enscript-type">struct</span> icmp6_hdr	nd_rd_hdr;
	<span class="enscript-type">struct</span> in6_addr		nd_rd_target;	<span class="enscript-comment">/* target address */</span>
	<span class="enscript-type">struct</span> in6_addr		nd_rd_dst;	<span class="enscript-comment">/* destination address */</span>
	<span class="enscript-comment">/* could be followed by options */</span>
}__attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rd_type</span>		nd_rd_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rd_code</span>		nd_rd_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rd_cksum</span>		nd_rd_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">nd_rd_reserved</span>		nd_rd_hdr.icmp6_data32[0]

<span class="enscript-type">struct</span> nd_opt_hdr {		<span class="enscript-comment">/* Neighbor discovery option header */</span>
	u_int8_t	nd_opt_type;
	u_int8_t	nd_opt_len;
	<span class="enscript-comment">/* followed by option specific data*/</span>
}__attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_SOURCE_LINKADDR</span>		1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_TARGET_LINKADDR</span>		2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_PREFIX_INFORMATION</span>	3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_REDIRECTED_HEADER</span>	4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_MTU</span>			5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_RDNSS</span>			25	<span class="enscript-comment">/* RFC 5006 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_DNSSL</span>			31	<span class="enscript-comment">/* RFC 6106 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_ROUTE_INFO</span>		200	<span class="enscript-comment">/* draft-ietf-ipngwg-router-preference, not officially assigned yet */</span>

<span class="enscript-type">struct</span> nd_opt_prefix_info {	<span class="enscript-comment">/* prefix information */</span>
	u_int8_t	nd_opt_pi_type;
	u_int8_t	nd_opt_pi_len;
	u_int8_t	nd_opt_pi_prefix_len;
	u_int8_t	nd_opt_pi_flags_reserved;
	u_int32_t	nd_opt_pi_valid_time;
	u_int32_t	nd_opt_pi_preferred_time;
	u_int32_t	nd_opt_pi_reserved2;
	<span class="enscript-type">struct</span> in6_addr	nd_opt_pi_prefix;
}__attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_PI_FLAG_ONLINK</span>		0x80
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ND_OPT_PI_FLAG_AUTO</span>		0x40

<span class="enscript-type">struct</span> nd_opt_rd_hdr {		<span class="enscript-comment">/* redirected header */</span>
	u_int8_t	nd_opt_rh_type;
	u_int8_t	nd_opt_rh_len;
	u_int16_t	nd_opt_rh_reserved1;
	u_int32_t	nd_opt_rh_reserved2;
	<span class="enscript-comment">/* followed by IP header and data */</span>
} __attribute__((__packed__));

<span class="enscript-type">struct</span> nd_opt_mtu {		<span class="enscript-comment">/* MTU option */</span>
	u_int8_t	nd_opt_mtu_type;
	u_int8_t	nd_opt_mtu_len;
	u_int16_t	nd_opt_mtu_reserved;
	u_int32_t	nd_opt_mtu_mtu;
}__attribute__((__packed__));

<span class="enscript-type">struct</span> nd_opt_route_info {	<span class="enscript-comment">/* route info */</span>
	u_int8_t	nd_opt_rti_type;
	u_int8_t	nd_opt_rti_len;
	u_int8_t	nd_opt_rti_prefixlen;
	u_int8_t	nd_opt_rti_flags;
	u_int32_t	nd_opt_rti_lifetime;
	<span class="enscript-comment">/* prefix follows */</span>
}__attribute__((__packed__));

<span class="enscript-type">struct</span> nd_opt_rdnss {	<span class="enscript-comment">/* recursive domain name system servers */</span>
    u_int8_t		nd_opt_rdnss_type;
    u_int8_t		nd_opt_rdnss_len;
    u_int16_t		nd_opt_rdnss_reserved;
    u_int32_t		nd_opt_rdnss_lifetime;
    <span class="enscript-type">struct</span> in6_addr	nd_opt_rdnss_addr[1];
} __attribute__((__packed__));

<span class="enscript-type">struct</span> nd_opt_dnssl {	<span class="enscript-comment">/* domain name search list */</span>
    u_int8_t		nd_opt_dnssl_type;
    u_int8_t		nd_opt_dnssl_len;
    u_int16_t 		nd_opt_dnssl_reserved;
    u_int32_t		nd_opt_dnssl_lifetime;
    u_int8_t		nd_opt_dnssl_domains[8];
} __attribute__((__packed__));

<span class="enscript-comment">/*
 * icmp6 namelookup
 */</span>

<span class="enscript-type">struct</span> icmp6_namelookup {
	<span class="enscript-type">struct</span> icmp6_hdr 	icmp6_nl_hdr;
	u_int8_t	icmp6_nl_nonce[8];
	int32_t		icmp6_nl_ttl;
#<span class="enscript-reference">if</span> 0
	u_int8_t	icmp6_nl_len;
	u_int8_t	icmp6_nl_name[3];
#<span class="enscript-reference">endif</span>
	<span class="enscript-comment">/* could be followed by options */</span>
}__attribute__((__packed__));

<span class="enscript-comment">/*
 * icmp6 node information
 */</span>
<span class="enscript-type">struct</span> icmp6_nodeinfo {
	<span class="enscript-type">struct</span> icmp6_hdr icmp6_ni_hdr;
	u_int8_t icmp6_ni_nonce[8];
	<span class="enscript-comment">/* could be followed by reply data */</span>
}__attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ni_type</span>		icmp6_ni_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ni_code</span>		icmp6_ni_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ni_cksum</span>	icmp6_ni_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ni_qtype</span>	icmp6_ni_hdr.icmp6_data16[0]
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ni_flags</span>	icmp6_ni_hdr.icmp6_data16[1]

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_QTYPE_NOOP</span>		0 <span class="enscript-comment">/* NOOP  */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_QTYPE_SUPTYPES</span>	1 <span class="enscript-comment">/* Supported Qtypes */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_QTYPE_FQDN</span>		2 <span class="enscript-comment">/* FQDN (draft 04) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_QTYPE_DNSNAME</span>	2 <span class="enscript-comment">/* DNS Name */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_QTYPE_NODEADDR</span>	3 <span class="enscript-comment">/* Node Addresses */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_QTYPE_IPV4ADDR</span>	4 <span class="enscript-comment">/* IPv4 Addresses */</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">BIG_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_SUPTYPE_FLAG_COMPRESS</span>	0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_FQDN_FLAG_VALIDTTL</span>		0x1
#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">LITTLE_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_SUPTYPE_FLAG_COMPRESS</span>	0x0100
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_FQDN_FLAG_VALIDTTL</span>		0x0100
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">NAME_LOOKUPS_04</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">BIG_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_LINKLOCAL</span>	0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_SITELOCAL</span>	0x2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_GLOBAL</span>		0x4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ALL</span>		0x8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_TRUNCATE</span>	0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ANYCAST</span>	0x20 <span class="enscript-comment">/* just experimental. not in spec */</span>
#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">LITTLE_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_LINKLOCAL</span>	0x0100
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_SITELOCAL</span>	0x0200
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_GLOBAL</span>		0x0400
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ALL</span>		0x0800
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_TRUNCATE</span>	0x1000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ANYCAST</span>	0x2000 <span class="enscript-comment">/* just experimental. not in spec */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">else</span>  <span class="enscript-comment">/* draft-ietf-ipngwg-icmp-name-lookups-05 (and later?) */</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">BIG_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_TRUNCATE</span>	0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ALL</span>		0x2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_COMPAT</span>		0x4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_LINKLOCAL</span>	0x8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_SITELOCAL</span>	0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_GLOBAL</span>		0x20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ANYCAST</span>	0x40 <span class="enscript-comment">/* just experimental. not in spec */</span>
#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">LITTLE_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_TRUNCATE</span>	0x0100
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ALL</span>		0x0200
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_COMPAT</span>		0x0400
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_LINKLOCAL</span>	0x0800
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_SITELOCAL</span>	0x1000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_GLOBAL</span>		0x2000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NI_NODEADDR_FLAG_ANYCAST</span>	0x4000 <span class="enscript-comment">/* just experimental. not in spec */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-type">struct</span> ni_reply_fqdn {
	u_int32_t ni_fqdn_ttl;	<span class="enscript-comment">/* TTL */</span>
	u_int8_t ni_fqdn_namelen; <span class="enscript-comment">/* length in octets of the FQDN */</span>
	u_int8_t ni_fqdn_name[3]; <span class="enscript-comment">/* XXX: alignment */</span>
}__attribute__((__packed__));

<span class="enscript-comment">/*
 * Router Renumbering. as router-renum-08.txt
 */</span>
<span class="enscript-type">struct</span> icmp6_router_renum {	<span class="enscript-comment">/* router renumbering header */</span>
	<span class="enscript-type">struct</span> icmp6_hdr	rr_hdr;
	u_int8_t	rr_segnum;
	u_int8_t	rr_flags;
	u_int16_t	rr_maxdelay;
	u_int32_t	rr_reserved;
} __attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_FLAGS_TEST</span>		0x80
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_FLAGS_REQRESULT</span>	0x40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_FLAGS_FORCEAPPLY</span>	0x20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_FLAGS_SPECSITE</span>		0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_FLAGS_PREVDONE</span>		0x08

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">rr_type</span>		rr_hdr.icmp6_type
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">rr_code</span>		rr_hdr.icmp6_code
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">rr_cksum</span>	rr_hdr.icmp6_cksum
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">rr_seqnum</span> 	rr_hdr.icmp6_data32[0]

<span class="enscript-type">struct</span> rr_pco_match {		<span class="enscript-comment">/* match prefix part */</span>
	u_int8_t	rpm_code;
	u_int8_t	rpm_len;
	u_int8_t	rpm_ordinal;
	u_int8_t	rpm_matchlen;
	u_int8_t	rpm_minlen;
	u_int8_t	rpm_maxlen;
	u_int16_t	rpm_reserved;
	<span class="enscript-type">struct</span>	in6_addr	rpm_prefix;
} __attribute__((__packed__));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RPM_PCO_ADD</span>		1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RPM_PCO_CHANGE</span>		2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RPM_PCO_SETGLOBAL</span>	3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">RPM_PCO_MAX</span>		4

<span class="enscript-type">struct</span> rr_pco_use {		<span class="enscript-comment">/* use prefix part */</span>
	u_int8_t	rpu_uselen;
	u_int8_t	rpu_keeplen;
	u_int8_t	rpu_ramask;
	u_int8_t	rpu_raflags;
	u_int32_t	rpu_vltime;
	u_int32_t	rpu_pltime;
	u_int32_t	rpu_flags;
	<span class="enscript-type">struct</span>	in6_addr rpu_prefix;
} __attribute__((__packed__));
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_PCOUSE_RAFLAGS_ONLINK</span>	0x80
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_PCOUSE_RAFLAGS_AUTO</span>	0x40

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">BIG_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME</span>     0x80000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME</span>     0x40000000
#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">LITTLE_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_PCOUSE_FLAGS_DECRVLTIME</span>     0x80
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_PCOUSE_FLAGS_DECRPLTIME</span>     0x40
#<span class="enscript-reference">endif</span>

<span class="enscript-type">struct</span> rr_result {		<span class="enscript-comment">/* router renumbering result message */</span>
	u_int16_t	rrr_flags;
	u_int8_t	rrr_ordinal;
	u_int8_t	rrr_matchedlen;
	u_int32_t	rrr_ifid;
	<span class="enscript-type">struct</span>	in6_addr rrr_prefix;
} __attribute__((__packed__));
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">BIG_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_RESULT_FLAGS_OOB</span>		0x0002
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_RESULT_FLAGS_FORBIDDEN</span>		0x0001
#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">LITTLE_ENDIAN</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_RESULT_FLAGS_OOB</span>		0x0200
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_RR_RESULT_FLAGS_FORBIDDEN</span>		0x0100
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * icmp6 filter structures.
 */</span>

<span class="enscript-type">struct</span> icmp6_filter {
	u_int32_t icmp6_filt[8];
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_SETPASSALL</span>(filterp) \
<span class="enscript-keyword">do</span> {								\
	<span class="enscript-type">int</span> i; u_char *ptr;					\
	ptr = (u_char *)filterp;					\
	<span class="enscript-keyword">for</span> (i = 0; i &lt; <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">struct</span> icmp6_filter); i++)	\
		ptr[i] = 0xff;					\
} <span class="enscript-keyword">while</span> (0)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_SETBLOCKALL</span>(filterp) \
	bzero(filterp, <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">struct</span> icmp6_filter))
#<span class="enscript-reference">else</span> <span class="enscript-comment">/* KERNEL */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_SETPASSALL</span>(filterp) \
	memset(filterp, 0xff, <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">struct</span> icmp6_filter))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_SETBLOCKALL</span>(filterp) \
	memset(filterp, 0x00, <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">struct</span> icmp6_filter))
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_SETPASS</span>(type, filterp) \
	(((filterp)-&gt;icmp6_filt[(type) &gt;&gt; 5]) |= (1 &lt;&lt; ((type) &amp; 31)))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_SETBLOCK</span>(type, filterp) \
	(((filterp)-&gt;icmp6_filt[(type) &gt;&gt; 5]) &amp;= ~(1 &lt;&lt; ((type) &amp; 31)))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_WILLPASS</span>(type, filterp) \
	((((filterp)-&gt;icmp6_filt[(type) &gt;&gt; 5]) &amp; (1 &lt;&lt; ((type) &amp; 31))) != 0)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ICMP6_FILTER_WILLBLOCK</span>(type, filterp) \
	((((filterp)-&gt;icmp6_filt[(type) &gt;&gt; 5]) &amp; (1 &lt;&lt; ((type) &amp; 31))) == 0)

<span class="enscript-comment">/*
 * Variables related to this implementation
 * of the internet control message protocol version 6.
 */</span>
<span class="enscript-type">struct</span> icmp6errstat {
	u_quad_t icp6errs_dst_unreach_noroute;
	u_quad_t icp6errs_dst_unreach_admin;
	u_quad_t icp6errs_dst_unreach_beyondscope;
	u_quad_t icp6errs_dst_unreach_addr;
	u_quad_t icp6errs_dst_unreach_noport;
	u_quad_t icp6errs_packet_too_big;
	u_quad_t icp6errs_time_exceed_transit;
	u_quad_t icp6errs_time_exceed_reassembly;
	u_quad_t icp6errs_paramprob_header;
	u_quad_t icp6errs_paramprob_nextheader;
	u_quad_t icp6errs_paramprob_option;
	u_quad_t icp6errs_redirect; <span class="enscript-comment">/* we regard redirect as an error here */</span>
	u_quad_t icp6errs_unknown;
};

<span class="enscript-type">struct</span> icmp6stat {
<span class="enscript-comment">/* statistics related to icmp6 packets generated */</span>
	u_quad_t icp6s_error;		<span class="enscript-comment">/* # of calls to icmp6_error */</span>
	u_quad_t icp6s_canterror;	<span class="enscript-comment">/* no error 'cuz old was icmp */</span>
	u_quad_t icp6s_toofreq;		<span class="enscript-comment">/* no error 'cuz rate limitation */</span>
	u_quad_t icp6s_outhist[256];
<span class="enscript-comment">/* statistics related to input message processed */</span>
	u_quad_t icp6s_badcode;		<span class="enscript-comment">/* icmp6_code out of range */</span>
	u_quad_t icp6s_tooshort;	<span class="enscript-comment">/* packet &lt; sizeof(struct icmp6_hdr) */</span>
	u_quad_t icp6s_checksum;	<span class="enscript-comment">/* bad checksum */</span>
	u_quad_t icp6s_badlen;		<span class="enscript-comment">/* calculated bound mismatch */</span>
	u_quad_t icp6s_reflect;		<span class="enscript-comment">/* number of responses */</span>
	u_quad_t icp6s_inhist[256];	
	u_quad_t icp6s_nd_toomanyopt;	<span class="enscript-comment">/* too many ND options */</span>
	<span class="enscript-type">struct</span> icmp6errstat icp6s_outerrhist;
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_odst_unreach_noroute</span> \
	icp6s_outerrhist.icp6errs_dst_unreach_noroute
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_odst_unreach_admin</span> icp6s_outerrhist.icp6errs_dst_unreach_admin
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_odst_unreach_beyondscope</span> \
	icp6s_outerrhist.icp6errs_dst_unreach_beyondscope
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_odst_unreach_addr</span> icp6s_outerrhist.icp6errs_dst_unreach_addr
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_odst_unreach_noport</span> icp6s_outerrhist.icp6errs_dst_unreach_noport
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_opacket_too_big</span> icp6s_outerrhist.icp6errs_packet_too_big
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_otime_exceed_transit</span> \
	icp6s_outerrhist.icp6errs_time_exceed_transit
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_otime_exceed_reassembly</span> \
	icp6s_outerrhist.icp6errs_time_exceed_reassembly
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_oparamprob_header</span> icp6s_outerrhist.icp6errs_paramprob_header
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_oparamprob_nextheader</span> \
	icp6s_outerrhist.icp6errs_paramprob_nextheader
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_oparamprob_option</span> icp6s_outerrhist.icp6errs_paramprob_option
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_oredirect</span> icp6s_outerrhist.icp6errs_redirect
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">icp6s_ounknown</span> icp6s_outerrhist.icp6errs_unknown
	u_quad_t icp6s_pmtuchg;		<span class="enscript-comment">/* path MTU changes */</span>
	u_quad_t icp6s_nd_badopt;	<span class="enscript-comment">/* bad ND options */</span>
	u_quad_t icp6s_badns;		<span class="enscript-comment">/* bad neighbor solicitation */</span>
	u_quad_t icp6s_badna;		<span class="enscript-comment">/* bad neighbor advertisement */</span>
	u_quad_t icp6s_badrs;		<span class="enscript-comment">/* bad router advertisement */</span>
	u_quad_t icp6s_badra;		<span class="enscript-comment">/* bad router advertisement */</span>
	u_quad_t icp6s_badredirect;	<span class="enscript-comment">/* bad redirect message */</span>
};

<span class="enscript-comment">/*
 * Names for ICMP sysctl objects
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_STATS</span>				1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_REDIRACCEPT</span>		2	<span class="enscript-comment">/* accept/process redirects */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_REDIRTIMEOUT</span>		3	<span class="enscript-comment">/* redirect cache time */</span>
#<span class="enscript-reference">if</span> 0	<span class="enscript-comment">/*obsoleted*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ERRRATELIMIT</span>		5	<span class="enscript-comment">/* ICMPv6 error rate limitation */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_PRUNE</span>		6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_DELAY</span>		8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_UMAXTRIES</span>		9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_MMAXTRIES</span>		10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_USELOOPBACK</span>	11
<span class="enscript-comment">/*#define ICMPV6CTL_ND6_PROXYALL	12	obsoleted, do not reuse here */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_NODEINFO</span>		13
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ERRPPSLIMIT</span>		14	<span class="enscript-comment">/* ICMPv6 error pps limitation */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_MAXNUDHINT</span>	15
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_MTUDISC_HIWAT</span>		16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_MTUDISC_LOWAT</span>		17
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_DEBUG</span>		18
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_DRLIST</span>		19
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_PRLIST</span>		20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_MLD_MAXSRCFILTER</span>	21
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_MLD_SOMAXSRC</span>		22
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_MLD_VERSION</span>		23
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_MAXQLEN</span>		24
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_ACCEPT_6TO4</span>	25
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_ND6_OPTIMISTIC_DAD</span>	26	<span class="enscript-comment">/* RFC 4429 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_MAXID</span>			27

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMPV6CTL_NAMES</span> { \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;rediraccept&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;redirtimeout&quot;</span>, CTLTYPE_INT }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;nd6_prune&quot;</span>, CTLTYPE_INT }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;nd6_delay&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;nd6_umaxtries&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;nd6_mmaxtries&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;nd6_useloopback&quot;</span>, CTLTYPE_INT }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;nodeinfo&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;errppslimit&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;nd6_maxnudhint&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;mtudisc_hiwat&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;mtudisc_lowat&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;nd6_debug&quot;</span>, CTLTYPE_INT }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;nd6_accept_6to4&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;nd6_optimistic_dad&quot;</span>, CTLTYPE_INT }, \
}

# <span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__STDC__</span>
<span class="enscript-type">struct</span>	rtentry;
<span class="enscript-type">struct</span>	rttimer;
<span class="enscript-type">struct</span>	in6_multi;
# <span class="enscript-reference">endif</span>
<span class="enscript-type">struct</span> ip6protosw;
<span class="enscript-type">void</span>	icmp6_init(<span class="enscript-type">struct</span> ip6protosw *, <span class="enscript-type">struct</span> domain *);
<span class="enscript-type">void</span>	icmp6_paramerror(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);

<span class="enscript-type">void</span>	icmp6_error_flag(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ICMP6_ERROR_RST_MRCVIF</span>	0x1

<span class="enscript-type">void</span>	icmp6_error(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">void</span>	icmp6_error2(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">int</span>	icmp6_input(<span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">int</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">void</span>	icmp6_reflect(<span class="enscript-type">struct</span> mbuf *, size_t);
<span class="enscript-type">void</span>	icmp6_prepare(<span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">void</span>	icmp6_redirect_input(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);
<span class="enscript-type">void</span>	icmp6_redirect_output(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> rtentry *);

<span class="enscript-type">struct</span>	ip6ctlparam;
<span class="enscript-type">void</span>	icmp6_mtudisc_update(<span class="enscript-type">struct</span> ip6ctlparam *, <span class="enscript-type">int</span>);

<span class="enscript-type">extern</span> lck_rw_t icmp6_ifs_rwlock;
<span class="enscript-comment">/* XXX: is this the right place for these macros? */</span>
<span class="enscript-comment">/* N.B.: if_inet6data is never freed once set, so we don't need to lock */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">icmp6_ifstat_inc</span>(_ifp, _tag) do {			\
	<span class="enscript-keyword">if</span> (_ifp != NULL &amp;&amp; IN6_IFEXTRA(_ifp) != NULL) {	\
		IN6_IFEXTRA(_ifp)-&gt;icmp6_ifstat._tag++;		\
	}							\
} <span class="enscript-keyword">while</span> (0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">icmp6_ifoutstat_inc</span>(ifp, type, code) do {		\
	icmp6_ifstat_inc(ifp, ifs6_out_msg);			\
	<span class="enscript-keyword">if</span> (type &lt; ICMP6_INFOMSG_MASK)				\
 		icmp6_ifstat_inc(ifp, ifs6_out_error);		\
	<span class="enscript-keyword">switch</span> (type) {						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ICMP6_DST_UNREACH</span>:					\
		icmp6_ifstat_inc(ifp, ifs6_out_dstunreach);	\
		<span class="enscript-keyword">if</span> (code == ICMP6_DST_UNREACH_ADMIN)		\
			icmp6_ifstat_inc(ifp, ifs6_out_adminprohib);\
		 <span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ICMP6_PACKET_TOO_BIG</span>:				\
		icmp6_ifstat_inc(ifp, ifs6_out_pkttoobig);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ICMP6_TIME_EXCEEDED</span>:				\
		icmp6_ifstat_inc(ifp, ifs6_out_timeexceed);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ICMP6_PARAM_PROB</span>:					\
		icmp6_ifstat_inc(ifp, ifs6_out_paramprob);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ICMP6_ECHO_REQUEST</span>:				\
		icmp6_ifstat_inc(ifp, ifs6_out_echo);		\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ICMP6_ECHO_REPLY</span>:					\
		icmp6_ifstat_inc(ifp, ifs6_out_echoreply);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MLD_LISTENER_QUERY</span>:				\
		icmp6_ifstat_inc(ifp, ifs6_out_mldquery);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MLD_LISTENER_REPORT</span>:				\
		icmp6_ifstat_inc(ifp, ifs6_out_mldreport);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MLD_LISTENER_DONE</span>:					\
		icmp6_ifstat_inc(ifp, ifs6_out_mlddone);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ND_ROUTER_SOLICIT</span>:					\
		icmp6_ifstat_inc(ifp, ifs6_out_routersolicit);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ND_ROUTER_ADVERT</span>:					\
		icmp6_ifstat_inc(ifp, ifs6_out_routeradvert);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ND_NEIGHBOR_SOLICIT</span>:				\
		icmp6_ifstat_inc(ifp, ifs6_out_neighborsolicit);\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ND_NEIGHBOR_ADVERT</span>:				\
		icmp6_ifstat_inc(ifp, ifs6_out_neighboradvert);	\
		<span class="enscript-keyword">break</span>;						\
	<span class="enscript-keyword">case</span> <span class="enscript-reference">ND_REDIRECT</span>:					\
		icmp6_ifstat_inc(ifp, ifs6_out_redirect);	\
		<span class="enscript-keyword">break</span>;						\
	}							\
} <span class="enscript-keyword">while</span> (0)

<span class="enscript-type">extern</span> <span class="enscript-type">int</span>	icmp6_rediraccept;	<span class="enscript-comment">/* accept/process redirects */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span>	icmp6_redirtimeout;	<span class="enscript-comment">/* cache time for redirect routes */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NODEINFO_FQDNOK</span>		0x1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NODEINFO_NODEADDROK</span>	0x2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NODEINFO_TMPADDROK</span>	0x4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ICMP6_NODEINFO_GLOBALOK</span>		0x8

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_NETINET_ICMP6_H_ */</span>
</pre>
<hr />
</body></html>