<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>in.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">in.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2013 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*
 * Copyright (c) 1982, 1986, 1990, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)in.h	8.3 (Berkeley) 1/3/94
 * $FreeBSD: src/sys/netinet/in.h,v 1.48.2.2 2001/04/21 14:53:06 ume Exp $
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NETINET_IN_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_NETINET_IN_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;stdint.h&gt;</span>		<span class="enscript-comment">/* uint(8|16|32)_t */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;Availability.h&gt;</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_in_addr_t.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_in_port_t.h&gt;</span>

<span class="enscript-comment">/*
 * POSIX 1003.1-2003
 * &quot;Inclusion of the &lt;netinet/in.h&gt; header may also make visible all
 *  symbols from &lt;inttypes.h&gt; and &lt;sys/socket.h&gt;&quot;.
 */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/socket.h&gt;</span>

<span class="enscript-comment">/*
 * The following two #includes insure htonl and family are defined
 */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;machine/endian.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_endian.h&gt;</span>

<span class="enscript-comment">/*
 * Constants and structures defined by the internet system,
 * Per RFC 790, September 1981, and numerous additions.
 */</span>

<span class="enscript-comment">/*
 * Protocols (RFC 1700)
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IP</span>		0		<span class="enscript-comment">/* dummy for IP */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_HOPOPTS</span>	0		<span class="enscript-comment">/* IP6 hop-by-hop options */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ICMP</span>		1		<span class="enscript-comment">/* control message protocol */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IGMP</span>		2		<span class="enscript-comment">/* group mgmt protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_GGP</span>		3		<span class="enscript-comment">/* gateway^2 (deprecated) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPPROTO_IPV4</span>		4 		<span class="enscript-comment">/* IPv4 encapsulation */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPPROTO_IPIP</span>		IPPROTO_IPV4	<span class="enscript-comment">/* for compatibility */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_TCP</span>		6		<span class="enscript-comment">/* tcp */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ST</span>		7		<span class="enscript-comment">/* Stream protocol II */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_EGP</span>		8		<span class="enscript-comment">/* exterior gateway protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_PIGP</span>		9		<span class="enscript-comment">/* private interior gateway */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_RCCMON</span>		10		<span class="enscript-comment">/* BBN RCC Monitoring */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_NVPII</span>		11		<span class="enscript-comment">/* network voice protocol*/</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_PUP</span>		12		<span class="enscript-comment">/* pup */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ARGUS</span>		13		<span class="enscript-comment">/* Argus */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_EMCON</span>		14		<span class="enscript-comment">/* EMCON */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_XNET</span>		15		<span class="enscript-comment">/* Cross Net Debugger */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_CHAOS</span>		16		<span class="enscript-comment">/* Chaos*/</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_UDP</span>		17		<span class="enscript-comment">/* user datagram protocol */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_MUX</span>		18		<span class="enscript-comment">/* Multiplexing */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_MEAS</span>		19		<span class="enscript-comment">/* DCN Measurement Subsystems */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_HMP</span>		20		<span class="enscript-comment">/* Host Monitoring */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_PRM</span>		21		<span class="enscript-comment">/* Packet Radio Measurement */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IDP</span>		22		<span class="enscript-comment">/* xns idp */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_TRUNK1</span>		23		<span class="enscript-comment">/* Trunk-1 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_TRUNK2</span>		24		<span class="enscript-comment">/* Trunk-2 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_LEAF1</span>		25		<span class="enscript-comment">/* Leaf-1 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_LEAF2</span>		26		<span class="enscript-comment">/* Leaf-2 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_RDP</span>		27		<span class="enscript-comment">/* Reliable Data */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IRTP</span>		28		<span class="enscript-comment">/* Reliable Transaction */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_TP</span>		29 		<span class="enscript-comment">/* tp-4 w/ class negotiation */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_BLT</span>		30		<span class="enscript-comment">/* Bulk Data Transfer */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_NSP</span>		31		<span class="enscript-comment">/* Network Services */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_INP</span>		32		<span class="enscript-comment">/* Merit Internodal */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SEP</span>		33		<span class="enscript-comment">/* Sequential Exchange */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_3PC</span>		34		<span class="enscript-comment">/* Third Party Connect */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IDPR</span>		35		<span class="enscript-comment">/* InterDomain Policy Routing */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_XTP</span>		36		<span class="enscript-comment">/* XTP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_DDP</span>		37		<span class="enscript-comment">/* Datagram Delivery */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_CMTP</span>		38		<span class="enscript-comment">/* Control Message Transport */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_TPXX</span>		39		<span class="enscript-comment">/* TP++ Transport */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IL</span>		40		<span class="enscript-comment">/* IL transport protocol */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span> 	<span class="enscript-variable-name">IPPROTO_IPV6</span>		41		<span class="enscript-comment">/* IP6 header */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SDRP</span>		42		<span class="enscript-comment">/* Source Demand Routing */</span>
#<span class="enscript-reference">define</span> 	<span class="enscript-variable-name">IPPROTO_ROUTING</span>	43		<span class="enscript-comment">/* IP6 routing header */</span>
#<span class="enscript-reference">define</span> 	<span class="enscript-variable-name">IPPROTO_FRAGMENT</span>	44		<span class="enscript-comment">/* IP6 fragmentation header */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IDRP</span>		45		<span class="enscript-comment">/* InterDomain Routing*/</span>
#<span class="enscript-reference">define</span> 	<span class="enscript-variable-name">IPPROTO_RSVP</span>		46 		<span class="enscript-comment">/* resource reservation */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_GRE</span>		47		<span class="enscript-comment">/* General Routing Encap. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_MHRP</span>		48		<span class="enscript-comment">/* Mobile Host Routing */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_BHA</span>		49		<span class="enscript-comment">/* BHA */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ESP</span>		50		<span class="enscript-comment">/* IP6 Encap Sec. Payload */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_AH</span>		51		<span class="enscript-comment">/* IP6 Auth Header */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_INLSP</span>		52		<span class="enscript-comment">/* Integ. Net Layer Security */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SWIPE</span>		53		<span class="enscript-comment">/* IP with encryption */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_NHRP</span>		54		<span class="enscript-comment">/* Next Hop Resolution */</span>
<span class="enscript-comment">/* 55-57: Unassigned */</span>
#<span class="enscript-reference">define</span> 	<span class="enscript-variable-name">IPPROTO_ICMPV6</span>	58		<span class="enscript-comment">/* ICMP6 */</span>
#<span class="enscript-reference">define</span> 	<span class="enscript-variable-name">IPPROTO_NONE</span>		59		<span class="enscript-comment">/* IP6 no next header */</span>
#<span class="enscript-reference">define</span> 	<span class="enscript-variable-name">IPPROTO_DSTOPTS</span>	60		<span class="enscript-comment">/* IP6 destination option */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_AHIP</span>		61		<span class="enscript-comment">/* any host internal protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_CFTP</span>		62		<span class="enscript-comment">/* CFTP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_HELLO</span>		63		<span class="enscript-comment">/* &quot;hello&quot; routing protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SATEXPAK</span>	64		<span class="enscript-comment">/* SATNET/Backroom EXPAK */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_KRYPTOLAN</span>	65		<span class="enscript-comment">/* Kryptolan */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_RVD</span>		66		<span class="enscript-comment">/* Remote Virtual Disk */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IPPC</span>		67		<span class="enscript-comment">/* Pluribus Packet Core */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ADFS</span>		68		<span class="enscript-comment">/* Any distributed FS */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SATMON</span>		69		<span class="enscript-comment">/* Satnet Monitoring */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_VISA</span>		70		<span class="enscript-comment">/* VISA Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IPCV</span>		71		<span class="enscript-comment">/* Packet Core Utility */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_CPNX</span>		72		<span class="enscript-comment">/* Comp. Prot. Net. Executive */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_CPHB</span>		73		<span class="enscript-comment">/* Comp. Prot. HeartBeat */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_WSN</span>		74		<span class="enscript-comment">/* Wang Span Network */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_PVP</span>		75		<span class="enscript-comment">/* Packet Video Protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_BRSATMON</span>	76		<span class="enscript-comment">/* BackRoom SATNET Monitoring */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ND</span>		77		<span class="enscript-comment">/* Sun net disk proto (temp.) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_WBMON</span>		78		<span class="enscript-comment">/* WIDEBAND Monitoring */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_WBEXPAK</span>		79		<span class="enscript-comment">/* WIDEBAND EXPAK */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_EON</span>		80		<span class="enscript-comment">/* ISO cnlp */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_VMTP</span>		81		<span class="enscript-comment">/* VMTP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SVMTP</span>		82		<span class="enscript-comment">/* Secure VMTP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_VINES</span>		83		<span class="enscript-comment">/* Banyon VINES */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_TTP</span>		84		<span class="enscript-comment">/* TTP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IGP</span>		85		<span class="enscript-comment">/* NSFNET-IGP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_DGP</span>		86		<span class="enscript-comment">/* dissimilar gateway prot. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_TCF</span>		87		<span class="enscript-comment">/* TCF */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IGRP</span>		88		<span class="enscript-comment">/* Cisco/GXS IGRP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_OSPFIGP</span>		89		<span class="enscript-comment">/* OSPFIGP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SRPC</span>		90		<span class="enscript-comment">/* Strite RPC protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_LARP</span>		91		<span class="enscript-comment">/* Locus Address Resoloution */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_MTP</span>		92		<span class="enscript-comment">/* Multicast Transport */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_AX25</span>		93		<span class="enscript-comment">/* AX.25 Frames */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_IPEIP</span>		94		<span class="enscript-comment">/* IP encapsulated in IP */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_MICP</span>		95		<span class="enscript-comment">/* Mobile Int.ing control */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_SCCSP</span>		96		<span class="enscript-comment">/* Semaphore Comm. security */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ETHERIP</span>		97		<span class="enscript-comment">/* Ethernet IP encapsulation */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_ENCAP</span>		98		<span class="enscript-comment">/* encapsulation header */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_APES</span>		99		<span class="enscript-comment">/* any private encr. scheme */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_GMTP</span>		100		<span class="enscript-comment">/* GMTP*/</span>
<span class="enscript-comment">/* 101-254: Partly Unassigned */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_PIM</span>		103		<span class="enscript-comment">/* Protocol Independent Mcast */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPPROTO_IPCOMP</span>		108		<span class="enscript-comment">/* payload compression (IPComp) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_PGM</span>		113		<span class="enscript-comment">/* PGM */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPPROTO_SCTP</span>		132		<span class="enscript-comment">/* SCTP */</span>
<span class="enscript-comment">/* 255: Reserved */</span>
<span class="enscript-comment">/* BSD Private, local use, namespace incursion */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_DIVERT</span>		254		<span class="enscript-comment">/* divert pseudo-protocol */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_RAW</span>		255		<span class="enscript-comment">/* raw IP packet */</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_MAX</span>		256

<span class="enscript-comment">/* last return value of *_input(), meaning &quot;all job for this pkt is done&quot;.  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_DONE</span>		257
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

<span class="enscript-comment">/*
 * Local port number conventions:
 *
 * When a user does a bind(2) or connect(2) with a port number of zero,
 * a non-conflicting local port address is chosen.
 * The default range is IPPORT_RESERVED through
 * IPPORT_USERRESERVED, although that is settable by sysctl.
 *
 * A user may set the IPPROTO_IP option IP_PORTRANGE to change this
 * default assignment range.
 *
 * The value IP_PORTRANGE_DEFAULT causes the default behavior.
 *
 * The value IP_PORTRANGE_HIGH changes the range of candidate port numbers
 * into the &quot;high&quot; range.  These are reserved for client outbound connections
 * which do not want to be filtered by any firewalls.
 *
 * The value IP_PORTRANGE_LOW changes the range to the &quot;low&quot; are
 * that is (by convention) restricted to privileged processes.  This
 * convention is based on &quot;vouchsafe&quot; principles only.  It is only secure
 * if you trust the remote host to restrict these ports.
 *
 * The default range of ports and the high range can be changed by
 * sysctl(3).  (net.inet.ip.port{hi,low}{first,last}_auto)
 *
 * Changing those values has bad security implications if you are
 * using a a stateless firewall that is allowing packets outside of that
 * range in order to allow transparent outgoing connections.
 *
 * Such a firewall configuration will generally depend on the use of these
 * default values.  If you change them, you may find your Security
 * Administrator looking for you with a heavy object.
 *
 * For a slightly more orthodox text view on this:
 *
 *            <a href="ftp://ftp.isi.edu/in-notes/iana/assignments/port-numbers">ftp://ftp.isi.edu/in-notes/iana/assignments/port-numbers</a>
 *
 *    port numbers are divided into three ranges:
 *
 *                0 -  1023 Well Known Ports
 *             1024 - 49151 Registered Ports
 *            49152 - 65535 Dynamic and/or Private Ports
 *
 */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__DARWIN_IPPORT_RESERVED</span>	1024

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
<span class="enscript-comment">/*
 * Ports &lt; IPPORT_RESERVED are reserved for
 * privileged processes (e.g. root).         (IP_PORTRANGE_LOW)
 * Ports &gt; IPPORT_USERRESERVED are reserved
 * for servers, not necessarily privileged.  (IP_PORTRANGE_DEFAULT)
 */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">IPPORT_RESERVED</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPORT_RESERVED</span>		__DARWIN_IPPORT_RESERVED
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPORT_USERRESERVED</span>	5000

<span class="enscript-comment">/*
 * Default local port range to use by setting IP_PORTRANGE_HIGH
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPORT_HIFIRSTAUTO</span>	49152
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPORT_HILASTAUTO</span>	65535

<span class="enscript-comment">/*
 * Scanning for a free reserved port return a value below IPPORT_RESERVED,
 * but higher than IPPORT_RESERVEDSTART.  Traditionally the start value was
 * 512, but that conflicts with some well-known-services that firewalls may
 * have a fit if we use.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPPORT_RESERVEDSTART</span>	600
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>

<span class="enscript-comment">/*
 * Internet address (a structure for historical reasons)
 */</span>
<span class="enscript-type">struct</span> in_addr {
	in_addr_t s_addr;
};

<span class="enscript-comment">/*
 * Definitions of bits in internet address integers.
 * On subnets, the decomposition of addresses to host and net parts
 * is done according to subnet mask, not the masks here.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_ANY</span>		(u_int32_t)0x00000000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_BROADCAST</span>	(u_int32_t)0xffffffff	<span class="enscript-comment">/* must be masked */</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_CLASSA</span>(i)		(((u_int32_t)(i) &amp; 0x80000000) == 0)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSA_NET</span>		0xff000000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSA_NSHIFT</span>	24
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSA_HOST</span>		0x00ffffff
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSA_MAX</span>		128

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_CLASSB</span>(i)		(((u_int32_t)(i) &amp; 0xc0000000) == 0x80000000)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSB_NET</span>		0xffff0000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSB_NSHIFT</span>	16
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSB_HOST</span>		0x0000ffff
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSB_MAX</span>		65536

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_CLASSC</span>(i)		(((u_int32_t)(i) &amp; 0xe0000000) == 0xc0000000)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSC_NET</span>		0xffffff00
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSC_NSHIFT</span>	8
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSC_HOST</span>		0x000000ff

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_CLASSD</span>(i)		(((u_int32_t)(i) &amp; 0xf0000000) == 0xe0000000)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSD_NET</span>		0xf0000000	<span class="enscript-comment">/* These ones aren't really */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSD_NSHIFT</span>	28		<span class="enscript-comment">/* net and host fields, but */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_CLASSD_HOST</span>		0x0fffffff	<span class="enscript-comment">/* routing needn't know.    */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_MULTICAST</span>(i)		IN_CLASSD(i)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_EXPERIMENTAL</span>(i)	(((u_int32_t)(i) &amp; 0xf0000000) == 0xf0000000)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_BADCLASS</span>(i)		(((u_int32_t)(i) &amp; 0xf0000000) == 0xf0000000)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_LOOPBACK</span>		(u_int32_t)0x7f000001

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_NONE</span>		0xffffffff		<span class="enscript-comment">/* -1 return */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_UNSPEC_GROUP</span>	(u_int32_t)0xe0000000	<span class="enscript-comment">/* 224.0.0.0 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_ALLHOSTS_GROUP</span>	(u_int32_t)0xe0000001	<span class="enscript-comment">/* 224.0.0.1 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_ALLRTRS_GROUP</span>	(u_int32_t)0xe0000002	<span class="enscript-comment">/* 224.0.0.2 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_ALLRPTS_GROUP</span>	(u_int32_t)0xe0000016	<span class="enscript-comment">/* 224.0.0.22, IGMPv3 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_CARP_GROUP</span>	(u_int32_t)0xe0000012	<span class="enscript-comment">/* 224.0.0.18 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_PFSYNC_GROUP</span>	(u_int32_t)0xe00000f0	<span class="enscript-comment">/* 224.0.0.240 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_ALLMDNS_GROUP</span>	(u_int32_t)0xe00000fb	<span class="enscript-comment">/* 224.0.0.251 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INADDR_MAX_LOCAL_GROUP</span>	(u_int32_t)0xe00000ff	<span class="enscript-comment">/* 224.0.0.255 */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE__</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IN_LINKLOCALNETNUM</span>	(u_int32_t)0xA9FE0000 <span class="enscript-comment">/* 169.254.0.0 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IN_LINKLOCAL</span>(i)		(((u_int32_t)(i) &amp; IN_CLASSB_NET) == IN_LINKLOCALNETNUM)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IN_LOOPBACK</span>(i)		(((u_int32_t)(i) &amp; 0xff000000) == 0x7f000000)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IN_ZERONET</span>(i)		(((u_int32_t)(i) &amp; 0xff000000) == 0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_PRIVATE</span>(i)	((((u_int32_t)(i) &amp; 0xff000000) == 0x0a000000) || \
			 (((u_int32_t)(i) &amp; 0xfff00000) == 0xac100000) || \
			 (((u_int32_t)(i) &amp; 0xffff0000) == 0xc0a80000))

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_LOCAL_GROUP</span>(i)	(((u_int32_t)(i) &amp; 0xffffff00) == 0xe0000000)
 
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN_ANY_LOCAL</span>(i)		(IN_LINKLOCAL(i) || IN_LOCAL_GROUP(i))
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN_LOOPBACKNET</span>		127			<span class="enscript-comment">/* official! */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>

<span class="enscript-comment">/*
 * Socket address, internet style.
 */</span>
<span class="enscript-type">struct</span> sockaddr_in {
	__uint8_t	sin_len;
	sa_family_t	sin_family;
	in_port_t	sin_port;
	<span class="enscript-type">struct</span>	in_addr sin_addr;
	<span class="enscript-type">char</span>		sin_zero[8];
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/*
 * sockaddr_in with scope ID field; this is used internally to keep
 * track of scoped route entries in the routing table.  The fact that
 * such a value is embedded in the structure is an artifact of the
 * current implementation which could change in future.
 */</span>
<span class="enscript-type">struct</span> sockaddr_inifscope {
	__uint8_t	sin_len;
	sa_family_t	sin_family;
	in_port_t	sin_port;
	<span class="enscript-type">struct</span>	in_addr sin_addr;
	<span class="enscript-comment">/*
	 * To avoid possible conflict with an overlaid sockaddr_inarp
	 * having sin_other set to SIN_PROXY, we use the first 4-bytes
	 * of sin_zero since sin_srcaddr is one of the unused fields
	 * in sockaddr_inarp.
	 */</span>
	<span class="enscript-type">union</span> {
		<span class="enscript-type">char</span>	sin_zero[8];
		<span class="enscript-type">struct</span> {
			__uint32_t	ifscope;
		} _in_index;
	} un;
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">sin_scope_id</span>	un._in_index.ifscope
};

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">INET_ADDRSTRLEN</span>                 16

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
<span class="enscript-comment">/*
 * Structure used to describe IP options.
 * Used to store options internally, to pass them to a process,
 * or to restore options retrieved earlier.
 * The ip_dst is used for the first-hop gateway when using a source route
 * (this gets put into the header proper).
 */</span>
<span class="enscript-type">struct</span> ip_opts {
	<span class="enscript-type">struct</span>	in_addr ip_dst;		<span class="enscript-comment">/* first hop, 0 w/o src rt */</span>
	<span class="enscript-type">char</span>	ip_opts[40];		<span class="enscript-comment">/* actually variable in size */</span>
};

<span class="enscript-comment">/*
 * Options for use with [gs]etsockopt at the IP level.
 * First word of comment is data type; bool is stored in int.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OPTIONS</span>		1    <span class="enscript-comment">/* buf/ip_opts; set/get IP options */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_HDRINCL</span>		2    <span class="enscript-comment">/* int; header is included with data */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_TOS</span>			3    <span class="enscript-comment">/* int; IP type of service and preced. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_TTL</span>			4    <span class="enscript-comment">/* int; IP time to live */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_RECVOPTS</span>		5    <span class="enscript-comment">/* bool; receive all IP opts w/dgram */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_RECVRETOPTS</span>		6    <span class="enscript-comment">/* bool; receive IP opts for response */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_RECVDSTADDR</span>		7    <span class="enscript-comment">/* bool; receive IP dst addr w/dgram */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_RETOPTS</span>		8    <span class="enscript-comment">/* ip_opts; set/get IP options */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MULTICAST_IF</span>		9    <span class="enscript-comment">/* u_char; set/get IP multicast i/f  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MULTICAST_TTL</span>	10   <span class="enscript-comment">/* u_char; set/get IP multicast ttl */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MULTICAST_LOOP</span>	11   <span class="enscript-comment">/* u_char; set/get IP multicast loopback */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_ADD_MEMBERSHIP</span>	12   <span class="enscript-comment">/* ip_mreq; add an IP group membership */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DROP_MEMBERSHIP</span>	13   <span class="enscript-comment">/* ip_mreq; drop an IP group membership */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_MULTICAST_VIF</span>	14   <span class="enscript-comment">/* set/get IP mcast virt. iface */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_RSVP_ON</span>		15   <span class="enscript-comment">/* enable RSVP in kernel */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_RSVP_OFF</span>		16   <span class="enscript-comment">/* disable RSVP in kernel */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_RSVP_VIF_ON</span>		17   <span class="enscript-comment">/* set RSVP per-vif socket */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_RSVP_VIF_OFF</span>		18   <span class="enscript-comment">/* unset RSVP per-vif socket */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_PORTRANGE</span>		19   <span class="enscript-comment">/* int; range to choose for unspec port */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_RECVIF</span>		20   <span class="enscript-comment">/* bool; receive reception if w/dgram */</span>
<span class="enscript-comment">/* for IPSEC */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_IPSEC_POLICY</span>		21   <span class="enscript-comment">/* int; set/get security policy */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FAITH</span>		22   <span class="enscript-comment">/* deprecated */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE__</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_STRIPHDR</span>      	23   <span class="enscript-comment">/* bool: drop receive of raw IP header */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_RECVTTL</span>		24   <span class="enscript-comment">/* bool; receive reception TTL w/dgram */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_BOUND_IF</span>		25   <span class="enscript-comment">/* int; set/get bound interface */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_PKTINFO</span>		26   <span class="enscript-comment">/* get pktinfo on recv socket, set src on sent dgram  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_RECVPKTINFO</span>		IP_PKTINFO	<span class="enscript-comment">/* receive pktinfo w/dgram */</span>


#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FW_ADD</span>     		40   <span class="enscript-comment">/* add a firewall rule to chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FW_DEL</span>    		41   <span class="enscript-comment">/* delete a firewall rule from chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FW_FLUSH</span>   		42   <span class="enscript-comment">/* flush firewall rule chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FW_ZERO</span>    		43   <span class="enscript-comment">/* clear single/all firewall counter(s) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FW_GET</span>     		44   <span class="enscript-comment">/* get entire firewall rule chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FW_RESETLOG</span>		45   <span class="enscript-comment">/* reset logging counters */</span>

<span class="enscript-comment">/* These older firewall socket option codes are maintained for backward compatibility. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OLD_FW_ADD</span>     	50   <span class="enscript-comment">/* add a firewall rule to chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OLD_FW_DEL</span>    	51   <span class="enscript-comment">/* delete a firewall rule from chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OLD_FW_FLUSH</span>   	52   <span class="enscript-comment">/* flush firewall rule chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OLD_FW_ZERO</span>    	53   <span class="enscript-comment">/* clear single/all firewall counter(s) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OLD_FW_GET</span>     	54   <span class="enscript-comment">/* get entire firewall rule chain */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP_NAT__XXX</span>			55   <span class="enscript-comment">/* set/get NAT opts XXX Deprecated, do not use */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OLD_FW_RESETLOG</span>	56   <span class="enscript-comment">/* reset logging counters */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DUMMYNET_CONFIGURE</span>	60   <span class="enscript-comment">/* add/configure a dummynet pipe */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DUMMYNET_DEL</span>		61   <span class="enscript-comment">/* delete a dummynet pipe from chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DUMMYNET_FLUSH</span>	62   <span class="enscript-comment">/* flush dummynet */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DUMMYNET_GET</span>		64   <span class="enscript-comment">/* get entire dummynet pipes */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_TRAFFIC_MGT_BACKGROUND</span>	65   <span class="enscript-comment">/* int*; get background IO flags; set background IO */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MULTICAST_IFINDEX</span>	66   <span class="enscript-comment">/* int*; set/get IP multicast i/f index */</span>

<span class="enscript-comment">/* IPv4 Source Filter Multicast API [RFC3678] */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_ADD_SOURCE_MEMBERSHIP</span>	70   <span class="enscript-comment">/* join a source-specific group */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DROP_SOURCE_MEMBERSHIP</span>	71   <span class="enscript-comment">/* drop a single source */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_BLOCK_SOURCE</span>			72   <span class="enscript-comment">/* block a source */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_UNBLOCK_SOURCE</span>		73   <span class="enscript-comment">/* unblock a source */</span>

<span class="enscript-comment">/* The following option is private; do not use it from user applications. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MSFILTER</span>			74   <span class="enscript-comment">/* set/get filter list */</span>

<span class="enscript-comment">/* Protocol Independent Multicast API [RFC3678] */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_JOIN_GROUP</span>		80   <span class="enscript-comment">/* join an any-source group */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_LEAVE_GROUP</span>		81   <span class="enscript-comment">/* leave all sources for group */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_JOIN_SOURCE_GROUP</span>		82   <span class="enscript-comment">/* join a source-specific group */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_LEAVE_SOURCE_GROUP</span>	83   <span class="enscript-comment">/* leave a single source */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_BLOCK_SOURCE</span>		84   <span class="enscript-comment">/* block a source */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_UNBLOCK_SOURCE</span>		85   <span class="enscript-comment">/* unblock a source */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_FORCE_OUT_IFP</span>	69   <span class="enscript-comment">/* deprecated; use IP_BOUND_IF instead */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_NO_IFT_CELLULAR</span>	6969 <span class="enscript-comment">/* for internal use only */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_NO_IFT_PDP</span>		IP_NO_IFT_CELLULAR <span class="enscript-comment">/* deprecated */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_OUT_IF</span>		9696 <span class="enscript-comment">/* for internal use only */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

<span class="enscript-comment">/*
 * Defaults and limits for options
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DEFAULT_MULTICAST_TTL</span>  1	<span class="enscript-comment">/* normally limit m'casts to 1 hop  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_DEFAULT_MULTICAST_LOOP</span> 1	<span class="enscript-comment">/* normally hear sends if a member  */</span>

<span class="enscript-comment">/*
 * The imo_membership vector for each socket is now dynamically allocated at
 * run-time, bounded by USHRT_MAX, and is reallocated when needed, sized
 * according to a power-of-two increment.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MIN_MEMBERSHIPS</span>	31
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MAX_MEMBERSHIPS</span>	4095

<span class="enscript-comment">/*
 * Default resource limits for IPv4 multicast source filtering.
 * These may be modified by sysctl.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MAX_GROUP_SRC_FILTER</span>		512	<span class="enscript-comment">/* sources per group */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MAX_SOCK_SRC_FILTER</span>		128	<span class="enscript-comment">/* sources per socket/group */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_MAX_SOCK_MUTE_FILTER</span>		128	<span class="enscript-comment">/* XXX no longer used */</span>

<span class="enscript-comment">/*
 * Argument structure for IP_ADD_MEMBERSHIP and IP_DROP_MEMBERSHIP.
 */</span>
<span class="enscript-type">struct</span> ip_mreq {
	<span class="enscript-type">struct</span>	in_addr imr_multiaddr;	<span class="enscript-comment">/* IP multicast address of group */</span>
	<span class="enscript-type">struct</span>	in_addr imr_interface;	<span class="enscript-comment">/* local IP address of interface */</span>
};

<span class="enscript-comment">/*
 * Modified argument structure for IP_MULTICAST_IF, obtained from Linux.
 * This is used to specify an interface index for multicast sends, as
 * the IPv4 legacy APIs do not support this (unless IP_SENDIF is available).
 */</span>
<span class="enscript-type">struct</span> ip_mreqn {
	<span class="enscript-type">struct</span>	in_addr imr_multiaddr;	<span class="enscript-comment">/* IP multicast address of group */</span>
	<span class="enscript-type">struct</span>	in_addr imr_address;	<span class="enscript-comment">/* local IP address of interface */</span>
	<span class="enscript-type">int</span>		imr_ifindex;	<span class="enscript-comment">/* Interface index; cast to uint32_t */</span>
};

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>(4)
<span class="enscript-comment">/*
 * Argument structure for IPv4 Multicast Source Filter APIs. [RFC3678]
 */</span>
<span class="enscript-type">struct</span> ip_mreq_source {
	<span class="enscript-type">struct</span>	in_addr imr_multiaddr;	<span class="enscript-comment">/* IP multicast address of group */</span>
	<span class="enscript-type">struct</span>	in_addr imr_sourceaddr;	<span class="enscript-comment">/* IP address of source */</span>
	<span class="enscript-type">struct</span>	in_addr imr_interface;	<span class="enscript-comment">/* local IP address of interface */</span>
};

<span class="enscript-comment">/*
 * Argument structures for Protocol-Independent Multicast Source
 * Filter APIs. [RFC3678]
 */</span>
<span class="enscript-type">struct</span> group_req {
	uint32_t		gr_interface;	<span class="enscript-comment">/* interface index */</span>
	<span class="enscript-type">struct</span> sockaddr_storage	gr_group;	<span class="enscript-comment">/* group address */</span>
};

<span class="enscript-type">struct</span> group_source_req {
	uint32_t		gsr_interface;	<span class="enscript-comment">/* interface index */</span>
	<span class="enscript-type">struct</span> sockaddr_storage	gsr_group;	<span class="enscript-comment">/* group address */</span>
	<span class="enscript-type">struct</span> sockaddr_storage	gsr_source;	<span class="enscript-comment">/* source address */</span>
};

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">__MSFILTERREQ_DEFINED</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__MSFILTERREQ_DEFINED</span>
<span class="enscript-comment">/*
 * The following structure is private; do not use it from user applications.
 * It is used to communicate IP_MSFILTER/IPV6_MSFILTER information between
 * the RFC 3678 libc functions and the kernel.
 */</span>
<span class="enscript-type">struct</span> __msfilterreq {
	uint32_t		 msfr_ifindex;	<span class="enscript-comment">/* interface index */</span>
	uint32_t		 msfr_fmode;	<span class="enscript-comment">/* filter mode for group */</span>
	uint32_t		 msfr_nsrcs;	<span class="enscript-comment">/* # of sources in msfr_srcs */</span>
	uint32_t		__msfr_align;	
	<span class="enscript-type">struct</span> sockaddr_storage	 msfr_group;	<span class="enscript-comment">/* group address */</span>
	<span class="enscript-type">struct</span> sockaddr_storage	*msfr_srcs;
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-type">struct</span> __msfilterreq32 {
	uint32_t		 msfr_ifindex;	<span class="enscript-comment">/* interface index */</span>
	uint32_t		 msfr_fmode;	<span class="enscript-comment">/* filter mode for group */</span>
	uint32_t		 msfr_nsrcs;	<span class="enscript-comment">/* # of sources in msfr_srcs */</span>
	uint32_t		__msfr_align;	
	<span class="enscript-type">struct</span> sockaddr_storage	 msfr_group;	<span class="enscript-comment">/* group address */</span>
	user32_addr_t		 msfr_srcs;
};

<span class="enscript-type">struct</span> __msfilterreq64 {
	uint32_t		 msfr_ifindex;	<span class="enscript-comment">/* interface index */</span>
	uint32_t		 msfr_fmode;	<span class="enscript-comment">/* filter mode for group */</span>
	uint32_t		 msfr_nsrcs;	<span class="enscript-comment">/* # of sources in msfr_srcs */</span>
	uint32_t		__msfr_align;	
	<span class="enscript-type">struct</span> sockaddr_storage	 msfr_group;	<span class="enscript-comment">/* group address */</span>
	user64_addr_t		 msfr_srcs;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __MSFILTERREQ_DEFINED */</span>

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>()
<span class="enscript-type">struct</span> sockaddr;

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/*
 * Advanced (Full-state) APIs [RFC3678]
 * The RFC specifies uint_t for the 6th argument to [sg]etsourcefilter().
 * We use uint32_t here to be consistent.
 */</span>
<span class="enscript-type">int</span>	setipv4sourcefilter(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> in_addr, <span class="enscript-type">struct</span> in_addr, uint32_t,
	    uint32_t, <span class="enscript-type">struct</span> in_addr *) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
<span class="enscript-type">int</span>	getipv4sourcefilter(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> in_addr, <span class="enscript-type">struct</span> in_addr, uint32_t *,
	    uint32_t *, <span class="enscript-type">struct</span> in_addr *) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
<span class="enscript-type">int</span>	setsourcefilter(<span class="enscript-type">int</span>, uint32_t, <span class="enscript-type">struct</span> sockaddr *, socklen_t,
	    uint32_t, uint32_t, <span class="enscript-type">struct</span> sockaddr_storage *) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
<span class="enscript-type">int</span>	getsourcefilter(<span class="enscript-type">int</span>, uint32_t, <span class="enscript-type">struct</span> sockaddr *, socklen_t,
	    uint32_t *, uint32_t *, <span class="enscript-type">struct</span> sockaddr_storage *) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Filter modes; also used to represent per-socket filter mode internally.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_UNDEFINED</span>	0	<span class="enscript-comment">/* fmode: not yet defined */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_INCLUDE</span>	1	<span class="enscript-comment">/* fmode: include these source(s) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MCAST_EXCLUDE</span>	2	<span class="enscript-comment">/* fmode: exclude these source(s) */</span>

<span class="enscript-comment">/*
 * Argument for IP_PORTRANGE:
 * - which range to search when port is unspecified at bind() or connect()
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_PORTRANGE_DEFAULT</span>	0	<span class="enscript-comment">/* default range */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_PORTRANGE_HIGH</span>	1	<span class="enscript-comment">/* &quot;high&quot; - request firewall bypass */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP_PORTRANGE_LOW</span>	2	<span class="enscript-comment">/* &quot;low&quot; - vouchsafe security */</span>


<span class="enscript-comment">/*
 * IP_PKTINFO: Packet information (equivalent to  RFC2292 sec 5 for IPv4)
 * This structure is used for 
 *
 * 1) Receiving ancilliary data about the datagram if IP_PKTINFO sockopt is 
 *    set on the socket. In this case ipi_ifindex will contain the interface
 *    index the datagram was received on, ipi_addr is the IP address the 
 *    datagram was received to.
 *
 * 2) Sending a datagram using a specific interface or IP source address.
 *    if ipi_ifindex is set to non-zero when in_pktinfo is passed as 
 *    ancilliary data of type IP_PKTINFO, this will be used as the source
 *    interface to send the datagram from. If ipi_ifindex is null, ip_spec_dst
 *    will be used for the source address.
 *
 *    Note: if IP_BOUND_IF is set on the socket, ipi_ifindex in the ancillary
 *    IP_PKTINFO option silently overrides the bound interface when it is
 *    specified during send time.
 */</span>
<span class="enscript-type">struct</span> in_pktinfo {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	ipi_ifindex;	<span class="enscript-comment">/* send/recv interface index */</span>
	<span class="enscript-type">struct</span> in_addr	ipi_spec_dst;	<span class="enscript-comment">/* Local address */</span>
	<span class="enscript-type">struct</span> in_addr	ipi_addr;	<span class="enscript-comment">/* IP Header dst address */</span>
};

<span class="enscript-comment">/*
 * Definitions for inet sysctl operations.
 *
 * Third level is protocol number.
 * Fourth level is desired variable within that protocol.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPPROTO_MAXID</span>	(IPPROTO_AH + 1)	<span class="enscript-comment">/* don't list to IPPROTO_MAX */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">CTL_IPPROTO_NAMES</span> { \
	{ <span class="enscript-string">&quot;ip&quot;</span>, CTLTYPE_NODE }, \
	{ <span class="enscript-string">&quot;icmp&quot;</span>, CTLTYPE_NODE }, \
	{ <span class="enscript-string">&quot;igmp&quot;</span>, CTLTYPE_NODE }, \
	{ <span class="enscript-string">&quot;ggp&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;tcp&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;egp&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;pup&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;udp&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;idp&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;ipsec&quot;</span>, CTLTYPE_NODE }, \
}
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-comment">/*
 * Names for IP sysctl objects
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_FORWARDING</span>	1	<span class="enscript-comment">/* act as router */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_SENDREDIRECTS</span>	2	<span class="enscript-comment">/* may send redirects when forwarding */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_DEFTTL</span>		3	<span class="enscript-comment">/* default TTL */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">notyet</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_DEFMTU</span>		4	<span class="enscript-comment">/* default MTU */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPCTL_RTEXPIRE</span>		5	<span class="enscript-comment">/* cloned route expiration time */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPCTL_RTMINEXPIRE</span>	6	<span class="enscript-comment">/* min value for expiration time */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPCTL_RTMAXCACHE</span>	7	<span class="enscript-comment">/* trigger level for dynamic expire */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_SOURCEROUTE</span>	8	<span class="enscript-comment">/* may perform source routes */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_DIRECTEDBROADCAST</span>	9	<span class="enscript-comment">/* may re-broadcast received packets */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPCTL_INTRQMAXLEN</span>	10	<span class="enscript-comment">/* max length of netisr queue */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_INTRQDROPS</span>	11	<span class="enscript-comment">/* number of netisr q drops */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_STATS</span>		12	<span class="enscript-comment">/* ipstat structure */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_ACCEPTSOURCEROUTE</span>	13	<span class="enscript-comment">/* may accept source routed packets */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_FASTFORWARDING</span>	14	<span class="enscript-comment">/* use fast IP forwarding code */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_KEEPFAITH</span>		15	<span class="enscript-comment">/* deprecated */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_GIF_TTL</span>		16	<span class="enscript-comment">/* default TTL for gif encap packet */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_MAXID</span>		17

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPCTL_NAMES</span> { \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;forwarding&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;redirect&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;ttl&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;mtu&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;rtexpire&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;rtminexpire&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;rtmaxcache&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;sourceroute&quot;</span>, CTLTYPE_INT }, \
 	{ <span class="enscript-string">&quot;directed-broadcast&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;intr-queue-maxlen&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;intr-queue-drops&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;stats&quot;</span>, CTLTYPE_STRUCT }, \
	{ <span class="enscript-string">&quot;accept_sourceroute&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;fastforwarding&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;keepfaith&quot;</span>, CTLTYPE_INT }, \
	{ <span class="enscript-string">&quot;gifttl&quot;</span>, CTLTYPE_INT }, \
}
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>

<span class="enscript-comment">/* INET6 stuff */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__KAME_NETINET_IN_H_INCLUDED_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/in6.h&gt;</span>
#<span class="enscript-reference">undef</span> <span class="enscript-variable-name">__KAME_NETINET_IN_H_INCLUDED_</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/* 
 * Minimal sized structure to hold an IPv4 or IPv6 socket address
 * as sockaddr_storage can waste memory
 */</span>
<span class="enscript-type">union</span> sockaddr_in_4_6 {
	<span class="enscript-type">struct</span> sockaddr         sa;
	<span class="enscript-type">struct</span> sockaddr_in      sin;
	<span class="enscript-type">struct</span> sockaddr_in6     sin6;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/boolean.h&gt;</span>

<span class="enscript-type">struct</span> ip;
<span class="enscript-type">struct</span> ifnet;
<span class="enscript-type">struct</span> mbuf;

<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">in_broadcast</span>(<span class="enscript-type">struct</span> in_addr, <span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">in_canforward</span>(<span class="enscript-type">struct</span> in_addr);
<span class="enscript-type">extern</span> u_int32_t <span class="enscript-function-name">in_netof</span>(<span class="enscript-type">struct</span> in_addr);

<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">inet_cksum</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, uint32_t, uint32_t);
<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">in_addword</span>(uint16_t, uint16_t);
<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">in_pseudo</span>(uint32_t, uint32_t, uint32_t);
<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">in_pseudo64</span>(uint64_t, uint64_t, uint64_t);
<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">in_cksum_hdr_opt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ip *);
<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">ip_cksum_hdr_dir</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">in_finalize_cksum</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, uint32_t);
<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">b_sum16</span>(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *buf, <span class="enscript-type">int</span> len);

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_cksum</span>(_m, _l)			\
	inet_cksum(_m, 0, 0, _l)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ip_cksum_hdr_in</span>(_m, _l)			\
	ip_cksum_hdr_dir(_m, _l, 0)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ip_cksum_hdr_out</span>(_m, _l)		\
	ip_cksum_hdr_dir(_m, _l, 1)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_cksum_hdr</span>(_ip)			\
	(~b_sum16(_ip, <span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> ip)) &amp; 0xffff)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_cksum_offset</span>(_m, _o)		\
	((<span class="enscript-type">void</span>) in_finalize_cksum(_m, _o, CSUM_DELAY_IP))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_delayed_cksum</span>(_m)		\
	((<span class="enscript-type">void</span>) in_finalize_cksum(_m, 0, CSUM_DELAY_DATA))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_delayed_cksum_offset</span>(_m, _o)	\
	((<span class="enscript-type">void</span>) in_finalize_cksum(_m, _o, CSUM_DELAY_DATA))

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_hosteq</span>(s, t)	((s).s_addr == (t).s_addr)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_nullhost</span>(x)	((x).s_addr == INADDR_ANY)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in_allhosts</span>(x)	((x).s_addr == htonl(INADDR_ALLHOSTS_GROUP))

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">SIN</span>(s)		((struct sockaddr_in *)(void *)s)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">satosin</span>(sa)	SIN(sa)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">sintosa</span>(sin)	((struct sockaddr *)(void *)(sin))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">SINIFSCOPE</span>(s)	((struct sockaddr_inifscope *)(void *)(s))
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-comment">/* exported for ApplicationFirewall */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in_localaddr</span>(<span class="enscript-type">struct</span> in_addr);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inaddr_local</span>(<span class="enscript-type">struct</span> in_addr);

<span class="enscript-type">extern</span> <span class="enscript-type">char</span>	*inet_ntoa(<span class="enscript-type">struct</span> in_addr);
<span class="enscript-type">extern</span> <span class="enscript-type">char</span>	*inet_ntoa_r(<span class="enscript-type">struct</span> in_addr ina, <span class="enscript-type">char</span> *buf,
    size_t buflen);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span>	inet_pton(<span class="enscript-type">int</span> af, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *, <span class="enscript-type">void</span> *);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MAX_IPv4_STR_LEN</span>	16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MAX_IPv6_STR_LEN</span>	64

<span class="enscript-type">extern</span> <span class="enscript-type">int</span>	 inet_aton(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *, <span class="enscript-type">struct</span> in_addr *); <span class="enscript-comment">/* in libkern */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-function-name">inet_ntop</span>(<span class="enscript-type">int</span>, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *, <span class="enscript-type">char</span> *, socklen_t); <span class="enscript-comment">/* in libkern*/</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
__BEGIN_DECLS
<span class="enscript-type">int</span>        <span class="enscript-function-name">bindresvport</span>(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr_in *);
<span class="enscript-type">struct</span> sockaddr;
<span class="enscript-type">int</span>        <span class="enscript-function-name">bindresvport_sa</span>(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr *);
__END_DECLS
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !KERNEL */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _NETINET_IN_H_ */</span>
</pre>
<hr />
</body></html>