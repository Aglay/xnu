<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>audit_record.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">audit_record.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*-
 * Copyright (c) 2005-2009 Apple Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1.  Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 * 2.  Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 * 3.  Neither the name of Apple Inc. (&quot;Apple&quot;) nor the names of
 *     its contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * $P4: //depot/projects/trustedbsd/openbsm/sys/bsm/audit_record.h#10 $
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_BSM_AUDIT_RECORD_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_BSM_AUDIT_RECORD_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/time.h&gt;</span>			<span class="enscript-comment">/* struct timeval */</span>

<span class="enscript-comment">/*
 * Token type identifiers.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_INVALID</span>		0x00
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_OTHER_FILE32</span>	0x11
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_OHEADER</span>		0x12
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_TRAILER</span>		0x13
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_HEADER32</span>		0x14
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_HEADER32_EX</span>		0x15
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_DATA</span>		0x21
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_IPC</span>			0x22
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_PATH</span>		0x23
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SUBJECT32</span>		0x24
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XATPATH</span>		0x25
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_PROCESS32</span>		0x26
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_RETURN32</span>		0x27
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_TEXT</span>		0x28
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_OPAQUE</span>		0x29
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_IN_ADDR</span>		0x2a
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_IP</span>			0x2b
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_IPORT</span>		0x2c
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ARG32</span>		0x2d
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SOCKET</span>		0x2e
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SEQ</span>			0x2f
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ACL</span>			0x30
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ATTR</span>		0x31
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_IPC_PERM</span>		0x32
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_LABEL</span>		0x33
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_GROUPS</span>		0x34
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ACE</span>			0x35
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_PRIV</span>		0x38
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_UPRIV</span>		0x39
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_LIAISON</span>		0x3a
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_NEWGROUPS</span>		0x3b
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_EXEC_ARGS</span>		0x3c
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_EXEC_ENV</span>		0x3d
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ATTR32</span>		0x3e
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_UNAUTH</span>		0x3f
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XATOM</span>		0x40
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XOBJ</span>		0x41
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XPROTO</span>		0x42
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XSELECT</span>		0x43
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XCOLORMAP</span>		0x44
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XCURSOR</span>		0x45
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XFONT</span>		0x46
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XGC</span>			0x47
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XPIXMAP</span>		0x48
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XPROPERTY</span>		0x49
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XWINDOW</span>		0x4a
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_XCLIENT</span>		0x4b
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_CMD</span>			0x51
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_EXIT</span>		0x52
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ZONENAME</span>		0x60
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_HOST</span>		0x70
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ARG64</span>		0x71
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_RETURN64</span>		0x72
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ATTR64</span>		0x73
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_HEADER64</span>		0x74
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SUBJECT64</span>		0x75
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_PROCESS64</span>		0x77
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_OTHER_FILE64</span>	0x78
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_HEADER64_EX</span>		0x79
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SUBJECT32_EX</span>	0x7a
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_PROCESS32_EX</span>	0x7b
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SUBJECT64_EX</span>	0x7c
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_PROCESS64_EX</span>	0x7d
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_IN_ADDR_EX</span>		0x7e
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SOCKET_EX</span>		0x7f

<span class="enscript-comment">/*
 * Pre-64-bit BSM, 32-bit tokens weren't explicitly named as '32'.  We have
 * compatibility defines.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_HEADER</span>		AUT_HEADER32
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_ARG</span>			AUT_ARG32
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_RETURN</span>		AUT_RETURN32
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SUBJECT</span>		AUT_SUBJECT32
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_PROCESS</span>		AUT_PROCESS32
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_OTHER_FILE</span>		AUT_OTHER_FILE32

<span class="enscript-comment">/*
 * The values for the following token ids are not defined by BSM.
 *
 * XXXRW: Not sure how to handle these in OpenBSM yet, but I'll give them
 * names more consistent with Sun's BSM.  These originally came from Apple's
 * BSM.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SOCKINET32</span>		0x80		<span class="enscript-comment">/* XXX */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SOCKINET128</span>		0x81		<span class="enscript-comment">/* XXX */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_SOCKUNIX</span>		0x82		<span class="enscript-comment">/* XXX */</span>

<span class="enscript-comment">/* print values for the arbitrary token */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUP_BINARY</span>      0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUP_OCTAL</span>       1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUP_DECIMAL</span>     2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUP_HEX</span>         3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUP_STRING</span>      4

<span class="enscript-comment">/* data-types for the arbitrary token */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_BYTE</span>        0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_CHAR</span>        AUR_BYTE
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_SHORT</span>       1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_INT32</span>       2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_INT</span>         AUR_INT32
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_INT64</span>       3

<span class="enscript-comment">/* ... and their sizes */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_BYTE_SIZE</span>       sizeof(u_char)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_CHAR_SIZE</span>       AUR_BYTE_SIZE
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_SHORT_SIZE</span>      sizeof(uint16_t)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_INT32_SIZE</span>      sizeof(uint32_t)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_INT_SIZE</span>        AUR_INT32_SIZE
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUR_INT64_SIZE</span>      sizeof(uint64_t)

<span class="enscript-comment">/* Modifiers for the header token */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PAD_NOTATTR</span>  0x4000   <span class="enscript-comment">/* nonattributable event */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PAD_FAILURE</span>  0x8000   <span class="enscript-comment">/* fail audit event */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AUDIT_MAX_GROUPS</span>      16

<span class="enscript-comment">/*
 * A number of BSM versions are floating around and defined.  Here are
 * constants for them.  OpenBSM uses the same token types, etc, used in the
 * Solaris BSM version, but has a separate version number in order to
 * identify a potentially different event identifier name space.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HEADER_VERSION_OLDDARWIN</span>	1	<span class="enscript-comment">/* In retrospect, a mistake. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HEADER_VERSION_SOLARIS</span>	2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HEADER_VERSION_TSOL25</span>	3
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HEADER_VERSION_TSOL</span>	4
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HEADER_VERSION_OPENBSM10</span>	10
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HEADER_VERSION_OPENBSM11</span>	11
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HEADER_VERSION_OPENBSM</span>	AUDIT_HEADER_VERSION_OPENBSM11

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUT_TRAILER_MAGIC</span>	0xb105

<span class="enscript-comment">/* BSM library calls */</span>

__BEGIN_DECLS

<span class="enscript-type">struct</span> in_addr;
<span class="enscript-type">struct</span> in6_addr;
<span class="enscript-type">struct</span> ip;
<span class="enscript-type">struct</span> ipc_perm;
<span class="enscript-type">struct</span> kevent;
<span class="enscript-type">struct</span> sockaddr;
<span class="enscript-type">struct</span> sockaddr_in;
<span class="enscript-type">struct</span> sockaddr_in6;
<span class="enscript-type">struct</span> sockaddr_un;
#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_KERNEL</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">KERNEL</span>)
<span class="enscript-type">struct</span> vnode_au_info;
#<span class="enscript-reference">endif</span>

<span class="enscript-type">int</span>	 au_open(<span class="enscript-type">void</span>);
<span class="enscript-type">int</span>	 au_write(<span class="enscript-type">int</span> d, token_t *m);
<span class="enscript-type">int</span>	 au_close(<span class="enscript-type">int</span> d, <span class="enscript-type">int</span> keep, <span class="enscript-type">short</span> event);
<span class="enscript-type">int</span>	 au_close_buffer(<span class="enscript-type">int</span> d, <span class="enscript-type">short</span> event, u_char *buffer, size_t *buflen);
<span class="enscript-type">int</span>	 au_close_token(token_t *tok, u_char *buffer, size_t *buflen);

token_t	*au_to_file(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *file, <span class="enscript-type">struct</span> timeval tm);

token_t	*au_to_header32_tm(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod,
	    <span class="enscript-type">struct</span> timeval tm);
token_t	*au_to_header32_ex_tm(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod,
	    <span class="enscript-type">struct</span> timeval tm, <span class="enscript-type">struct</span> auditinfo_addr *aia);
token_t	*au_to_header64_tm(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod,
	    <span class="enscript-type">struct</span> timeval tm);
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">KERNEL</span>) &amp;&amp; !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_KERNEL</span>)
token_t	*au_to_header(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod);
token_t	*au_to_header_ex(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod);
token_t	*au_to_header32(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod);
token_t	*au_to_header64(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod);
token_t	*au_to_header32_ex(<span class="enscript-type">int</span> rec_size, au_event_t e_type, au_emod_t e_mod);
#<span class="enscript-reference">endif</span>

token_t	*au_to_me(<span class="enscript-type">void</span>);
token_t	*au_to_arg(<span class="enscript-type">char</span> n, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *text, uint32_t v);
token_t	*au_to_arg32(<span class="enscript-type">char</span> n, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *text, uint32_t v);
token_t	*au_to_arg64(<span class="enscript-type">char</span> n, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *text, uint64_t v);

#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_KERNEL</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">KERNEL</span>)
token_t	*au_to_attr(<span class="enscript-type">struct</span> vnode_au_info *vni);
token_t	*au_to_attr32(<span class="enscript-type">struct</span> vnode_au_info *vni);
token_t	*au_to_attr64(<span class="enscript-type">struct</span> vnode_au_info *vni);
#<span class="enscript-reference">endif</span>

token_t	*au_to_data(<span class="enscript-type">char</span> unit_print, <span class="enscript-type">char</span> unit_type, <span class="enscript-type">char</span> unit_count,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *p);
token_t	*au_to_exit(<span class="enscript-type">int</span> retval, <span class="enscript-type">int</span> err);
token_t	*au_to_groups(<span class="enscript-type">int</span> *groups);
token_t	*au_to_newgroups(uint16_t n, gid_t *groups);
token_t	*au_to_in_addr(<span class="enscript-type">struct</span> in_addr *internet_addr);
token_t	*au_to_in_addr_ex(<span class="enscript-type">struct</span> in6_addr *internet_addr);
token_t	*au_to_ip(<span class="enscript-type">struct</span> ip *ip);
token_t	*au_to_ipc(<span class="enscript-type">char</span> type, <span class="enscript-type">int</span> id);
token_t	*au_to_ipc_perm(<span class="enscript-type">struct</span> ipc_perm *perm);
token_t	*au_to_iport(uint16_t iport);
token_t	*au_to_opaque(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *data, uint16_t bytes);
token_t	*au_to_path(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *path);
token_t	*au_to_process(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_t *tid);
token_t	*au_to_process32(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_t *tid);
token_t	*au_to_process64(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_t *tid);
token_t	*au_to_process_ex(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_addr_t *tid);
token_t	*au_to_process32_ex(au_id_t auid, uid_t euid, gid_t egid,
	    uid_t ruid, gid_t rgid, pid_t pid, au_asid_t sid,
	    au_tid_addr_t *tid);
token_t	*au_to_process64_ex(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_addr_t *tid);
token_t	*au_to_return(<span class="enscript-type">char</span> status, uint32_t ret);
token_t	*au_to_return32(<span class="enscript-type">char</span> status, uint32_t ret);
token_t	*au_to_return64(<span class="enscript-type">char</span> status, uint64_t ret);
token_t	*au_to_seq(<span class="enscript-type">long</span> audit_count);
token_t	*au_to_socket_ex(u_short so_domain, u_short so_type,
	    <span class="enscript-type">struct</span> sockaddr *sa_local, <span class="enscript-type">struct</span> sockaddr *sa_remote);
token_t	*au_to_sock_inet(<span class="enscript-type">struct</span> sockaddr_in *so);
token_t	*au_to_sock_inet32(<span class="enscript-type">struct</span> sockaddr_in *so);
token_t	*au_to_sock_inet128(<span class="enscript-type">struct</span> sockaddr_in6 *so);
token_t	*au_to_sock_unix(<span class="enscript-type">struct</span> sockaddr_un *so);
token_t	*au_to_subject(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_t *tid);
token_t	*au_to_subject32(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_t *tid);
token_t	*au_to_subject64(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_t *tid);
token_t	*au_to_subject_ex(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_addr_t *tid);
token_t	*au_to_subject32_ex(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_addr_t *tid);
token_t	*au_to_subject64_ex(au_id_t auid, uid_t euid, gid_t egid, uid_t ruid,
	    gid_t rgid, pid_t pid, au_asid_t sid, au_tid_addr_t *tid);
#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_KERNEL</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">KERNEL</span>)
token_t	*au_to_exec_args(<span class="enscript-type">char</span> *args, <span class="enscript-type">int</span> argc);
token_t	*au_to_exec_env(<span class="enscript-type">char</span> *envs, <span class="enscript-type">int</span> envc);
#<span class="enscript-reference">else</span>
token_t	*au_to_exec_args(<span class="enscript-type">char</span> **argv);
token_t	*au_to_exec_env(<span class="enscript-type">char</span> **envp);
#<span class="enscript-reference">endif</span>
token_t	*au_to_text(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *text);
token_t	*au_to_kevent(<span class="enscript-type">struct</span> kevent *kev);
token_t	*au_to_trailer(<span class="enscript-type">int</span> rec_size);
token_t	*au_to_zonename(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *zonename);

<span class="enscript-comment">/*
 * BSM library routines for converting between local and BSM constant spaces.
 */</span>
<span class="enscript-type">int</span>	 au_bsm_to_domain(u_short bsm_domain, <span class="enscript-type">int</span> *local_domainp);
<span class="enscript-type">int</span>	 au_bsm_to_errno(u_char bsm_error, <span class="enscript-type">int</span> *errorp);
<span class="enscript-type">int</span>	 au_bsm_to_fcntl_cmd(u_short bsm_fcntl_cmd, <span class="enscript-type">int</span> *local_fcntl_cmdp);
<span class="enscript-type">int</span>	 au_bsm_to_socket_type(u_short bsm_socket_type,
	    <span class="enscript-type">int</span> *local_socket_typep);
u_short	 au_domain_to_bsm(<span class="enscript-type">int</span> local_domain);
u_char	 au_errno_to_bsm(<span class="enscript-type">int</span> local_errno);
u_short	 au_fcntl_cmd_to_bsm(<span class="enscript-type">int</span> local_fcntl_command);
u_short	 au_socket_type_to_bsm(<span class="enscript-type">int</span> local_socket_type);

__END_DECLS

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* ! _BSM_AUDIT_RECORD_H_ */</span>
</pre>
<hr />
</body></html>