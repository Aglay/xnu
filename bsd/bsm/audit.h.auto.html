<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>audit.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">audit.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*-
 * Copyright (c) 2005-2009 Apple Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1.  Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 * 2.  Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 * 3.  Neither the name of Apple Inc. (&quot;Apple&quot;) nor the names of
 *     its contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS &quot;AS IS&quot; AND ANY
 * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
 * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * $P4: //depot/projects/trustedbsd/openbsm/sys/bsm/audit.h#10 $
 */</span>

#<span class="enscript-reference">ifndef</span>	<span class="enscript-variable-name">_BSM_AUDIT_H</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_BSM_AUDIT_H</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/param.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/types.h&gt;</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_RECORD_MAGIC</span>	0x828a0f1b
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MAX_AUDIT_RECORDS</span>	20
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MAXAUDITDATA</span>		(0x8000 - 1)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MAX_AUDIT_RECORD_SIZE</span>	MAXAUDITDATA
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MIN_AUDIT_FILE_SIZE</span>	(512 * 1024)

<span class="enscript-comment">/*
 * Minimum noumber of free blocks on the filesystem containing the audit
 * log necessary to avoid a hard log rotation. DO NOT SET THIS VALUE TO 0
 * as the kernel does an unsigned compare, plus we want to leave a few blocks
 * free so userspace can terminate the log, etc.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_HARD_LIMIT_FREE_BLOCKS</span>	4

<span class="enscript-comment">/*
 * Triggers for the audit daemon.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_MIN</span>		1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_LOW_SPACE</span>		1	<span class="enscript-comment">/* Below low watermark. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_ROTATE_KERNEL</span>	2	<span class="enscript-comment">/* Kernel requests rotate. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_READ_FILE</span>		3	<span class="enscript-comment">/* Re-read config file. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_CLOSE_AND_DIE</span>	4	<span class="enscript-comment">/* Terminate audit. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_NO_SPACE</span>		5	<span class="enscript-comment">/* Below min free space. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_ROTATE_USER</span>	6	<span class="enscript-comment">/* User requests rotate. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_INITIALIZE</span>	7	<span class="enscript-comment">/* User initialize of auditd. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_EXPIRE_TRAILS</span>	8	<span class="enscript-comment">/* User expiration of trails. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_MAX</span>		8

<span class="enscript-comment">/*
 * The special device filename (FreeBSD).
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDITDEV_FILENAME</span>	<span class="enscript-string">&quot;audit&quot;</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRIGGER_FILE</span>	(<span class="enscript-string">&quot;/dev/&quot;</span> AUDITDEV_FILENAME)

<span class="enscript-comment">/*
 * Pre-defined audit IDs
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AU_DEFAUDITID</span>	(uid_t)(-1)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AU_DEFAUDITSID</span>	 0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AU_ASSIGN_ASID</span>	-1

<span class="enscript-comment">/*
 * IPC types.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AT_IPC_MSG</span>	((u_char)1)	<span class="enscript-comment">/* Message IPC id. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AT_IPC_SEM</span>	((u_char)2)	<span class="enscript-comment">/* Semaphore IPC id. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AT_IPC_SHM</span>	((u_char)3)	<span class="enscript-comment">/* Shared mem IPC id. */</span>

<span class="enscript-comment">/*
 * Audit conditions.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUC_UNSET</span>		0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUC_AUDITING</span>		1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUC_NOAUDIT</span>		2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUC_DISABLED</span>		-1

<span class="enscript-comment">/*
 * auditon(2) commands.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_OLDGETPOLICY</span>	2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_OLDSETPOLICY</span>	3
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETKMASK</span>	4
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETKMASK</span>	5
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_OLDGETQCTRL</span>	6
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_OLDSETQCTRL</span>	7
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETCWD</span>	8
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETCAR</span>	9
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETSTAT</span>	12
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETSTAT</span>	13
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETUMASK</span>	14
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETSMASK</span>	15
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_OLDGETCOND</span>	20
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_OLDSETCOND</span>	21
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETCLASS</span>	22
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETCLASS</span>	23
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETPINFO</span>	24
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETPMASK</span>	25
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETFSIZE</span>	26
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETFSIZE</span>	27
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETPINFO_ADDR</span>	28
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETKAUDIT</span>	29
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETKAUDIT</span>	30
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SENDTRIGGER</span>	31
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETSINFO_ADDR</span>	32
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETPOLICY</span>	33
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETPOLICY</span>	34
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETQCTRL</span>	35
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETQCTRL</span>	36
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETCOND</span>	37
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETCOND</span>	38
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_GETSFLAGS</span>	39
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">A_SETSFLAGS</span>	40

<span class="enscript-comment">/*
 * Audit policy controls.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_CNT</span>	0x0001
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_AHLT</span>	0x0002
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_ARGV</span>	0x0004
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_ARGE</span>	0x0008
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_SEQ</span>	0x0010
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_WINDATA</span>	0x0020
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_USER</span>	0x0040
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_GROUP</span>	0x0080
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_TRAIL</span>	0x0100
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_PATH</span>	0x0200
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_SCNT</span>	0x0400
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_PUBLIC</span>	0x0800
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_ZONENAME</span>	0x1000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AUDIT_PERZONE</span>	0x2000

<span class="enscript-comment">/*
 * Default audit queue control parameters.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AQ_HIWATER</span>	100
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AQ_MAXHIGH</span>	10000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AQ_LOWATER</span>	10
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AQ_BUFSZ</span>	MAXAUDITDATA
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AQ_MAXBUFSZ</span>	1048576

<span class="enscript-comment">/*
 * Default minimum percentage free space on file system.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AU_FS_MINFREE</span>	20

<span class="enscript-comment">/*
 * Type definitions used indicating the length of variable length addresses
 * in tokens containing addresses, such as header fields.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AU_IPv4</span>		4
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">AU_IPv6</span>		16

__BEGIN_DECLS

<span class="enscript-type">typedef</span>	uid_t		au_id_t;
<span class="enscript-type">typedef</span>	pid_t		au_asid_t;
<span class="enscript-type">typedef</span>	u_int16_t	au_event_t;
<span class="enscript-type">typedef</span>	u_int16_t	au_emod_t;
<span class="enscript-type">typedef</span>	u_int32_t	au_class_t;
<span class="enscript-type">typedef</span>	u_int64_t	au_asflgs_t __attribute__ ((aligned (8)));

<span class="enscript-type">struct</span> au_tid {
	dev_t		port;
	u_int32_t	machine;
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> au_tid	au_tid_t;

<span class="enscript-type">struct</span> au_tid_addr {
	dev_t		at_port;
	u_int32_t	at_type;
	u_int32_t	at_addr[4];
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> au_tid_addr	au_tid_addr_t;

<span class="enscript-type">struct</span> au_mask {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>    am_success;     <span class="enscript-comment">/* Success bits. */</span>
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>    am_failure;     <span class="enscript-comment">/* Failure bits. */</span>
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> au_mask	au_mask_t;

<span class="enscript-type">struct</span> auditinfo {
	au_id_t		ai_auid;	<span class="enscript-comment">/* Audit user ID. */</span>
	au_mask_t	ai_mask;	<span class="enscript-comment">/* Audit masks. */</span>
	au_tid_t	ai_termid;	<span class="enscript-comment">/* Terminal ID. */</span>
	au_asid_t	ai_asid;	<span class="enscript-comment">/* Audit session ID. */</span>
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> auditinfo	auditinfo_t;

<span class="enscript-type">struct</span> auditinfo_addr {
	au_id_t		ai_auid;	<span class="enscript-comment">/* Audit user ID. */</span>
	au_mask_t	ai_mask;	<span class="enscript-comment">/* Audit masks. */</span>
	au_tid_addr_t	ai_termid;	<span class="enscript-comment">/* Terminal ID. */</span>
	au_asid_t	ai_asid;	<span class="enscript-comment">/* Audit session ID. */</span>
	au_asflgs_t	ai_flags;	<span class="enscript-comment">/* Audit session flags. */</span>
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> auditinfo_addr	auditinfo_addr_t;

<span class="enscript-type">struct</span> auditpinfo {
	pid_t		ap_pid;		<span class="enscript-comment">/* ID of target process. */</span>
	au_id_t		ap_auid;	<span class="enscript-comment">/* Audit user ID. */</span>
	au_mask_t	ap_mask;	<span class="enscript-comment">/* Audit masks. */</span>
	au_tid_t	ap_termid;	<span class="enscript-comment">/* Terminal ID. */</span>
	au_asid_t	ap_asid;	<span class="enscript-comment">/* Audit session ID. */</span>
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> auditpinfo	auditpinfo_t;

<span class="enscript-type">struct</span> auditpinfo_addr {
	pid_t		ap_pid;		<span class="enscript-comment">/* ID of target process. */</span>
	au_id_t		ap_auid;	<span class="enscript-comment">/* Audit user ID. */</span>
	au_mask_t	ap_mask;	<span class="enscript-comment">/* Audit masks. */</span>
	au_tid_addr_t	ap_termid;	<span class="enscript-comment">/* Terminal ID. */</span>
	au_asid_t	ap_asid;	<span class="enscript-comment">/* Audit session ID. */</span>
	au_asflgs_t	ap_flags;	<span class="enscript-comment">/* Audit session flags. */</span>
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> auditpinfo_addr	auditpinfo_addr_t;

<span class="enscript-type">struct</span> au_session {
	auditinfo_addr_t	*as_aia_p;	<span class="enscript-comment">/* Ptr to full audit info. */</span>
	au_mask_t		 as_mask;	<span class="enscript-comment">/* Process Audit Masks. */</span>
};
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> au_session       au_session_t;

<span class="enscript-comment">/*
 * Contents of token_t are opaque outside of libbsm.
 */</span>
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> au_token	token_t;

<span class="enscript-comment">/*
 * Kernel audit queue control parameters:
 * 			Default:		Maximum:
 * 	aq_hiwater:	AQ_HIWATER (100)	AQ_MAXHIGH (10000) 
 * 	aq_lowater:	AQ_LOWATER (10)		&lt;aq_hiwater
 * 	aq_bufsz:	AQ_BUFSZ (32767)	AQ_MAXBUFSZ (1048576)
 * 	aq_delay:	20			20000 (not used) 
 */</span>
<span class="enscript-type">struct</span> au_qctrl {
	<span class="enscript-type">int</span>	aq_hiwater;	<span class="enscript-comment">/* Max # of audit recs in queue when */</span>
				<span class="enscript-comment">/* threads with new ARs get blocked. */</span> 

	<span class="enscript-type">int</span>	aq_lowater;	<span class="enscript-comment">/* # of audit recs in queue when */</span>
				<span class="enscript-comment">/* blocked threads get unblocked. */</span>

	<span class="enscript-type">int</span>	aq_bufsz;	<span class="enscript-comment">/* Max size of audit record for audit(2). */</span>
	<span class="enscript-type">int</span>	aq_delay;	<span class="enscript-comment">/* Queue delay (not used). */</span>
	<span class="enscript-type">int</span>	aq_minfree;	<span class="enscript-comment">/* Minimum filesystem percent free space. */</span>
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> au_qctrl	au_qctrl_t;

<span class="enscript-comment">/*
 * Structure for the audit statistics.
 */</span>
<span class="enscript-type">struct</span> audit_stat {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	as_version;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	as_numevent;
	<span class="enscript-type">int</span>		as_generated;
	<span class="enscript-type">int</span>		as_nonattrib;
	<span class="enscript-type">int</span>		as_kernel;
	<span class="enscript-type">int</span>		as_audit;
	<span class="enscript-type">int</span>		as_auditctl;
	<span class="enscript-type">int</span>		as_enqueue;
	<span class="enscript-type">int</span>		as_written;
	<span class="enscript-type">int</span>		as_wblocked;
	<span class="enscript-type">int</span>		as_rblocked;
	<span class="enscript-type">int</span>		as_dropped;
	<span class="enscript-type">int</span>		as_totalsize;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	as_memused;
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> audit_stat	au_stat_t;

<span class="enscript-comment">/*
 * Structure for the audit file statistics.
 */</span>
<span class="enscript-type">struct</span> audit_fstat {
	u_int64_t	af_filesz;
	u_int64_t	af_currsz;
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> audit_fstat	au_fstat_t;

<span class="enscript-comment">/*
 * Audit to event class mapping.
 */</span>
<span class="enscript-type">struct</span> au_evclass_map {
	au_event_t	ec_number;
	au_class_t	ec_class;
};
<span class="enscript-type">typedef</span>	<span class="enscript-type">struct</span> au_evclass_map	au_evclass_map_t;

<span class="enscript-comment">/*
 * Audit system calls.
 */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_KERNEL</span>) &amp;&amp; !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">KERNEL</span>)
<span class="enscript-type">int</span>	audit(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">int</span>	auditon(<span class="enscript-type">int</span>, <span class="enscript-type">void</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">int</span>	auditctl(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *);
<span class="enscript-type">int</span>	getauid(au_id_t *);
<span class="enscript-type">int</span>	setauid(<span class="enscript-type">const</span> au_id_t *);
<span class="enscript-type">int</span>	getaudit_addr(<span class="enscript-type">struct</span> auditinfo_addr *, <span class="enscript-type">int</span>);
<span class="enscript-type">int</span>	setaudit_addr(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> auditinfo_addr *, <span class="enscript-type">int</span>);

#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__APPLE__</span>)
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;Availability.h&gt;</span>

<span class="enscript-comment">/*
 * getaudit()/setaudit() are deprecated and have been replaced with
 * wrappers to the getaudit_addr()/setaudit_addr() syscalls above.
 */</span>

<span class="enscript-type">int</span>	getaudit(<span class="enscript-type">struct</span> auditinfo *)
		__OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_8,
		    __IPHONE_2_0, __IPHONE_6_0);
<span class="enscript-type">int</span>	setaudit(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> auditinfo *)
		__OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0, __MAC_10_8,
		    __IPHONE_2_0, __IPHONE_6_0);
#<span class="enscript-reference">else</span>

<span class="enscript-type">int</span>	getaudit(<span class="enscript-type">struct</span> auditinfo *);
<span class="enscript-type">int</span>	setaudit(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> auditinfo *);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !__APPLE__ */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE_API_PRIVATE</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/port.h&gt;</span>
mach_port_name_t <span class="enscript-function-name">audit_session_self</span>(<span class="enscript-type">void</span>);
au_asid_t	 audit_session_join(mach_port_name_t port);
<span class="enscript-type">int</span>		 audit_session_port(au_asid_t asid, mach_port_name_t *portname);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __APPLE_API_PRIVATE */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* defined(_KERNEL) || defined(KERNEL) */</span>

__END_DECLS

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_BSM_AUDIT_H */</span>
</pre>
<hr />
</body></html>