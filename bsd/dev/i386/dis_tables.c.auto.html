<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>dis_tables.c</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">dis_tables.c&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 *
 * CDDL HEADER START
 *
 * The contents of this file are subject to the terms of the
 * Common Development and Distribution License (the &quot;License&quot;).
 * You may not use this file except in compliance with the License.
 *
 * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
 * or <a href="http://www.opensolaris.org/os/licensing.">http://www.opensolaris.org/os/licensing.</a>
 * See the License for the specific language governing permissions
 * and limitations under the License.
 *
 * When distributing Covered Code, include this CDDL HEADER in each
 * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
 * If applicable, add the following below this CDDL HEADER, with the
 * fields enclosed by brackets &quot;[]&quot; replaced with your own identifying
 * information: Portions Copyright [yyyy] [name of copyright owner]
 *
 * CDDL HEADER END
 */</span>

<span class="enscript-comment">/*
 * Copyright (c) 2015, Joyent, Inc.
 * Copyright (c) 2008 Sun Microsystems, Inc.  All rights reserved.
 *
 * Use is subject to license terms.
 */</span>

<span class="enscript-comment">/*
 * Copyright (c) 2010, Intel Corporation.
 * All rights reserved.
 */</span>

<span class="enscript-comment">/*	Copyright (c) 1988 AT&amp;T	*/</span>
<span class="enscript-comment">/*	  All Rights Reserved  	*/</span>


<span class="enscript-comment">/*
 * #pragma ident	&quot;@(#)dis_tables.c	1.18	08/05/24 SMI&quot;
 */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/dtrace.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/dtrace_glue.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/dis_tables.h&gt;</span>

<span class="enscript-comment">/* BEGIN CSTYLED */</span>

<span class="enscript-comment">/*
 * Disassembly begins in dis_distable, which is equivalent to the One-byte
 * Opcode Map in the Intel IA32 ISA Reference (page A-6 in my copy).  The
 * decoding loops then traverse out through the other tables as necessary to
 * decode a given instruction.
 *
 * The behavior of this file can be controlled by one of the following flags:
 *
 * 	DIS_TEXT	Include text for disassembly
 * 	DIS_MEM		Include memory-size calculations
 *
 * Either or both of these can be defined.
 *
 * This file is not, and will never be, cstyled.  If anything, the tables should
 * be taken out another tab stop or two so nothing overlaps.
 */</span>

<span class="enscript-comment">/*
 * These functions must be provided for the consumer to do disassembly.
 */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
<span class="enscript-type">extern</span> <span class="enscript-type">char</span> *<span class="enscript-function-name">strncpy</span>(<span class="enscript-type">char</span> *, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *, size_t);
<span class="enscript-type">extern</span> size_t <span class="enscript-function-name">strlen</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">strncmp</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *, size_t);
<span class="enscript-type">extern</span> size_t <span class="enscript-function-name">strlcat</span>(<span class="enscript-type">char</span> *, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *, size_t);
#<span class="enscript-reference">endif</span>


#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">TERM</span> 	0	<span class="enscript-comment">/* used to indicate that the 'indirect' */</span>
				<span class="enscript-comment">/* field terminates - no pointer.	*/</span>

<span class="enscript-comment">/* Used to decode instructions. */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span>	instable {
	<span class="enscript-type">struct</span> instable	*it_indirect;	<span class="enscript-comment">/* for decode op codes */</span>
	uchar_t		it_adrmode;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	<span class="enscript-type">char</span>		it_name[NCPS];
	uint_t		it_suffix:1;		<span class="enscript-comment">/* mnem + &quot;w&quot;, &quot;l&quot;, or &quot;d&quot; */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_MEM</span>
	uint_t		it_size:16;
#<span class="enscript-reference">endif</span>
	uint_t		it_invalid64:1;		<span class="enscript-comment">/* opcode invalid in amd64 */</span>
	uint_t		it_always64:1;		<span class="enscript-comment">/* 64 bit when in 64 bit mode */</span>
	uint_t		it_invalid32:1;		<span class="enscript-comment">/* invalid in IA32 */</span>
	uint_t		it_stackop:1;		<span class="enscript-comment">/* push/pop stack operation */</span>
} instable_t;

<span class="enscript-comment">/*
 * Instruction formats.
 */</span>
<span class="enscript-type">enum</span> {
	UNKNOWN,
	MRw,
	IMlw,
	IMw,
	IR,
	OA,
	AO,
	MS,
	SM,
	Mv,
	Mw,
	M,		<span class="enscript-comment">/* register or memory */</span>
	Mb,		<span class="enscript-comment">/* register or memory, always byte sized */</span>
	MO,		<span class="enscript-comment">/* memory only (no registers) */</span>
	PREF,
	SWAPGS,
	MONITOR_MWAIT,
	R,
	RA,
	SEG,
	MR,
	RM,
	IA,
	MA,
	SD,
	AD,
	SA,
	D,
	INM,
	SO,
	BD,
	I,
	P,
	V,
	DSHIFT,		<span class="enscript-comment">/* for double shift that has an 8-bit immediate */</span>
	U,
	OVERRIDE,
	NORM,		<span class="enscript-comment">/* instructions w/o ModR/M byte, no memory access */</span>
	IMPLMEM,	<span class="enscript-comment">/* instructions w/o ModR/M byte, implicit mem access */</span>
	O,		<span class="enscript-comment">/* for call	*/</span>
	JTAB,		<span class="enscript-comment">/* jump table 	*/</span>
	IMUL,		<span class="enscript-comment">/* for 186 iimul instr  */</span>
	CBW,		<span class="enscript-comment">/* so data16 can be evaluated for cbw and variants */</span>
	MvI,		<span class="enscript-comment">/* for 186 logicals */</span>
	ENTER,		<span class="enscript-comment">/* for 186 enter instr  */</span>
	RMw,		<span class="enscript-comment">/* for 286 arpl instr */</span>
	Ib,		<span class="enscript-comment">/* for push immediate byte */</span>
	F,		<span class="enscript-comment">/* for 287 instructions */</span>
	FF,		<span class="enscript-comment">/* for 287 instructions */</span>
	FFC,		<span class="enscript-comment">/* for 287 instructions */</span>
	DM,		<span class="enscript-comment">/* 16-bit data */</span>
	AM,		<span class="enscript-comment">/* 16-bit addr */</span>
	LSEG,		<span class="enscript-comment">/* for 3-bit seg reg encoding */</span>
	MIb,		<span class="enscript-comment">/* for 386 logicals */</span>
	SREG,		<span class="enscript-comment">/* for 386 special registers */</span>
	PREFIX,		<span class="enscript-comment">/* a REP instruction prefix */</span>
	LOCK,		<span class="enscript-comment">/* a LOCK instruction prefix */</span>
	INT3,		<span class="enscript-comment">/* The int 3 instruction, which has a fake operand */</span>
	INTx,		<span class="enscript-comment">/* The normal int instruction, with explicit int num */</span>
	DSHIFTcl,	<span class="enscript-comment">/* for double shift that implicitly uses %cl */</span>
	CWD,		<span class="enscript-comment">/* so data16 can be evaluated for cwd and variants */</span>
	RET,		<span class="enscript-comment">/* single immediate 16-bit operand */</span>
	MOVZ,		<span class="enscript-comment">/* for movs and movz, with different size operands */</span>
	CRC32,		<span class="enscript-comment">/* for crc32, with different size operands */</span>
	XADDB,		<span class="enscript-comment">/* for xaddb */</span>
	MOVSXZ,		<span class="enscript-comment">/* AMD64 mov sign extend 32 to 64 bit instruction */</span>
	MOVBE,		<span class="enscript-comment">/* movbe instruction */</span>

<span class="enscript-comment">/*
 * MMX/SIMD addressing modes.
 */</span>

	MMO,		<span class="enscript-comment">/* Prefixable MMX/SIMD-Int	mm/mem	-&gt; mm */</span>
	MMOIMPL,	<span class="enscript-comment">/* Prefixable MMX/SIMD-Int	mm	-&gt; mm (mem) */</span>
	MMO3P,		<span class="enscript-comment">/* Prefixable MMX/SIMD-Int	mm	-&gt; r32,imm8 */</span>
	MMOM3,		<span class="enscript-comment">/* Prefixable MMX/SIMD-Int	mm	-&gt; r32 	*/</span>
	MMOS,		<span class="enscript-comment">/* Prefixable MMX/SIMD-Int	mm	-&gt; mm/mem */</span>
	MMOMS,		<span class="enscript-comment">/* Prefixable MMX/SIMD-Int	mm	-&gt; mem */</span>
	MMOPM,		<span class="enscript-comment">/* MMX/SIMD-Int			mm/mem	-&gt; mm,imm8 */</span>
	MMOPM_66o,	<span class="enscript-comment">/* MMX/SIMD-Int 0x66 optional	mm/mem	-&gt; mm,imm8 */</span>
	MMOPRM,		<span class="enscript-comment">/* Prefixable MMX/SIMD-Int	r32/mem	-&gt; mm,imm8 */</span>
	MMOSH,		<span class="enscript-comment">/* Prefixable MMX		mm,imm8	*/</span>
	MM,		<span class="enscript-comment">/* MMX/SIMD-Int			mm/mem	-&gt; mm	*/</span>
	MMS,		<span class="enscript-comment">/* MMX/SIMD-Int			mm	-&gt; mm/mem */</span>
	MMSH,		<span class="enscript-comment">/* MMX				mm,imm8 */</span>
	XMMO,		<span class="enscript-comment">/* Prefixable SIMD		xmm/mem	-&gt; xmm */</span>
	XMMOS,		<span class="enscript-comment">/* Prefixable SIMD		xmm	-&gt; xmm/mem */</span>
	XMMOPM,		<span class="enscript-comment">/* Prefixable SIMD		xmm/mem	w/to xmm,imm8 */</span>
	XMMOMX,		<span class="enscript-comment">/* Prefixable SIMD		mm/mem	-&gt; xmm */</span>
	XMMOX3,		<span class="enscript-comment">/* Prefixable SIMD		xmm	-&gt; r32 */</span>
	XMMOXMM,	<span class="enscript-comment">/* Prefixable SIMD		xmm/mem	-&gt; mm	*/</span>
	XMMOM,		<span class="enscript-comment">/* Prefixable SIMD		xmm	-&gt; mem */</span>
	XMMOMS,		<span class="enscript-comment">/* Prefixable SIMD		mem	-&gt; xmm */</span>
	XMM,		<span class="enscript-comment">/* SIMD 			xmm/mem	-&gt; xmm */</span>
	XMM_66r,	<span class="enscript-comment">/* SIMD 0x66 prefix required	xmm/mem	-&gt; xmm */</span>
	XMM_66o,	<span class="enscript-comment">/* SIMD 0x66 prefix optional 	xmm/mem	-&gt; xmm */</span>
	XMMXIMPL,	<span class="enscript-comment">/* SIMD				xmm	-&gt; xmm (mem) */</span>
	XMM3P,		<span class="enscript-comment">/* SIMD				xmm	-&gt; r32,imm8 */</span>
	XMM3PM_66r,	<span class="enscript-comment">/* SIMD 0x66 prefix required	xmm	-&gt; r32/mem,imm8 */</span>
	XMMP,		<span class="enscript-comment">/* SIMD 			xmm/mem w/to xmm,imm8 */</span>
	XMMP_66o,	<span class="enscript-comment">/* SIMD 0x66 prefix optional	xmm/mem w/to xmm,imm8 */</span>
	XMMP_66r,	<span class="enscript-comment">/* SIMD 0x66 prefix required	xmm/mem w/to xmm,imm8 */</span>
	XMMPRM,		<span class="enscript-comment">/* SIMD 			r32/mem -&gt; xmm,imm8 */</span>
	XMMPRM_66r,	<span class="enscript-comment">/* SIMD 0x66 prefix required	r32/mem -&gt; xmm,imm8 */</span>
	XMMS,		<span class="enscript-comment">/* SIMD				xmm	-&gt; xmm/mem */</span>
	XMMM,		<span class="enscript-comment">/* SIMD 			mem	-&gt; xmm */</span>
	XMMM_66r,	<span class="enscript-comment">/* SIMD	0x66 prefix required	mem	-&gt; xmm */</span>
	XMMMS,		<span class="enscript-comment">/* SIMD				xmm	-&gt; mem */</span>
	XMM3MX,		<span class="enscript-comment">/* SIMD 			r32/mem -&gt; xmm */</span>
	XMM3MXS,	<span class="enscript-comment">/* SIMD 			xmm	-&gt; r32/mem */</span>
	XMMSH,		<span class="enscript-comment">/* SIMD 			xmm,imm8 */</span>
	XMMXM3,		<span class="enscript-comment">/* SIMD 			xmm/mem -&gt; r32 */</span>
	XMMX3,		<span class="enscript-comment">/* SIMD 			xmm	-&gt; r32 */</span>
	XMMXMM,		<span class="enscript-comment">/* SIMD 			xmm/mem	-&gt; mm */</span>
	XMMMX,		<span class="enscript-comment">/* SIMD 			mm	-&gt; xmm */</span>
	XMMXM,		<span class="enscript-comment">/* SIMD 			xmm	-&gt; mm */</span>
        XMMX2I,		<span class="enscript-comment">/* SIMD				xmm -&gt; xmm, imm, imm */</span>
        XMM2I,		<span class="enscript-comment">/* SIMD				xmm, imm, imm */</span>
	XMMFENCE,	<span class="enscript-comment">/* SIMD lfence or mfence */</span>
	XMMSFNC,	<span class="enscript-comment">/* SIMD sfence (none or mem) */</span>
	XGETBV_XSETBV,
	VEX_NONE,	<span class="enscript-comment">/* VEX  no operand */</span>
	VEX_MO,		<span class="enscript-comment">/* VEX	mod_rm		               -&gt; implicit reg */</span>
	VEX_RMrX,	<span class="enscript-comment">/* VEX  VEX.vvvv, mod_rm               -&gt; mod_reg */</span>
	VEX_RRX,	<span class="enscript-comment">/* VEX  VEX.vvvv, mod_reg              -&gt; mod_rm */</span>
	VEX_RMRX,	<span class="enscript-comment">/* VEX  VEX.vvvv, mod_rm, imm8[7:4]    -&gt; mod_reg */</span>
	VEX_MX,         <span class="enscript-comment">/* VEX  mod_rm                         -&gt; mod_reg */</span>
	VEX_MXI,        <span class="enscript-comment">/* VEX  mod_rm, imm8                   -&gt; mod_reg */</span>
	VEX_XXI,        <span class="enscript-comment">/* VEX  mod_rm, imm8                   -&gt; VEX.vvvv */</span>
	VEX_MR,         <span class="enscript-comment">/* VEX  mod_rm                         -&gt; mod_reg */</span>
	VEX_RRI,        <span class="enscript-comment">/* VEX  mod_reg, mod_rm                -&gt; implicit(eflags/r32) */</span>
	VEX_RX,         <span class="enscript-comment">/* VEX  mod_reg                        -&gt; mod_rm */</span>
	VEX_RR,         <span class="enscript-comment">/* VEX  mod_rm                         -&gt; mod_reg */</span>
	VEX_RRi,        <span class="enscript-comment">/* VEX  mod_rm, imm8                   -&gt; mod_reg */</span>
	VEX_RM,         <span class="enscript-comment">/* VEX  mod_reg                        -&gt; mod_rm */</span>
	VEX_RIM,        <span class="enscript-comment">/* VEX  mod_reg, imm8                  -&gt; mod_rm */</span>
	VEX_RRM,        <span class="enscript-comment">/* VEX  VEX.vvvv, mod_reg              -&gt; mod_rm */</span>
	VEX_RMX,        <span class="enscript-comment">/* VEX  VEX.vvvv, mod_rm               -&gt; mod_reg */</span>
};

<span class="enscript-comment">/*
 * VEX prefixes
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VEX_2bytes</span>	0xC5	<span class="enscript-comment">/* the first byte of two-byte form */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VEX_3bytes</span>	0xC4	<span class="enscript-comment">/* the first byte of three-byte form */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FILL</span>	0x90	<span class="enscript-comment">/* Fill byte used for alignment (nop)	*/</span>

<span class="enscript-comment">/*
** Register numbers for the i386
*/</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">EAX_REGNO</span> 0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ECX_REGNO</span> 1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">EDX_REGNO</span> 2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">EBX_REGNO</span> 3
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ESP_REGNO</span> 4
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">EBP_REGNO</span> 5
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ESI_REGNO</span> 6
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">EDI_REGNO</span> 7

<span class="enscript-comment">/*
 * modes for immediate values
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MODE_NONE</span>	0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MODE_IPREL</span>	1	<span class="enscript-comment">/* signed IP relative value */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MODE_SIGNED</span>	2	<span class="enscript-comment">/* sign extended immediate */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MODE_IMPLIED</span>	3	<span class="enscript-comment">/* constant value implied from opcode */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MODE_OFFSET</span>	4	<span class="enscript-comment">/* offset part of an address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MODE_RIPREL</span>	5	<span class="enscript-comment">/* like IPREL, but from %rip (amd64) */</span>

<span class="enscript-comment">/*
 * The letters used in these macros are:
 *   IND - indirect to another to another table
 *   &quot;T&quot; - means to Terminate indirections (this is the final opcode)
 *   &quot;S&quot; - means &quot;operand length suffix required&quot;
 *   &quot;NS&quot; - means &quot;no suffix&quot; which is the operand length suffix of the opcode
 *   &quot;Z&quot; - means instruction size arg required
 *   &quot;u&quot; - means the opcode is invalid in IA32 but valid in amd64
 *   &quot;x&quot; - means the opcode is invalid in amd64, but not IA32
 *   &quot;y&quot; - means the operand size is always 64 bits in 64 bit mode
 *   &quot;p&quot; - means push/pop stack operation
 */</span>

#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">DIS_TEXT</span>) &amp;&amp; <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">DIS_MEM</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IND</span>(table)		{(instable_t *)table, 0, <span class="enscript-string">&quot;&quot;</span>, 0, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">INDx</span>(table)		{(instable_t *)table, 0, <span class="enscript-string">&quot;&quot;</span>, 0, 0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNS</span>(name, amode)	{TERM, amode, name, 0, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSu</span>(name, amode)	{TERM, amode, name, 0, 0, 0, 0, 1, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSx</span>(name, amode)	{TERM, amode, name, 0, 0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSy</span>(name, amode)	{TERM, amode, name, 0, 0, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSyp</span>(name, amode)	{TERM, amode, name, 0, 0, 0, 1, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZ</span>(name, amode, sz)	{TERM, amode, name, 0, sz, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZy</span>(name, amode, sz)	{TERM, amode, name, 0, sz, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TS</span>(name, amode)		{TERM, amode, name, 1, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSx</span>(name, amode)	{TERM, amode, name, 1, 0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSy</span>(name, amode)	{TERM, amode, name, 1, 0, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSp</span>(name, amode)	{TERM, amode, name, 1, 0, 0, 0, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZ</span>(name, amode, sz)	{TERM, amode, name, 1, sz, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZx</span>(name, amode, sz)	{TERM, amode, name, 1, sz, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZy</span>(name, amode, sz)	{TERM, amode, name, 1, sz, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INVALID</span>			{TERM, UNKNOWN, <span class="enscript-string">&quot;&quot;</span>, 0, 0, 0, 0, 0}
#<span class="enscript-reference">elif</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">DIS_TEXT</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IND</span>(table)		{(instable_t *)table, 0, <span class="enscript-string">&quot;&quot;</span>, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">INDx</span>(table)		{(instable_t *)table, 0, <span class="enscript-string">&quot;&quot;</span>, 0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNS</span>(name, amode)	{TERM, amode, name, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSu</span>(name, amode)	{TERM, amode, name, 0, 0, 0, 1, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSx</span>(name, amode)	{TERM, amode, name, 0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSy</span>(name, amode)	{TERM, amode, name, 0, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSyp</span>(name, amode)	{TERM, amode, name, 0, 0, 1, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZ</span>(name, amode, sz)	{TERM, amode, name, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZy</span>(name, amode, sz)	{TERM, amode, name, 0, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TS</span>(name, amode)		{TERM, amode, name, 1, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSx</span>(name, amode)	{TERM, amode, name, 1, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSy</span>(name, amode)	{TERM, amode, name, 1, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSp</span>(name, amode)	{TERM, amode, name, 1, 0, 0, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZ</span>(name, amode, sz)	{TERM, amode, name, 1, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZx</span>(name, amode, sz)	{TERM, amode, name, 1, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZy</span>(name, amode, sz)	{TERM, amode, name, 1, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INVALID</span>			{TERM, UNKNOWN, <span class="enscript-string">&quot;&quot;</span>, 0, 0, 0, 0, 0}
#<span class="enscript-reference">elif</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">DIS_MEM</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IND</span>(table)		{(instable_t *)table, 0, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">INDx</span>(table)		{(instable_t *)table, 0, 0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNS</span>(name, amode)	{TERM, amode,  0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSu</span>(name, amode)	{TERM, amode,  0, 0, 0, 1, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSy</span>(name, amode)	{TERM, amode,  0, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSyp</span>(name, amode)	{TERM, amode,  0, 0, 1, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSx</span>(name, amode)	{TERM, amode,  0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZ</span>(name, amode, sz)	{TERM, amode, sz, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZy</span>(name, amode, sz)	{TERM, amode, sz, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TS</span>(name, amode)		{TERM, amode,  0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSx</span>(name, amode)	{TERM, amode,  0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSy</span>(name, amode)	{TERM, amode,  0, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSp</span>(name, amode)	{TERM, amode,  0, 0, 0, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZ</span>(name, amode, sz)	{TERM, amode, sz, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZx</span>(name, amode, sz)	{TERM, amode, sz, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZy</span>(name, amode, sz)	{TERM, amode, sz, 0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INVALID</span>			{TERM, UNKNOWN, 0, 0, 0, 0, 0}
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IND</span>(table)		{(instable_t *)table, 0, 0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">INDx</span>(table)		{(instable_t *)table, 0, 1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNS</span>(name, amode)	{TERM, amode,  0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSu</span>(name, amode)	{TERM, amode,  0, 0, 1, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSy</span>(name, amode)	{TERM, amode,  0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSyp</span>(name, amode)	{TERM, amode,  0, 1, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSx</span>(name, amode)	{TERM, amode,  1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZ</span>(name, amode, sz)	{TERM, amode,  0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TNSZy</span>(name, amode, sz)	{TERM, amode,  0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TS</span>(name, amode)		{TERM, amode,  0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSx</span>(name, amode)	{TERM, amode,  1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSy</span>(name, amode)	{TERM, amode,  0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSp</span>(name, amode)	{TERM, amode,  0, 0, 0, 1}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZ</span>(name, amode, sz)	{TERM, amode,  0, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZx</span>(name, amode, sz)	{TERM, amode,  1, 0, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSZy</span>(name, amode, sz)	{TERM, amode,  0, 1, 0, 0}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INVALID</span>			{TERM, UNKNOWN, 0, 0, 0, 0}
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
<span class="enscript-comment">/*
 * this decodes the r_m field for mode's 0, 1, 2 in 16 bit mode
 */</span>
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_addr16[3][8] = {
<span class="enscript-string">&quot;(%bx,%si)&quot;</span>, <span class="enscript-string">&quot;(%bx,%di)&quot;</span>, <span class="enscript-string">&quot;(%bp,%si)&quot;</span>, <span class="enscript-string">&quot;(%bp,%di)&quot;</span>, <span class="enscript-string">&quot;(%si)&quot;</span>, <span class="enscript-string">&quot;(%di)&quot;</span>, <span class="enscript-string">&quot;&quot;</span>,
									<span class="enscript-string">&quot;(%bx)&quot;</span>,
<span class="enscript-string">&quot;(%bx,%si)&quot;</span>, <span class="enscript-string">&quot;(%bx,%di)&quot;</span>, <span class="enscript-string">&quot;(%bp,%si)&quot;</span>, <span class="enscript-string">&quot;(%bp,%di)&quot;</span>, <span class="enscript-string">&quot;(%si)&quot;</span>, <span class="enscript-string">&quot;(%di&quot;</span>, <span class="enscript-string">&quot;(%bp)&quot;</span>,
									<span class="enscript-string">&quot;(%bx)&quot;</span>,
<span class="enscript-string">&quot;(%bx,%si)&quot;</span>, <span class="enscript-string">&quot;(%bx,%di)&quot;</span>, <span class="enscript-string">&quot;(%bp,%si)&quot;</span>, <span class="enscript-string">&quot;(%bp,%di)&quot;</span>, <span class="enscript-string">&quot;(%si)&quot;</span>, <span class="enscript-string">&quot;(%di)&quot;</span>, <span class="enscript-string">&quot;(%bp)&quot;</span>,
									<span class="enscript-string">&quot;(%bx)&quot;</span>,
};


<span class="enscript-comment">/*
 * This decodes 32 bit addressing mode r_m field for modes 0, 1, 2
 */</span>
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_addr32_mode0[16] = {
  <span class="enscript-string">&quot;(%eax)&quot;</span>, <span class="enscript-string">&quot;(%ecx)&quot;</span>, <span class="enscript-string">&quot;(%edx)&quot;</span>,  <span class="enscript-string">&quot;(%ebx)&quot;</span>,  <span class="enscript-string">&quot;&quot;</span>, <span class="enscript-string">&quot;&quot;</span>,        <span class="enscript-string">&quot;(%esi)&quot;</span>,  <span class="enscript-string">&quot;(%edi)&quot;</span>,
  <span class="enscript-string">&quot;(%r8d)&quot;</span>, <span class="enscript-string">&quot;(%r9d)&quot;</span>, <span class="enscript-string">&quot;(%r10d)&quot;</span>, <span class="enscript-string">&quot;(%r11d)&quot;</span>, <span class="enscript-string">&quot;&quot;</span>, <span class="enscript-string">&quot;&quot;</span>,        <span class="enscript-string">&quot;(%r14d)&quot;</span>, <span class="enscript-string">&quot;(%r15d)&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_addr32_mode12[16] = {
  <span class="enscript-string">&quot;(%eax)&quot;</span>, <span class="enscript-string">&quot;(%ecx)&quot;</span>, <span class="enscript-string">&quot;(%edx)&quot;</span>,  <span class="enscript-string">&quot;(%ebx)&quot;</span>,  <span class="enscript-string">&quot;&quot;</span>, <span class="enscript-string">&quot;(%ebp)&quot;</span>,  <span class="enscript-string">&quot;(%esi)&quot;</span>,  <span class="enscript-string">&quot;(%edi)&quot;</span>,
  <span class="enscript-string">&quot;(%r8d)&quot;</span>, <span class="enscript-string">&quot;(%r9d)&quot;</span>, <span class="enscript-string">&quot;(%r10d)&quot;</span>, <span class="enscript-string">&quot;(%r11d)&quot;</span>, <span class="enscript-string">&quot;&quot;</span>, <span class="enscript-string">&quot;(%r13d)&quot;</span>, <span class="enscript-string">&quot;(%r14d)&quot;</span>, <span class="enscript-string">&quot;(%r15d)&quot;</span>
};

<span class="enscript-comment">/*
 * This decodes 64 bit addressing mode r_m field for modes 0, 1, 2
 */</span>
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_addr64_mode0[16] = {
 <span class="enscript-string">&quot;(%rax)&quot;</span>, <span class="enscript-string">&quot;(%rcx)&quot;</span>, <span class="enscript-string">&quot;(%rdx)&quot;</span>, <span class="enscript-string">&quot;(%rbx)&quot;</span>, <span class="enscript-string">&quot;&quot;</span>,       <span class="enscript-string">&quot;(%rip)&quot;</span>, <span class="enscript-string">&quot;(%rsi)&quot;</span>, <span class="enscript-string">&quot;(%rdi)&quot;</span>,
 <span class="enscript-string">&quot;(%r8)&quot;</span>,  <span class="enscript-string">&quot;(%r9)&quot;</span>,  <span class="enscript-string">&quot;(%r10)&quot;</span>, <span class="enscript-string">&quot;(%r11)&quot;</span>, <span class="enscript-string">&quot;(%r12)&quot;</span>, <span class="enscript-string">&quot;(%rip)&quot;</span>, <span class="enscript-string">&quot;(%r14)&quot;</span>, <span class="enscript-string">&quot;(%r15)&quot;</span>
};
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_addr64_mode12[16] = {
 <span class="enscript-string">&quot;(%rax)&quot;</span>, <span class="enscript-string">&quot;(%rcx)&quot;</span>, <span class="enscript-string">&quot;(%rdx)&quot;</span>, <span class="enscript-string">&quot;(%rbx)&quot;</span>, <span class="enscript-string">&quot;&quot;</span>,       <span class="enscript-string">&quot;(%rbp)&quot;</span>, <span class="enscript-string">&quot;(%rsi)&quot;</span>, <span class="enscript-string">&quot;(%rdi)&quot;</span>,
 <span class="enscript-string">&quot;(%r8)&quot;</span>,  <span class="enscript-string">&quot;(%r9)&quot;</span>,  <span class="enscript-string">&quot;(%r10)&quot;</span>, <span class="enscript-string">&quot;(%r11)&quot;</span>, <span class="enscript-string">&quot;(%r12)&quot;</span>, <span class="enscript-string">&quot;(%r13)&quot;</span>, <span class="enscript-string">&quot;(%r14)&quot;</span>, <span class="enscript-string">&quot;(%r15)&quot;</span>
};

<span class="enscript-comment">/*
 * decode for scale from SIB byte
 */</span>
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_scale_factor[4] = { <span class="enscript-string">&quot;)&quot;</span>, <span class="enscript-string">&quot;,2)&quot;</span>, <span class="enscript-string">&quot;,4)&quot;</span>, <span class="enscript-string">&quot;,8)&quot;</span> };

<span class="enscript-comment">/*
 * register decoding for normal references to registers (ie. not addressing)
 */</span>
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_REG8[16] = {
	<span class="enscript-string">&quot;%al&quot;</span>,  <span class="enscript-string">&quot;%cl&quot;</span>,  <span class="enscript-string">&quot;%dl&quot;</span>,   <span class="enscript-string">&quot;%bl&quot;</span>,   <span class="enscript-string">&quot;%ah&quot;</span>,   <span class="enscript-string">&quot;%ch&quot;</span>,   <span class="enscript-string">&quot;%dh&quot;</span>,   <span class="enscript-string">&quot;%bh&quot;</span>,
	<span class="enscript-string">&quot;%r8b&quot;</span>, <span class="enscript-string">&quot;%r9b&quot;</span>, <span class="enscript-string">&quot;%r10b&quot;</span>, <span class="enscript-string">&quot;%r11b&quot;</span>, <span class="enscript-string">&quot;%r12b&quot;</span>, <span class="enscript-string">&quot;%r13b&quot;</span>, <span class="enscript-string">&quot;%r14b&quot;</span>, <span class="enscript-string">&quot;%r15b&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_REG8_REX[16] = {
	<span class="enscript-string">&quot;%al&quot;</span>,  <span class="enscript-string">&quot;%cl&quot;</span>,  <span class="enscript-string">&quot;%dl&quot;</span>,   <span class="enscript-string">&quot;%bl&quot;</span>,   <span class="enscript-string">&quot;%spl&quot;</span>,  <span class="enscript-string">&quot;%bpl&quot;</span>,  <span class="enscript-string">&quot;%sil&quot;</span>,  <span class="enscript-string">&quot;%dil&quot;</span>,
	<span class="enscript-string">&quot;%r8b&quot;</span>, <span class="enscript-string">&quot;%r9b&quot;</span>, <span class="enscript-string">&quot;%r10b&quot;</span>, <span class="enscript-string">&quot;%r11b&quot;</span>, <span class="enscript-string">&quot;%r12b&quot;</span>, <span class="enscript-string">&quot;%r13b&quot;</span>, <span class="enscript-string">&quot;%r14b&quot;</span>, <span class="enscript-string">&quot;%r15b&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_REG16[16] = {
	<span class="enscript-string">&quot;%ax&quot;</span>,  <span class="enscript-string">&quot;%cx&quot;</span>,  <span class="enscript-string">&quot;%dx&quot;</span>,   <span class="enscript-string">&quot;%bx&quot;</span>,   <span class="enscript-string">&quot;%sp&quot;</span>,   <span class="enscript-string">&quot;%bp&quot;</span>,   <span class="enscript-string">&quot;%si&quot;</span>,   <span class="enscript-string">&quot;%di&quot;</span>,
	<span class="enscript-string">&quot;%r8w&quot;</span>, <span class="enscript-string">&quot;%r9w&quot;</span>, <span class="enscript-string">&quot;%r10w&quot;</span>, <span class="enscript-string">&quot;%r11w&quot;</span>, <span class="enscript-string">&quot;%r12w&quot;</span>, <span class="enscript-string">&quot;%r13w&quot;</span>, <span class="enscript-string">&quot;%r14w&quot;</span>, <span class="enscript-string">&quot;%r15w&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_REG32[16] = {
	<span class="enscript-string">&quot;%eax&quot;</span>, <span class="enscript-string">&quot;%ecx&quot;</span>, <span class="enscript-string">&quot;%edx&quot;</span>,  <span class="enscript-string">&quot;%ebx&quot;</span>,  <span class="enscript-string">&quot;%esp&quot;</span>,  <span class="enscript-string">&quot;%ebp&quot;</span>,  <span class="enscript-string">&quot;%esi&quot;</span>,  <span class="enscript-string">&quot;%edi&quot;</span>,
	<span class="enscript-string">&quot;%r8d&quot;</span>, <span class="enscript-string">&quot;%r9d&quot;</span>, <span class="enscript-string">&quot;%r10d&quot;</span>, <span class="enscript-string">&quot;%r11d&quot;</span>, <span class="enscript-string">&quot;%r12d&quot;</span>, <span class="enscript-string">&quot;%r13d&quot;</span>, <span class="enscript-string">&quot;%r14d&quot;</span>, <span class="enscript-string">&quot;%r15d&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_REG64[16] = {
	<span class="enscript-string">&quot;%rax&quot;</span>, <span class="enscript-string">&quot;%rcx&quot;</span>, <span class="enscript-string">&quot;%rdx&quot;</span>,  <span class="enscript-string">&quot;%rbx&quot;</span>, <span class="enscript-string">&quot;%rsp&quot;</span>, <span class="enscript-string">&quot;%rbp&quot;</span>, <span class="enscript-string">&quot;%rsi&quot;</span>, <span class="enscript-string">&quot;%rdi&quot;</span>,
	<span class="enscript-string">&quot;%r8&quot;</span>,  <span class="enscript-string">&quot;%r9&quot;</span>,  <span class="enscript-string">&quot;%r10&quot;</span>,  <span class="enscript-string">&quot;%r11&quot;</span>, <span class="enscript-string">&quot;%r12&quot;</span>, <span class="enscript-string">&quot;%r13&quot;</span>, <span class="enscript-string">&quot;%r14&quot;</span>, <span class="enscript-string">&quot;%r15&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_DEBUGREG[16] = {
	<span class="enscript-string">&quot;%db0&quot;</span>, <span class="enscript-string">&quot;%db1&quot;</span>, <span class="enscript-string">&quot;%db2&quot;</span>,  <span class="enscript-string">&quot;%db3&quot;</span>,  <span class="enscript-string">&quot;%db4&quot;</span>,  <span class="enscript-string">&quot;%db5&quot;</span>,  <span class="enscript-string">&quot;%db6&quot;</span>,  <span class="enscript-string">&quot;%db7&quot;</span>,
	<span class="enscript-string">&quot;%db8&quot;</span>, <span class="enscript-string">&quot;%db9&quot;</span>, <span class="enscript-string">&quot;%db10&quot;</span>, <span class="enscript-string">&quot;%db11&quot;</span>, <span class="enscript-string">&quot;%db12&quot;</span>, <span class="enscript-string">&quot;%db13&quot;</span>, <span class="enscript-string">&quot;%db14&quot;</span>, <span class="enscript-string">&quot;%db15&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_CONTROLREG[16] = {
    <span class="enscript-string">&quot;%cr0&quot;</span>, <span class="enscript-string">&quot;%cr1&quot;</span>, <span class="enscript-string">&quot;%cr2&quot;</span>, <span class="enscript-string">&quot;%cr3&quot;</span>, <span class="enscript-string">&quot;%cr4&quot;</span>, <span class="enscript-string">&quot;%cr5?&quot;</span>, <span class="enscript-string">&quot;%cr6?&quot;</span>, <span class="enscript-string">&quot;%cr7?&quot;</span>,
    <span class="enscript-string">&quot;%cr8&quot;</span>, <span class="enscript-string">&quot;%cr9?&quot;</span>, <span class="enscript-string">&quot;%cr10?&quot;</span>, <span class="enscript-string">&quot;%cr11?&quot;</span>, <span class="enscript-string">&quot;%cr12?&quot;</span>, <span class="enscript-string">&quot;%cr13?&quot;</span>, <span class="enscript-string">&quot;%cr14?&quot;</span>, <span class="enscript-string">&quot;%cr15?&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_TESTREG[16] = {
	<span class="enscript-string">&quot;%tr0?&quot;</span>, <span class="enscript-string">&quot;%tr1?&quot;</span>, <span class="enscript-string">&quot;%tr2?&quot;</span>, <span class="enscript-string">&quot;%tr3&quot;</span>, <span class="enscript-string">&quot;%tr4&quot;</span>, <span class="enscript-string">&quot;%tr5&quot;</span>, <span class="enscript-string">&quot;%tr6&quot;</span>, <span class="enscript-string">&quot;%tr7&quot;</span>,
	<span class="enscript-string">&quot;%tr0?&quot;</span>, <span class="enscript-string">&quot;%tr1?&quot;</span>, <span class="enscript-string">&quot;%tr2?&quot;</span>, <span class="enscript-string">&quot;%tr3&quot;</span>, <span class="enscript-string">&quot;%tr4&quot;</span>, <span class="enscript-string">&quot;%tr5&quot;</span>, <span class="enscript-string">&quot;%tr6&quot;</span>, <span class="enscript-string">&quot;%tr7&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_MMREG[16] = {
	<span class="enscript-string">&quot;%mm0&quot;</span>, <span class="enscript-string">&quot;%mm1&quot;</span>, <span class="enscript-string">&quot;%mm2&quot;</span>, <span class="enscript-string">&quot;%mm3&quot;</span>, <span class="enscript-string">&quot;%mm4&quot;</span>, <span class="enscript-string">&quot;%mm5&quot;</span>, <span class="enscript-string">&quot;%mm6&quot;</span>, <span class="enscript-string">&quot;%mm7&quot;</span>,
	<span class="enscript-string">&quot;%mm0&quot;</span>, <span class="enscript-string">&quot;%mm1&quot;</span>, <span class="enscript-string">&quot;%mm2&quot;</span>, <span class="enscript-string">&quot;%mm3&quot;</span>, <span class="enscript-string">&quot;%mm4&quot;</span>, <span class="enscript-string">&quot;%mm5&quot;</span>, <span class="enscript-string">&quot;%mm6&quot;</span>, <span class="enscript-string">&quot;%mm7&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_XMMREG[16] = {
    <span class="enscript-string">&quot;%xmm0&quot;</span>, <span class="enscript-string">&quot;%xmm1&quot;</span>, <span class="enscript-string">&quot;%xmm2&quot;</span>, <span class="enscript-string">&quot;%xmm3&quot;</span>, <span class="enscript-string">&quot;%xmm4&quot;</span>, <span class="enscript-string">&quot;%xmm5&quot;</span>, <span class="enscript-string">&quot;%xmm6&quot;</span>, <span class="enscript-string">&quot;%xmm7&quot;</span>,
    <span class="enscript-string">&quot;%xmm8&quot;</span>, <span class="enscript-string">&quot;%xmm9&quot;</span>, <span class="enscript-string">&quot;%xmm10&quot;</span>, <span class="enscript-string">&quot;%xmm11&quot;</span>, <span class="enscript-string">&quot;%xmm12&quot;</span>, <span class="enscript-string">&quot;%xmm13&quot;</span>, <span class="enscript-string">&quot;%xmm14&quot;</span>, <span class="enscript-string">&quot;%xmm15&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_YMMREG[16] = {
    <span class="enscript-string">&quot;%ymm0&quot;</span>, <span class="enscript-string">&quot;%ymm1&quot;</span>, <span class="enscript-string">&quot;%ymm2&quot;</span>, <span class="enscript-string">&quot;%ymm3&quot;</span>, <span class="enscript-string">&quot;%ymm4&quot;</span>, <span class="enscript-string">&quot;%ymm5&quot;</span>, <span class="enscript-string">&quot;%ymm6&quot;</span>, <span class="enscript-string">&quot;%ymm7&quot;</span>,
    <span class="enscript-string">&quot;%ymm8&quot;</span>, <span class="enscript-string">&quot;%ymm9&quot;</span>, <span class="enscript-string">&quot;%ymm10&quot;</span>, <span class="enscript-string">&quot;%ymm11&quot;</span>, <span class="enscript-string">&quot;%ymm12&quot;</span>, <span class="enscript-string">&quot;%ymm13&quot;</span>, <span class="enscript-string">&quot;%ymm14&quot;</span>, <span class="enscript-string">&quot;%ymm15&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_SEGREG[16] = {
	<span class="enscript-string">&quot;%es&quot;</span>, <span class="enscript-string">&quot;%cs&quot;</span>, <span class="enscript-string">&quot;%ss&quot;</span>, <span class="enscript-string">&quot;%ds&quot;</span>, <span class="enscript-string">&quot;%fs&quot;</span>, <span class="enscript-string">&quot;%gs&quot;</span>, <span class="enscript-string">&quot;&lt;reserved&gt;&quot;</span>, <span class="enscript-string">&quot;&lt;reserved&gt;&quot;</span>,
	<span class="enscript-string">&quot;%es&quot;</span>, <span class="enscript-string">&quot;%cs&quot;</span>, <span class="enscript-string">&quot;%ss&quot;</span>, <span class="enscript-string">&quot;%ds&quot;</span>, <span class="enscript-string">&quot;%fs&quot;</span>, <span class="enscript-string">&quot;%gs&quot;</span>, <span class="enscript-string">&quot;&lt;reserved&gt;&quot;</span>, <span class="enscript-string">&quot;&lt;reserved&gt;&quot;</span>
};

<span class="enscript-comment">/*
 * SIMD predicate suffixes
 */</span>
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_PREDSUFFIX[8] = {
	<span class="enscript-string">&quot;eq&quot;</span>, <span class="enscript-string">&quot;lt&quot;</span>, <span class="enscript-string">&quot;le&quot;</span>, <span class="enscript-string">&quot;unord&quot;</span>, <span class="enscript-string">&quot;neq&quot;</span>, <span class="enscript-string">&quot;nlt&quot;</span>, <span class="enscript-string">&quot;nle&quot;</span>, <span class="enscript-string">&quot;ord&quot;</span>
};

<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-type">const</span> dis_AVXvgrp7[3][8] = {
	<span class="enscript-comment">/*0	1	2		3		4		5	6		7*/</span>
<span class="enscript-comment">/*71*/</span>	{<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;vpsrlw&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,		<span class="enscript-string">&quot;vpsraw&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;vpsllw&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>},
<span class="enscript-comment">/*72*/</span>	{<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;vpsrld&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,		<span class="enscript-string">&quot;vpsrad&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;vpslld&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>},
<span class="enscript-comment">/*73*/</span>	{<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;vpsrlq&quot;</span>,	<span class="enscript-string">&quot;vpsrldq&quot;</span>,	<span class="enscript-string">&quot;&quot;</span>,		<span class="enscript-string">&quot;&quot;</span>,	<span class="enscript-string">&quot;vpsllq&quot;</span>,	<span class="enscript-string">&quot;vpslldq&quot;</span>}
};

#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* DIS_TEXT */</span>




<span class="enscript-comment">/*
 *	&quot;decode table&quot; for 64 bit mode MOVSXD instruction (opcode 0x63)
 */</span>
<span class="enscript-type">const</span> instable_t dis_opMOVSLD = TNS(<span class="enscript-string">&quot;movslq&quot;</span>,MOVSXZ);

<span class="enscript-comment">/*
 *	&quot;decode table&quot; for pause and clflush instructions
 */</span>
<span class="enscript-type">const</span> instable_t dis_opPause = TNS(<span class="enscript-string">&quot;pause&quot;</span>, NORM);

<span class="enscript-comment">/*
 *	Decode table for 0x0F00 opcodes
 */</span>
<span class="enscript-type">const</span> instable_t dis_op0F00[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;sldt&quot;</span>,M),		TNS(<span class="enscript-string">&quot;str&quot;</span>,M),		TNSy(<span class="enscript-string">&quot;lldt&quot;</span>,M), 	TNSy(<span class="enscript-string">&quot;ltr&quot;</span>,M),
<span class="enscript-comment">/*  [4]  */</span>	TNSZ(<span class="enscript-string">&quot;verr&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;verw&quot;</span>,M,2),	INVALID,		INVALID,
};


<span class="enscript-comment">/*
 *	Decode table for 0x0F01 opcodes
 */</span>
<span class="enscript-type">const</span> instable_t dis_op0F01[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNSZ(<span class="enscript-string">&quot;sgdt&quot;</span>,MO,6),	TNSZ(<span class="enscript-string">&quot;sidt&quot;</span>,MONITOR_MWAIT,6), TNSZ(<span class="enscript-string">&quot;lgdt&quot;</span>,XGETBV_XSETBV,6),	TNSZ(<span class="enscript-string">&quot;lidt&quot;</span>,MO,6),
<span class="enscript-comment">/*  [4]  */</span>	TNSZ(<span class="enscript-string">&quot;smsw&quot;</span>,M,2),	INVALID, 		TNSZ(<span class="enscript-string">&quot;lmsw&quot;</span>,M,2),	TNS(<span class="enscript-string">&quot;invlpg&quot;</span>,SWAPGS),
};

<span class="enscript-comment">/*
 *	Decode table for 0x0F18 opcodes -- SIMD prefetch
 */</span>
<span class="enscript-type">const</span> instable_t dis_op0F18[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;prefetchnta&quot;</span>,PREF),TNS(<span class="enscript-string">&quot;prefetcht0&quot;</span>,PREF),	TNS(<span class="enscript-string">&quot;prefetcht1&quot;</span>,PREF),	TNS(<span class="enscript-string">&quot;prefetcht2&quot;</span>,PREF),
<span class="enscript-comment">/*  [4]  */</span>	TNSZ(<span class="enscript-string">&quot;xsave&quot;</span>,M,512),	TNS(<span class="enscript-string">&quot;lfence&quot;</span>,XMMFENCE), TNS(<span class="enscript-string">&quot;mfence&quot;</span>,XMMFENCE),	TNS(<span class="enscript-string">&quot;sfence&quot;</span>,XMMSFNC),
};

<span class="enscript-comment">/*
 * 	Decode table for 0x0FAE opcodes -- SIMD state save/restore
 */</span>
<span class="enscript-type">const</span> instable_t dis_op0FAE[8] = {
<span class="enscript-comment">/*  [0]  */</span>	TNSZ(<span class="enscript-string">&quot;fxsave&quot;</span>,M,512),	TNSZ(<span class="enscript-string">&quot;fxrstor&quot;</span>,M,512),	TNS(<span class="enscript-string">&quot;ldmxcsr&quot;</span>,M),	TNS(<span class="enscript-string">&quot;stmxcsr&quot;</span>,M),
<span class="enscript-comment">/*  [4]  */</span>	INVALID,		TNS(<span class="enscript-string">&quot;lfence&quot;</span>,XMMFENCE), TNS(<span class="enscript-string">&quot;mfence&quot;</span>,XMMFENCE),	TNS(<span class="enscript-string">&quot;sfence&quot;</span>,XMMSFNC),
};

<span class="enscript-comment">/*
 *	Decode table for 0x0FBA opcodes
 */</span>

<span class="enscript-type">const</span> instable_t dis_op0FBA[8] = {

<span class="enscript-comment">/*  [0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4]  */</span>	TS(<span class="enscript-string">&quot;bt&quot;</span>,MIb),		TS(<span class="enscript-string">&quot;bts&quot;</span>,MIb),		TS(<span class="enscript-string">&quot;btr&quot;</span>,MIb),		TS(<span class="enscript-string">&quot;btc&quot;</span>,MIb),
};

<span class="enscript-comment">/*
 * 	Decode table for 0x0FC7 opcode
 */</span>

<span class="enscript-type">const</span> instable_t dis_op0FC7[8] = {

<span class="enscript-comment">/*  [0]  */</span>	INVALID,		TNS(<span class="enscript-string">&quot;cmpxchg8b&quot;</span>,M),	INVALID,		INVALID,
<span class="enscript-comment">/*  [4]  */</span>	INVALID,		INVALID,	INVALID,		 INVALID,
};


<span class="enscript-comment">/*
 *	Decode table for 0x0FC8 opcode -- 486 bswap instruction
 *
 *bit pattern: 0000 1111 1100 1reg
 */</span>
<span class="enscript-type">const</span> instable_t dis_op0FC8[4] = {
<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;bswap&quot;</span>,R),		INVALID,		INVALID,		INVALID,
};

<span class="enscript-comment">/*
 *	Decode table for 0x0F71, 0x0F72, and 0x0F73 opcodes -- MMX instructions
 */</span>
<span class="enscript-type">const</span> instable_t dis_op0F7123[4][8] = {
{
<span class="enscript-comment">/*  [70].0 */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*      .4 */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [71].0 */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;psrlw&quot;</span>,MMOSH),	INVALID,
<span class="enscript-comment">/*      .4 */</span>	TNS(<span class="enscript-string">&quot;psraw&quot;</span>,MMOSH),	INVALID,		TNS(<span class="enscript-string">&quot;psllw&quot;</span>,MMOSH),	INVALID,
}, {
<span class="enscript-comment">/*  [72].0 */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;psrld&quot;</span>,MMOSH),	INVALID,
<span class="enscript-comment">/*      .4 */</span>	TNS(<span class="enscript-string">&quot;psrad&quot;</span>,MMOSH),	INVALID,		TNS(<span class="enscript-string">&quot;pslld&quot;</span>,MMOSH),	INVALID,
}, {
<span class="enscript-comment">/*  [73].0 */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;psrlq&quot;</span>,MMOSH),	TNS(<span class="enscript-string">&quot;INVALID&quot;</span>,MMOSH),
<span class="enscript-comment">/*      .4 */</span>	INVALID,		INVALID, 		TNS(<span class="enscript-string">&quot;psllq&quot;</span>,MMOSH),	TNS(<span class="enscript-string">&quot;INVALID&quot;</span>,MMOSH),
} };

<span class="enscript-comment">/*
 *	Decode table for SIMD extensions to above 0x0F71-0x0F73 opcodes.
 */</span>
<span class="enscript-type">const</span> instable_t dis_opSIMD7123[32] = {
<span class="enscript-comment">/* [70].0 */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*     .4 */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/* [71].0 */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;psrlw&quot;</span>,XMMSH),	INVALID,
<span class="enscript-comment">/*     .4 */</span>	TNS(<span class="enscript-string">&quot;psraw&quot;</span>,XMMSH),	INVALID,		TNS(<span class="enscript-string">&quot;psllw&quot;</span>,XMMSH),	INVALID,

<span class="enscript-comment">/* [72].0 */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;psrld&quot;</span>,XMMSH),	INVALID,
<span class="enscript-comment">/*     .4 */</span>	TNS(<span class="enscript-string">&quot;psrad&quot;</span>,XMMSH),	INVALID,		TNS(<span class="enscript-string">&quot;pslld&quot;</span>,XMMSH),	INVALID,

<span class="enscript-comment">/* [73].0 */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;psrlq&quot;</span>,XMMSH),	TNS(<span class="enscript-string">&quot;psrldq&quot;</span>,XMMSH),
<span class="enscript-comment">/*     .4 */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;psllq&quot;</span>,XMMSH),	TNS(<span class="enscript-string">&quot;pslldq&quot;</span>,XMMSH),
};

<span class="enscript-comment">/*
 *	SIMD instructions have been wedged into the existing IA32 instruction
 *	set through the use of prefixes.  That is, while 0xf0 0x58 may be
 *	addps, 0xf3 0xf0 0x58 (literally, repz addps) is a completely different
 *	instruction - addss.  At present, three prefixes have been coopted in
 *	this manner - address size (0x66), repnz (0xf2) and repz (0xf3).  The
 *	following tables are used to provide the prefixed instruction names.
 *	The arrays are sparse, but they're fast.
 */</span>

<span class="enscript-comment">/*
 *	Decode table for SIMD instructions with the address size (0x66) prefix.
 */</span>
<span class="enscript-type">const</span> instable_t dis_opSIMDdata16[256] = {
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;movupd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;movupd&quot;</span>,XMMS,16),	TNSZ(<span class="enscript-string">&quot;movlpd&quot;</span>,XMMM,8),	TNSZ(<span class="enscript-string">&quot;movlpd&quot;</span>,XMMMS,8),
<span class="enscript-comment">/*  [14]  */</span>	TNSZ(<span class="enscript-string">&quot;unpcklpd&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;unpckhpd&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;movhpd&quot;</span>,XMMM,8),	TNSZ(<span class="enscript-string">&quot;movhpd&quot;</span>,XMMMS,8),
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	TNSZ(<span class="enscript-string">&quot;movapd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;movapd&quot;</span>,XMMS,16),	TNSZ(<span class="enscript-string">&quot;cvtpi2pd&quot;</span>,XMMOMX,8),TNSZ(<span class="enscript-string">&quot;movntpd&quot;</span>,XMMOMS,16),
<span class="enscript-comment">/*  [2C]  */</span>	TNSZ(<span class="enscript-string">&quot;cvttpd2pi&quot;</span>,XMMXMM,16),TNSZ(<span class="enscript-string">&quot;cvtpd2pi&quot;</span>,XMMXMM,16),TNSZ(<span class="enscript-string">&quot;ucomisd&quot;</span>,XMM,8),TNSZ(<span class="enscript-string">&quot;comisd&quot;</span>,XMM,8),

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	TNS(<span class="enscript-string">&quot;movmskpd&quot;</span>,XMMOX3),	TNSZ(<span class="enscript-string">&quot;sqrtpd&quot;</span>,XMM,16),	INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	TNSZ(<span class="enscript-string">&quot;andpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;andnpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;orpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;xorpd&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;addpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;mulpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;cvtpd2ps&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;cvtps2dq&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;subpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;minpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;divpd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;maxpd&quot;</span>,XMM,16),

<span class="enscript-comment">/*  [60]  */</span>	TNSZ(<span class="enscript-string">&quot;punpcklbw&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;punpcklwd&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;punpckldq&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;packsswb&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [64]  */</span>	TNSZ(<span class="enscript-string">&quot;pcmpgtb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pcmpgtw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pcmpgtd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;packuswb&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [68]  */</span>	TNSZ(<span class="enscript-string">&quot;punpckhbw&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;punpckhwd&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;punpckhdq&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;packssdw&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [6C]  */</span>	TNSZ(<span class="enscript-string">&quot;punpcklqdq&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;punpckhqdq&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;movd&quot;</span>,XMM3MX,4),TNSZ(<span class="enscript-string">&quot;movdqa&quot;</span>,XMM,16),

<span class="enscript-comment">/*  [70]  */</span>	TNSZ(<span class="enscript-string">&quot;pshufd&quot;</span>,XMMP,16),	INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	TNSZ(<span class="enscript-string">&quot;pcmpeqb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pcmpeqw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pcmpeqd&quot;</span>,XMM,16),	INVALID,
<span class="enscript-comment">/*  [78]  */</span>	TNSZ(<span class="enscript-string">&quot;extrq&quot;</span>,XMM2I,16),	TNSZ(<span class="enscript-string">&quot;extrq&quot;</span>,XMM,16), INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;movd&quot;</span>,XMM3MXS,4),	TNSZ(<span class="enscript-string">&quot;movdqa&quot;</span>,XMMS,16),

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [8C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;cmppd&quot;</span>,XMMP,16),	INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	TNSZ(<span class="enscript-string">&quot;pinsrw&quot;</span>,XMMPRM,2),TNS(<span class="enscript-string">&quot;pextrw&quot;</span>,XMM3P),	TNSZ(<span class="enscript-string">&quot;shufpd&quot;</span>,XMMP,16),	INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;psrlw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psrld&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psrlq&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [D4]  */</span>	TNSZ(<span class="enscript-string">&quot;paddq&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pmullw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;movq&quot;</span>,XMMS,8),	TNS(<span class="enscript-string">&quot;pmovmskb&quot;</span>,XMMX3),
<span class="enscript-comment">/*  [D8]  */</span>	TNSZ(<span class="enscript-string">&quot;psubusb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psubusw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pminub&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pand&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [DC]  */</span>	TNSZ(<span class="enscript-string">&quot;paddusb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;paddusw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pmaxub&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pandn&quot;</span>,XMM,16),

<span class="enscript-comment">/*  [E0]  */</span>	TNSZ(<span class="enscript-string">&quot;pavgb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psraw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psrad&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pavgw&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [E4]  */</span>	TNSZ(<span class="enscript-string">&quot;pmulhuw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pmulhw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;cvttpd2dq&quot;</span>,XMM,16),TNSZ(<span class="enscript-string">&quot;movntdq&quot;</span>,XMMS,16),
<span class="enscript-comment">/*  [E8]  */</span>	TNSZ(<span class="enscript-string">&quot;psubsb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psubsw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pminsw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;por&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [EC]  */</span>	TNSZ(<span class="enscript-string">&quot;paddsb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;paddsw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pmaxsw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pxor&quot;</span>,XMM,16),

<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;psllw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pslld&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psllq&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [F4]  */</span>	TNSZ(<span class="enscript-string">&quot;pmuludq&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;pmaddwd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psadbw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;maskmovdqu&quot;</span>, XMMXIMPL,16),
<span class="enscript-comment">/*  [F8]  */</span>	TNSZ(<span class="enscript-string">&quot;psubb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psubw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psubd&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;psubq&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [FC]  */</span>	TNSZ(<span class="enscript-string">&quot;paddb&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;paddw&quot;</span>,XMM,16),	TNSZ(<span class="enscript-string">&quot;paddd&quot;</span>,XMM,16),	INVALID,
};

<span class="enscript-type">const</span> instable_t dis_opAVX660F[256] = {
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;vmovupd&quot;</span>,VEX_MX,16),	TNSZ(<span class="enscript-string">&quot;vmovupd&quot;</span>,VEX_RX,16),	TNSZ(<span class="enscript-string">&quot;vmovlpd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vmovlpd&quot;</span>,VEX_RM,8),
<span class="enscript-comment">/*  [14]  */</span>	TNSZ(<span class="enscript-string">&quot;vunpcklpd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vunpckhpd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vmovhpd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vmovhpd&quot;</span>,VEX_RM,8),
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	TNSZ(<span class="enscript-string">&quot;vmovapd&quot;</span>,VEX_MX,16),	TNSZ(<span class="enscript-string">&quot;vmovapd&quot;</span>,VEX_RX,16),	INVALID,		TNSZ(<span class="enscript-string">&quot;vmovntpd&quot;</span>,VEX_RM,16),
<span class="enscript-comment">/*  [2C]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vucomisd&quot;</span>,VEX_MX,8),TNSZ(<span class="enscript-string">&quot;vcomisd&quot;</span>,VEX_MX,8),

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	TNS(<span class="enscript-string">&quot;vmovmskpd&quot;</span>,VEX_MR),	TNSZ(<span class="enscript-string">&quot;vsqrtpd&quot;</span>,VEX_MX,16),	INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	TNSZ(<span class="enscript-string">&quot;vandpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vandnpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vorpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vxorpd&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;vaddpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vmulpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vcvtpd2ps&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vcvtps2dq&quot;</span>,VEX_MX,16),
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;vsubpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vminpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vdivpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vmaxpd&quot;</span>,VEX_RMrX,16),

<span class="enscript-comment">/*  [60]  */</span>	TNSZ(<span class="enscript-string">&quot;vpunpcklbw&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpunpcklwd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpunpckldq&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpacksswb&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [64]  */</span>	TNSZ(<span class="enscript-string">&quot;vpcmpgtb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpcmpgtw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpcmpgtd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpackuswb&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [68]  */</span>	TNSZ(<span class="enscript-string">&quot;vpunpckhbw&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpunpckhwd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpunpckhdq&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpackssdw&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [6C]  */</span>	TNSZ(<span class="enscript-string">&quot;vpunpcklqdq&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpunpckhqdq&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vmovd&quot;</span>,VEX_MX,4),TNSZ(<span class="enscript-string">&quot;vmovdqa&quot;</span>,VEX_MX,16),

<span class="enscript-comment">/*  [70]  */</span>	TNSZ(<span class="enscript-string">&quot;vpshufd&quot;</span>,VEX_MXI,16),	TNSZ(<span class="enscript-string">&quot;vgrp71&quot;</span>,VEX_XXI,16),	TNSZ(<span class="enscript-string">&quot;vgrp72&quot;</span>,VEX_XXI,16),		TNSZ(<span class="enscript-string">&quot;vgrp73&quot;</span>,VEX_XXI,16),
<span class="enscript-comment">/*  [74]  */</span>	TNSZ(<span class="enscript-string">&quot;vpcmpeqb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpcmpeqw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpcmpeqd&quot;</span>,VEX_RMrX,16),	INVALID,
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	TNSZ(<span class="enscript-string">&quot;vhaddpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vhsubpd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vmovd&quot;</span>,VEX_RR,4),	TNSZ(<span class="enscript-string">&quot;vmovdqa&quot;</span>,VEX_RX,16),

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [8C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcmppd&quot;</span>,VEX_RMRX,16),	INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	TNSZ(<span class="enscript-string">&quot;vpinsrw&quot;</span>,VEX_RMRX,2),TNS(<span class="enscript-string">&quot;vpextrw&quot;</span>,VEX_MR),	TNSZ(<span class="enscript-string">&quot;vshufpd&quot;</span>,VEX_RMRX,16),	INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	TNSZ(<span class="enscript-string">&quot;vaddsubpd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpsrlw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsrld&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsrlq&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [D4]  */</span>	TNSZ(<span class="enscript-string">&quot;vpaddq&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpmullw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vmovq&quot;</span>,VEX_RX,8),	TNS(<span class="enscript-string">&quot;vpmovmskb&quot;</span>,VEX_MR),
<span class="enscript-comment">/*  [D8]  */</span>	TNSZ(<span class="enscript-string">&quot;vpsubusb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsubusw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpminub&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpand&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [DC]  */</span>	TNSZ(<span class="enscript-string">&quot;vpaddusb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpaddusw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpmaxub&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpandn&quot;</span>,VEX_RMrX,16),

<span class="enscript-comment">/*  [E0]  */</span>	TNSZ(<span class="enscript-string">&quot;vpavgb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsraw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsrad&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpavgw&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [E4]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmulhuw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpmulhw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vcvttpd2dq&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vmovntdq&quot;</span>,VEX_RM,16),
<span class="enscript-comment">/*  [E8]  */</span>	TNSZ(<span class="enscript-string">&quot;vpsubsb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsubsw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpminsw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpor&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [EC]  */</span>	TNSZ(<span class="enscript-string">&quot;vpaddsb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpaddsw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpmaxsw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpxor&quot;</span>,VEX_RMrX,16),

<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;vpsllw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpslld&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsllq&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [F4]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmuludq&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpmaddwd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsadbw&quot;</span>,VEX_RMrX,16),	TNS(<span class="enscript-string">&quot;vmaskmovdqu&quot;</span>,VEX_MX),
<span class="enscript-comment">/*  [F8]  */</span>	TNSZ(<span class="enscript-string">&quot;vpsubb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsubw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsubd&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpsubq&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [FC]  */</span>	TNSZ(<span class="enscript-string">&quot;vpaddb&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpaddw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vpaddd&quot;</span>,VEX_RMrX,16),	INVALID,
};

<span class="enscript-comment">/*
 *	Decode table for SIMD instructions with the repnz (0xf2) prefix.
 */</span>
<span class="enscript-type">const</span> instable_t dis_opSIMDrepnz[256] = {
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;movsd&quot;</span>,XMM,8),	TNSZ(<span class="enscript-string">&quot;movsd&quot;</span>,XMMS,8),	INVALID,		INVALID,
<span class="enscript-comment">/*  [14]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;cvtsi2sd&quot;</span>,XMM3MX,4),TNSZ(<span class="enscript-string">&quot;movntsd&quot;</span>,XMMMS,8),
<span class="enscript-comment">/*  [2C]  */</span>	TNSZ(<span class="enscript-string">&quot;cvttsd2si&quot;</span>,XMMXM3,8),TNSZ(<span class="enscript-string">&quot;cvtsd2si&quot;</span>,XMMXM3,8),INVALID,		INVALID,

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;sqrtsd&quot;</span>,XMM,8),	INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;addsd&quot;</span>,XMM,8),	TNSZ(<span class="enscript-string">&quot;mulsd&quot;</span>,XMM,8),	TNSZ(<span class="enscript-string">&quot;cvtsd2ss&quot;</span>,XMM,8),	INVALID,
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;subsd&quot;</span>,XMM,8),	TNSZ(<span class="enscript-string">&quot;minsd&quot;</span>,XMM,8),	TNSZ(<span class="enscript-string">&quot;divsd&quot;</span>,XMM,8),	TNSZ(<span class="enscript-string">&quot;maxsd&quot;</span>,XMM,8),

<span class="enscript-comment">/*  [60]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [70]  */</span>	TNSZ(<span class="enscript-string">&quot;pshuflw&quot;</span>,XMMP,16),INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	TNSZ(<span class="enscript-string">&quot;insertq&quot;</span>,XMMX2I,16),TNSZ(<span class="enscript-string">&quot;insertq&quot;</span>,XMM,8),INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;cmpsd&quot;</span>,XMMP,8),	INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;movdq2q&quot;</span>,XMMXM),	INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;cvtpd2dq&quot;</span>,XMM,16),INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-type">const</span> instable_t dis_opAVXF20F[256] = {
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;vmovsd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vmovsd&quot;</span>,VEX_RRX,8),	TNSZ(<span class="enscript-string">&quot;vmovddup&quot;</span>,VEX_MX,8),	INVALID,
<span class="enscript-comment">/*  [14]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcvtsi2sd&quot;</span>,VEX_RMrX,4),INVALID,
<span class="enscript-comment">/*  [2C]  */</span>	TNSZ(<span class="enscript-string">&quot;vcvttsd2si&quot;</span>,VEX_MR,8),TNSZ(<span class="enscript-string">&quot;vcvtsd2si&quot;</span>,VEX_MR,8),INVALID,		INVALID,

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;vsqrtsd&quot;</span>,VEX_RMrX,8),	INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;vaddsd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vmulsd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vcvtsd2ss&quot;</span>,VEX_RMrX,8),	INVALID,
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;vsubsd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vminsd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vdivsd&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vmaxsd&quot;</span>,VEX_RMrX,8),

<span class="enscript-comment">/*  [60]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [70]  */</span>	TNSZ(<span class="enscript-string">&quot;vpshuflw&quot;</span>,VEX_MXI,16),INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	TNSZ(<span class="enscript-string">&quot;vhaddps&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vhsubps&quot;</span>,VEX_RMrX,8),	INVALID,		INVALID,

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcmpsd&quot;</span>,VEX_RMRX,8),	INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	TNSZ(<span class="enscript-string">&quot;vaddsubps&quot;</span>,VEX_RMrX,8),	INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcvtpd2dq&quot;</span>,VEX_MX,16),INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [F0]  */</span>	TNSZ(<span class="enscript-string">&quot;vlddqu&quot;</span>,VEX_MX,16),	INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-comment">/*
 *	Decode table for SIMD instructions with the repz (0xf3) prefix.
 */</span>
<span class="enscript-type">const</span> instable_t dis_opSIMDrepz[256] = {
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;movss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;movss&quot;</span>,XMMS,4),	INVALID,		INVALID,
<span class="enscript-comment">/*  [14]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;cvtsi2ss&quot;</span>,XMM3MX,4),TNSZ(<span class="enscript-string">&quot;movntss&quot;</span>,XMMMS,4),
<span class="enscript-comment">/*  [2C]  */</span>	TNSZ(<span class="enscript-string">&quot;cvttss2si&quot;</span>,XMMXM3,4),TNSZ(<span class="enscript-string">&quot;cvtss2si&quot;</span>,XMMXM3,4),INVALID,		INVALID,

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;sqrtss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;rsqrtss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;rcpss&quot;</span>,XMM,4),
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;addss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;mulss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;cvtss2sd&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;cvttps2dq&quot;</span>,XMM,16),
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;subss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;minss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;divss&quot;</span>,XMM,4),	TNSZ(<span class="enscript-string">&quot;maxss&quot;</span>,XMM,4),

<span class="enscript-comment">/*  [60]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;movdqu&quot;</span>,XMM,16),

<span class="enscript-comment">/*  [70]  */</span>	TNSZ(<span class="enscript-string">&quot;pshufhw&quot;</span>,XMMP,16),INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;movq&quot;</span>,XMM,8),	TNSZ(<span class="enscript-string">&quot;movdqu&quot;</span>,XMMS,16),

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	TS(<span class="enscript-string">&quot;popcnt&quot;</span>,MRw),	INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		TS(<span class="enscript-string">&quot;lzcnt&quot;</span>,MRw),	INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;cmpss&quot;</span>,XMMP,4),	INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;movq2dq&quot;</span>,XMMMX),	INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;cvtdq2pd&quot;</span>,XMM,8),	INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-type">const</span> instable_t dis_opAVXF30F[256] = {
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;vmovss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vmovss&quot;</span>,VEX_RRX,4),	TNSZ(<span class="enscript-string">&quot;vmovsldup&quot;</span>,VEX_MX,4),	INVALID,
<span class="enscript-comment">/*  [14]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vmovshdup&quot;</span>,VEX_MX,4),	INVALID,
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcvtsi2ss&quot;</span>,VEX_RMrX,4),INVALID,
<span class="enscript-comment">/*  [2C]  */</span>	TNSZ(<span class="enscript-string">&quot;vcvttss2si&quot;</span>,VEX_MR,4),TNSZ(<span class="enscript-string">&quot;vcvtss2si&quot;</span>,VEX_MR,4),INVALID,		INVALID,

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;vsqrtss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vrsqrtss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vrcpss&quot;</span>,VEX_RMrX,4),
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;vaddss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vmulss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vcvtss2sd&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vcvttps2dq&quot;</span>,VEX_MX,16),
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;vsubss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vminss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vdivss&quot;</span>,VEX_RMrX,4),	TNSZ(<span class="enscript-string">&quot;vmaxss&quot;</span>,VEX_RMrX,4),

<span class="enscript-comment">/*  [60]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vmovdqu&quot;</span>,VEX_MX,16),

<span class="enscript-comment">/*  [70]  */</span>	TNSZ(<span class="enscript-string">&quot;vpshufhw&quot;</span>,VEX_MXI,16),INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vmovq&quot;</span>,VEX_MX,8),	TNSZ(<span class="enscript-string">&quot;vmovdqu&quot;</span>,VEX_RX,16),

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcmpss&quot;</span>,VEX_RMRX,4),	INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcvtdq2pd&quot;</span>,VEX_MX,8),	INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-comment">/*
 * The following two tables are used to encode crc32 and movbe
 * since they share the same opcodes.
 */</span>
<span class="enscript-type">const</span> instable_t dis_op0F38F0[2] = {
<span class="enscript-comment">/*  [00]  */</span>	TNS(<span class="enscript-string">&quot;crc32b&quot;</span>,CRC32),
		TS(<span class="enscript-string">&quot;movbe&quot;</span>,MOVBE),
};

<span class="enscript-type">const</span> instable_t dis_op0F38F1[2] = {
<span class="enscript-comment">/*  [00]  */</span>	TS(<span class="enscript-string">&quot;crc32&quot;</span>,CRC32),
		TS(<span class="enscript-string">&quot;movbe&quot;</span>,MOVBE),
};


<span class="enscript-type">const</span> instable_t dis_op0F38[256] = {
<span class="enscript-comment">/*  [00]  */</span>	TNSZ(<span class="enscript-string">&quot;pshufb&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;phaddw&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;phaddd&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;phaddsw&quot;</span>,XMM_66o,16),
<span class="enscript-comment">/*  [04]  */</span>	TNSZ(<span class="enscript-string">&quot;pmaddubsw&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;phsubw&quot;</span>,XMM_66o,16),	TNSZ(<span class="enscript-string">&quot;phsubd&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;phsubsw&quot;</span>,XMM_66o,16),
<span class="enscript-comment">/*  [08]  */</span>	TNSZ(<span class="enscript-string">&quot;psignb&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;psignw&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;psignd&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;pmulhrsw&quot;</span>,XMM_66o,16),
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;pblendvb&quot;</span>,XMM_66r,16),INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [14]  */</span>	TNSZ(<span class="enscript-string">&quot;blendvps&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;blendvpd&quot;</span>,XMM_66r,16),INVALID,	TNSZ(<span class="enscript-string">&quot;ptest&quot;</span>,XMM_66r,16),
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	TNSZ(<span class="enscript-string">&quot;pabsb&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;pabsw&quot;</span>,XMM_66o,16),TNSZ(<span class="enscript-string">&quot;pabsd&quot;</span>,XMM_66o,16),INVALID,

<span class="enscript-comment">/*  [20]  */</span>	TNSZ(<span class="enscript-string">&quot;pmovsxbw&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovsxbd&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovsxbq&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovsxwd&quot;</span>,XMM_66r,16),
<span class="enscript-comment">/*  [24]  */</span>	TNSZ(<span class="enscript-string">&quot;pmovsxwq&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovsxdq&quot;</span>,XMM_66r,16),INVALID,	INVALID,
<span class="enscript-comment">/*  [28]  */</span>	TNSZ(<span class="enscript-string">&quot;pmuldq&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pcmpeqq&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;movntdqa&quot;</span>,XMMM_66r,16),TNSZ(<span class="enscript-string">&quot;packusdw&quot;</span>,XMM_66r,16),
<span class="enscript-comment">/*  [2C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [30]  */</span>	TNSZ(<span class="enscript-string">&quot;pmovzxbw&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovzxbd&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovzxbq&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovzxwd&quot;</span>,XMM_66r,16),
<span class="enscript-comment">/*  [34]  */</span>	TNSZ(<span class="enscript-string">&quot;pmovzxwq&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmovzxdq&quot;</span>,XMM_66r,16),INVALID,	TNSZ(<span class="enscript-string">&quot;pcmpgtq&quot;</span>,XMM_66r,16),
<span class="enscript-comment">/*  [38]  */</span>	TNSZ(<span class="enscript-string">&quot;pminsb&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pminsd&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pminuw&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pminud&quot;</span>,XMM_66r,16),
<span class="enscript-comment">/*  [3C]  */</span>	TNSZ(<span class="enscript-string">&quot;pmaxsb&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmaxsd&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmaxuw&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;pmaxud&quot;</span>,XMM_66r,16),

<span class="enscript-comment">/*  [40]  */</span>	TNSZ(<span class="enscript-string">&quot;pmulld&quot;</span>,XMM_66r,16),TNSZ(<span class="enscript-string">&quot;phminposuw&quot;</span>,XMM_66r,16),INVALID,	INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [5C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [60]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [70]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [8C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [F0]  */</span>	TNS(<span class="enscript-string">&quot;crc32b&quot;</span>,CRC32),	TS(<span class="enscript-string">&quot;crc32&quot;</span>,CRC32),	INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-type">const</span> instable_t dis_opAVX660F38[256] = {
<span class="enscript-comment">/*  [00]  */</span>	TNSZ(<span class="enscript-string">&quot;vpshufb&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vphaddw&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vphaddd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vphaddsw&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [04]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmaddubsw&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vphsubw&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vphsubd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vphsubsw&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [08]  */</span>	TNSZ(<span class="enscript-string">&quot;vpsignb&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpsignw&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpsignd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpmulhrsw&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [0C]  */</span>	TNSZ(<span class="enscript-string">&quot;vpermilps&quot;</span>,VEX_RMrX,8),TNSZ(<span class="enscript-string">&quot;vpermilpd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vtestps&quot;</span>,VEX_RRI,8),	TNSZ(<span class="enscript-string">&quot;vtestpd&quot;</span>,VEX_RRI,16),

<span class="enscript-comment">/*  [10]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [14]  */</span>	INVALID,		INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vptest&quot;</span>,VEX_RRI,16),
<span class="enscript-comment">/*  [18]  */</span>	TNSZ(<span class="enscript-string">&quot;vbroadcastss&quot;</span>,VEX_MX,4),TNSZ(<span class="enscript-string">&quot;vbroadcastsd&quot;</span>,VEX_MX,8),TNSZ(<span class="enscript-string">&quot;vbroadcastf128&quot;</span>,VEX_MX,16),INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	TNSZ(<span class="enscript-string">&quot;vpabsb&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpabsw&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpabsd&quot;</span>,VEX_MX,16),INVALID,

<span class="enscript-comment">/*  [20]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmovsxbw&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovsxbd&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovsxbq&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovsxwd&quot;</span>,VEX_MX,16),
<span class="enscript-comment">/*  [24]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmovsxwq&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovsxdq&quot;</span>,VEX_MX,16),INVALID,	INVALID,
<span class="enscript-comment">/*  [28]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmuldq&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpcmpeqq&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vmovntdqa&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpackusdw&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [2C]  */</span>	TNSZ(<span class="enscript-string">&quot;vmaskmovps&quot;</span>,VEX_RMrX,8),TNSZ(<span class="enscript-string">&quot;vmaskmovpd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vmaskmovps&quot;</span>,VEX_RRM,8),TNSZ(<span class="enscript-string">&quot;vmaskmovpd&quot;</span>,VEX_RRM,16),

<span class="enscript-comment">/*  [30]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmovzxbw&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovzxbd&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovzxbq&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovzxwd&quot;</span>,VEX_MX,16),
<span class="enscript-comment">/*  [34]  */</span>   TNSZ(<span class="enscript-string">&quot;vpmovzxwq&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpmovzxdq&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpermd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpcmpgtq&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [38]  */</span>	TNSZ(<span class="enscript-string">&quot;vpminsb&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpminsd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpminuw&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpminud&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [3C]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmaxsb&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpmaxsd&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpmaxuw&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vpmaxud&quot;</span>,VEX_RMrX,16),

<span class="enscript-comment">/*  [40]  */</span>	TNSZ(<span class="enscript-string">&quot;vpmulld&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vphminposuw&quot;</span>,VEX_MX,16),INVALID,	INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;vpbroadcastd&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpbroadcastq&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vbroadcasti128&quot;</span>,VEX_MX,16),INVALID,
<span class="enscript-comment">/*  [5C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [60]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [70]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	TNSZ(<span class="enscript-string">&quot;vpbroadcastb&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vpbroadcastw&quot;</span>,VEX_MX,16),INVALID,	INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [8C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vaesimc&quot;</span>,VEX_MX,16),
<span class="enscript-comment">/*  [DC]  */</span>	TNSZ(<span class="enscript-string">&quot;vaesenc&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vaesenclast&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vaesdec&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vaesdeclast&quot;</span>,VEX_RMrX,16),

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F0]  */</span>	IND(dis_op0F38F0),	IND(dis_op0F38F1),	INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-type">const</span> instable_t dis_op0F3A[256] = {
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	TNSZ(<span class="enscript-string">&quot;roundps&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;roundpd&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;roundss&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;roundsd&quot;</span>,XMMP_66r,16),
<span class="enscript-comment">/*  [0C]  */</span>	TNSZ(<span class="enscript-string">&quot;blendps&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;blendpd&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;pblendw&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;palignr&quot;</span>,XMMP_66o,16),

<span class="enscript-comment">/*  [10]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [14]  */</span>	TNSZ(<span class="enscript-string">&quot;pextrb&quot;</span>,XMM3PM_66r,8),TNSZ(<span class="enscript-string">&quot;pextrw&quot;</span>,XMM3PM_66r,16),TSZ(<span class="enscript-string">&quot;pextr&quot;</span>,XMM3PM_66r,16),TNSZ(<span class="enscript-string">&quot;extractps&quot;</span>,XMM3PM_66r,16),
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	TNSZ(<span class="enscript-string">&quot;pinsrb&quot;</span>,XMMPRM_66r,8),TNSZ(<span class="enscript-string">&quot;insertps&quot;</span>,XMMP_66r,16),TSZ(<span class="enscript-string">&quot;pinsr&quot;</span>,XMMPRM_66r,16),INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [2C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	TNSZ(<span class="enscript-string">&quot;dpps&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;dppd&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;mpsadbw&quot;</span>,XMMP_66r,16),INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [5C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [60]  */</span>	TNSZ(<span class="enscript-string">&quot;pcmpestrm&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;pcmpestri&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;pcmpistrm&quot;</span>,XMMP_66r,16),TNSZ(<span class="enscript-string">&quot;pcmpistri&quot;</span>,XMMP_66r,16),
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [70]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [8C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-type">const</span> instable_t dis_opAVX660F3A[256] = {
<span class="enscript-comment">/*  [00]  */</span>	TNSZ(<span class="enscript-string">&quot;vpermq&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vpermpd&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vpblendd&quot;</span>,VEX_RMRX,16),INVALID,
<span class="enscript-comment">/*  [04]  */</span>	TNSZ(<span class="enscript-string">&quot;vpermilps&quot;</span>,VEX_MXI,8),TNSZ(<span class="enscript-string">&quot;vpermilpd&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vperm2f128&quot;</span>,VEX_RMRX,16),INVALID,
<span class="enscript-comment">/*  [08]  */</span>	TNSZ(<span class="enscript-string">&quot;vroundps&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vroundpd&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vroundss&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vroundsd&quot;</span>,VEX_RMRX,16),
<span class="enscript-comment">/*  [0C]  */</span>	TNSZ(<span class="enscript-string">&quot;vblendps&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vblendpd&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vpblendw&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vpalignr&quot;</span>,VEX_RMRX,16),

<span class="enscript-comment">/*  [10]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [14]  */</span>	TNSZ(<span class="enscript-string">&quot;vpextrb&quot;</span>,VEX_RRi,8),TNSZ(<span class="enscript-string">&quot;vpextrw&quot;</span>,VEX_RRi,16),TNSZ(<span class="enscript-string">&quot;vpextrd&quot;</span>,VEX_RRi,16),TNSZ(<span class="enscript-string">&quot;vextractps&quot;</span>,VEX_RM,16),
<span class="enscript-comment">/*  [18]  */</span>	TNSZ(<span class="enscript-string">&quot;vinsertf128&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vextractf128&quot;</span>,VEX_RX,16),INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [20]  */</span>	TNSZ(<span class="enscript-string">&quot;vpinsrb&quot;</span>,VEX_RMRX,8),TNSZ(<span class="enscript-string">&quot;vinsertps&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vpinsrd&quot;</span>,VEX_RMRX,16),INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [2C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	TNSZ(<span class="enscript-string">&quot;vinserti128&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vextracti128&quot;</span>,VEX_RIM,16),INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [40]  */</span>	TNSZ(<span class="enscript-string">&quot;vdpps&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vdppd&quot;</span>,VEX_RMRX,16),TNSZ(<span class="enscript-string">&quot;vmpsadbw&quot;</span>,VEX_RMRX,16),INVALID,
<span class="enscript-comment">/*  [44]  */</span>	TNSZ(<span class="enscript-string">&quot;vpclmulqdq&quot;</span>,VEX_RMRX,16),INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vblendvps&quot;</span>,VEX_RMRX,8),	TNSZ(<span class="enscript-string">&quot;vblendvpd&quot;</span>,VEX_RMRX,16),
<span class="enscript-comment">/*  [4C]  */</span>	TNSZ(<span class="enscript-string">&quot;vpblendvb&quot;</span>,VEX_RMRX,16),INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [50]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [54]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [58]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [5C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [60]  */</span>	TNSZ(<span class="enscript-string">&quot;vpcmpestrm&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vpcmpestri&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vpcmpistrm&quot;</span>,VEX_MXI,16),TNSZ(<span class="enscript-string">&quot;vpcmpistri&quot;</span>,VEX_MXI,16),
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [70]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [8C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vaeskeygenassist&quot;</span>,VEX_MXI,16),

<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,

<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-comment">/*
 *	Decode table for 0x0F opcodes
 */</span>

<span class="enscript-type">const</span> instable_t dis_op0F[16][16] = {
{
<span class="enscript-comment">/*  [00]  */</span>	IND(dis_op0F00),	IND(dis_op0F01),	TNS(<span class="enscript-string">&quot;lar&quot;</span>,MR),		TNS(<span class="enscript-string">&quot;lsl&quot;</span>,MR),
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		TNS(<span class="enscript-string">&quot;syscall&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;clts&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;sysret&quot;</span>,NORM),
<span class="enscript-comment">/*  [08]  */</span>	TNS(<span class="enscript-string">&quot;invd&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;wbinvd&quot;</span>,NORM),	INVALID,		TNS(<span class="enscript-string">&quot;ud2&quot;</span>,NORM),
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;movups&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;movups&quot;</span>,XMMOS,16),TNSZ(<span class="enscript-string">&quot;movlps&quot;</span>,XMMO,8),	TNSZ(<span class="enscript-string">&quot;movlps&quot;</span>,XMMOS,8),
<span class="enscript-comment">/*  [14]  */</span>	TNSZ(<span class="enscript-string">&quot;unpcklps&quot;</span>,XMMO,16),TNSZ(<span class="enscript-string">&quot;unpckhps&quot;</span>,XMMO,16),TNSZ(<span class="enscript-string">&quot;movhps&quot;</span>,XMMOM,8),TNSZ(<span class="enscript-string">&quot;movhps&quot;</span>,XMMOMS,8),
<span class="enscript-comment">/*  [18]  */</span>	IND(dis_op0F18),	INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/* APPLE NOTE: Need to handle multi-byte NOP */</span>
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		TS(<span class="enscript-string">&quot;nop&quot;</span>,Mw),
}, {
<span class="enscript-comment">/*  [20]  */</span>	TSy(<span class="enscript-string">&quot;mov&quot;</span>,SREG),	TSy(<span class="enscript-string">&quot;mov&quot;</span>,SREG),	TSy(<span class="enscript-string">&quot;mov&quot;</span>,SREG),	TSy(<span class="enscript-string">&quot;mov&quot;</span>,SREG),
<span class="enscript-comment">/*  [24]  */</span>	TSx(<span class="enscript-string">&quot;mov&quot;</span>,SREG),	INVALID,		TSx(<span class="enscript-string">&quot;mov&quot;</span>,SREG),	INVALID,
<span class="enscript-comment">/*  [28]  */</span>	TNSZ(<span class="enscript-string">&quot;movaps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;movaps&quot;</span>,XMMOS,16),TNSZ(<span class="enscript-string">&quot;cvtpi2ps&quot;</span>,XMMOMX,8),TNSZ(<span class="enscript-string">&quot;movntps&quot;</span>,XMMOS,16),
<span class="enscript-comment">/*  [2C]  */</span>	TNSZ(<span class="enscript-string">&quot;cvttps2pi&quot;</span>,XMMOXMM,8),TNSZ(<span class="enscript-string">&quot;cvtps2pi&quot;</span>,XMMOXMM,8),TNSZ(<span class="enscript-string">&quot;ucomiss&quot;</span>,XMMO,4),TNSZ(<span class="enscript-string">&quot;comiss&quot;</span>,XMMO,4),
}, {
<span class="enscript-comment">/*  [30]  */</span>	TNS(<span class="enscript-string">&quot;wrmsr&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;rdtsc&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;rdmsr&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;rdpmc&quot;</span>,NORM),
<span class="enscript-comment">/*  [34]  */</span>	TNSx(<span class="enscript-string">&quot;sysenter&quot;</span>,NORM),	TNSx(<span class="enscript-string">&quot;sysexit&quot;</span>,NORM),	INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [40]  */</span>	TS(<span class="enscript-string">&quot;cmovx.o&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.no&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.b&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.ae&quot;</span>,MR),
<span class="enscript-comment">/*  [44]  */</span>	TS(<span class="enscript-string">&quot;cmovx.e&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.ne&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.be&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.a&quot;</span>,MR),
<span class="enscript-comment">/*  [48]  */</span>	TS(<span class="enscript-string">&quot;cmovx.s&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.ns&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.pe&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.po&quot;</span>,MR),
<span class="enscript-comment">/*  [4C]  */</span>	TS(<span class="enscript-string">&quot;cmovx.l&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.ge&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.le&quot;</span>,MR),	TS(<span class="enscript-string">&quot;cmovx.g&quot;</span>,MR),
}, {
<span class="enscript-comment">/*  [50]  */</span>	TNS(<span class="enscript-string">&quot;movmskps&quot;</span>,XMMOX3),	TNSZ(<span class="enscript-string">&quot;sqrtps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;rsqrtps&quot;</span>,XMMO,16),TNSZ(<span class="enscript-string">&quot;rcpps&quot;</span>,XMMO,16),
<span class="enscript-comment">/*  [54]  */</span>	TNSZ(<span class="enscript-string">&quot;andps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;andnps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;orps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;xorps&quot;</span>,XMMO,16),
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;addps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;mulps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;cvtps2pd&quot;</span>,XMMO,8),TNSZ(<span class="enscript-string">&quot;cvtdq2ps&quot;</span>,XMMO,16),
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;subps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;minps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;divps&quot;</span>,XMMO,16),	TNSZ(<span class="enscript-string">&quot;maxps&quot;</span>,XMMO,16),
}, {
<span class="enscript-comment">/*  [60]  */</span>	TNSZ(<span class="enscript-string">&quot;punpcklbw&quot;</span>,MMO,4),TNSZ(<span class="enscript-string">&quot;punpcklwd&quot;</span>,MMO,4),TNSZ(<span class="enscript-string">&quot;punpckldq&quot;</span>,MMO,4),TNSZ(<span class="enscript-string">&quot;packsswb&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [64]  */</span>	TNSZ(<span class="enscript-string">&quot;pcmpgtb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pcmpgtw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pcmpgtd&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;packuswb&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [68]  */</span>	TNSZ(<span class="enscript-string">&quot;punpckhbw&quot;</span>,MMO,8),TNSZ(<span class="enscript-string">&quot;punpckhwd&quot;</span>,MMO,8),TNSZ(<span class="enscript-string">&quot;punpckhdq&quot;</span>,MMO,8),TNSZ(<span class="enscript-string">&quot;packssdw&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [6C]  */</span>	TNSZ(<span class="enscript-string">&quot;INVALID&quot;</span>,MMO,0),	TNSZ(<span class="enscript-string">&quot;INVALID&quot;</span>,MMO,0),	TNSZ(<span class="enscript-string">&quot;movd&quot;</span>,MMO,4),	TNSZ(<span class="enscript-string">&quot;movq&quot;</span>,MMO,8),
}, {
<span class="enscript-comment">/*  [70]  */</span>	TNSZ(<span class="enscript-string">&quot;pshufw&quot;</span>,MMOPM,8),	TNS(<span class="enscript-string">&quot;psrXXX&quot;</span>,MR),	TNS(<span class="enscript-string">&quot;psrXXX&quot;</span>,MR),	TNS(<span class="enscript-string">&quot;psrXXX&quot;</span>,MR),
<span class="enscript-comment">/*  [74]  */</span>	TNSZ(<span class="enscript-string">&quot;pcmpeqb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pcmpeqw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pcmpeqd&quot;</span>,MMO,8),	TNS(<span class="enscript-string">&quot;emms&quot;</span>,NORM),
<span class="enscript-comment">/*  [78]  */</span>	TNS(<span class="enscript-string">&quot;INVALID&quot;</span>,XMMO),	TNS(<span class="enscript-string">&quot;INVALID&quot;</span>,XMMO),	INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;movd&quot;</span>,MMOS,4),	TNSZ(<span class="enscript-string">&quot;movq&quot;</span>,MMOS,8),
}, {
<span class="enscript-comment">/*  [80]  */</span>	TNS(<span class="enscript-string">&quot;jo&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jno&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jb&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jae&quot;</span>,D),
<span class="enscript-comment">/*  [84]  */</span>	TNS(<span class="enscript-string">&quot;je&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jne&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jbe&quot;</span>,D),		TNS(<span class="enscript-string">&quot;ja&quot;</span>,D),
<span class="enscript-comment">/*  [88]  */</span>	TNS(<span class="enscript-string">&quot;js&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jns&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jp&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jnp&quot;</span>,D),
<span class="enscript-comment">/*  [8C]  */</span>	TNS(<span class="enscript-string">&quot;jl&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jge&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jle&quot;</span>,D),		TNS(<span class="enscript-string">&quot;jg&quot;</span>,D),
}, {
<span class="enscript-comment">/*  [90]  */</span>	TNS(<span class="enscript-string">&quot;seto&quot;</span>,Mb),		TNS(<span class="enscript-string">&quot;setno&quot;</span>,Mb),	TNS(<span class="enscript-string">&quot;setb&quot;</span>,Mb),		TNS(<span class="enscript-string">&quot;setae&quot;</span>,Mb),
<span class="enscript-comment">/*  [94]  */</span>	TNS(<span class="enscript-string">&quot;sete&quot;</span>,Mb),		TNS(<span class="enscript-string">&quot;setne&quot;</span>,Mb),	TNS(<span class="enscript-string">&quot;setbe&quot;</span>,Mb),	TNS(<span class="enscript-string">&quot;seta&quot;</span>,Mb),
<span class="enscript-comment">/*  [98]  */</span>	TNS(<span class="enscript-string">&quot;sets&quot;</span>,Mb),		TNS(<span class="enscript-string">&quot;setns&quot;</span>,Mb),	TNS(<span class="enscript-string">&quot;setp&quot;</span>,Mb),		TNS(<span class="enscript-string">&quot;setnp&quot;</span>,Mb),
<span class="enscript-comment">/*  [9C]  */</span>	TNS(<span class="enscript-string">&quot;setl&quot;</span>,Mb),		TNS(<span class="enscript-string">&quot;setge&quot;</span>,Mb),	TNS(<span class="enscript-string">&quot;setle&quot;</span>,Mb),	TNS(<span class="enscript-string">&quot;setg&quot;</span>,Mb),
}, {
<span class="enscript-comment">/*  [A0]  */</span>	TSp(<span class="enscript-string">&quot;push&quot;</span>,LSEG),	TSp(<span class="enscript-string">&quot;pop&quot;</span>,LSEG),	TNS(<span class="enscript-string">&quot;cpuid&quot;</span>,NORM),	TS(<span class="enscript-string">&quot;bt&quot;</span>,RMw),
<span class="enscript-comment">/*  [A4]  */</span>	TS(<span class="enscript-string">&quot;shld&quot;</span>,DSHIFT),	TS(<span class="enscript-string">&quot;shld&quot;</span>,DSHIFTcl),	INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	TSp(<span class="enscript-string">&quot;push&quot;</span>,LSEG),	TSp(<span class="enscript-string">&quot;pop&quot;</span>,LSEG),	TNS(<span class="enscript-string">&quot;rsm&quot;</span>,NORM),	TS(<span class="enscript-string">&quot;bts&quot;</span>,RMw),
<span class="enscript-comment">/*  [AC]  */</span>	TS(<span class="enscript-string">&quot;shrd&quot;</span>,DSHIFT),	TS(<span class="enscript-string">&quot;shrd&quot;</span>,DSHIFTcl),	IND(dis_op0FAE),	TS(<span class="enscript-string">&quot;imul&quot;</span>,MRw),
}, {
<span class="enscript-comment">/*  [B0]  */</span>	TNS(<span class="enscript-string">&quot;cmpxchgb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;cmpxchg&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;lss&quot;</span>,MR),		TS(<span class="enscript-string">&quot;btr&quot;</span>,RMw),
<span class="enscript-comment">/*  [B4]  */</span>	TS(<span class="enscript-string">&quot;lfs&quot;</span>,MR),		TS(<span class="enscript-string">&quot;lgs&quot;</span>,MR),		TS(<span class="enscript-string">&quot;movzb&quot;</span>,MOVZ),	TNS(<span class="enscript-string">&quot;movzwl&quot;</span>,MOVZ),
<span class="enscript-comment">/*  [B8]  */</span>	TNS(<span class="enscript-string">&quot;INVALID&quot;</span>,MRw),	INVALID,		IND(dis_op0FBA),	TS(<span class="enscript-string">&quot;btc&quot;</span>,RMw),
<span class="enscript-comment">/*  [BC]  */</span>	TS(<span class="enscript-string">&quot;bsf&quot;</span>,MRw),		TS(<span class="enscript-string">&quot;bsr&quot;</span>,MRw),		TS(<span class="enscript-string">&quot;movsb&quot;</span>,MOVZ),	TNS(<span class="enscript-string">&quot;movswl&quot;</span>,MOVZ),
}, {
<span class="enscript-comment">/*  [C0]  */</span>	TNS(<span class="enscript-string">&quot;xaddb&quot;</span>,XADDB),	TS(<span class="enscript-string">&quot;xadd&quot;</span>,RMw),		TNSZ(<span class="enscript-string">&quot;cmpps&quot;</span>,XMMOPM,16),TNS(<span class="enscript-string">&quot;movnti&quot;</span>,RM),
<span class="enscript-comment">/*  [C4]  */</span>	TNSZ(<span class="enscript-string">&quot;pinsrw&quot;</span>,MMOPRM,2),TNS(<span class="enscript-string">&quot;pextrw&quot;</span>,MMO3P), 	TNSZ(<span class="enscript-string">&quot;shufps&quot;</span>,XMMOPM,16),IND(dis_op0FC7),
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;psrlw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psrld&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psrlq&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [D4]  */</span>	TNSZ(<span class="enscript-string">&quot;paddq&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pmullw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;INVALID&quot;</span>,MMO,0),	TNS(<span class="enscript-string">&quot;pmovmskb&quot;</span>,MMOM3),
<span class="enscript-comment">/*  [D8]  */</span>	TNSZ(<span class="enscript-string">&quot;psubusb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psubusw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pminub&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pand&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [DC]  */</span>	TNSZ(<span class="enscript-string">&quot;paddusb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;paddusw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pmaxub&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pandn&quot;</span>,MMO,8),
}, {
<span class="enscript-comment">/*  [E0]  */</span>	TNSZ(<span class="enscript-string">&quot;pavgb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psraw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psrad&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pavgw&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [E4]  */</span>	TNSZ(<span class="enscript-string">&quot;pmulhuw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pmulhw&quot;</span>,MMO,8),	TNS(<span class="enscript-string">&quot;INVALID&quot;</span>,XMMO),	TNSZ(<span class="enscript-string">&quot;movntq&quot;</span>,MMOMS,8),
<span class="enscript-comment">/*  [E8]  */</span>	TNSZ(<span class="enscript-string">&quot;psubsb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psubsw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pminsw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;por&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [EC]  */</span>	TNSZ(<span class="enscript-string">&quot;paddsb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;paddsw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pmaxsw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pxor&quot;</span>,MMO,8),
}, {
<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;psllw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pslld&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psllq&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [F4]  */</span>	TNSZ(<span class="enscript-string">&quot;pmuludq&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;pmaddwd&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psadbw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;maskmovq&quot;</span>,MMOIMPL,8),
<span class="enscript-comment">/*  [F8]  */</span>	TNSZ(<span class="enscript-string">&quot;psubb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psubw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psubd&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;psubq&quot;</span>,MMO,8),
<span class="enscript-comment">/*  [FC]  */</span>	TNSZ(<span class="enscript-string">&quot;paddb&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;paddw&quot;</span>,MMO,8),	TNSZ(<span class="enscript-string">&quot;paddd&quot;</span>,MMO,8),	INVALID,
} };

<span class="enscript-type">const</span> instable_t dis_opAVX0F[16][16] = {
{
<span class="enscript-comment">/*  [00]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [08]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [0C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [10]  */</span>	TNSZ(<span class="enscript-string">&quot;vmovups&quot;</span>,VEX_MX,16),	TNSZ(<span class="enscript-string">&quot;vmovups&quot;</span>,VEX_RM,16),TNSZ(<span class="enscript-string">&quot;vmovlps&quot;</span>,VEX_RMrX,8),	TNSZ(<span class="enscript-string">&quot;vmovlps&quot;</span>,VEX_RM,8),
<span class="enscript-comment">/*  [14]  */</span>	TNSZ(<span class="enscript-string">&quot;vunpcklps&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vunpckhps&quot;</span>,VEX_RMrX,16),TNSZ(<span class="enscript-string">&quot;vmovhps&quot;</span>,VEX_RMrX,8),TNSZ(<span class="enscript-string">&quot;vmovhps&quot;</span>,VEX_RM,8),
<span class="enscript-comment">/*  [18]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [1C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [20]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [24]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [28]  */</span>	TNSZ(<span class="enscript-string">&quot;vmovaps&quot;</span>,VEX_MX,16),	TNSZ(<span class="enscript-string">&quot;vmovaps&quot;</span>,VEX_RX,16),INVALID,		TNSZ(<span class="enscript-string">&quot;vmovntps&quot;</span>,VEX_RM,16),
<span class="enscript-comment">/*  [2C]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vucomiss&quot;</span>,VEX_MX,4),TNSZ(<span class="enscript-string">&quot;vcomiss&quot;</span>,VEX_MX,4),
}, {
<span class="enscript-comment">/*  [30]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [34]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [38]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [40]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [44]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [48]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [4C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [50]  */</span>	TNS(<span class="enscript-string">&quot;vmovmskps&quot;</span>,VEX_MR),	TNSZ(<span class="enscript-string">&quot;vsqrtps&quot;</span>,VEX_MX,16),	TNSZ(<span class="enscript-string">&quot;vrsqrtps&quot;</span>,VEX_MX,16),TNSZ(<span class="enscript-string">&quot;vrcpps&quot;</span>,VEX_MX,16),
<span class="enscript-comment">/*  [54]  */</span>	TNSZ(<span class="enscript-string">&quot;vandps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vandnps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vorps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vxorps&quot;</span>,VEX_RMrX,16),
<span class="enscript-comment">/*  [58]  */</span>	TNSZ(<span class="enscript-string">&quot;vaddps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vmulps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vcvtps2pd&quot;</span>,VEX_MX,8),TNSZ(<span class="enscript-string">&quot;vcvtdq2ps&quot;</span>,VEX_MX,16),
<span class="enscript-comment">/*  [5C]  */</span>	TNSZ(<span class="enscript-string">&quot;vsubps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vminps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vdivps&quot;</span>,VEX_RMrX,16),	TNSZ(<span class="enscript-string">&quot;vmaxps&quot;</span>,VEX_RMrX,16),
}, {
<span class="enscript-comment">/*  [60]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [64]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [68]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [6C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [70]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [74]  */</span>	INVALID,		INVALID,		INVALID,		TNS(<span class="enscript-string">&quot;vzeroupper&quot;</span>, VEX_NONE),
<span class="enscript-comment">/*  [78]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [7C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [80]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [84]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [88]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [8C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [90]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [94]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [98]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [9C]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [A0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [A8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [AC]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vldmxcsr&quot;</span>,VEX_MO,2),		INVALID,
}, {
<span class="enscript-comment">/*  [B0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [B8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [BC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [C0]  */</span>	INVALID,		INVALID,		TNSZ(<span class="enscript-string">&quot;vcmpps&quot;</span>,VEX_RMRX,16),INVALID,
<span class="enscript-comment">/*  [C4]  */</span>	INVALID,		INVALID,	 	TNSZ(<span class="enscript-string">&quot;vshufps&quot;</span>,VEX_RMRX,16),INVALID,
<span class="enscript-comment">/*  [C8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [CC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [D0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [D8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [DC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [E0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [E8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [EC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [F0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [F8]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [FC]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
} };

<span class="enscript-comment">/*
 *	Decode table for 0x80 opcodes
 */</span>

<span class="enscript-type">const</span> instable_t dis_op80[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;addb&quot;</span>,IMlw),	TNS(<span class="enscript-string">&quot;orb&quot;</span>,IMw),		TNS(<span class="enscript-string">&quot;adcb&quot;</span>,IMlw),	TNS(<span class="enscript-string">&quot;sbbb&quot;</span>,IMlw),
<span class="enscript-comment">/*  [4]  */</span>	TNS(<span class="enscript-string">&quot;andb&quot;</span>,IMw),	TNS(<span class="enscript-string">&quot;subb&quot;</span>,IMlw),	TNS(<span class="enscript-string">&quot;xorb&quot;</span>,IMw),	TNS(<span class="enscript-string">&quot;cmpb&quot;</span>,IMlw),
};


<span class="enscript-comment">/*
 *	Decode table for 0x81 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_op81[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TS(<span class="enscript-string">&quot;add&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;or&quot;</span>,IMw),		TS(<span class="enscript-string">&quot;adc&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;sbb&quot;</span>,IMlw),
<span class="enscript-comment">/*  [4]  */</span>	TS(<span class="enscript-string">&quot;and&quot;</span>,IMw),		TS(<span class="enscript-string">&quot;sub&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;xor&quot;</span>,IMw),		TS(<span class="enscript-string">&quot;cmp&quot;</span>,IMlw),
};


<span class="enscript-comment">/*
 *	Decode table for 0x82 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_op82[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNSx(<span class="enscript-string">&quot;addb&quot;</span>,IMlw),	TNSx(<span class="enscript-string">&quot;orb&quot;</span>,IMlw),	TNSx(<span class="enscript-string">&quot;adcb&quot;</span>,IMlw),	TNSx(<span class="enscript-string">&quot;sbbb&quot;</span>,IMlw),
<span class="enscript-comment">/*  [4]  */</span>	TNSx(<span class="enscript-string">&quot;andb&quot;</span>,IMlw),	TNSx(<span class="enscript-string">&quot;subb&quot;</span>,IMlw),	TNSx(<span class="enscript-string">&quot;xorb&quot;</span>,IMlw),	TNSx(<span class="enscript-string">&quot;cmpb&quot;</span>,IMlw),
};
<span class="enscript-comment">/*
 *	Decode table for 0x83 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_op83[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TS(<span class="enscript-string">&quot;add&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;or&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;adc&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;sbb&quot;</span>,IMlw),
<span class="enscript-comment">/*  [4]  */</span>	TS(<span class="enscript-string">&quot;and&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;sub&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;xor&quot;</span>,IMlw),		TS(<span class="enscript-string">&quot;cmp&quot;</span>,IMlw),
};

<span class="enscript-comment">/*
 *	Decode table for 0xC0 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opC0[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;rolb&quot;</span>,MvI),	TNS(<span class="enscript-string">&quot;rorb&quot;</span>,MvI),	TNS(<span class="enscript-string">&quot;rclb&quot;</span>,MvI),	TNS(<span class="enscript-string">&quot;rcrb&quot;</span>,MvI),
<span class="enscript-comment">/*  [4]  */</span>	TNS(<span class="enscript-string">&quot;shlb&quot;</span>,MvI),	TNS(<span class="enscript-string">&quot;shrb&quot;</span>,MvI),	INVALID,		TNS(<span class="enscript-string">&quot;sarb&quot;</span>,MvI),
};

<span class="enscript-comment">/*
 *	Decode table for 0xD0 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opD0[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;rolb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;rorb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;rclb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;rcrb&quot;</span>,Mv),
<span class="enscript-comment">/*  [4]  */</span>	TNS(<span class="enscript-string">&quot;shlb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;shrb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;salb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;sarb&quot;</span>,Mv),
};

<span class="enscript-comment">/*
 *	Decode table for 0xC1 opcodes.
 *	186 instruction set
 */</span>

<span class="enscript-type">const</span> instable_t dis_opC1[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TS(<span class="enscript-string">&quot;rol&quot;</span>,MvI),		TS(<span class="enscript-string">&quot;ror&quot;</span>,MvI),		TS(<span class="enscript-string">&quot;rcl&quot;</span>,MvI),		TS(<span class="enscript-string">&quot;rcr&quot;</span>,MvI),
<span class="enscript-comment">/*  [4]  */</span>	TS(<span class="enscript-string">&quot;shl&quot;</span>,MvI),		TS(<span class="enscript-string">&quot;shr&quot;</span>,MvI),		TS(<span class="enscript-string">&quot;sal&quot;</span>,MvI),		TS(<span class="enscript-string">&quot;sar&quot;</span>,MvI),
};

<span class="enscript-comment">/*
 *	Decode table for 0xD1 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opD1[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TS(<span class="enscript-string">&quot;rol&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;ror&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;rcl&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;rcr&quot;</span>,Mv),
<span class="enscript-comment">/*  [4]  */</span>	TS(<span class="enscript-string">&quot;shl&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;shr&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;sal&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;sar&quot;</span>,Mv),
};


<span class="enscript-comment">/*
 *	Decode table for 0xD2 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opD2[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;rolb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;rorb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;rclb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;rcrb&quot;</span>,Mv),
<span class="enscript-comment">/*  [4]  */</span>	TNS(<span class="enscript-string">&quot;shlb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;shrb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;salb&quot;</span>,Mv),		TNS(<span class="enscript-string">&quot;sarb&quot;</span>,Mv),
};
<span class="enscript-comment">/*
 *	Decode table for 0xD3 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opD3[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TS(<span class="enscript-string">&quot;rol&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;ror&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;rcl&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;rcr&quot;</span>,Mv),
<span class="enscript-comment">/*  [4]  */</span>	TS(<span class="enscript-string">&quot;shl&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;shr&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;salb&quot;</span>,Mv),		TS(<span class="enscript-string">&quot;sar&quot;</span>,Mv),
};


<span class="enscript-comment">/*
 *	Decode table for 0xF6 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opF6[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;testb&quot;</span>,IMw),	TNS(<span class="enscript-string">&quot;testb&quot;</span>,IMw),	TNS(<span class="enscript-string">&quot;notb&quot;</span>,Mw),		TNS(<span class="enscript-string">&quot;negb&quot;</span>,Mw),
<span class="enscript-comment">/*  [4]  */</span>	TNS(<span class="enscript-string">&quot;mulb&quot;</span>,MA),		TNS(<span class="enscript-string">&quot;imulb&quot;</span>,MA),	TNS(<span class="enscript-string">&quot;divb&quot;</span>,MA),		TNS(<span class="enscript-string">&quot;idivb&quot;</span>,MA),
};


<span class="enscript-comment">/*
 *	Decode table for 0xF7 opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opF7[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TS(<span class="enscript-string">&quot;test&quot;</span>,IMw),		TS(<span class="enscript-string">&quot;test&quot;</span>,IMw),		TS(<span class="enscript-string">&quot;not&quot;</span>,Mw),		TS(<span class="enscript-string">&quot;neg&quot;</span>,Mw),
<span class="enscript-comment">/*  [4]  */</span>	TS(<span class="enscript-string">&quot;mul&quot;</span>,MA),		TS(<span class="enscript-string">&quot;imul&quot;</span>,MA),		TS(<span class="enscript-string">&quot;div&quot;</span>,MA),		TS(<span class="enscript-string">&quot;idiv&quot;</span>,MA),
};


<span class="enscript-comment">/*
 *	Decode table for 0xFE opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opFE[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;incb&quot;</span>,Mw),		TNS(<span class="enscript-string">&quot;decb&quot;</span>,Mw),		INVALID,		INVALID,
<span class="enscript-comment">/*  [4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};
<span class="enscript-comment">/*
 *	Decode table for 0xFF opcodes.
 */</span>

<span class="enscript-type">const</span> instable_t dis_opFF[8] = {

<span class="enscript-comment">/*  [0]  */</span>	TS(<span class="enscript-string">&quot;inc&quot;</span>,Mw),		TS(<span class="enscript-string">&quot;dec&quot;</span>,Mw),		TNSyp(<span class="enscript-string">&quot;call&quot;</span>,INM),	TNS(<span class="enscript-string">&quot;lcall&quot;</span>,INM),
<span class="enscript-comment">/*  [4]  */</span>	TNSy(<span class="enscript-string">&quot;jmp&quot;</span>,INM),	TNS(<span class="enscript-string">&quot;ljmp&quot;</span>,INM),	TSp(<span class="enscript-string">&quot;push&quot;</span>,M),		INVALID,
};

<span class="enscript-comment">/* for 287 instructions, which are a mess to decode */</span>

<span class="enscript-type">const</span> instable_t dis_opFP1n2[8][8] = {
{
<span class="enscript-comment">/* bit pattern:	1101 1xxx MODxx xR/M */</span>
<span class="enscript-comment">/*  [0,0] */</span>	TNS(<span class="enscript-string">&quot;fadds&quot;</span>,M),		TNS(<span class="enscript-string">&quot;fmuls&quot;</span>,M),		TNS(<span class="enscript-string">&quot;fcoms&quot;</span>,M),		TNS(<span class="enscript-string">&quot;fcomps&quot;</span>,M),
<span class="enscript-comment">/*  [0,4] */</span>	TNS(<span class="enscript-string">&quot;fsubs&quot;</span>,M),		TNS(<span class="enscript-string">&quot;fsubrs&quot;</span>,M),	TNS(<span class="enscript-string">&quot;fdivs&quot;</span>,M),		TNS(<span class="enscript-string">&quot;fdivrs&quot;</span>,M),
}, {
<span class="enscript-comment">/*  [1,0]  */</span>	TNS(<span class="enscript-string">&quot;flds&quot;</span>,M),		INVALID,		TNS(<span class="enscript-string">&quot;fsts&quot;</span>,M),		TNS(<span class="enscript-string">&quot;fstps&quot;</span>,M),
<span class="enscript-comment">/*  [1,4]  */</span>	TNSZ(<span class="enscript-string">&quot;fldenv&quot;</span>,M,28),	TNSZ(<span class="enscript-string">&quot;fldcw&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;fnstenv&quot;</span>,M,28),	TNSZ(<span class="enscript-string">&quot;fnstcw&quot;</span>,M,2),
}, {
<span class="enscript-comment">/*  [2,0]  */</span>	TNS(<span class="enscript-string">&quot;fiaddl&quot;</span>,M),	TNS(<span class="enscript-string">&quot;fimull&quot;</span>,M),	TNS(<span class="enscript-string">&quot;ficoml&quot;</span>,M),	TNS(<span class="enscript-string">&quot;ficompl&quot;</span>,M),
<span class="enscript-comment">/*  [2,4]  */</span>	TNS(<span class="enscript-string">&quot;fisubl&quot;</span>,M),	TNS(<span class="enscript-string">&quot;fisubrl&quot;</span>,M),	TNS(<span class="enscript-string">&quot;fidivl&quot;</span>,M),	TNS(<span class="enscript-string">&quot;fidivrl&quot;</span>,M),
}, {
<span class="enscript-comment">/*  [3,0]  */</span>	TNS(<span class="enscript-string">&quot;fildl&quot;</span>,M),		INVALID,		TNS(<span class="enscript-string">&quot;fistl&quot;</span>,M),		TNS(<span class="enscript-string">&quot;fistpl&quot;</span>,M),
<span class="enscript-comment">/*  [3,4]  */</span>	INVALID,		TNSZ(<span class="enscript-string">&quot;fldt&quot;</span>,M,10),	INVALID,		TNSZ(<span class="enscript-string">&quot;fstpt&quot;</span>,M,10),
}, {
<span class="enscript-comment">/*  [4,0]  */</span>	TNSZ(<span class="enscript-string">&quot;faddl&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fmull&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fcoml&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fcompl&quot;</span>,M,8),
<span class="enscript-comment">/*  [4,1]  */</span>	TNSZ(<span class="enscript-string">&quot;fsubl&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fsubrl&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fdivl&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fdivrl&quot;</span>,M,8),
}, {
<span class="enscript-comment">/*  [5,0]  */</span>	TNSZ(<span class="enscript-string">&quot;fldl&quot;</span>,M,8),	INVALID,		TNSZ(<span class="enscript-string">&quot;fstl&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fstpl&quot;</span>,M,8),
<span class="enscript-comment">/*  [5,4]  */</span>	TNSZ(<span class="enscript-string">&quot;frstor&quot;</span>,M,108),	INVALID,		TNSZ(<span class="enscript-string">&quot;fnsave&quot;</span>,M,108),	TNSZ(<span class="enscript-string">&quot;fnstsw&quot;</span>,M,2),
}, {
<span class="enscript-comment">/*  [6,0]  */</span>	TNSZ(<span class="enscript-string">&quot;fiadd&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;fimul&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;ficom&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;ficomp&quot;</span>,M,2),
<span class="enscript-comment">/*  [6,4]  */</span>	TNSZ(<span class="enscript-string">&quot;fisub&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;fisubr&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;fidiv&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;fidivr&quot;</span>,M,2),
}, {
<span class="enscript-comment">/*  [7,0]  */</span>	TNSZ(<span class="enscript-string">&quot;fild&quot;</span>,M,2),	INVALID,		TNSZ(<span class="enscript-string">&quot;fist&quot;</span>,M,2),	TNSZ(<span class="enscript-string">&quot;fistp&quot;</span>,M,2),
<span class="enscript-comment">/*  [7,4]  */</span>	TNSZ(<span class="enscript-string">&quot;fbld&quot;</span>,M,10),	TNSZ(<span class="enscript-string">&quot;fildll&quot;</span>,M,8),	TNSZ(<span class="enscript-string">&quot;fbstp&quot;</span>,M,10),	TNSZ(<span class="enscript-string">&quot;fistpll&quot;</span>,M,8),
} };

<span class="enscript-type">const</span> instable_t dis_opFP3[8][8] = {
{
<span class="enscript-comment">/* bit  pattern:	1101 1xxx 11xx xREG */</span>
<span class="enscript-comment">/*  [0,0]  */</span>	TNS(<span class="enscript-string">&quot;fadd&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fmul&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fcom&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fcomp&quot;</span>,F),
<span class="enscript-comment">/*  [0,4]  */</span>	TNS(<span class="enscript-string">&quot;fsub&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fsubr&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fdiv&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fdivr&quot;</span>,FF),
}, {
<span class="enscript-comment">/*  [1,0]  */</span>	TNS(<span class="enscript-string">&quot;fld&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fxch&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fnop&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fstp&quot;</span>,F),
<span class="enscript-comment">/*  [1,4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [2,0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [2,4]  */</span>	INVALID,		TNS(<span class="enscript-string">&quot;fucompp&quot;</span>,NORM),	INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [3,0]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
<span class="enscript-comment">/*  [3,4]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [4,0]  */</span>	TNS(<span class="enscript-string">&quot;fadd&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fmul&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fcom&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fcomp&quot;</span>,F),
<span class="enscript-comment">/*  [4,4]  */</span>	TNS(<span class="enscript-string">&quot;fsub&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fsubr&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fdiv&quot;</span>,FF),		TNS(<span class="enscript-string">&quot;fdivr&quot;</span>,FF),
}, {
<span class="enscript-comment">/*  [5,0]  */</span>	TNS(<span class="enscript-string">&quot;ffree&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fxch&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fst&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fstp&quot;</span>,F),
<span class="enscript-comment">/*  [5,4]  */</span>	TNS(<span class="enscript-string">&quot;fucom&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fucomp&quot;</span>,F),	INVALID,		INVALID,
}, {
<span class="enscript-comment">/*  [6,0]  */</span>	TNS(<span class="enscript-string">&quot;faddp&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fmulp&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fcomp&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fcompp&quot;</span>,NORM),
<span class="enscript-comment">/*  [6,4]  */</span>	TNS(<span class="enscript-string">&quot;fsubp&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fsubrp&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fdivp&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fdivrp&quot;</span>,FF),
}, {
<span class="enscript-comment">/*  [7,0]  */</span>	TNS(<span class="enscript-string">&quot;ffreep&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fxch&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fstp&quot;</span>,F),		TNS(<span class="enscript-string">&quot;fstp&quot;</span>,F),
<span class="enscript-comment">/*  [7,4]  */</span>	TNS(<span class="enscript-string">&quot;fnstsw&quot;</span>,M),	TNS(<span class="enscript-string">&quot;fucomip&quot;</span>,FFC),	TNS(<span class="enscript-string">&quot;fcomip&quot;</span>,FFC),	INVALID,
} };

<span class="enscript-type">const</span> instable_t dis_opFP4[4][8] = {
{
<span class="enscript-comment">/* bit pattern:	1101 1001 111x xxxx */</span>
<span class="enscript-comment">/*  [0,0]  */</span>	TNS(<span class="enscript-string">&quot;fchs&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fabs&quot;</span>,NORM),	INVALID,		INVALID,
<span class="enscript-comment">/*  [0,4]  */</span>	TNS(<span class="enscript-string">&quot;ftst&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fxam&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;ftstp&quot;</span>,NORM),	INVALID,
}, {
<span class="enscript-comment">/*  [1,0]  */</span>	TNS(<span class="enscript-string">&quot;fld1&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fldl2t&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fldl2e&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fldpi&quot;</span>,NORM),
<span class="enscript-comment">/*  [1,4]  */</span>	TNS(<span class="enscript-string">&quot;fldlg2&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fldln2&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fldz&quot;</span>,NORM),	INVALID,
}, {
<span class="enscript-comment">/*  [2,0]  */</span>	TNS(<span class="enscript-string">&quot;f2xm1&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fyl2x&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fptan&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fpatan&quot;</span>,NORM),
<span class="enscript-comment">/*  [2,4]  */</span>	TNS(<span class="enscript-string">&quot;fxtract&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fprem1&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fdecstp&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fincstp&quot;</span>,NORM),
}, {
<span class="enscript-comment">/*  [3,0]  */</span>	TNS(<span class="enscript-string">&quot;fprem&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fyl2xp1&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fsqrt&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fsincos&quot;</span>,NORM),
<span class="enscript-comment">/*  [3,4]  */</span>	TNS(<span class="enscript-string">&quot;frndint&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fscale&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fsin&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fcos&quot;</span>,NORM),
} };

<span class="enscript-type">const</span> instable_t dis_opFP5[8] = {
<span class="enscript-comment">/* bit pattern:	1101 1011 111x xxxx */</span>
<span class="enscript-comment">/*  [0]  */</span>	TNS(<span class="enscript-string">&quot;feni&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fdisi&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fnclex&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;fninit&quot;</span>,NORM),
<span class="enscript-comment">/*  [4]  */</span>	TNS(<span class="enscript-string">&quot;fsetpm&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;frstpm&quot;</span>,NORM),	INVALID,		INVALID,
};

<span class="enscript-type">const</span> instable_t dis_opFP6[8] = {
<span class="enscript-comment">/* bit pattern:	1101 1011 11yy yxxx */</span>
<span class="enscript-comment">/*  [00]  */</span>	TNS(<span class="enscript-string">&quot;fcmov.nb&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fcmov.ne&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fcmov.nbe&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fcmov.nu&quot;</span>,FF),
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		TNS(<span class="enscript-string">&quot;fucomi&quot;</span>,F),	TNS(<span class="enscript-string">&quot;fcomi&quot;</span>,F),		INVALID,
};

<span class="enscript-type">const</span> instable_t dis_opFP7[8] = {
<span class="enscript-comment">/* bit pattern:	1101 1010 11yy yxxx */</span>
<span class="enscript-comment">/*  [00]  */</span>	TNS(<span class="enscript-string">&quot;fcmov.b&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fcmov.e&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fcmov.be&quot;</span>,FF),	TNS(<span class="enscript-string">&quot;fcmov.u&quot;</span>,FF),
<span class="enscript-comment">/*  [04]  */</span>	INVALID,		INVALID,		INVALID,		INVALID,
};

<span class="enscript-comment">/*
 *	Main decode table for the op codes.  The first two nibbles
 *	will be used as an index into the table.  If there is a
 *	a need to further decode an instruction, the array to be
 *	referenced is indicated with the other two entries being
 *	empty.
 */</span>

<span class="enscript-type">const</span> instable_t dis_distable[16][16] = {
{
<span class="enscript-comment">/* [0,0] */</span>	TNS(<span class="enscript-string">&quot;addb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;add&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;addb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;add&quot;</span>,MRw),
<span class="enscript-comment">/* [0,4] */</span>	TNS(<span class="enscript-string">&quot;addb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;add&quot;</span>,IA),		TSx(<span class="enscript-string">&quot;push&quot;</span>,SEG),	TSx(<span class="enscript-string">&quot;pop&quot;</span>,SEG),
<span class="enscript-comment">/* [0,8] */</span>	TNS(<span class="enscript-string">&quot;orb&quot;</span>,RMw),		TS(<span class="enscript-string">&quot;or&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;orb&quot;</span>,MRw),		TS(<span class="enscript-string">&quot;or&quot;</span>,MRw),
<span class="enscript-comment">/* [0,C] */</span>	TNS(<span class="enscript-string">&quot;orb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;or&quot;</span>,IA),		TSx(<span class="enscript-string">&quot;push&quot;</span>,SEG),	IND(dis_op0F),
}, {
<span class="enscript-comment">/* [1,0] */</span>	TNS(<span class="enscript-string">&quot;adcb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;adc&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;adcb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;adc&quot;</span>,MRw),
<span class="enscript-comment">/* [1,4] */</span>	TNS(<span class="enscript-string">&quot;adcb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;adc&quot;</span>,IA),		TSx(<span class="enscript-string">&quot;push&quot;</span>,SEG),	TSx(<span class="enscript-string">&quot;pop&quot;</span>,SEG),
<span class="enscript-comment">/* [1,8] */</span>	TNS(<span class="enscript-string">&quot;sbbb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;sbb&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;sbbb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;sbb&quot;</span>,MRw),
<span class="enscript-comment">/* [1,C] */</span>	TNS(<span class="enscript-string">&quot;sbbb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;sbb&quot;</span>,IA),		TSx(<span class="enscript-string">&quot;push&quot;</span>,SEG),	TSx(<span class="enscript-string">&quot;pop&quot;</span>,SEG),
}, {
<span class="enscript-comment">/* [2,0] */</span>	TNS(<span class="enscript-string">&quot;andb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;and&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;andb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;and&quot;</span>,MRw),
<span class="enscript-comment">/* [2,4] */</span>	TNS(<span class="enscript-string">&quot;andb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;and&quot;</span>,IA),		TNS(<span class="enscript-string">&quot;%es:&quot;</span>,OVERRIDE),	TNSx(<span class="enscript-string">&quot;daa&quot;</span>,NORM),
<span class="enscript-comment">/* [2,8] */</span>	TNS(<span class="enscript-string">&quot;subb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;sub&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;subb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;sub&quot;</span>,MRw),
<span class="enscript-comment">/* [2,C] */</span>	TNS(<span class="enscript-string">&quot;subb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;sub&quot;</span>,IA),		TNS(<span class="enscript-string">&quot;%cs:&quot;</span>,OVERRIDE),	TNSx(<span class="enscript-string">&quot;das&quot;</span>,NORM),
}, {
<span class="enscript-comment">/* [3,0] */</span>	TNS(<span class="enscript-string">&quot;xorb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;xor&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;xorb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;xor&quot;</span>,MRw),
<span class="enscript-comment">/* [3,4] */</span>	TNS(<span class="enscript-string">&quot;xorb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;xor&quot;</span>,IA),		TNS(<span class="enscript-string">&quot;%ss:&quot;</span>,OVERRIDE),	TNSx(<span class="enscript-string">&quot;aaa&quot;</span>,NORM),
<span class="enscript-comment">/* [3,8] */</span>	TNS(<span class="enscript-string">&quot;cmpb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;cmp&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;cmpb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;cmp&quot;</span>,MRw),
<span class="enscript-comment">/* [3,C] */</span>	TNS(<span class="enscript-string">&quot;cmpb&quot;</span>,IA),		TS(<span class="enscript-string">&quot;cmp&quot;</span>,IA),		TNS(<span class="enscript-string">&quot;%ds:&quot;</span>,OVERRIDE),	TNSx(<span class="enscript-string">&quot;aas&quot;</span>,NORM),
}, {
<span class="enscript-comment">/* [4,0] */</span>	TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),		TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),		TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),		TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),
<span class="enscript-comment">/* [4,4] */</span>	TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),		TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),		TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),		TSx(<span class="enscript-string">&quot;inc&quot;</span>,R),
<span class="enscript-comment">/* [4,8] */</span>	TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),		TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),		TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),		TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),
<span class="enscript-comment">/* [4,C] */</span>	TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),		TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),		TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),		TSx(<span class="enscript-string">&quot;dec&quot;</span>,R),
}, {
<span class="enscript-comment">/* [5,0] */</span>	TSp(<span class="enscript-string">&quot;push&quot;</span>,R),		TSp(<span class="enscript-string">&quot;push&quot;</span>,R),		TSp(<span class="enscript-string">&quot;push&quot;</span>,R),		TSp(<span class="enscript-string">&quot;push&quot;</span>,R),
<span class="enscript-comment">/* [5,4] */</span>	TSp(<span class="enscript-string">&quot;push&quot;</span>,R),		TSp(<span class="enscript-string">&quot;push&quot;</span>,R),		TSp(<span class="enscript-string">&quot;push&quot;</span>,R),		TSp(<span class="enscript-string">&quot;push&quot;</span>,R),
<span class="enscript-comment">/* [5,8] */</span>	TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),		TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),		TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),		TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),
<span class="enscript-comment">/* [5,C] */</span>	TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),		TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),		TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),		TSp(<span class="enscript-string">&quot;pop&quot;</span>,R),
}, {
<span class="enscript-comment">/* [6,0] */</span>	TSZx(<span class="enscript-string">&quot;pusha&quot;</span>,IMPLMEM,28),TSZx(<span class="enscript-string">&quot;popa&quot;</span>,IMPLMEM,28), TSx(<span class="enscript-string">&quot;bound&quot;</span>,MR),	TNS(<span class="enscript-string">&quot;arpl&quot;</span>,RMw),
<span class="enscript-comment">/* [6,4] */</span>	TNS(<span class="enscript-string">&quot;%fs:&quot;</span>,OVERRIDE),	TNS(<span class="enscript-string">&quot;%gs:&quot;</span>,OVERRIDE),	TNS(<span class="enscript-string">&quot;data16&quot;</span>,DM),	TNS(<span class="enscript-string">&quot;addr16&quot;</span>,AM),
<span class="enscript-comment">/* [6,8] */</span>	TSp(<span class="enscript-string">&quot;push&quot;</span>,I),		TS(<span class="enscript-string">&quot;imul&quot;</span>,IMUL),	TSp(<span class="enscript-string">&quot;push&quot;</span>,Ib),	TS(<span class="enscript-string">&quot;imul&quot;</span>,IMUL),
<span class="enscript-comment">/* [6,C] */</span>	TNSZ(<span class="enscript-string">&quot;insb&quot;</span>,IMPLMEM,1),	TSZ(<span class="enscript-string">&quot;ins&quot;</span>,IMPLMEM,4),	TNSZ(<span class="enscript-string">&quot;outsb&quot;</span>,IMPLMEM,1),TSZ(<span class="enscript-string">&quot;outs&quot;</span>,IMPLMEM,4),
}, {
<span class="enscript-comment">/* [7,0] */</span>	TNSy(<span class="enscript-string">&quot;jo&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jno&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jb&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jae&quot;</span>,BD),
<span class="enscript-comment">/* [7,4] */</span>	TNSy(<span class="enscript-string">&quot;je&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jne&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jbe&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;ja&quot;</span>,BD),
<span class="enscript-comment">/* [7,8] */</span>	TNSy(<span class="enscript-string">&quot;js&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jns&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jp&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jnp&quot;</span>,BD),
<span class="enscript-comment">/* [7,C] */</span>	TNSy(<span class="enscript-string">&quot;jl&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jge&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jle&quot;</span>,BD),		TNSy(<span class="enscript-string">&quot;jg&quot;</span>,BD),
}, {
<span class="enscript-comment">/* [8,0] */</span>	IND(dis_op80),		IND(dis_op81),		INDx(dis_op82),		IND(dis_op83),
<span class="enscript-comment">/* [8,4] */</span>	TNS(<span class="enscript-string">&quot;testb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;test&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;xchgb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;xchg&quot;</span>,RMw),
<span class="enscript-comment">/* [8,8] */</span>	TNS(<span class="enscript-string">&quot;movb&quot;</span>,RMw),	TS(<span class="enscript-string">&quot;mov&quot;</span>,RMw),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,MRw),	TS(<span class="enscript-string">&quot;mov&quot;</span>,MRw),
<span class="enscript-comment">/* [8,C] */</span>	TNS(<span class="enscript-string">&quot;movw&quot;</span>,SM),		TS(<span class="enscript-string">&quot;lea&quot;</span>,MR),		TNS(<span class="enscript-string">&quot;movw&quot;</span>,MS),		TSp(<span class="enscript-string">&quot;pop&quot;</span>,M),
}, {
<span class="enscript-comment">/* [9,0] */</span>	TNS(<span class="enscript-string">&quot;nop&quot;</span>,NORM),	TS(<span class="enscript-string">&quot;xchg&quot;</span>,RA),		TS(<span class="enscript-string">&quot;xchg&quot;</span>,RA),		TS(<span class="enscript-string">&quot;xchg&quot;</span>,RA),
<span class="enscript-comment">/* [9,4] */</span>	TS(<span class="enscript-string">&quot;xchg&quot;</span>,RA),		TS(<span class="enscript-string">&quot;xchg&quot;</span>,RA),		TS(<span class="enscript-string">&quot;xchg&quot;</span>,RA),		TS(<span class="enscript-string">&quot;xchg&quot;</span>,RA),
<span class="enscript-comment">/* [9,8] */</span>	TNS(<span class="enscript-string">&quot;cXtX&quot;</span>,CBW),	TNS(<span class="enscript-string">&quot;cXtX&quot;</span>,CWD),	TNSx(<span class="enscript-string">&quot;lcall&quot;</span>,SO),	TNS(<span class="enscript-string">&quot;fwait&quot;</span>,NORM),
<span class="enscript-comment">/* [9,C] */</span>	TSZy(<span class="enscript-string">&quot;pushf&quot;</span>,IMPLMEM,4),TSZy(<span class="enscript-string">&quot;popf&quot;</span>,IMPLMEM,4),	TNSx(<span class="enscript-string">&quot;sahf&quot;</span>,NORM),	TNSx(<span class="enscript-string">&quot;lahf&quot;</span>,NORM),
}, {
<span class="enscript-comment">/* [A,0] */</span>	TNS(<span class="enscript-string">&quot;movb&quot;</span>,OA),		TS(<span class="enscript-string">&quot;mov&quot;</span>,OA),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,AO),		TS(<span class="enscript-string">&quot;mov&quot;</span>,AO),
<span class="enscript-comment">/* [A,4] */</span>	TNSZ(<span class="enscript-string">&quot;movsb&quot;</span>,SD,1),	TS(<span class="enscript-string">&quot;movs&quot;</span>,SD),		TNSZ(<span class="enscript-string">&quot;cmpsb&quot;</span>,SD,1),	TS(<span class="enscript-string">&quot;cmps&quot;</span>,SD),
<span class="enscript-comment">/* [A,8] */</span>	TNS(<span class="enscript-string">&quot;testb&quot;</span>,IA),	TS(<span class="enscript-string">&quot;test&quot;</span>,IA),		TNS(<span class="enscript-string">&quot;stosb&quot;</span>,AD),	TS(<span class="enscript-string">&quot;stos&quot;</span>,AD),
<span class="enscript-comment">/* [A,C] */</span>	TNS(<span class="enscript-string">&quot;lodsb&quot;</span>,SA),	TS(<span class="enscript-string">&quot;lods&quot;</span>,SA),		TNS(<span class="enscript-string">&quot;scasb&quot;</span>,AD),	TS(<span class="enscript-string">&quot;scas&quot;</span>,AD),
}, {
<span class="enscript-comment">/* [B,0] */</span>	TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),
<span class="enscript-comment">/* [B,4] */</span>	TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,IR),
<span class="enscript-comment">/* [B,8] */</span>	TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),		TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),		TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),		TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),
<span class="enscript-comment">/* [B,C] */</span>	TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),		TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),		TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),		TS(<span class="enscript-string">&quot;mov&quot;</span>,IR),
}, {
<span class="enscript-comment">/* [C,0] */</span>	IND(dis_opC0),		IND(dis_opC1), 		TNSyp(<span class="enscript-string">&quot;ret&quot;</span>,RET),	TNSyp(<span class="enscript-string">&quot;ret&quot;</span>,NORM),
<span class="enscript-comment">/* [C,4] */</span>	TNSx(<span class="enscript-string">&quot;les&quot;</span>,MR),		TNSx(<span class="enscript-string">&quot;lds&quot;</span>,MR),		TNS(<span class="enscript-string">&quot;movb&quot;</span>,IMw),	TS(<span class="enscript-string">&quot;mov&quot;</span>,IMw),
<span class="enscript-comment">/* [C,8] */</span>	TNSyp(<span class="enscript-string">&quot;enter&quot;</span>,ENTER),	TNSyp(<span class="enscript-string">&quot;leave&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;lret&quot;</span>,RET),	TNS(<span class="enscript-string">&quot;lret&quot;</span>,NORM),
<span class="enscript-comment">/* [C,C] */</span>	TNS(<span class="enscript-string">&quot;int&quot;</span>,INT3),	TNS(<span class="enscript-string">&quot;int&quot;</span>,INTx),	TNSx(<span class="enscript-string">&quot;into&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;iret&quot;</span>,NORM),
}, {
<span class="enscript-comment">/* [D,0] */</span>	IND(dis_opD0),		IND(dis_opD1),		IND(dis_opD2),		IND(dis_opD3),
<span class="enscript-comment">/* [D,4] */</span>	TNSx(<span class="enscript-string">&quot;aam&quot;</span>,U),		TNSx(<span class="enscript-string">&quot;aad&quot;</span>,U),		TNSx(<span class="enscript-string">&quot;falc&quot;</span>,NORM),	TNSZ(<span class="enscript-string">&quot;xlat&quot;</span>,IMPLMEM,1),

<span class="enscript-comment">/* 287 instructions.  Note that although the indirect field		*/</span>
<span class="enscript-comment">/* indicates opFP1n2 for further decoding, this is not necessarily	*/</span>
<span class="enscript-comment">/* the case since the opFP arrays are not partitioned according to key1	*/</span>
<span class="enscript-comment">/* and key2.  opFP1n2 is given only to indicate that we haven't		*/</span>
<span class="enscript-comment">/* finished decoding the instruction.					*/</span>
<span class="enscript-comment">/* [D,8] */</span>	IND(dis_opFP1n2),	IND(dis_opFP1n2),	IND(dis_opFP1n2),	IND(dis_opFP1n2),
<span class="enscript-comment">/* [D,C] */</span>	IND(dis_opFP1n2),	IND(dis_opFP1n2),	IND(dis_opFP1n2),	IND(dis_opFP1n2),
}, {
<span class="enscript-comment">/* [E,0] */</span>	TNSy(<span class="enscript-string">&quot;loopnz&quot;</span>,BD),	TNSy(<span class="enscript-string">&quot;loopz&quot;</span>,BD),	TNSy(<span class="enscript-string">&quot;loop&quot;</span>,BD),	TNSy(<span class="enscript-string">&quot;jcxz&quot;</span>,BD),
<span class="enscript-comment">/* [E,4] */</span>	TNS(<span class="enscript-string">&quot;inb&quot;</span>,P),		TS(<span class="enscript-string">&quot;in&quot;</span>,P),		TNS(<span class="enscript-string">&quot;outb&quot;</span>,P),		TS(<span class="enscript-string">&quot;out&quot;</span>,P),
<span class="enscript-comment">/* [E,8] */</span>	TNSyp(<span class="enscript-string">&quot;call&quot;</span>,D),	TNSy(<span class="enscript-string">&quot;jmp&quot;</span>,D),		TNSx(<span class="enscript-string">&quot;ljmp&quot;</span>,SO),		TNSy(<span class="enscript-string">&quot;jmp&quot;</span>,BD),
<span class="enscript-comment">/* [E,C] */</span>	TNS(<span class="enscript-string">&quot;inb&quot;</span>,V),		TS(<span class="enscript-string">&quot;in&quot;</span>,V),		TNS(<span class="enscript-string">&quot;outb&quot;</span>,V),		TS(<span class="enscript-string">&quot;out&quot;</span>,V),
}, {
<span class="enscript-comment">/* [F,0] */</span>	TNS(<span class="enscript-string">&quot;lock&quot;</span>,LOCK),	TNS(<span class="enscript-string">&quot;icebp&quot;</span>, NORM),	TNS(<span class="enscript-string">&quot;repnz&quot;</span>,PREFIX),	TNS(<span class="enscript-string">&quot;repz&quot;</span>,PREFIX),
<span class="enscript-comment">/* [F,4] */</span>	TNS(<span class="enscript-string">&quot;hlt&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;cmc&quot;</span>,NORM),	IND(dis_opF6),		IND(dis_opF7),
<span class="enscript-comment">/* [F,8] */</span>	TNS(<span class="enscript-string">&quot;clc&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;stc&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;cli&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;sti&quot;</span>,NORM),
<span class="enscript-comment">/* [F,C] */</span>	TNS(<span class="enscript-string">&quot;cld&quot;</span>,NORM),	TNS(<span class="enscript-string">&quot;std&quot;</span>,NORM),	IND(dis_opFE),		IND(dis_opFF),
} };

<span class="enscript-comment">/* END CSTYLED */</span>

<span class="enscript-comment">/*
 * common functions to decode and disassemble an x86 or amd64 instruction
 */</span>

<span class="enscript-comment">/*
 * These are the individual fields of a REX prefix. Note that a REX
 * prefix with none of these set is still needed to:
 *	- use the MOVSXD (sign extend 32 to 64 bits) instruction
 *	- access the %sil, %dil, %bpl, %spl registers
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">REX_W</span> 0x08	<span class="enscript-comment">/* 64 bit operand size when set */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">REX_R</span> 0x04	<span class="enscript-comment">/* high order bit extension of ModRM reg field */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">REX_X</span> 0x02	<span class="enscript-comment">/* high order bit extension of SIB index field */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">REX_B</span> 0x01	<span class="enscript-comment">/* extends ModRM r_m, SIB base, or opcode reg */</span>

<span class="enscript-comment">/*
 * These are the individual fields of a VEX prefix.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_R</span> 0x08	<span class="enscript-comment">/* REX.R in 1's complement form */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_X</span> 0x04	<span class="enscript-comment">/* REX.X in 1's complement form */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_B</span> 0x02	<span class="enscript-comment">/* REX.B in 1's complement form */</span>
<span class="enscript-comment">/* Vector Length, 0: scalar or 128-bit vector, 1: 256-bit vector */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_L</span> 0x04
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_W</span> 0x08	<span class="enscript-comment">/* opcode specific, use like REX.W */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_m</span> 0x1F	<span class="enscript-comment">/* VEX m-mmmm field */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_v</span> 0x78	<span class="enscript-comment">/* VEX register specifier */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_p</span> 0x03	<span class="enscript-comment">/* VEX pp field, opcode extension */</span>

<span class="enscript-comment">/* VEX m-mmmm field, only used by three bytes prefix */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_m_0F</span> 0x01   <span class="enscript-comment">/* implied 0F leading opcode byte */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_m_0F38</span> 0x02 <span class="enscript-comment">/* implied 0F 38 leading opcode byte */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_m_0F3A</span> 0x03 <span class="enscript-comment">/* implied 0F 3A leading opcode byte */</span>

<span class="enscript-comment">/* VEX pp field, providing equivalent functionality of a SIMD prefix */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_p_66</span> 0x01
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_p_F3</span> 0x02
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VEX_p_F2</span> 0x03

<span class="enscript-comment">/*
 * Even in 64 bit mode, usually only 4 byte immediate operands are supported.
 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">int</span> isize[] = {1, 2, 4, 4};
<span class="enscript-type">static</span> <span class="enscript-type">int</span> isize64[] = {1, 2, 4, 8};

<span class="enscript-comment">/*
 * Just a bunch of useful macros.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">WBIT</span>(x)	(x &amp; 0x1)		<span class="enscript-comment">/* to get w bit	*/</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">REGNO</span>(x) (x &amp; 0x7)		<span class="enscript-comment">/* to get 3 bit register */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">VBIT</span>(x)	((x)&gt;&gt;1 &amp; 0x1)		<span class="enscript-comment">/* to get 'v' bit */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">OPSIZE</span>(osize, wbit) ((wbit) ? isize[osize] : 1)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">OPSIZE64</span>(osize, wbit) ((wbit) ? isize64[osize] : 1)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">REG_ONLY</span> 3	<span class="enscript-comment">/* mode to indicate a register operand (not memory) */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BYTE_OPND</span>	0	<span class="enscript-comment">/* w-bit value indicating byte register */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">LONG_OPND</span>	1	<span class="enscript-comment">/* w-bit value indicating opnd_size register */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">MM_OPND</span>		2	<span class="enscript-comment">/* &quot;value&quot; used to indicate a mmx reg */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">XMM_OPND</span>	3	<span class="enscript-comment">/* &quot;value&quot; used to indicate a xmm reg */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SEG_OPND</span>	4	<span class="enscript-comment">/* &quot;value&quot; used to indicate a segment reg */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">CONTROL_OPND</span>	5	<span class="enscript-comment">/* &quot;value&quot; used to indicate a control reg */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DEBUG_OPND</span>	6	<span class="enscript-comment">/* &quot;value&quot; used to indicate a debug reg */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TEST_OPND</span>	7	<span class="enscript-comment">/* &quot;value&quot; used to indicate a test reg */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">WORD_OPND</span>	8	<span class="enscript-comment">/* w-bit value indicating word size reg */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">YMM_OPND</span>	9	<span class="enscript-comment">/* &quot;value&quot; used to indicate a ymm reg */</span>

<span class="enscript-comment">/*
 * Get the next byte and separate the op code into the high and low nibbles.
 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">int</span>
<span class="enscript-function-name">dtrace_get_opcode</span>(dis86_t *x, uint_t *high, uint_t *low)
{
	<span class="enscript-type">int</span> byte;

	<span class="enscript-comment">/*
	 * x86 instructions have a maximum length of 15 bytes.  Bail out if
	 * we try to read more.
	 */</span>
	<span class="enscript-keyword">if</span> (x-&gt;d86_len &gt;= 15)
		<span class="enscript-keyword">return</span> (x-&gt;d86_error = 1);

	<span class="enscript-keyword">if</span> (x-&gt;d86_error)
		<span class="enscript-keyword">return</span> (1);
	byte = x-&gt;d86_get_byte(x-&gt;d86_data);
	<span class="enscript-keyword">if</span> (byte &lt; 0)
		<span class="enscript-keyword">return</span> (x-&gt;d86_error = 1);
	x-&gt;d86_bytes[x-&gt;d86_len++] = byte;
	*low = byte &amp; 0xf;		<span class="enscript-comment">/* ----xxxx low 4 bits */</span>
	*high = byte &gt;&gt; 4 &amp; 0xf;	<span class="enscript-comment">/* xxxx---- bits 7 to 4 */</span>
	<span class="enscript-keyword">return</span> (0);
}

<span class="enscript-comment">/*
 * Get and decode an SIB (scaled index base) byte
 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_get_SIB</span>(dis86_t *x, uint_t *ss, uint_t *index, uint_t *base)
{
	<span class="enscript-type">int</span> byte;

	<span class="enscript-keyword">if</span> (x-&gt;d86_error)
		<span class="enscript-keyword">return</span>;

	byte = x-&gt;d86_get_byte(x-&gt;d86_data);
	<span class="enscript-keyword">if</span> (byte &lt; 0) {
		x-&gt;d86_error = 1;
		<span class="enscript-keyword">return</span>;
	}
	x-&gt;d86_bytes[x-&gt;d86_len++] = byte;

	*base = byte &amp; 0x7;
	*index = (byte &gt;&gt; 3) &amp; 0x7;
	*ss = (byte &gt;&gt; 6) &amp; 0x3;
}

<span class="enscript-comment">/*
 * Get the byte following the op code and separate it into the
 * mode, register, and r/m fields.
 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_get_modrm</span>(dis86_t *x, uint_t *mode, uint_t *reg, uint_t *r_m)
{
	<span class="enscript-keyword">if</span> (x-&gt;d86_got_modrm == 0) {
		<span class="enscript-keyword">if</span> (x-&gt;d86_rmindex == -1)
			x-&gt;d86_rmindex = x-&gt;d86_len;
		dtrace_get_SIB(x, mode, reg, r_m);
		x-&gt;d86_got_modrm = 1;
	}
}

<span class="enscript-comment">/*
 * Adjust register selection based on any REX prefix bits present.
 */</span>
<span class="enscript-comment">/*ARGSUSED*/</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_rex_adjust</span>(uint_t rex_prefix, uint_t mode, uint_t *reg, uint_t *r_m)
{
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">unused</span> (<span class="enscript-variable-name">mode</span>)
	<span class="enscript-keyword">if</span> (reg != NULL &amp;&amp; r_m == NULL) {
		<span class="enscript-keyword">if</span> (rex_prefix &amp; REX_B)
			*reg += 8;
	} <span class="enscript-keyword">else</span> {
		<span class="enscript-keyword">if</span> (reg != NULL &amp;&amp; (REX_R &amp; rex_prefix) != 0)
			*reg += 8;
		<span class="enscript-keyword">if</span> (r_m != NULL &amp;&amp; (REX_B &amp; rex_prefix) != 0)
			*r_m += 8;
	}
}

<span class="enscript-comment">/*
 * Adjust register selection based on any VEX prefix bits present.
 * Notes: VEX.R, VEX.X and VEX.B use the inverted form compared with REX prefix
 */</span>
<span class="enscript-comment">/*ARGSUSED*/</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_vex_adjust</span>(uint_t vex_byte1, uint_t mode, uint_t *reg, uint_t *r_m)
{
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">unused</span> (<span class="enscript-variable-name">mode</span>)
	<span class="enscript-keyword">if</span> (reg != NULL &amp;&amp; r_m == NULL) {
		<span class="enscript-keyword">if</span> (!(vex_byte1 &amp; VEX_B))
			*reg += 8;
	} <span class="enscript-keyword">else</span> {
		<span class="enscript-keyword">if</span> (reg != NULL &amp;&amp; ((VEX_R &amp; vex_byte1) == 0))
			*reg += 8;
		<span class="enscript-keyword">if</span> (r_m != NULL &amp;&amp; ((VEX_B &amp; vex_byte1) == 0))
			*r_m += 8;
	}
}
<span class="enscript-comment">/*
 * Get an immediate operand of the given size, with sign extension.
 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_imm_opnd</span>(dis86_t *x, <span class="enscript-type">int</span> wbit, <span class="enscript-type">int</span> size, <span class="enscript-type">int</span> opindex)
{
	<span class="enscript-type">int</span> i;
	<span class="enscript-type">int</span> byte;
	<span class="enscript-type">int</span> valsize;

	<span class="enscript-keyword">if</span> (x-&gt;d86_numopnds &lt; (uint_t)opindex + 1)
		x-&gt;d86_numopnds = (uint_t)opindex + 1;

	<span class="enscript-keyword">switch</span> (wbit) {
	<span class="enscript-keyword">case</span> <span class="enscript-reference">BYTE_OPND</span>:
		valsize = 1;
		<span class="enscript-keyword">break</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">LONG_OPND</span>:
		<span class="enscript-keyword">if</span> (x-&gt;d86_opnd_size == SIZE16)
			valsize = 2;
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (x-&gt;d86_opnd_size == SIZE32)
			valsize = 4;
		<span class="enscript-keyword">else</span>
			valsize = 8;
		<span class="enscript-keyword">break</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MM_OPND</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM_OPND</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">YMM_OPND</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">SEG_OPND</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">CONTROL_OPND</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">DEBUG_OPND</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">TEST_OPND</span>:
		valsize = size;
		<span class="enscript-keyword">break</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">WORD_OPND</span>:
		valsize = 2;
		<span class="enscript-keyword">break</span>;
	}
	<span class="enscript-keyword">if</span> (valsize &lt; size)
		valsize = size;

	<span class="enscript-keyword">if</span> (x-&gt;d86_error)
		<span class="enscript-keyword">return</span>;
	x-&gt;d86_opnd[opindex].d86_value = 0;
	<span class="enscript-keyword">for</span> (i = 0; i &lt; size; ++i) {
		byte = x-&gt;d86_get_byte(x-&gt;d86_data);
		<span class="enscript-keyword">if</span> (byte &lt; 0) {
			x-&gt;d86_error = 1;
			<span class="enscript-keyword">return</span>;
		}
		x-&gt;d86_bytes[x-&gt;d86_len++] = byte;
		x-&gt;d86_opnd[opindex].d86_value |= (uint64_t)byte &lt;&lt; (i * 8);
	}
	<span class="enscript-comment">/* Do sign extension */</span>
	<span class="enscript-keyword">if</span> (x-&gt;d86_bytes[x-&gt;d86_len - 1] &amp; 0x80) {
		<span class="enscript-keyword">for</span> (; i &lt; (<span class="enscript-type">int</span>)<span class="enscript-keyword">sizeof</span> (uint64_t); i++)
			x-&gt;d86_opnd[opindex].d86_value |=
			    (uint64_t)0xff &lt;&lt; (i * 8);
	}
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	x-&gt;d86_opnd[opindex].d86_mode = MODE_SIGNED;
	x-&gt;d86_opnd[opindex].d86_value_size = valsize;
	x-&gt;d86_imm_bytes += size;
#<span class="enscript-reference">endif</span>
}

<span class="enscript-comment">/*
 * Get an ip relative operand of the given size, with sign extension.
 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_disp_opnd</span>(dis86_t *x, <span class="enscript-type">int</span> wbit, <span class="enscript-type">int</span> size, <span class="enscript-type">int</span> opindex)
{
	dtrace_imm_opnd(x, wbit, size, opindex);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	x-&gt;d86_opnd[opindex].d86_mode = MODE_IPREL;
#<span class="enscript-reference">endif</span>
}

<span class="enscript-comment">/*
 * Check to see if there is a segment override prefix pending.
 * If so, print it in the current 'operand' location and set
 * the override flag back to false.
 */</span>
<span class="enscript-comment">/*ARGSUSED*/</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_check_override</span>(dis86_t *x, <span class="enscript-type">int</span> opindex)
{
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	<span class="enscript-keyword">if</span> (x-&gt;d86_seg_prefix) {
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[opindex].d86_prefix,
		    x-&gt;d86_seg_prefix, PFIXLEN);
	}
#<span class="enscript-reference">else</span>
	#pragma unused (opindex)
#<span class="enscript-reference">endif</span>
	x-&gt;d86_seg_prefix = NULL;
}


<span class="enscript-comment">/*
 * Process a single instruction Register or Memory operand.
 *
 * mode = addressing mode from ModRM byte
 * r_m = r_m (or reg if mode == 3) field from ModRM byte
 * wbit = indicates which register (8bit, 16bit, ... MMX, etc.) set to use.
 * o = index of operand that we are processing (0, 1 or 2)
 *
 * the value of reg or r_m must have already been adjusted for any REX prefix.
 */</span>
<span class="enscript-comment">/*ARGSUSED*/</span>
<span class="enscript-type">static</span> <span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_get_operand</span>(dis86_t *x, uint_t mode, uint_t r_m, <span class="enscript-type">int</span> wbit, <span class="enscript-type">int</span> opindex)
{
	<span class="enscript-type">int</span> have_SIB = 0;	<span class="enscript-comment">/* flag presence of scale-index-byte */</span>
	uint_t ss;		<span class="enscript-comment">/* scale-factor from opcode */</span>
	uint_t index;		<span class="enscript-comment">/* index register number */</span>
	uint_t base;		<span class="enscript-comment">/* base register number */</span>
	<span class="enscript-type">int</span> dispsize;   	<span class="enscript-comment">/* size of displacement in bytes */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	<span class="enscript-type">char</span> *opnd = x-&gt;d86_opnd[opindex].d86_opnd;
#<span class="enscript-reference">else</span>
	#pragma unused (wbit)
#<span class="enscript-reference">endif</span>

	<span class="enscript-keyword">if</span> (x-&gt;d86_numopnds &lt; (uint_t)opindex + 1)
		x-&gt;d86_numopnds = (uint_t)opindex + 1;

	<span class="enscript-keyword">if</span> (x-&gt;d86_error)
		<span class="enscript-keyword">return</span>;

	<span class="enscript-comment">/*
	 * first handle a simple register
	 */</span>
	<span class="enscript-keyword">if</span> (mode == REG_ONLY) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">switch</span> (wbit) {
		<span class="enscript-keyword">case</span> <span class="enscript-reference">MM_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_MMREG[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_XMMREG[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">YMM_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_YMMREG[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">SEG_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_SEGREG[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">CONTROL_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_CONTROLREG[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">DEBUG_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_DEBUGREG[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">TEST_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_TESTREG[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">BYTE_OPND</span>:
			<span class="enscript-keyword">if</span> (x-&gt;d86_rex_prefix == 0)
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_REG8[r_m], OPLEN);
			<span class="enscript-keyword">else</span>
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_REG8_REX[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">WORD_OPND</span>:
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_REG16[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">LONG_OPND</span>:
			<span class="enscript-keyword">if</span> (x-&gt;d86_opnd_size == SIZE16)
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_REG16[r_m], OPLEN);
			<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (x-&gt;d86_opnd_size == SIZE32)
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_REG32[r_m], OPLEN);
			<span class="enscript-keyword">else</span>
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_REG64[r_m], OPLEN);
			<span class="enscript-keyword">break</span>;
		}
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* DIS_TEXT */</span>
		<span class="enscript-keyword">return</span>;
	}

	<span class="enscript-comment">/*
	 * if symbolic representation, skip override prefix, if any
	 */</span>
	dtrace_check_override(x, opindex);

	<span class="enscript-comment">/*
	 * Handle 16 bit memory references first, since they decode
	 * the mode values more simply.
	 * mode 1 is r_m + 8 bit displacement
	 * mode 2 is r_m + 16 bit displacement
	 * mode 0 is just r_m, unless r_m is 6 which is 16 bit disp
	 */</span>
	<span class="enscript-keyword">if</span> (x-&gt;d86_addr_size == SIZE16) {
		<span class="enscript-keyword">if</span> ((mode == 0 &amp;&amp; r_m == 6) || mode == 2)
			dtrace_imm_opnd(x, WORD_OPND, 2, opindex);
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (mode == 1)
			dtrace_imm_opnd(x, BYTE_OPND, 1, opindex);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (mode == 0 &amp;&amp; r_m == 6)
			x-&gt;d86_opnd[opindex].d86_mode = MODE_SIGNED;
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (mode == 0)
			x-&gt;d86_opnd[opindex].d86_mode = MODE_NONE;
		<span class="enscript-keyword">else</span>
			x-&gt;d86_opnd[opindex].d86_mode = MODE_OFFSET;
		(<span class="enscript-type">void</span>) strlcat(opnd, dis_addr16[mode][r_m], OPLEN);
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">return</span>;
	}

	<span class="enscript-comment">/*
	 * 32 and 64 bit addressing modes are more complex since they
	 * can involve an SIB (scaled index and base) byte to decode.
	 */</span>
	<span class="enscript-keyword">if</span> (r_m == ESP_REGNO || r_m == ESP_REGNO + 8) {
		have_SIB = 1;
		dtrace_get_SIB(x, &amp;ss, &amp;index, &amp;base);
		<span class="enscript-keyword">if</span> (x-&gt;d86_error)
			<span class="enscript-keyword">return</span>;
		<span class="enscript-keyword">if</span> (base != 5 || mode != 0)
			<span class="enscript-keyword">if</span> (x-&gt;d86_rex_prefix &amp; REX_B)
				base += 8;
		<span class="enscript-keyword">if</span> (x-&gt;d86_rex_prefix &amp; REX_X)
			index += 8;
	} <span class="enscript-keyword">else</span> {
		base = r_m;
	}

	<span class="enscript-comment">/*
	 * Compute the displacement size and get its bytes
	 */</span>
	dispsize = 0;

	<span class="enscript-keyword">if</span> (mode == 1)
		dispsize = 1;
	<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (mode == 2)
		dispsize = 4;
	<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((r_m &amp; 7) == EBP_REGNO ||
	    (have_SIB &amp;&amp; (base &amp; 7) == EBP_REGNO))
		dispsize = 4;

	<span class="enscript-keyword">if</span> (dispsize &gt; 0) {
		dtrace_imm_opnd(x, dispsize == 4 ? LONG_OPND : BYTE_OPND,
		    dispsize, opindex);
		<span class="enscript-keyword">if</span> (x-&gt;d86_error)
			<span class="enscript-keyword">return</span>;
	}

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	<span class="enscript-keyword">if</span> (dispsize &gt; 0)
		x-&gt;d86_opnd[opindex].d86_mode = MODE_OFFSET;

	<span class="enscript-keyword">if</span> (have_SIB == 0) {
		<span class="enscript-keyword">if</span> (x-&gt;d86_mode == SIZE32) {
			<span class="enscript-keyword">if</span> (mode == 0)
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_addr32_mode0[r_m],
				    OPLEN);
			<span class="enscript-keyword">else</span>
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_addr32_mode12[r_m],
				    OPLEN);
		} <span class="enscript-keyword">else</span> {
			<span class="enscript-keyword">if</span> (mode == 0) {
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_addr64_mode0[r_m],
				    OPLEN);
				<span class="enscript-keyword">if</span> (r_m == 5) {
					x-&gt;d86_opnd[opindex].d86_mode =
					    MODE_RIPREL;
				}
			} <span class="enscript-keyword">else</span> {
				(<span class="enscript-type">void</span>) strlcat(opnd, dis_addr64_mode12[r_m],
				    OPLEN);
			}
		}
	} <span class="enscript-keyword">else</span> {
		uint_t need_paren = 0;
		<span class="enscript-type">char</span> **regs;
		<span class="enscript-keyword">if</span> (x-&gt;d86_mode == SIZE32) <span class="enscript-comment">/* NOTE this is not addr_size! */</span>
			regs = (<span class="enscript-type">char</span> **)dis_REG32;
		<span class="enscript-keyword">else</span>
			regs = (<span class="enscript-type">char</span> **)dis_REG64;

		<span class="enscript-comment">/*
		 * print the base (if any)
		 */</span>
		<span class="enscript-keyword">if</span> (base == EBP_REGNO &amp;&amp; mode == 0) {
			<span class="enscript-keyword">if</span> (index != ESP_REGNO) {
				(<span class="enscript-type">void</span>) strlcat(opnd, <span class="enscript-string">&quot;(&quot;</span>, OPLEN);
				need_paren = 1;
			}
		} <span class="enscript-keyword">else</span> {
			(<span class="enscript-type">void</span>) strlcat(opnd, <span class="enscript-string">&quot;(&quot;</span>, OPLEN);
			(<span class="enscript-type">void</span>) strlcat(opnd, regs[base], OPLEN);
			need_paren = 1;
		}

		<span class="enscript-comment">/*
		 * print the index (if any)
		 */</span>
		<span class="enscript-keyword">if</span> (index != ESP_REGNO) {
			(<span class="enscript-type">void</span>) strlcat(opnd, <span class="enscript-string">&quot;,&quot;</span>, OPLEN);
			(<span class="enscript-type">void</span>) strlcat(opnd, regs[index], OPLEN);
			(<span class="enscript-type">void</span>) strlcat(opnd, dis_scale_factor[ss], OPLEN);
		} <span class="enscript-keyword">else</span>
			<span class="enscript-keyword">if</span> (need_paren)
				(<span class="enscript-type">void</span>) strlcat(opnd, <span class="enscript-string">&quot;)&quot;</span>, OPLEN);
	}
#<span class="enscript-reference">endif</span>
}

<span class="enscript-comment">/*
 * Operand sequence for standard instruction involving one register
 * and one register/memory operand.
 * wbit indicates a byte(0) or opnd_size(1) operation
 * vbit indicates direction (0 for &quot;opcode r,r_m&quot;) or (1 for &quot;opcode r_m, r&quot;)
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">STANDARD_MODRM</span>(x, mode, reg, r_m, rex_prefix, wbit, vbit)  {	\
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);			\
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);	\
		dtrace_get_operand(x, mode, r_m, wbit, vbit);		\
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 1 - vbit);	\
}

<span class="enscript-comment">/*
 * Similar to above, but allows for the two operands to be of different
 * classes (ie. wbit).
 *	wbit is for the r_m operand
 *	w2 is for the reg operand
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">MIXED_MM</span>(x, mode, reg, r_m, rex_prefix, wbit, w2, vbit)	{	\
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);			\
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);	\
		dtrace_get_operand(x, mode, r_m, wbit, vbit);		\
		dtrace_get_operand(x, REG_ONLY, reg, w2, 1 - vbit);	\
}

<span class="enscript-comment">/*
 * Similar, but for 2 operands plus an immediate.
 * vbit indicates direction
 * 	0 for &quot;opcode imm, r, r_m&quot; or
 *	1 for &quot;opcode imm, r_m, r&quot;
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">THREEOPERAND</span>(x, mode, reg, r_m, rex_prefix, wbit, w2, immsize, vbit) { \
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);			\
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);	\
		dtrace_get_operand(x, mode, r_m, wbit, 2-vbit);		\
		dtrace_get_operand(x, REG_ONLY, reg, w2, 1+vbit);	\
		dtrace_imm_opnd(x, wbit, immsize, 0);			\
}

<span class="enscript-comment">/*
 * Similar, but for 2 operands plus two immediates.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">FOUROPERAND</span>(x, mode, reg, r_m, rex_prefix, wbit, w2, immsize) { \
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);			\
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);	\
		dtrace_get_operand(x, mode, r_m, wbit, 2);		\
		dtrace_get_operand(x, REG_ONLY, reg, w2, 3);		\
		dtrace_imm_opnd(x, wbit, immsize, 1);			\
		dtrace_imm_opnd(x, wbit, immsize, 0);			\
}

<span class="enscript-comment">/*
 * 1 operands plus two immediates.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ONEOPERAND_TWOIMM</span>(x, mode, reg, r_m, rex_prefix, wbit, immsize) { \
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);			\
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);	\
		dtrace_get_operand(x, mode, r_m, wbit, 2);		\
		dtrace_imm_opnd(x, wbit, immsize, 1);			\
		dtrace_imm_opnd(x, wbit, immsize, 0);			\
}

<span class="enscript-comment">/*
 * Dissassemble a single x86 or amd64 instruction.
 *
 * Mode determines the default operating mode (SIZE16, SIZE32 or SIZE64)
 * for interpreting instructions.
 *
 * returns non-zero for bad opcode
 */</span>
<span class="enscript-type">int</span>
<span class="enscript-function-name">dtrace_disx86</span>(dis86_t *x, uint_t cpu_mode)
{
	instable_t *dp;		<span class="enscript-comment">/* decode table being used */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	uint_t i;
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_MEM</span>
	uint_t nomem = 0;
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">NOMEM</span>	(nomem = 1)
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">NOMEM</span>	<span class="enscript-comment">/* nothing */</span>
#<span class="enscript-reference">endif</span>
	uint_t opnd_size;	<span class="enscript-comment">/* SIZE16, SIZE32 or SIZE64 */</span>
	uint_t addr_size;	<span class="enscript-comment">/* SIZE16, SIZE32 or SIZE64 */</span>
	uint_t wbit = 0;	<span class="enscript-comment">/* opcode wbit, 0 is 8 bit, !0 for opnd_size */</span>
	uint_t w2;		<span class="enscript-comment">/* wbit value for second operand */</span>
	uint_t vbit;
	uint_t mode = 0;	<span class="enscript-comment">/* mode value from ModRM byte */</span>
	uint_t reg;		<span class="enscript-comment">/* reg value from ModRM byte */</span>
	uint_t r_m;		<span class="enscript-comment">/* r_m value from ModRM byte */</span>

	uint_t opcode1;		<span class="enscript-comment">/* high nibble of 1st byte */</span>
	uint_t opcode2;		<span class="enscript-comment">/* low nibble of 1st byte */</span>
	uint_t opcode3;		<span class="enscript-comment">/* extra opcode bits usually from ModRM byte */</span>
	uint_t opcode4;		<span class="enscript-comment">/* high nibble of 2nd byte */</span>
	uint_t opcode5;		<span class="enscript-comment">/* low nibble of 2nd byte */</span>
	uint_t opcode6;		<span class="enscript-comment">/* high nibble of 3rd byte */</span>
	uint_t opcode7;		<span class="enscript-comment">/* low nibble of 3rd byte */</span>
	uint_t opcode_bytes = 1;

	<span class="enscript-comment">/*
	 * legacy prefixes come in 5 flavors, you should have only one of each
	 */</span>
	uint_t	opnd_size_prefix = 0;
	uint_t	addr_size_prefix = 0;
	uint_t	segment_prefix = 0;
	uint_t	lock_prefix = 0;
	uint_t	rep_prefix = 0;
	uint_t	rex_prefix = 0;	<span class="enscript-comment">/* amd64 register extension prefix */</span>

	<span class="enscript-comment">/*
	 * Intel VEX instruction encoding prefix and fields
	 */</span>

	<span class="enscript-comment">/* 0xC4 means 3 bytes prefix, 0xC5 means 2 bytes prefix */</span>
	uint_t vex_prefix = 0;

	<span class="enscript-comment">/*
	 * VEX prefix byte 1, includes vex.r, vex.x and vex.b
	 * (for 3 bytes prefix)
	 */</span>
	uint_t vex_byte1 = 0;

	<span class="enscript-comment">/*
	 * For 32-bit mode, it should prefetch the next byte to
	 * distinguish between AVX and les/lds
	 */</span>
	uint_t vex_prefetch = 0;

	uint_t vex_m = 0;
	uint_t vex_v = 0;
	uint_t vex_p = 0;
	uint_t vex_R = 1;
	uint_t vex_X = 1;
	uint_t vex_B = 1;
	uint_t vex_W = 0;
	uint_t vex_L;

	size_t	off;

	instable_t dp_mmx;

	x-&gt;d86_len = 0;
	x-&gt;d86_rmindex = -1;
	x-&gt;d86_rex_prefix = 0;
	x-&gt;d86_got_modrm = 0;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	x-&gt;d86_numopnds = 0;
	x-&gt;d86_seg_prefix = NULL;
	x-&gt;d86_mnem[0] = 0;
	<span class="enscript-keyword">for</span> (i = 0; i &lt; 4; ++i) {
		x-&gt;d86_opnd[i].d86_opnd[0] = 0;
		x-&gt;d86_opnd[i].d86_prefix[0] = 0;
		x-&gt;d86_opnd[i].d86_value_size = 0;
		x-&gt;d86_opnd[i].d86_value = 0;
		x-&gt;d86_opnd[i].d86_mode = MODE_NONE;
	}
#<span class="enscript-reference">endif</span>
	x-&gt;d86_error = 0;
	x-&gt;d86_memsize = 0;

	<span class="enscript-keyword">if</span> (cpu_mode == SIZE16) {
		opnd_size = SIZE16;
		addr_size = SIZE16;
	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (cpu_mode == SIZE32) {
		opnd_size = SIZE32;
		addr_size = SIZE32;
	} <span class="enscript-keyword">else</span> {
		opnd_size = SIZE32;
		addr_size = SIZE64;
	}

	<span class="enscript-comment">/*
	 * Get one opcode byte and check for zero padding that follows
	 * jump tables.
	 */</span>
	<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode1, &amp;opcode2) != 0)
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

	<span class="enscript-keyword">if</span> (opcode1 == 0 &amp;&amp; opcode2 == 0 &amp;&amp;
	    x-&gt;d86_check_func != NULL &amp;&amp; x-&gt;d86_check_func(x-&gt;d86_data)) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;.byte\t0&quot;</span>, OPLEN);
		x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">done</span>;
	}

	<span class="enscript-comment">/*
	 * Gather up legacy x86 prefix bytes.
	 */</span>
	<span class="enscript-keyword">for</span> (;;) {
		uint_t *which_prefix = NULL;

		dp = (instable_t *)&amp;dis_distable[opcode1][opcode2];

		<span class="enscript-keyword">switch</span> (dp-&gt;it_adrmode) {
		<span class="enscript-keyword">case</span> <span class="enscript-reference">PREFIX</span>:
			which_prefix = &amp;rep_prefix;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">LOCK</span>:
			which_prefix = &amp;lock_prefix;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">OVERRIDE</span>:
			which_prefix = &amp;segment_prefix;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			x-&gt;d86_seg_prefix = (<span class="enscript-type">char</span> *)dp-&gt;it_name;
#<span class="enscript-reference">endif</span>
			<span class="enscript-keyword">if</span> (dp-&gt;it_invalid64 &amp;&amp; cpu_mode == SIZE64)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">AM</span>:
			which_prefix = &amp;addr_size_prefix;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">DM</span>:
			which_prefix = &amp;opnd_size_prefix;
			<span class="enscript-keyword">break</span>;
		}
		<span class="enscript-keyword">if</span> (which_prefix == NULL)
			<span class="enscript-keyword">break</span>;
		*which_prefix = (opcode1 &lt;&lt; 4) | opcode2;
		<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode1, &amp;opcode2) != 0)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
	}

	<span class="enscript-comment">/*
	 * Handle amd64 mode PREFIX values.
	 * Some of the segment prefixes are no-ops. (only FS/GS actually work)
	 * We might have a REX prefix (opcodes 0x40-0x4f)
	 */</span>
	<span class="enscript-keyword">if</span> (cpu_mode == SIZE64) {
		<span class="enscript-keyword">if</span> (segment_prefix != 0x64 &amp;&amp; segment_prefix != 0x65)
			segment_prefix = 0;

		<span class="enscript-keyword">if</span> (opcode1 == 0x4) {
			rex_prefix = (opcode1 &lt;&lt; 4) | opcode2;
			<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode1, &amp;opcode2) != 0)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			dp = (instable_t *)&amp;dis_distable[opcode1][opcode2];
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opcode1 == 0xC &amp;&amp;
		    (opcode2 == 0x4 || opcode2 == 0x5)) {
			<span class="enscript-comment">/* AVX instructions */</span>
			vex_prefix = (opcode1 &lt;&lt; 4) | opcode2;
			x-&gt;d86_rex_prefix = 0x40;
		}
	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opcode1 == 0xC &amp;&amp; (opcode2 == 0x4 || opcode2 == 0x5)) {
		<span class="enscript-comment">/* LDS, LES or AVX */</span>
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		vex_prefetch = 1;

		<span class="enscript-keyword">if</span> (mode == REG_ONLY) {
			<span class="enscript-comment">/* AVX */</span>
			vex_prefix = (opcode1 &lt;&lt; 4) | opcode2;
			x-&gt;d86_rex_prefix = 0x40;
			opcode3 = (((mode &lt;&lt; 3) | reg)&gt;&gt;1) &amp; 0x0F;
			opcode4 = ((reg &lt;&lt; 3) | r_m) &amp; 0x0F;
		}
	}

	<span class="enscript-keyword">if</span> (vex_prefix == VEX_2bytes) {
		<span class="enscript-keyword">if</span> (!vex_prefetch) {
			<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode3, &amp;opcode4) != 0)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		}
		vex_R = ((opcode3 &amp; VEX_R) &amp; 0x0F) &gt;&gt; 3;
		vex_L = ((opcode4 &amp; VEX_L) &amp; 0x0F) &gt;&gt; 2;
		vex_v = (((opcode3 &lt;&lt; 4) | opcode4) &amp; VEX_v) &gt;&gt; 3;
		vex_p = opcode4 &amp; VEX_p;
		<span class="enscript-comment">/*
		 * The vex.x and vex.b bits are not defined in two bytes
		 * mode vex prefix, their default values are 1
		 */</span>
		vex_byte1 = (opcode3 &amp; VEX_R) | VEX_X | VEX_B;

		<span class="enscript-keyword">if</span> (vex_R == 0)
			x-&gt;d86_rex_prefix |= REX_R;

		<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode1, &amp;opcode2) != 0)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

		<span class="enscript-keyword">switch</span> (vex_p) {
			<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_p_66</span>:
				dp = (instable_t *)
				    &amp;dis_opAVX660F[(opcode1 &lt;&lt; 4) | opcode2];
				<span class="enscript-keyword">break</span>;
			<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_p_F3</span>:
				dp = (instable_t *)
				    &amp;dis_opAVXF30F[(opcode1 &lt;&lt; 4) | opcode2];
				<span class="enscript-keyword">break</span>;
			<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_p_F2</span>:
				dp = (instable_t *)
				    &amp;dis_opAVXF20F [(opcode1 &lt;&lt; 4) | opcode2];
				<span class="enscript-keyword">break</span>;
			<span class="enscript-reference">default</span>:
				dp = (instable_t *)
				    &amp;dis_opAVX0F[opcode1][opcode2];

		}

	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (vex_prefix == VEX_3bytes) {
		<span class="enscript-keyword">if</span> (!vex_prefetch) {
			<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode3, &amp;opcode4) != 0)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		}
		vex_R = (opcode3 &amp; VEX_R) &gt;&gt; 3;
		vex_X = (opcode3 &amp; VEX_X) &gt;&gt; 2;
		vex_B = (opcode3 &amp; VEX_B) &gt;&gt; 1;
		vex_m = (((opcode3 &lt;&lt; 4) | opcode4) &amp; VEX_m);
		vex_byte1 = opcode3 &amp; (VEX_R | VEX_X | VEX_B);

		<span class="enscript-keyword">if</span> (vex_R == 0)
			x-&gt;d86_rex_prefix |= REX_R;
		<span class="enscript-keyword">if</span> (vex_X == 0)
			x-&gt;d86_rex_prefix |= REX_X;
		<span class="enscript-keyword">if</span> (vex_B == 0)
			x-&gt;d86_rex_prefix |= REX_B;

		<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode5, &amp;opcode6) != 0)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		vex_W = (opcode5 &amp; VEX_W) &gt;&gt; 3;
		vex_L = (opcode6 &amp; VEX_L) &gt;&gt; 2;
		vex_v = (((opcode5 &lt;&lt; 4) | opcode6) &amp; VEX_v) &gt;&gt; 3;
		vex_p = opcode6 &amp; VEX_p;

		<span class="enscript-keyword">if</span> (vex_W)
			x-&gt;d86_rex_prefix |= REX_W;

		<span class="enscript-comment">/* Only these three vex_m values valid; others are reserved */</span>
		<span class="enscript-keyword">if</span> ((vex_m != VEX_m_0F) &amp;&amp; (vex_m != VEX_m_0F38) &amp;&amp;
		    (vex_m != VEX_m_0F3A))
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

		<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode1, &amp;opcode2) != 0)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

		<span class="enscript-keyword">switch</span> (vex_p) {
			<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_p_66</span>:
				<span class="enscript-keyword">if</span> (vex_m == VEX_m_0F) {
					dp = (instable_t *)
					    &amp;dis_opAVX660F
					    [(opcode1 &lt;&lt; 4) | opcode2];
				} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (vex_m == VEX_m_0F38) {
					dp = (instable_t *)
					    &amp;dis_opAVX660F38
					    [(opcode1 &lt;&lt; 4) | opcode2];
				} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (vex_m == VEX_m_0F3A) {
					dp = (instable_t *)
					    &amp;dis_opAVX660F3A
					    [(opcode1 &lt;&lt; 4) | opcode2];
				} <span class="enscript-keyword">else</span> {
					<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
				}
				<span class="enscript-keyword">break</span>;
			<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_p_F3</span>:
				<span class="enscript-keyword">if</span> (vex_m == VEX_m_0F) {
					dp = (instable_t *)
					    &amp;dis_opAVXF30F
					    [(opcode1 &lt;&lt; 4) | opcode2];
				} <span class="enscript-keyword">else</span> {
					<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
				}
				<span class="enscript-keyword">break</span>;
			<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_p_F2</span>:
				<span class="enscript-keyword">if</span> (vex_m == VEX_m_0F) {
					dp = (instable_t *)
					    &amp;dis_opAVXF20F
					    [(opcode1 &lt;&lt; 4) | opcode2];
				} <span class="enscript-keyword">else</span> {
					<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
				}
				<span class="enscript-keyword">break</span>;
			<span class="enscript-reference">default</span>:
				dp = (instable_t *)
				    &amp;dis_opAVX0F[opcode1][opcode2];

 		}
 	}

	<span class="enscript-keyword">if</span> (vex_prefix) {
		<span class="enscript-keyword">if</span> (vex_L)
			wbit = YMM_OPND;
		<span class="enscript-keyword">else</span>
			wbit = XMM_OPND;
	}

	<span class="enscript-comment">/*
	 * Deal with selection of operand and address size now.
	 * Note that the REX.W bit being set causes opnd_size_prefix to be
	 * ignored.
	 */</span>
	<span class="enscript-keyword">if</span> (cpu_mode == SIZE64) {
		<span class="enscript-keyword">if</span> ((rex_prefix &amp; REX_W) || vex_W)
			opnd_size = SIZE64;
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opnd_size_prefix)
			opnd_size = SIZE16;

		<span class="enscript-keyword">if</span> (addr_size_prefix)
			addr_size = SIZE32;
	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (cpu_mode == SIZE32) {
		<span class="enscript-keyword">if</span> (opnd_size_prefix)
			opnd_size = SIZE16;
		<span class="enscript-keyword">if</span> (addr_size_prefix)
			addr_size = SIZE16;
	} <span class="enscript-keyword">else</span> {
		<span class="enscript-keyword">if</span> (opnd_size_prefix)
			opnd_size = SIZE32;
		<span class="enscript-keyword">if</span> (addr_size_prefix)
			addr_size = SIZE32;
	}

	<span class="enscript-comment">/*
	 * The pause instruction - a repz'd nop.  This doesn't fit
	 * with any of the other prefix goop added for SSE, so we'll
	 * special-case it here.
	 */</span>
	<span class="enscript-keyword">if</span> (rep_prefix == 0xf3 &amp;&amp; opcode1 == 0x9 &amp;&amp; opcode2 == 0x0) {
		rep_prefix = 0;
		dp = (instable_t *)&amp;dis_opPause;
	}

	<span class="enscript-comment">/*
	 * Some 386 instructions have 2 bytes of opcode before the mod_r/m
	 * byte so we may need to perform a table indirection.
	 */</span>
	<span class="enscript-keyword">if</span> (dp-&gt;it_indirect == (instable_t *)dis_op0F) {
		<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode4, &amp;opcode5) != 0)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		opcode_bytes = 2;
		<span class="enscript-keyword">if</span> (opcode4 == 0x7 &amp;&amp; opcode5 &gt;= 0x1 &amp;&amp; opcode5 &lt;= 0x3) {
			uint_t	subcode;

			<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode6, &amp;opcode7) != 0)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			opcode_bytes = 3;
			subcode = ((opcode6 &amp; 0x3) &lt;&lt; 1) |
			    ((opcode7 &amp; 0x8) &gt;&gt; 3);
			dp = (instable_t *)&amp;dis_op0F7123[opcode5][subcode];
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((opcode4 == 0xc) &amp;&amp; (opcode5 &gt;= 0x8)) {
			dp = (instable_t *)&amp;dis_op0FC8[0];
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((opcode4 == 0x3) &amp;&amp; (opcode5 == 0xA)) {
			opcode_bytes = 3;
			<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode6, &amp;opcode7) != 0)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			<span class="enscript-keyword">if</span> (opnd_size == SIZE16)
				opnd_size = SIZE32;

			dp = (instable_t *)&amp;dis_op0F3A[(opcode6&lt;&lt;4)|opcode7];
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			<span class="enscript-keyword">if</span> (LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;INVALID&quot;</span>))
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
#<span class="enscript-reference">endif</span>
			<span class="enscript-keyword">switch</span> (dp-&gt;it_adrmode) {
				<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMP_66r</span>:
				<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMPRM_66r</span>:
				<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM3PM_66r</span>:
					<span class="enscript-keyword">if</span> (opnd_size_prefix == 0) {
						<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
					}
					<span class="enscript-keyword">break</span>;
				<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMP_66o</span>:
					<span class="enscript-keyword">if</span> (opnd_size_prefix == 0) {
						<span class="enscript-comment">/* SSSE3 MMX instructions */</span>
						dp_mmx = *dp;
						dp = &amp;dp_mmx;
						dp-&gt;it_adrmode = MMOPM_66o;
#<span class="enscript-reference">ifdef</span>	<span class="enscript-variable-name">DIS_MEM</span>
						dp-&gt;it_size = 8;
#<span class="enscript-reference">endif</span>
					}
					<span class="enscript-keyword">break</span>;
				<span class="enscript-reference">default</span>:
					<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			}
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((opcode4 == 0x3) &amp;&amp; (opcode5 == 0x8)) {
			opcode_bytes = 3;
			<span class="enscript-keyword">if</span> (dtrace_get_opcode(x, &amp;opcode6, &amp;opcode7) != 0)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			dp = (instable_t *)&amp;dis_op0F38[(opcode6&lt;&lt;4)|opcode7];
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			<span class="enscript-keyword">if</span> (LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;INVALID&quot;</span>))
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
#<span class="enscript-reference">endif</span>
			<span class="enscript-keyword">switch</span> (dp-&gt;it_adrmode) {
				<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM_66r</span>:
				<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMM_66r</span>:
					<span class="enscript-keyword">if</span> (opnd_size_prefix == 0) {
						<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
					}
					<span class="enscript-keyword">break</span>;
				<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM_66o</span>:
					<span class="enscript-keyword">if</span> (opnd_size_prefix == 0) {
						<span class="enscript-comment">/* SSSE3 MMX instructions */</span>
						dp_mmx = *dp;
						dp = &amp;dp_mmx;
						dp-&gt;it_adrmode = MM;
#<span class="enscript-reference">ifdef</span>	<span class="enscript-variable-name">DIS_MEM</span>
						dp-&gt;it_size = 8;
#<span class="enscript-reference">endif</span>
					}
					<span class="enscript-keyword">break</span>;
				<span class="enscript-keyword">case</span> <span class="enscript-reference">CRC32</span>:
					<span class="enscript-keyword">if</span> (rep_prefix != 0xF2) {
						<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
					}
					rep_prefix = 0;
					<span class="enscript-keyword">break</span>;
				<span class="enscript-reference">default</span>:
					<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			}
		} <span class="enscript-keyword">else</span> {
			dp = (instable_t *)&amp;dis_op0F[opcode4][opcode5];
		}
	}

	<span class="enscript-comment">/*
	 * If still not at a TERM decode entry, then a ModRM byte
	 * exists and its fields further decode the instruction.
	 */</span>
	x-&gt;d86_got_modrm = 0;
	<span class="enscript-keyword">if</span> (dp-&gt;it_indirect != TERM) {
		dtrace_get_modrm(x, &amp;mode, &amp;opcode3, &amp;r_m);
		<span class="enscript-keyword">if</span> (x-&gt;d86_error)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		reg = opcode3;

		<span class="enscript-comment">/*
		 * decode 287 instructions (D8-DF) from opcodeN
		 */</span>
		<span class="enscript-keyword">if</span> (opcode1 == 0xD &amp;&amp; opcode2 &gt;= 0x8) {
			<span class="enscript-keyword">if</span> (opcode2 == 0xB &amp;&amp; mode == 0x3 &amp;&amp; opcode3 == 4)
				dp = (instable_t *)&amp;dis_opFP5[r_m];
			<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opcode2 == 0xA &amp;&amp; mode == 0x3 &amp;&amp; opcode3 &lt; 4)
				dp = (instable_t *)&amp;dis_opFP7[opcode3];
			<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opcode2 == 0xB &amp;&amp; mode == 0x3)
				dp = (instable_t *)&amp;dis_opFP6[opcode3];
			<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opcode2 == 0x9 &amp;&amp; mode == 0x3 &amp;&amp; opcode3 &gt;= 4)
				dp = (instable_t *)&amp;dis_opFP4[opcode3 - 4][r_m];
			<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (mode == 0x3)
				dp = (instable_t *)
				    &amp;dis_opFP3[opcode2 - 8][opcode3];
			<span class="enscript-keyword">else</span>
				dp = (instable_t *)
				    &amp;dis_opFP1n2[opcode2 - 8][opcode3];
		} <span class="enscript-keyword">else</span> {
			dp = (instable_t *)dp-&gt;it_indirect + opcode3;
		}
	}

	<span class="enscript-comment">/*
	 * In amd64 bit mode, ARPL opcode is changed to MOVSXD
	 * (sign extend 32bit to 64 bit)
	 */</span>
	<span class="enscript-keyword">if</span> ((vex_prefix == 0) &amp;&amp; cpu_mode == SIZE64 &amp;&amp;
	    opcode1 == 0x6 &amp;&amp; opcode2 == 0x3)
	{
		dp = (instable_t *)&amp;dis_opMOVSLD;
	}

	<span class="enscript-comment">/*
	 * at this point we should have a correct (or invalid) opcode
	 */</span>
	<span class="enscript-keyword">if</span> ((cpu_mode == SIZE64 &amp;&amp; dp-&gt;it_invalid64) ||
	    (cpu_mode != SIZE64 &amp;&amp; dp-&gt;it_invalid32))
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
	<span class="enscript-keyword">if</span> (dp-&gt;it_indirect != TERM)
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

	<span class="enscript-comment">/*
	 * deal with MMX/SSE opcodes which are changed by prefixes
	 */</span>
	<span class="enscript-keyword">switch</span> (dp-&gt;it_adrmode) {
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMO</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOIMPL</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMO3P</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOM3</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOMS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOPM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOPRM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMO</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOMS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOPM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOMX</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOX3</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOXMM</span>:
		<span class="enscript-comment">/*
		 * This is horrible.  Some SIMD instructions take the
		 * form 0x0F 0x?? ..., which is easily decoded using the
		 * existing tables.  Other SIMD instructions use various
		 * prefix bytes to overload existing instructions.  For
		 * Example, addps is F0, 58, whereas addss is F3 (repz),
		 * F0, 58.  Presumably someone got a raise for this.
		 *
		 * If we see one of the instructions which can be
		 * modified in this way (if we've got one of the SIMDO*
		 * address modes), we'll check to see if the last prefix
		 * was a repz.  If it was, we strip the prefix from the
		 * mnemonic, and we indirect using the dis_opSIMDrepz
		 * table.
		 */</span>

		<span class="enscript-comment">/*
		 * Calculate our offset in dis_op0F
		 */</span>
		<span class="enscript-keyword">if</span> ((uintptr_t)dp - (uintptr_t)dis_op0F &gt; <span class="enscript-keyword">sizeof</span> (dis_op0F))
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

		off = ((uintptr_t)dp - (uintptr_t)dis_op0F) /
		    <span class="enscript-keyword">sizeof</span> (instable_t);

		<span class="enscript-comment">/*
		 * Rewrite if this instruction used one of the magic prefixes.
		 */</span>
		<span class="enscript-keyword">if</span> (rep_prefix) {
			<span class="enscript-keyword">if</span> (rep_prefix == 0xf2)
				dp = (instable_t *)&amp;dis_opSIMDrepnz[off];
			<span class="enscript-keyword">else</span>
				dp = (instable_t *)&amp;dis_opSIMDrepz[off];
			rep_prefix = 0;
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opnd_size_prefix) {
			dp = (instable_t *)&amp;dis_opSIMDdata16[off];
			opnd_size_prefix = 0;
			<span class="enscript-keyword">if</span> (opnd_size == SIZE16)
				opnd_size = SIZE32;
		}
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOSH</span>:
		<span class="enscript-comment">/*
		 * As with the &quot;normal&quot; SIMD instructions, the MMX
		 * shuffle instructions are overloaded.  These
		 * instructions, however, are special in that they use
		 * an extra byte, and thus an extra table.  As of this
		 * writing, they only use the opnd_size prefix.
		 */</span>

		<span class="enscript-comment">/*
		 * Calculate our offset in dis_op0F7123
		 */</span>
		<span class="enscript-keyword">if</span> ((uintptr_t)dp - (uintptr_t)dis_op0F7123 &gt;
		    <span class="enscript-keyword">sizeof</span> (dis_op0F7123))
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

		<span class="enscript-keyword">if</span> (opnd_size_prefix) {
			off = ((uintptr_t)dp - (uintptr_t)dis_op0F7123) /
			    <span class="enscript-keyword">sizeof</span> (instable_t);
			dp = (instable_t *)&amp;dis_opSIMD7123[off];
			opnd_size_prefix = 0;
			<span class="enscript-keyword">if</span> (opnd_size == SIZE16)
				opnd_size = SIZE32;
		}
		<span class="enscript-keyword">break</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MRw</span>:
		<span class="enscript-keyword">if</span> (rep_prefix) {
			<span class="enscript-keyword">if</span> (rep_prefix == 0xf3) {

				<span class="enscript-comment">/*
				 * Calculate our offset in dis_op0F
				 */</span>
				<span class="enscript-keyword">if</span> ((uintptr_t)dp - (uintptr_t)dis_op0F
				    &gt; <span class="enscript-keyword">sizeof</span> (dis_op0F))
					<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

				off = ((uintptr_t)dp - (uintptr_t)dis_op0F) /
				    <span class="enscript-keyword">sizeof</span> (instable_t);

				dp = (instable_t *)&amp;dis_opSIMDrepz[off];
				rep_prefix = 0;
			} <span class="enscript-keyword">else</span> {
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			}
		}
		<span class="enscript-keyword">break</span>;
	}

	<span class="enscript-comment">/*
	 * In 64 bit mode, some opcodes automatically use opnd_size == SIZE64.
	 */</span>
	<span class="enscript-keyword">if</span> (cpu_mode == SIZE64)
		<span class="enscript-keyword">if</span> (dp-&gt;it_always64 || (opnd_size == SIZE32 &amp;&amp; dp-&gt;it_stackop))
			opnd_size = SIZE64;

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	<span class="enscript-comment">/*
	 * At this point most instructions can format the opcode mnemonic
	 * including the prefixes.
	 */</span>
	<span class="enscript-keyword">if</span> (lock_prefix)
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;lock &quot;</span>, OPLEN);

	<span class="enscript-keyword">if</span> (rep_prefix == 0xf2)
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;repnz &quot;</span>, OPLEN);
	<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (rep_prefix == 0xf3)
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;repz &quot;</span>, OPLEN);

	<span class="enscript-keyword">if</span> (cpu_mode == SIZE64 &amp;&amp; addr_size_prefix)
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;addr32 &quot;</span>, OPLEN);

	<span class="enscript-keyword">if</span> (dp-&gt;it_adrmode != CBW &amp;&amp;
	    dp-&gt;it_adrmode != CWD &amp;&amp;
	    dp-&gt;it_adrmode != XMMSFNC) {
		<span class="enscript-keyword">if</span> (LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;INVALID&quot;</span>))
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, dp-&gt;it_name, OPLEN);
		<span class="enscript-keyword">if</span> (dp-&gt;it_suffix) {
			<span class="enscript-type">char</span> *types[] = {<span class="enscript-string">&quot;&quot;</span>, <span class="enscript-string">&quot;w&quot;</span>, <span class="enscript-string">&quot;l&quot;</span>, <span class="enscript-string">&quot;q&quot;</span>};
			<span class="enscript-keyword">if</span> (opcode_bytes == 2 &amp;&amp; opcode4 == 4) {
				<span class="enscript-comment">/* It's a cmovx.yy. Replace the suffix x */</span>
				<span class="enscript-keyword">for</span> (i = 5; i &lt; OPLEN; i++) {
					<span class="enscript-keyword">if</span> (x-&gt;d86_mnem[i] == <span class="enscript-string">'.'</span>)
						<span class="enscript-keyword">break</span>;
				}
				x-&gt;d86_mnem[i - 1] = *types[opnd_size];
			} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((opnd_size == 2) &amp;&amp; (opcode_bytes == 3) &amp;&amp;
			    ((opcode6 == 1 &amp;&amp; opcode7 == 6) ||
			    (opcode6 == 2 &amp;&amp; opcode7 == 2))) {
				<span class="enscript-comment">/*
				 * To handle PINSRD and PEXTRD
				 */</span>
				(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;d&quot;</span>, OPLEN);
			} <span class="enscript-keyword">else</span> {
				(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, types[opnd_size],
				    OPLEN);
			}
		}
	}
#<span class="enscript-reference">endif</span>

	<span class="enscript-comment">/*
	 * Process operands based on the addressing modes.
	 */</span>
	x-&gt;d86_mode = cpu_mode;
	<span class="enscript-comment">/*
	 * In vex mode the rex_prefix has no meaning
	 */</span>
	<span class="enscript-keyword">if</span> (!vex_prefix)
		x-&gt;d86_rex_prefix = rex_prefix;
	x-&gt;d86_opnd_size = opnd_size;
	x-&gt;d86_addr_size = addr_size;
	vbit = 0;		<span class="enscript-comment">/* initialize for mem/reg -&gt; reg */</span>
	<span class="enscript-keyword">switch</span> (dp-&gt;it_adrmode) {
		<span class="enscript-comment">/*
		 * amd64 instruction to sign extend 32 bit reg/mem operands
		 * into 64 bit register values
		 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MOVSXZ</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (rex_prefix == 0) {
			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;movzld&quot;</span>, OPLEN);
			x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
		}
#<span class="enscript-reference">endif</span>
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
		x-&gt;d86_opnd_size = SIZE64;
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, 1);
		x-&gt;d86_opnd_size = opnd_size = SIZE32;
		wbit = LONG_OPND;
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;

		<span class="enscript-comment">/*
		 * movsbl movsbw movsbq (0x0FBE) or movswl movswq (0x0FBF)
		 * movzbl movzbw movzbq (0x0FB6) or movzwl movzwq (0x0FB7)
		 * wbit lives in 2nd byte, note that operands
		 * are different sized
		 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MOVZ</span>:
		<span class="enscript-keyword">if</span> (rex_prefix &amp; REX_W) {
			<span class="enscript-comment">/* target register size = 64 bit */</span>
			x-&gt;d86_mnem[5] = <span class="enscript-string">'q'</span>;
		}
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, 1);
		x-&gt;d86_opnd_size = opnd_size = SIZE16;
		wbit = WBIT(opcode5);
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">CRC32</span>:
		opnd_size = SIZE32;
		<span class="enscript-keyword">if</span> (rex_prefix &amp; REX_W)
			opnd_size = SIZE64;
		x-&gt;d86_opnd_size = opnd_size;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, 1);
		wbit = WBIT(opcode7);
		<span class="enscript-keyword">if</span> (opnd_size_prefix)
			x-&gt;d86_opnd_size = opnd_size = SIZE16;
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * imul instruction, with either 8-bit or longer immediate
	 * opcode 0x6B for byte, sign-extended displacement, 0x69 for word(s)
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">IMUL</span>:
		wbit = LONG_OPND;
		THREEOPERAND(x, mode, reg, r_m, rex_prefix, wbit, LONG_OPND,
		    OPSIZE(opnd_size, opcode2 == 0x9), 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* memory or register operand to register, with 'w' bit	*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MRw</span>:
		wbit = WBIT(opcode2);
		STANDARD_MODRM(x, mode, reg, r_m, rex_prefix, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* register to memory or register operand, with 'w' bit	*/</span>
	<span class="enscript-comment">/* arpl happens to fit here also because it is odd */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">RMw</span>:
		<span class="enscript-keyword">if</span> (opcode_bytes == 2)
			wbit = WBIT(opcode5);
		<span class="enscript-keyword">else</span>
			wbit = WBIT(opcode2);
		STANDARD_MODRM(x, mode, reg, r_m, rex_prefix, wbit, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* xaddb instruction */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XADDB</span>:
		wbit = 0;
		STANDARD_MODRM(x, mode, reg, r_m, rex_prefix, wbit, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* MMX register to memory or register operand		*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOS</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		wbit = !LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movd&quot;</span>) ? MM_OPND : LONG_OPND;
#<span class="enscript-reference">else</span>
		wbit = LONG_OPND;
#<span class="enscript-reference">endif</span>
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, MM_OPND, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* MMX register to memory */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOMS</span>:
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		<span class="enscript-keyword">if</span> (mode == REG_ONLY)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		wbit = MM_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, MM_OPND, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* Double shift. Has immediate operand specifying the shift. */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">DSHIFT</span>:
		wbit = LONG_OPND;
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 2);
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, 1);
		dtrace_imm_opnd(x, wbit, 1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * Double shift. With no immediate operand, specifies using %cl.
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">DSHIFTcl</span>:
		wbit = LONG_OPND;
		STANDARD_MODRM(x, mode, reg, r_m, rex_prefix, wbit, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* immediate to memory or register operand */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">IMlw</span>:
		wbit = WBIT(opcode2);
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 1);
		<span class="enscript-comment">/*
		 * Have long immediate for opcode 0x81, but not 0x80 nor 0x83
		 */</span>
		dtrace_imm_opnd(x, wbit, OPSIZE(opnd_size, opcode2 == 1), 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* immediate to memory or register operand with the	*/</span>
	<span class="enscript-comment">/* 'w' bit present					*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">IMw</span>:
		wbit = WBIT(opcode2);
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 1);
		dtrace_imm_opnd(x, wbit, OPSIZE(opnd_size, wbit), 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* immediate to register with register in low 3 bits	*/</span>
	<span class="enscript-comment">/* of op code						*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">IR</span>:
		<span class="enscript-comment">/* w-bit here (with regs) is bit 3 */</span>
		wbit = opcode2 &gt;&gt;3 &amp; 0x1;
		reg = REGNO(opcode2);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, NULL);
		mode = REG_ONLY;
		r_m = reg;
		dtrace_get_operand(x, mode, r_m, wbit, 1);
		dtrace_imm_opnd(x, wbit, OPSIZE64(opnd_size, wbit), 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* MMX immediate shift of register */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMSH</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOSH</span>:
		wbit = MM_OPND;
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">mm_shift</span>;	<span class="enscript-comment">/* in next case */</span>

	<span class="enscript-comment">/* SIMD immediate shift of register */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMSH</span>:
		wbit = XMM_OPND;
<span class="enscript-reference">mm_shift</span>:
		reg = REGNO(opcode7);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, NULL);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);
		dtrace_imm_opnd(x, wbit, 1, 0);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* accumulator to memory operand */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">AO</span>:
		vbit = 1;
		<span class="enscript-comment">/*FALLTHROUGH*/</span>

	<span class="enscript-comment">/* memory operand to accumulator */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">OA</span>:
		wbit = WBIT(opcode2);
		dtrace_get_operand(x, REG_ONLY, EAX_REGNO, wbit, 1 - vbit);
		dtrace_imm_opnd(x, wbit, OPSIZE64(addr_size, LONG_OPND), vbit);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		x-&gt;d86_opnd[vbit].d86_mode = MODE_OFFSET;
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">break</span>;


	<span class="enscript-comment">/* segment register to memory or register operand */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">SM</span>:
		vbit = 1;
		<span class="enscript-comment">/*FALLTHROUGH*/</span>

	<span class="enscript-comment">/* memory or register operand to segment register */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MS</span>:
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, LONG_OPND, vbit);
		dtrace_get_operand(x, REG_ONLY, reg, SEG_OPND, 1 - vbit);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * rotate or shift instructions, which may shift by 1 or
	 * consult the cl register, depending on the 'v' bit
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">Mv</span>:
		vbit = VBIT(opcode2);
		wbit = WBIT(opcode2);
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 1);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (vbit) {
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;%cl&quot;</span>, OPLEN);
		} <span class="enscript-keyword">else</span> {
			x-&gt;d86_opnd[0].d86_mode = MODE_SIGNED;
			x-&gt;d86_opnd[0].d86_value_size = 1;
			x-&gt;d86_opnd[0].d86_value = 1;
		}
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">break</span>;
	<span class="enscript-comment">/*
	 * immediate rotate or shift instructions
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MvI</span>:
		wbit = WBIT(opcode2);
<span class="enscript-reference">normal_imm_mem</span>:
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 1);
		dtrace_imm_opnd(x, wbit, 1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* bit test instructions */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MIb</span>:
		wbit = LONG_OPND;
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">normal_imm_mem</span>;

	<span class="enscript-comment">/* single memory or register operand with 'w' bit present */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">Mw</span>:
		wbit = WBIT(opcode2);
<span class="enscript-reference">just_mem</span>:
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">SWAPGS</span>:
		<span class="enscript-keyword">if</span> (cpu_mode == SIZE64 &amp;&amp; mode == 3 &amp;&amp; r_m == 0) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;swapgs&quot;</span>, OPLEN);
			x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
#<span class="enscript-reference">endif</span>
			NOMEM;
			<span class="enscript-keyword">break</span>;
		}
		<span class="enscript-comment">/*FALLTHROUGH*/</span>

	<span class="enscript-comment">/* prefetch instruction - memory operand, but no memory acess */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">PREF</span>:
		NOMEM;
		<span class="enscript-comment">/*FALLTHROUGH*/</span>

	<span class="enscript-comment">/* single memory or register operand */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">M</span>:
		wbit = LONG_OPND;
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">just_mem</span>;

	<span class="enscript-comment">/* single memory or register byte operand */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">Mb</span>:
		wbit = BYTE_OPND;
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">just_mem</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">MONITOR_MWAIT</span>:
		<span class="enscript-keyword">if</span> (mode == 3) {
			<span class="enscript-keyword">if</span> (r_m == 0) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;monitor&quot;</span>, OPLEN);
				x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
#<span class="enscript-reference">endif</span>
				NOMEM;
				<span class="enscript-keyword">break</span>;
			} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (r_m == 1) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;mwait&quot;</span>, OPLEN);
				x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
#<span class="enscript-reference">endif</span>
				NOMEM;
				<span class="enscript-keyword">break</span>;
			} <span class="enscript-keyword">else</span> {
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			}
		}
		<span class="enscript-comment">/*FALLTHROUGH*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XGETBV_XSETBV</span>:
		<span class="enscript-keyword">if</span> (mode == 3) {
			<span class="enscript-keyword">if</span> (r_m == 0) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;xgetbv&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
				NOMEM;
				<span class="enscript-keyword">break</span>;
			} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (r_m == 1) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;xsetbv&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
				NOMEM;
				<span class="enscript-keyword">break</span>;
			} <span class="enscript-keyword">else</span> {
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
			}

		}
		<span class="enscript-comment">/*FALLTHROUGH*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MO</span>:
		<span class="enscript-comment">/* Similar to M, but only memory (no direct registers) */</span>
		wbit = LONG_OPND;
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		<span class="enscript-keyword">if</span> (mode == 3)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* move special register to register or reverse if vbit */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">SREG</span>:
		<span class="enscript-keyword">switch</span> (opcode5) {

		<span class="enscript-keyword">case</span> <span class="enscript-reference">2</span>:
			vbit = 1;
			<span class="enscript-comment">/*FALLTHROUGH*/</span>
		<span class="enscript-keyword">case</span> <span class="enscript-reference">0</span>:
			wbit = CONTROL_OPND;
			<span class="enscript-keyword">break</span>;

		<span class="enscript-keyword">case</span> <span class="enscript-reference">3</span>:
			vbit = 1;
			<span class="enscript-comment">/*FALLTHROUGH*/</span>
		<span class="enscript-keyword">case</span> <span class="enscript-reference">1</span>:
			wbit = DEBUG_OPND;
			<span class="enscript-keyword">break</span>;

		<span class="enscript-keyword">case</span> <span class="enscript-reference">6</span>:
			vbit = 1;
			<span class="enscript-comment">/*FALLTHROUGH*/</span>
		<span class="enscript-keyword">case</span> <span class="enscript-reference">4</span>:
			wbit = TEST_OPND;
			<span class="enscript-keyword">break</span>;

		}
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, vbit);
		dtrace_get_operand(x, REG_ONLY, r_m, LONG_OPND, 1 - vbit);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * single register operand with register in the low 3
	 * bits of op code
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">R</span>:
		<span class="enscript-keyword">if</span> (opcode_bytes == 2)
			reg = REGNO(opcode5);
		<span class="enscript-keyword">else</span>
			reg = REGNO(opcode2);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, NULL);
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, 0);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * register to accumulator with register in the low 3
	 * bits of op code, xchg instructions
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">RA</span>:
		NOMEM;
		reg = REGNO(opcode2);
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, NULL);
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, 0);
		dtrace_get_operand(x, REG_ONLY, EAX_REGNO, LONG_OPND, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * single segment register operand, with register in
	 * bits 3-4 of op code byte
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">SEG</span>:
		NOMEM;
		reg = (x-&gt;d86_bytes[x-&gt;d86_len - 1] &gt;&gt; 3) &amp; 0x3;
		dtrace_get_operand(x, REG_ONLY, reg, SEG_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * single segment register operand, with register in
	 * bits 3-5 of op code
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">LSEG</span>:
		NOMEM;
		<span class="enscript-comment">/* long seg reg from opcode */</span>
		reg = (x-&gt;d86_bytes[x-&gt;d86_len - 1] &gt;&gt; 3) &amp; 0x7;
		dtrace_get_operand(x, REG_ONLY, reg, SEG_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* memory or register operand to register */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MR</span>:
		<span class="enscript-keyword">if</span> (vex_prefetch) {
			x-&gt;d86_got_modrm = 1;
		}
		wbit = LONG_OPND;
		STANDARD_MODRM(x, mode, reg, r_m, rex_prefix, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">RM</span>:
		wbit = LONG_OPND;
		STANDARD_MODRM(x, mode, reg, r_m, rex_prefix, wbit, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* MMX/SIMD-Int memory or mm reg to mm reg		*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMO</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		wbit = !LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movd&quot;</span>) ? MM_OPND : LONG_OPND;
#<span class="enscript-reference">else</span>
		wbit = LONG_OPND;
#<span class="enscript-reference">endif</span>
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, MM_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOIMPL</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		wbit = !LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movd&quot;</span>) ? MM_OPND : LONG_OPND;
#<span class="enscript-reference">else</span>
		wbit = LONG_OPND;
#<span class="enscript-reference">endif</span>
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		<span class="enscript-keyword">if</span> (mode != REG_ONLY)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		dtrace_get_operand(x, REG_ONLY, reg, MM_OPND, 1);
		mode = 0;	<span class="enscript-comment">/* change for memory access size... */</span>
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* MMX/SIMD-Int and SIMD-FP predicated mm reg to r32 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMO3P</span>:
		wbit = MM_OPND;
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">xmm3p</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM3P</span>:
		wbit = XMM_OPND;
<span class="enscript-reference">xmm3p</span>:
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		<span class="enscript-keyword">if</span> (mode != REG_ONLY)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

		THREEOPERAND(x, mode, reg, r_m, rex_prefix, wbit, LONG_OPND, 1,
		    1);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM3PM_66r</span>:
		THREEOPERAND(x, mode, reg, r_m, rex_prefix, LONG_OPND, XMM_OPND,
		    1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* MMX/SIMD-Int predicated r32/mem to mm reg */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOPRM</span>:
		wbit = LONG_OPND;
		w2 = MM_OPND;
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">xmmprm</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMPRM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMPRM_66r</span>:
		wbit = LONG_OPND;
		w2 = XMM_OPND;
<span class="enscript-reference">xmmprm</span>:
		THREEOPERAND(x, mode, reg, r_m, rex_prefix, wbit, w2, 1, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* MMX/SIMD-Int predicated mm/mem to mm reg */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOPM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOPM_66o</span>:
		wbit = w2 = MM_OPND;
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">xmmprm</span>;

	<span class="enscript-comment">/* MMX/SIMD-Int mm reg to r32 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MMOM3</span>:
		NOMEM;
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		<span class="enscript-keyword">if</span> (mode != REG_ONLY)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		wbit = MM_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, LONG_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD memory or xmm reg operand to xmm reg		*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM_66o</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM_66r</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMO</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMXIMPL</span>:
		wbit = XMM_OPND;
		STANDARD_MODRM(x, mode, reg, r_m, rex_prefix, wbit, 0);

		<span class="enscript-keyword">if</span> (dp-&gt;it_adrmode == XMMXIMPL &amp;&amp; mode != REG_ONLY)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-comment">/*
		 * movlps and movhlps share opcodes.  They differ in the
		 * addressing modes allowed for their operands.
		 * movhps and movlhps behave similarly.
		 */</span>
		<span class="enscript-keyword">if</span> (mode == REG_ONLY) {
			<span class="enscript-keyword">if</span> (LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movlps&quot;</span>))
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;movhlps&quot;</span>, OPLEN);
				x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
			} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movhps&quot;</span>)) {
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;movlhps&quot;</span>, OPLEN);
				x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
		}
		}
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">if</span> (dp-&gt;it_adrmode == XMMXIMPL)
			mode = 0;	<span class="enscript-comment">/* change for memory access size... */</span>
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD xmm reg to memory or xmm reg */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMMS</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOMS</span>:
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> ((LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movlps&quot;</span>) ||
		    LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movhps&quot;</span>) ||
		    LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movntps&quot;</span>)) &amp;&amp;
		    mode == REG_ONLY)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
#<span class="enscript-reference">endif</span>
		wbit = XMM_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, XMM_OPND, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD memory to xmm reg */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMM_66r</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOM</span>:
		wbit = XMM_OPND;
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (mode == REG_ONLY) {
			<span class="enscript-keyword">if</span> (LIT_STRNEQL(dp-&gt;it_name, <span class="enscript-string">&quot;movhps&quot;</span>)) {
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;movlhps&quot;</span>, OPLEN);
				x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
			} <span class="enscript-keyword">else</span>
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		}
#<span class="enscript-reference">endif</span>
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, XMM_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD memory or r32 to xmm reg			*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM3MX</span>:
		wbit = LONG_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, XMM_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM3MXS</span>:
		wbit = LONG_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, XMM_OPND, 1);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD memory or mm reg to xmm reg			*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOMX</span>:
	<span class="enscript-comment">/* SIMD mm to xmm */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMMX</span>:
		wbit = MM_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, XMM_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD memory or xmm reg to mm reg			*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMXMM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOXMM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMXM</span>:
		wbit = XMM_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, MM_OPND, 0);
		<span class="enscript-keyword">break</span>;


	<span class="enscript-comment">/* SIMD memory or xmm reg to r32			*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMXM3</span>:
		wbit = XMM_OPND;
		MIXED_MM(x, mode, reg, r_m, rex_prefix, wbit, LONG_OPND, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD xmm to r32					*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMX3</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOX3</span>:
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		<span class="enscript-keyword">if</span> (mode != REG_ONLY)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, XMM_OPND, 0);
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, 1);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* SIMD predicated memory or xmm reg with/to xmm reg */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMP</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMP_66r</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMP_66o</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMOPM</span>:
		wbit = XMM_OPND;
		THREEOPERAND(x, mode, reg, r_m, rex_prefix, wbit, XMM_OPND, 1,
		    1);

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-comment">/*
		 * cmpps and cmpss vary their instruction name based
		 * on the value of imm8.  Other XMMP instructions,
		 * such as shufps, require explicit specification of
		 * the predicate.
		 */</span>
		<span class="enscript-keyword">if</span> (dp-&gt;it_name[0] == <span class="enscript-string">'c'</span> &amp;&amp;
		    dp-&gt;it_name[1] == <span class="enscript-string">'m'</span> &amp;&amp;
		    dp-&gt;it_name[2] == <span class="enscript-string">'p'</span> &amp;&amp;
		    strlen(dp-&gt;it_name) == 5) {
			uchar_t pred = x-&gt;d86_opnd[0].d86_value &amp; 0xff;

			<span class="enscript-keyword">if</span> (pred &gt;= (<span class="enscript-keyword">sizeof</span> (dis_PREDSUFFIX) / <span class="enscript-keyword">sizeof</span> (<span class="enscript-type">char</span> *)))
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;cmp&quot;</span>, OPLEN);
			x-&gt;d86_mnem[OPLEN - 1] = <span class="enscript-string">'\0'</span>;
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, dis_PREDSUFFIX[pred],
			    OPLEN);
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem,
			    dp-&gt;it_name + strlen(dp-&gt;it_name) - 2,
			    OPLEN);
			x-&gt;d86_opnd[0] = x-&gt;d86_opnd[1];
			x-&gt;d86_opnd[1] = x-&gt;d86_opnd[2];
			x-&gt;d86_numopnds = 2;
		}
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMX2I</span>:
		FOUROPERAND(x, mode, reg, r_m, rex_prefix, XMM_OPND, XMM_OPND,
		    1);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMM2I</span>:
		ONEOPERAND_TWOIMM(x, mode, reg, r_m, rex_prefix, XMM_OPND, 1);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* immediate operand to accumulator */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">IA</span>:
		wbit = WBIT(opcode2);
		dtrace_get_operand(x, REG_ONLY, EAX_REGNO, wbit, 1);
		dtrace_imm_opnd(x, wbit, OPSIZE(opnd_size, wbit), 0);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* memory or register operand to accumulator */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">MA</span>:
		wbit = WBIT(opcode2);
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* si register to di register used to reference memory		*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">SD</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		dtrace_check_override(x, 0);
		x-&gt;d86_numopnds = 2;
		<span class="enscript-keyword">if</span> (addr_size == SIZE64) {
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;(%rsi)&quot;</span>,
			    OPLEN);
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[1].d86_opnd, <span class="enscript-string">&quot;(%rdi)&quot;</span>,
			    OPLEN);
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (addr_size == SIZE32) {
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;(%esi)&quot;</span>,
			    OPLEN);
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[1].d86_opnd, <span class="enscript-string">&quot;(%edi)&quot;</span>,
			    OPLEN);
		} <span class="enscript-keyword">else</span> {
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;(%si)&quot;</span>,
			    OPLEN);
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[1].d86_opnd, <span class="enscript-string">&quot;(%di)&quot;</span>,
			    OPLEN);
		}
#<span class="enscript-reference">endif</span>
		wbit = LONG_OPND;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* accumulator to di register				*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">AD</span>:
		wbit = WBIT(opcode2);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		dtrace_check_override(x, 1);
		x-&gt;d86_numopnds = 2;
		dtrace_get_operand(x, REG_ONLY, EAX_REGNO, wbit, 0);
		<span class="enscript-keyword">if</span> (addr_size == SIZE64)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[1].d86_opnd, <span class="enscript-string">&quot;(%rdi)&quot;</span>,
			    OPLEN);
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (addr_size == SIZE32)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[1].d86_opnd, <span class="enscript-string">&quot;(%edi)&quot;</span>,
			    OPLEN);
		<span class="enscript-keyword">else</span>
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[1].d86_opnd, <span class="enscript-string">&quot;(%di)&quot;</span>,
			    OPLEN);
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* si register to accumulator				*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">SA</span>:
		wbit = WBIT(opcode2);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		dtrace_check_override(x, 0);
		x-&gt;d86_numopnds = 2;
		<span class="enscript-keyword">if</span> (addr_size == SIZE64)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;(%rsi)&quot;</span>,
			    OPLEN);
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (addr_size == SIZE32)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;(%esi)&quot;</span>,
			    OPLEN);
		<span class="enscript-keyword">else</span>
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;(%si)&quot;</span>,
			    OPLEN);
		dtrace_get_operand(x, REG_ONLY, EAX_REGNO, wbit, 1);
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * single operand, a 16/32 bit displacement
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">D</span>:
		wbit = LONG_OPND;
		dtrace_disp_opnd(x, wbit, OPSIZE(opnd_size, LONG_OPND), 0);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* jmp/call indirect to memory or register operand		*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">INM</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_prefix, <span class="enscript-string">&quot;*&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
		dtrace_rex_adjust(rex_prefix, mode, NULL, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, LONG_OPND, 0);
		wbit = LONG_OPND;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * for long jumps and long calls -- a new code segment
	 * register and an offset in IP -- stored in object
	 * code in reverse order. Note - not valid in amd64
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">SO</span>:
		dtrace_check_override(x, 1);
		wbit = LONG_OPND;
		dtrace_imm_opnd(x, wbit, OPSIZE(opnd_size, LONG_OPND), 1);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		x-&gt;d86_opnd[1].d86_mode = MODE_SIGNED;
#<span class="enscript-reference">endif</span>
		<span class="enscript-comment">/* will now get segment operand */</span>
		dtrace_imm_opnd(x, wbit, 2, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * jmp/call. single operand, 8 bit displacement.
	 * added to current EIP in 'compofff'
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">BD</span>:
		dtrace_disp_opnd(x, BYTE_OPND, 1, 0);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* single 32/16 bit immediate operand			*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">I</span>:
		wbit = LONG_OPND;
		dtrace_imm_opnd(x, wbit, OPSIZE(opnd_size, LONG_OPND), 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* single 8 bit immediate operand			*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">Ib</span>:
		wbit = LONG_OPND;
		dtrace_imm_opnd(x, wbit, 1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">ENTER</span>:
		wbit = LONG_OPND;
		dtrace_imm_opnd(x, wbit, 2, 0);
		dtrace_imm_opnd(x, wbit, 1, 1);
		<span class="enscript-keyword">switch</span> (opnd_size) {
		<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE64</span>:
			x-&gt;d86_memsize = (x-&gt;d86_opnd[1].d86_value + 1) * 8;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE32</span>:
			x-&gt;d86_memsize = (x-&gt;d86_opnd[1].d86_value + 1) * 4;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE16</span>:
			x-&gt;d86_memsize = (x-&gt;d86_opnd[1].d86_value + 1) * 2;
			<span class="enscript-keyword">break</span>;
		}

		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* 16-bit immediate operand */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">RET</span>:
		wbit = LONG_OPND;
		dtrace_imm_opnd(x, wbit, 2, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* single 8 bit port operand				*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">P</span>:
		dtrace_check_override(x, 0);
		dtrace_imm_opnd(x, BYTE_OPND, 1, 0);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* single operand, dx register (variable port instruction) */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">V</span>:
		x-&gt;d86_numopnds = 1;
		dtrace_check_override(x, 0);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;(%dx)&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * The int instruction, which has two forms:
	 * int 3 (breakpoint) or
	 * int n, where n is indicated in the subsequent
	 * byte (format Ib).  The int 3 instruction (opcode 0xCC),
	 * where, although the 3 looks  like an operand,
	 * it is implied by the opcode. It must be converted
	 * to the correct base and output.
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">INT3</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		x-&gt;d86_numopnds = 1;
		x-&gt;d86_opnd[0].d86_mode = MODE_SIGNED;
		x-&gt;d86_opnd[0].d86_value_size = 1;
		x-&gt;d86_opnd[0].d86_value = 3;
#<span class="enscript-reference">endif</span>
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* single 8 bit immediate operand			*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">INTx</span>:
		dtrace_imm_opnd(x, BYTE_OPND, 1, 0);
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* an unused byte must be discarded */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">U</span>:
		<span class="enscript-keyword">if</span> (x-&gt;d86_get_byte(x-&gt;d86_data) &lt; 0)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		x-&gt;d86_len++;
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">CBW</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (opnd_size == SIZE16)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;cbtw&quot;</span>, OPLEN);
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opnd_size == SIZE32)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;cwtl&quot;</span>, OPLEN);
		<span class="enscript-keyword">else</span>
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;cltq&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
		wbit = LONG_OPND;
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">CWD</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (opnd_size == SIZE16)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;cwtd&quot;</span>, OPLEN);
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opnd_size == SIZE32)
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;cltd&quot;</span>, OPLEN);
		<span class="enscript-keyword">else</span>
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;cqtd&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
		wbit = LONG_OPND;
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMSFNC</span>:
		<span class="enscript-comment">/*
		 * sfence is sfence if mode is REG_ONLY.  If mode isn't
		 * REG_ONLY, mnemonic should be 'clflush'.
		 */</span>
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);

		<span class="enscript-comment">/* sfence doesn't take operands */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (mode == REG_ONLY) {
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;sfence&quot;</span>, OPLEN);
		} <span class="enscript-keyword">else</span> {
			(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;clflush&quot;</span>, OPLEN);
			dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
			dtrace_get_operand(x, mode, r_m, BYTE_OPND, 0);
			NOMEM;
		}
#<span class="enscript-reference">else</span>
		<span class="enscript-keyword">if</span> (mode != REG_ONLY) {
			dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
			dtrace_get_operand(x, mode, r_m, LONG_OPND, 0);
			NOMEM;
		}
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/*
	 * no disassembly, the mnemonic was all there was so go on
	 */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">NORM</span>:
		<span class="enscript-keyword">if</span> (dp-&gt;it_invalid32 &amp;&amp; cpu_mode != SIZE64)
			<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		NOMEM;
		<span class="enscript-comment">/*FALLTHROUGH*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">IMPLMEM</span>:
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">XMMFENCE</span>:
		<span class="enscript-comment">/*
		 * XRSTOR and LFENCE share the same opcode but differ in mode
		 */</span>
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);

		<span class="enscript-keyword">if</span> (mode == REG_ONLY) {
			<span class="enscript-comment">/*
			 * Only the following exact byte sequences are allowed:
			 *
			 * 	0f ae e8	lfence
			 * 	0f ae f0	mfence
			 */</span>
			<span class="enscript-keyword">if</span> ((uint8_t)x-&gt;d86_bytes[x-&gt;d86_len - 1] != 0xe8 &amp;&amp;
			    (uint8_t)x-&gt;d86_bytes[x-&gt;d86_len - 1] != 0xf0)
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
		} <span class="enscript-keyword">else</span> {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;xrstor&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
			dtrace_rex_adjust(rex_prefix, mode, &amp;reg, &amp;r_m);
			dtrace_get_operand(x, mode, r_m, BYTE_OPND, 0);
		}
		<span class="enscript-keyword">break</span>;


	<span class="enscript-comment">/* float reg */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">F</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		x-&gt;d86_numopnds = 1;
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[0].d86_opnd, <span class="enscript-string">&quot;%st(X)&quot;</span>, OPLEN);
		x-&gt;d86_opnd[0].d86_opnd[4] = r_m + <span class="enscript-string">'0'</span>;
#<span class="enscript-reference">endif</span>
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* float reg to float reg, with ret bit present */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">FF</span>:
		vbit = opcode2 &gt;&gt; 2 &amp; 0x1;	<span class="enscript-comment">/* vbit = 1: st -&gt; st(i) */</span>
		<span class="enscript-comment">/*FALLTHROUGH*/</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">FFC</span>:				<span class="enscript-comment">/* case for vbit always = 0 */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		x-&gt;d86_numopnds = 2;
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[1 - vbit].d86_opnd, <span class="enscript-string">&quot;%st&quot;</span>, OPLEN);
		(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_opnd[vbit].d86_opnd, <span class="enscript-string">&quot;%st(X)&quot;</span>, OPLEN);
		x-&gt;d86_opnd[vbit].d86_opnd[4] = r_m + <span class="enscript-string">'0'</span>;
#<span class="enscript-reference">endif</span>
		NOMEM;
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* AVX instructions */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_MO</span>:
		<span class="enscript-comment">/* op(ModR/M.r/m) */</span>
		x-&gt;d86_numopnds = 1;
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVX0F[0xA][0xE]) &amp;&amp; (reg == 3))
			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;vstmxcsr&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;
	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RMrX</span>:
		<span class="enscript-comment">/* ModR/M.reg := op(VEX.vvvv, ModR/M.r/m) */</span>
		x-&gt;d86_numopnds = 3;
		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

		<span class="enscript-keyword">if</span> (mode != REG_ONLY) {
			<span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVXF20F[0x10]) ||
			    (dp == &amp;dis_opAVXF30F[0x10])) {
				<span class="enscript-comment">/* vmovsd &lt;m64&gt;, &lt;xmm&gt; */</span>
				<span class="enscript-comment">/* or vmovss &lt;m64&gt;, &lt;xmm&gt; */</span>
				x-&gt;d86_numopnds = 2;
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">L_VEX_MX</span>;
			}
		}

		dtrace_get_operand(x, REG_ONLY, reg, wbit, 2);
		<span class="enscript-comment">/*
		 * VEX prefix uses the 1's complement form to encode the
		 * XMM/YMM regs
		 */</span>
		dtrace_get_operand(x, REG_ONLY, (0xF - vex_v), wbit, 1);

		<span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVXF20F[0x2A]) ||
		    (dp == &amp;dis_opAVXF30F[0x2A])) {
			<span class="enscript-comment">/*
			 * vcvtsi2si &lt;/r,m&gt;, &lt;xmm&gt;, &lt;xmm&gt; or vcvtsi2ss &lt;/r,m&gt;,
			 * &lt;xmm&gt;, &lt;xmm&gt;
			 */</span>
			wbit = LONG_OPND;
		}
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((mode == REG_ONLY) &amp;&amp;
		    (dp == &amp;dis_opAVX0F[0x1][0x6])) {	<span class="enscript-comment">/* vmovlhps */</span>
			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;vmovlhps&quot;</span>, OPLEN);
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((mode == REG_ONLY) &amp;&amp;
		    (dp == &amp;dis_opAVX0F[0x1][0x2])) {	<span class="enscript-comment">/* vmovhlps */</span>
			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;vmovhlps&quot;</span>, OPLEN);
		}
#<span class="enscript-reference">endif</span>
		dtrace_get_operand(x, mode, r_m, wbit, 0);

		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RRX</span>:
		<span class="enscript-comment">/* ModR/M.rm := op(VEX.vvvv, ModR/M.reg) */</span>
		x-&gt;d86_numopnds = 3;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

		<span class="enscript-keyword">if</span> (mode != REG_ONLY) {
			<span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVXF20F[0x11]) ||
			    (dp == &amp;dis_opAVXF30F[0x11])) {
				<span class="enscript-comment">/* vmovsd &lt;xmm&gt;, &lt;m64&gt; */</span>
				<span class="enscript-comment">/* or vmovss &lt;xmm&gt;, &lt;m64&gt; */</span>
				x-&gt;d86_numopnds = 2;
				<span class="enscript-keyword">goto</span> <span class="enscript-reference">L_VEX_RM</span>;
			}
		}

		dtrace_get_operand(x, mode, r_m, wbit, 2);
		dtrace_get_operand(x, REG_ONLY, (0xF - vex_v), wbit, 1);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RMRX</span>:
		<span class="enscript-comment">/* ModR/M.reg := op(VEX.vvvv, ModR/M.r_m, imm8[7:4]) */</span>
		x-&gt;d86_numopnds = 4;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 3);
		dtrace_get_operand(x, REG_ONLY, (0xF - vex_v), wbit, 2);
		<span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F3A[0x18]) {
			<span class="enscript-comment">/* vinsertf128 &lt;imm8&gt;, &lt;xmm&gt;, &lt;ymm&gt;, &lt;ymm&gt; */</span>
			dtrace_get_operand(x, mode, r_m, XMM_OPND, 1);
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVX660F3A[0x20]) ||
		    (dp == &amp; dis_opAVX660F[0xC4])) {
			<span class="enscript-comment">/* vpinsrb &lt;imm8&gt;, &lt;reg/mm&gt;, &lt;xmm&gt;, &lt;xmm&gt; */</span>
			<span class="enscript-comment">/* or vpinsrw &lt;imm8&gt;, &lt;reg/mm&gt;, &lt;xmm&gt;, &lt;xmm&gt; */</span>
			dtrace_get_operand(x, mode, r_m, LONG_OPND, 1);
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F3A[0x22]) {
			<span class="enscript-comment">/* vpinsrd/q &lt;imm8&gt;, &lt;reg/mm&gt;, &lt;xmm&gt;, &lt;xmm&gt; */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			<span class="enscript-keyword">if</span> (vex_W)
				x-&gt;d86_mnem[6] = <span class="enscript-string">'q'</span>;
#<span class="enscript-reference">endif</span>
			dtrace_get_operand(x, mode, r_m, LONG_OPND, 1);
		} <span class="enscript-keyword">else</span> {
			dtrace_get_operand(x, mode, r_m, wbit, 1);
		}

		<span class="enscript-comment">/* one byte immediate number */</span>
		dtrace_imm_opnd(x, wbit, 1, 0);

		<span class="enscript-comment">/* vblendvpd, vblendvps, vblendvb use the imm encode the regs */</span>
		<span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVX660F3A[0x4A]) ||
		    (dp == &amp;dis_opAVX660F3A[0x4B]) ||
		    (dp == &amp;dis_opAVX660F3A[0x4C])) {
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			<span class="enscript-type">int</span> regnum = (x-&gt;d86_opnd[0].d86_value &amp; 0xF0) &gt;&gt; 4;
#<span class="enscript-reference">endif</span>
			x-&gt;d86_opnd[0].d86_mode = MODE_NONE;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			<span class="enscript-keyword">if</span> (vex_L)
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_opnd[0].d86_opnd,
				    dis_YMMREG[regnum], OPLEN);
			<span class="enscript-keyword">else</span>
				(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_opnd[0].d86_opnd,
				    dis_XMMREG[regnum], OPLEN);
#<span class="enscript-reference">endif</span>
		}
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_MX</span>:
		<span class="enscript-comment">/* ModR/M.reg := op(ModR/M.rm) */</span>
		x-&gt;d86_numopnds = 2;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
<span class="enscript-reference">L_VEX_MX</span>:

		<span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVXF20F[0xE6]) ||
		    (dp == &amp;dis_opAVX660F[0x5A]) ||
		    (dp == &amp;dis_opAVX660F[0xE6])) {
			<span class="enscript-comment">/* vcvtpd2dq &lt;ymm&gt;, &lt;xmm&gt; */</span>
			<span class="enscript-comment">/* or vcvtpd2ps &lt;ymm&gt;, &lt;xmm&gt; */</span>
			<span class="enscript-comment">/* or vcvttpd2dq &lt;ymm&gt;, &lt;xmm&gt; */</span>
			dtrace_get_operand(x, REG_ONLY, reg, XMM_OPND, 1);
			dtrace_get_operand(x, mode, r_m, wbit, 0);
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> ((dp == &amp;dis_opAVXF30F[0xE6]) ||
		    (dp == &amp;dis_opAVX0F[0x5][0xA]) ||
		    (dp == &amp;dis_opAVX660F38[0x58]) ||
		    (dp == &amp;dis_opAVX660F38[0x59]) ||
		    (dp == &amp;dis_opAVX660F38[0x78]) ||
		    (dp == &amp;dis_opAVX660F38[0x79])) {
			<span class="enscript-comment">/* vcvtdq2pd &lt;xmm&gt;, &lt;ymm&gt; */</span>
			<span class="enscript-comment">/* or vcvtps2pd &lt;xmm&gt;, &lt;ymm&gt; */</span>
			<span class="enscript-comment">/* or vbroadcasts* &lt;xmm&gt;, &lt;ymm&gt; */</span>
			dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);
			dtrace_get_operand(x, mode, r_m, XMM_OPND, 0);
		} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F[0x6E]) {
			<span class="enscript-comment">/* vmovd/q &lt;reg/mem 32/64&gt;, &lt;xmm&gt; */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			<span class="enscript-keyword">if</span> (vex_W)
				x-&gt;d86_mnem[4] = <span class="enscript-string">'q'</span>;
#<span class="enscript-reference">endif</span>
			dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);
			dtrace_get_operand(x, mode, r_m, LONG_OPND, 0);
		} <span class="enscript-keyword">else</span> {
			dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);
			dtrace_get_operand(x, mode, r_m, wbit, 0);
		}

		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_MXI</span>:
		<span class="enscript-comment">/* ModR/M.reg := op(ModR/M.rm, imm8) */</span>
		x-&gt;d86_numopnds = 3;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

		dtrace_get_operand(x, REG_ONLY, reg, wbit, 2);
		dtrace_get_operand(x, mode, r_m, wbit, 1);

		<span class="enscript-comment">/* one byte immediate number */</span>
		dtrace_imm_opnd(x, wbit, 1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_XXI</span>:
		<span class="enscript-comment">/* VEX.vvvv := op(ModR/M.rm, imm8) */</span>
		x-&gt;d86_numopnds = 3;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, dis_AVXvgrp7[opcode2 - 1][reg],
		    OPLEN);
#<span class="enscript-reference">endif</span>
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

		dtrace_get_operand(x, REG_ONLY, (0xF - vex_v), wbit, 2);
		dtrace_get_operand(x, REG_ONLY, r_m, wbit, 1);

		<span class="enscript-comment">/* one byte immediate number */</span>
		dtrace_imm_opnd(x, wbit, 1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_MR</span>:
		<span class="enscript-comment">/* ModR/M.reg (reg32/64) := op(ModR/M.rm) */</span>
		<span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F[0xC5]) {
			<span class="enscript-comment">/* vpextrw &lt;imm8&gt;, &lt;xmm&gt;, &lt;reg&gt; */</span>
			x-&gt;d86_numopnds = 2;
			vbit = 2;
		} <span class="enscript-keyword">else</span> {
			x-&gt;d86_numopnds = 2;
			vbit = 1;
		}

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, REG_ONLY, reg, LONG_OPND, vbit);
		dtrace_get_operand(x, mode, r_m, wbit, vbit - 1);

		<span class="enscript-keyword">if</span> (vbit == 2)
			dtrace_imm_opnd(x, wbit, 1, 0);

		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RRI</span>:
		<span class="enscript-comment">/* implicit(eflags/r32) := op(ModR/M.reg, ModR/M.rm) */</span>
		x-&gt;d86_numopnds = 2;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);
		dtrace_get_operand(x, mode, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RX</span>:
		<span class="enscript-comment">/* ModR/M.rm := op(ModR/M.reg) */</span>
		<span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F3A[0x19]) {	<span class="enscript-comment">/* vextractf128 */</span>
			x-&gt;d86_numopnds = 3;

			dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
			dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

			dtrace_get_operand(x, mode, r_m, XMM_OPND, 2);
			dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);

			<span class="enscript-comment">/* one byte immediate number */</span>
			dtrace_imm_opnd(x, wbit, 1, 0);
			<span class="enscript-keyword">break</span>;
		}

		x-&gt;d86_numopnds = 2;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 1);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RR</span>:
		<span class="enscript-comment">/* ModR/M.rm := op(ModR/M.reg) */</span>
		x-&gt;d86_numopnds = 2;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

		<span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F[0x7E]) {
			<span class="enscript-comment">/* vmovd/q &lt;reg/mem 32/64&gt;, &lt;xmm&gt; */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
			<span class="enscript-keyword">if</span> (vex_W)
				x-&gt;d86_mnem[4] = <span class="enscript-string">'q'</span>;
#<span class="enscript-reference">endif</span>
			dtrace_get_operand(x, mode, r_m, LONG_OPND, 1);
		} <span class="enscript-keyword">else</span>
			dtrace_get_operand(x, mode, r_m, wbit, 1);

		dtrace_get_operand(x, REG_ONLY, reg, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RRi</span>:
		<span class="enscript-comment">/* ModR/M.rm := op(ModR/M.reg, imm) */</span>
		x-&gt;d86_numopnds = 3;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F3A[0x16]) {
			<span class="enscript-comment">/* vpextrd/q &lt;imm&gt;, &lt;xmm&gt;, &lt;reg/mem 32/64&gt; */</span>
			<span class="enscript-keyword">if</span> (vex_W)
				x-&gt;d86_mnem[6] = <span class="enscript-string">'q'</span>;
		}
#<span class="enscript-reference">endif</span>
		dtrace_get_operand(x, mode, r_m, LONG_OPND, 2);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);

		<span class="enscript-comment">/* one byte immediate number */</span>
		dtrace_imm_opnd(x, wbit, 1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RIM</span>:
		<span class="enscript-comment">/* ModR/M.rm := op(ModR/M.reg, imm) */</span>
		x-&gt;d86_numopnds = 3;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

		dtrace_get_operand(x, mode, r_m, XMM_OPND, 2);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);
		<span class="enscript-comment">/* one byte immediate number */</span>
		dtrace_imm_opnd(x, wbit, 1, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RM</span>:
		<span class="enscript-comment">/* ModR/M.rm := op(ModR/M.reg) */</span>
		<span class="enscript-keyword">if</span> (dp == &amp;dis_opAVX660F3A[0x17]) {	<span class="enscript-comment">/* vextractps */</span>
			x-&gt;d86_numopnds = 3;

			dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
			dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);

			dtrace_get_operand(x, mode, r_m, LONG_OPND, 2);
			dtrace_get_operand(x, REG_ONLY, reg, wbit, 1);
			<span class="enscript-comment">/* one byte immediate number */</span>
			dtrace_imm_opnd(x, wbit, 1, 0);
			<span class="enscript-keyword">break</span>;
		}
		x-&gt;d86_numopnds = 2;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
<span class="enscript-reference">L_VEX_RM</span>:
		vbit = 1;
		dtrace_get_operand(x, mode, r_m, wbit, vbit);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, vbit - 1);

		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RRM</span>:
		<span class="enscript-comment">/* ModR/M.rm := op(VEX.vvvv, ModR/M.reg) */</span>
		x-&gt;d86_numopnds = 3;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, mode, r_m, wbit, 2);
		<span class="enscript-comment">/* VEX use the 1's complement form encode the XMM/YMM regs */</span>
		dtrace_get_operand(x, REG_ONLY, (0xF - vex_v), wbit, 1);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_RMX</span>:
		<span class="enscript-comment">/* ModR/M.reg := op(VEX.vvvv, ModR/M.rm) */</span>
		x-&gt;d86_numopnds = 3;

		dtrace_get_modrm(x, &amp;mode, &amp;reg, &amp;r_m);
		dtrace_vex_adjust(vex_byte1, mode, &amp;reg, &amp;r_m);
		dtrace_get_operand(x, REG_ONLY, reg, wbit, 2);
		dtrace_get_operand(x, REG_ONLY, (0xF - vex_v), wbit, 1);
		dtrace_get_operand(x, REG_ONLY, r_m, wbit, 0);
		<span class="enscript-keyword">break</span>;

	<span class="enscript-keyword">case</span> <span class="enscript-reference">VEX_NONE</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
		<span class="enscript-keyword">if</span> (vex_L)
			(<span class="enscript-type">void</span>) strncpy(x-&gt;d86_mnem, <span class="enscript-string">&quot;vzeroall&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
		<span class="enscript-keyword">break</span>;

	<span class="enscript-comment">/* an invalid op code */</span>
	<span class="enscript-keyword">case</span> <span class="enscript-reference">AM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">DM</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">OVERRIDE</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">PREFIX</span>:
	<span class="enscript-keyword">case</span> <span class="enscript-reference">UNKNOWN</span>:
		NOMEM;
	<span class="enscript-reference">default</span>:
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;
	} <span class="enscript-comment">/* end switch */</span>
	<span class="enscript-keyword">if</span> (x-&gt;d86_error)
		<span class="enscript-keyword">goto</span> <span class="enscript-reference">error</span>;

<span class="enscript-reference">done</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_MEM</span>
	<span class="enscript-comment">/*
	 * compute the size of any memory accessed by the instruction
	 */</span>
	<span class="enscript-keyword">if</span> (x-&gt;d86_memsize != 0) {
		<span class="enscript-keyword">return</span> (0);
	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (dp-&gt;it_stackop) {
		<span class="enscript-keyword">switch</span> (opnd_size) {
		<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE16</span>:
			x-&gt;d86_memsize = 2;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE32</span>:
			x-&gt;d86_memsize = 4;
			<span class="enscript-keyword">break</span>;
		<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE64</span>:
			x-&gt;d86_memsize = 8;
			<span class="enscript-keyword">break</span>;
		}
	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (nomem || mode == REG_ONLY) {
		x-&gt;d86_memsize = 0;

	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (dp-&gt;it_size != 0) {
		<span class="enscript-comment">/*
		 * In 64 bit mode descriptor table entries
		 * go up to 10 bytes and popf/pushf are always 8 bytes
		 */</span>
		<span class="enscript-keyword">if</span> (x-&gt;d86_mode == SIZE64 &amp;&amp; dp-&gt;it_size == 6)
			x-&gt;d86_memsize = 10;
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (x-&gt;d86_mode == SIZE64 &amp;&amp; opcode1 == 0x9 &amp;&amp;
		    (opcode2 == 0xc || opcode2 == 0xd))
			x-&gt;d86_memsize = 8;
		<span class="enscript-keyword">else</span>
			x-&gt;d86_memsize = dp-&gt;it_size;

	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (wbit == 0) {
		x-&gt;d86_memsize = 1;

	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (wbit == LONG_OPND) {
		<span class="enscript-keyword">if</span> (opnd_size == SIZE64)
			x-&gt;d86_memsize = 8;
		<span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (opnd_size == SIZE32)
			x-&gt;d86_memsize = 4;
		<span class="enscript-keyword">else</span>
			x-&gt;d86_memsize = 2;

	} <span class="enscript-keyword">else</span> <span class="enscript-keyword">if</span> (wbit == SEG_OPND) {
		x-&gt;d86_memsize = 4;

	} <span class="enscript-keyword">else</span> {
		x-&gt;d86_memsize = 8;
	}
#<span class="enscript-reference">endif</span>
	<span class="enscript-keyword">return</span> (0);

<span class="enscript-reference">error</span>:
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>
	(<span class="enscript-type">void</span>) strlcat(x-&gt;d86_mnem, <span class="enscript-string">&quot;undef&quot;</span>, OPLEN);
#<span class="enscript-reference">endif</span>
	<span class="enscript-keyword">return</span> (1);
}

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">DIS_TEXT</span>

<span class="enscript-comment">/*
 * Some instructions should have immediate operands printed
 * as unsigned integers. We compare against this table.
 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">char</span> *unsigned_ops[] = {
	<span class="enscript-string">&quot;or&quot;</span>, <span class="enscript-string">&quot;and&quot;</span>, <span class="enscript-string">&quot;xor&quot;</span>, <span class="enscript-string">&quot;test&quot;</span>, <span class="enscript-string">&quot;in&quot;</span>, <span class="enscript-string">&quot;out&quot;</span>, <span class="enscript-string">&quot;lcall&quot;</span>, <span class="enscript-string">&quot;ljmp&quot;</span>,
	<span class="enscript-string">&quot;rcr&quot;</span>, <span class="enscript-string">&quot;rcl&quot;</span>, <span class="enscript-string">&quot;ror&quot;</span>, <span class="enscript-string">&quot;rol&quot;</span>, <span class="enscript-string">&quot;shl&quot;</span>, <span class="enscript-string">&quot;shr&quot;</span>, <span class="enscript-string">&quot;sal&quot;</span>, <span class="enscript-string">&quot;psr&quot;</span>, <span class="enscript-string">&quot;psl&quot;</span>,
	0
};


<span class="enscript-type">static</span> <span class="enscript-type">int</span>
<span class="enscript-function-name">isunsigned_op</span>(<span class="enscript-type">char</span> *opcode)
{
	<span class="enscript-type">char</span> *where;
	<span class="enscript-type">int</span> i;
	<span class="enscript-type">int</span> is_unsigned = 0;

	<span class="enscript-comment">/*
	 * Work back to start of last mnemonic, since we may have
	 * prefixes on some opcodes.
	 */</span>
	where = opcode + strlen(opcode) - 1;
	<span class="enscript-keyword">while</span> (where &gt; opcode &amp;&amp; *where != <span class="enscript-string">' '</span>)
		--where;
	<span class="enscript-keyword">if</span> (*where == <span class="enscript-string">' '</span>)
		++where;

	<span class="enscript-keyword">for</span> (i = 0; unsigned_ops[i]; ++i) {
		<span class="enscript-keyword">if</span> (strncmp(where, unsigned_ops[i],
		    strlen(unsigned_ops[i])))
			<span class="enscript-keyword">continue</span>;
		is_unsigned = 1;
		<span class="enscript-keyword">break</span>;
	}
	<span class="enscript-keyword">return</span> (is_unsigned);
}

<span class="enscript-comment">/*
 * Print a numeric immediate into end of buf, maximum length buflen.
 * The immediate may be an address or a displacement.  Mask is set
 * for address size.  If the immediate is a &quot;small negative&quot;, or
 * if it's a negative displacement of any magnitude, print as -&lt;absval&gt;.
 * Respect the &quot;octal&quot; flag.  &quot;Small negative&quot; is defined as &quot;in the
 * interval [NEG_LIMIT, 0)&quot;.
 *
 * Also, &quot;isunsigned_op()&quot; instructions never print negatives.
 *
 * Return whether we decided to print a negative value or not.
 */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">NEG_LIMIT</span>	-255
<span class="enscript-type">enum</span> {IMM, DISP};
<span class="enscript-type">enum</span> {POS, TRY_NEG};

<span class="enscript-type">static</span> <span class="enscript-type">int</span>
<span class="enscript-function-name">print_imm</span>(dis86_t *dis, uint64_t usv, uint64_t mask, <span class="enscript-type">char</span> *buf,
    size_t buflen, <span class="enscript-type">int</span> disp, <span class="enscript-type">int</span> try_neg)
{
	<span class="enscript-type">int</span> curlen;
	int64_t sv = (int64_t)usv;
	<span class="enscript-type">int</span> octal = dis-&gt;d86_flags &amp; DIS_F_OCTAL;

	curlen = strlen(buf);

	<span class="enscript-keyword">if</span> (try_neg == TRY_NEG &amp;&amp; sv &lt; 0 &amp;&amp;
	    (disp || sv &gt;= NEG_LIMIT) &amp;&amp;
	    !isunsigned_op(dis-&gt;d86_mnem)) {
		dis-&gt;d86_sprintf_func(buf + curlen, buflen - curlen,
		    octal ? <span class="enscript-string">&quot;-0%llo&quot;</span> : <span class="enscript-string">&quot;-0x%llx&quot;</span>, (-sv) &amp; mask);
		<span class="enscript-keyword">return</span> (1);
	} <span class="enscript-keyword">else</span> {
		<span class="enscript-keyword">if</span> (disp == DISP)
			dis-&gt;d86_sprintf_func(buf + curlen, buflen - curlen,
			    octal ? <span class="enscript-string">&quot;+0%llo&quot;</span> : <span class="enscript-string">&quot;+0x%llx&quot;</span>, usv &amp; mask);
		<span class="enscript-keyword">else</span>
			dis-&gt;d86_sprintf_func(buf + curlen, buflen - curlen,
			    octal ? <span class="enscript-string">&quot;0%llo&quot;</span> : <span class="enscript-string">&quot;0x%llx&quot;</span>, usv &amp; mask);
		<span class="enscript-keyword">return</span> (0);

	}
}


<span class="enscript-type">static</span> <span class="enscript-type">int</span>
<span class="enscript-function-name">log2</span>(<span class="enscript-type">int</span> size)
{
	<span class="enscript-keyword">switch</span> (size) {
	<span class="enscript-keyword">case</span> <span class="enscript-reference">1</span>: <span class="enscript-keyword">return</span> (0);
	<span class="enscript-keyword">case</span> <span class="enscript-reference">2</span>: <span class="enscript-keyword">return</span> (1);
	<span class="enscript-keyword">case</span> <span class="enscript-reference">4</span>: <span class="enscript-keyword">return</span> (2);
	<span class="enscript-keyword">case</span> <span class="enscript-reference">8</span>: <span class="enscript-keyword">return</span> (3);
	}
	<span class="enscript-keyword">return</span> (0);
}

<span class="enscript-comment">/* ARGSUSED */</span>
<span class="enscript-type">void</span>
<span class="enscript-function-name">dtrace_disx86_str</span>(dis86_t *dis, uint_t mode, uint64_t pc, <span class="enscript-type">char</span> *buf,
    size_t buflen)
{
	uint64_t reltgt = 0;
	uint64_t tgt = 0;
	<span class="enscript-type">int</span> curlen;
	<span class="enscript-type">int</span> (*lookup)(<span class="enscript-type">void</span> *, uint64_t, <span class="enscript-type">char</span> *, size_t);
	<span class="enscript-type">int</span> i;
	int64_t sv;
	uint64_t usv, mask, save_mask, save_usv;
	<span class="enscript-type">static</span> uint64_t masks[] =
	    {0xffU, 0xffffU, 0xffffffffU, 0xffffffffffffffffULL};
	save_usv = 0;

	dis-&gt;d86_sprintf_func(buf, buflen, <span class="enscript-string">&quot;%-6s &quot;</span>, dis-&gt;d86_mnem);

	<span class="enscript-comment">/*
	 * For PC-relative jumps, the pc is really the next pc after executing
	 * this instruction, so increment it appropriately.
	 */</span>
	pc += dis-&gt;d86_len;

	<span class="enscript-keyword">for</span> (i = 0; i &lt; dis-&gt;d86_numopnds; i++) {
		d86opnd_t *op = &amp;dis-&gt;d86_opnd[i];

		<span class="enscript-keyword">if</span> (i != 0)
			(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;,&quot;</span>, buflen);

		(<span class="enscript-type">void</span>) strlcat(buf, op-&gt;d86_prefix, buflen);

		<span class="enscript-comment">/*
		 * sv is for the signed, possibly-truncated immediate or
		 * displacement; usv retains the original size and
		 * unsignedness for symbol lookup.
		 */</span>

		sv = usv = op-&gt;d86_value;

		<span class="enscript-comment">/*
		 * About masks: for immediates that represent
		 * addresses, the appropriate display size is
		 * the effective address size of the instruction.
		 * This includes MODE_OFFSET, MODE_IPREL, and
		 * MODE_RIPREL.  Immediates that are simply
		 * immediate values should display in the operand's
		 * size, however, since they don't represent addresses.
		 */</span>

		<span class="enscript-comment">/* d86_addr_size is SIZEnn, which is log2(real size) */</span>
		mask = masks[dis-&gt;d86_addr_size];

		<span class="enscript-comment">/* d86_value_size and d86_imm_bytes are in bytes */</span>
		<span class="enscript-keyword">if</span> (op-&gt;d86_mode == MODE_SIGNED ||
		    op-&gt;d86_mode == MODE_IMPLIED)
			mask = masks[log2(op-&gt;d86_value_size)];

		<span class="enscript-keyword">switch</span> (op-&gt;d86_mode) {

		<span class="enscript-keyword">case</span> <span class="enscript-reference">MODE_NONE</span>:

			(<span class="enscript-type">void</span>) strlcat(buf, op-&gt;d86_opnd, buflen);
			<span class="enscript-keyword">break</span>;

		<span class="enscript-keyword">case</span> <span class="enscript-reference">MODE_SIGNED</span>:
		<span class="enscript-keyword">case</span> <span class="enscript-reference">MODE_IMPLIED</span>:
		<span class="enscript-keyword">case</span> <span class="enscript-reference">MODE_OFFSET</span>:

			tgt = usv;

			<span class="enscript-keyword">if</span> (dis-&gt;d86_seg_prefix)
				(<span class="enscript-type">void</span>) strlcat(buf, dis-&gt;d86_seg_prefix,
				    buflen);

			<span class="enscript-keyword">if</span> (op-&gt;d86_mode == MODE_SIGNED ||
			    op-&gt;d86_mode == MODE_IMPLIED) {
				(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;$&quot;</span>, buflen);
			}

			<span class="enscript-keyword">if</span> (print_imm(dis, usv, mask, buf, buflen,
			    IMM, TRY_NEG) &amp;&amp;
			    (op-&gt;d86_mode == MODE_SIGNED ||
			    op-&gt;d86_mode == MODE_IMPLIED)) {

				<span class="enscript-comment">/*
				 * We printed a negative value for an
				 * immediate that wasn't a
				 * displacement.  Note that fact so we can
				 * print the positive value as an
				 * annotation.
				 */</span>

				save_usv = usv;
				save_mask = mask;
			}
			(<span class="enscript-type">void</span>) strlcat(buf, op-&gt;d86_opnd, buflen);

			<span class="enscript-keyword">break</span>;

		<span class="enscript-keyword">case</span> <span class="enscript-reference">MODE_IPREL</span>:
		<span class="enscript-keyword">case</span> <span class="enscript-reference">MODE_RIPREL</span>:

			reltgt = pc + sv;

			<span class="enscript-keyword">switch</span> (mode) {
			<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE16</span>:
				reltgt = (uint16_t)reltgt;
				<span class="enscript-keyword">break</span>;
			<span class="enscript-keyword">case</span> <span class="enscript-reference">SIZE32</span>:
				reltgt = (uint32_t)reltgt;
				<span class="enscript-keyword">break</span>;
			}

			(<span class="enscript-type">void</span>) print_imm(dis, usv, mask, buf, buflen,
			    DISP, TRY_NEG);

			<span class="enscript-keyword">if</span> (op-&gt;d86_mode == MODE_RIPREL)
				(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;(%rip)&quot;</span>, buflen);
			<span class="enscript-keyword">break</span>;
		}
	}

	<span class="enscript-comment">/*
	 * The symbol lookups may result in false positives,
	 * particularly on object files, where small numbers may match
	 * the 0-relative non-relocated addresses of symbols.
	 */</span>

	lookup = dis-&gt;d86_sym_lookup;
	<span class="enscript-keyword">if</span> (tgt != 0) {
		<span class="enscript-keyword">if</span> ((dis-&gt;d86_flags &amp; DIS_F_NOIMMSYM) == 0 &amp;&amp;
		    lookup(dis-&gt;d86_data, tgt, NULL, 0) == 0) {
			(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;\t&lt;&quot;</span>, buflen);
			curlen = strlen(buf);
			lookup(dis-&gt;d86_data, tgt, buf + curlen,
			    buflen - curlen);
			(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;&gt;&quot;</span>, buflen);
		}

		<span class="enscript-comment">/*
		 * If we printed a negative immediate above, print the
		 * positive in case our heuristic was unhelpful
		 */</span>
		<span class="enscript-keyword">if</span> (save_usv) {
			(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;\t&lt;&quot;</span>, buflen);
			(<span class="enscript-type">void</span>) print_imm(dis, save_usv, save_mask, buf, buflen,
			    IMM, POS);
			(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;&gt;&quot;</span>, buflen);
		}
	}

	<span class="enscript-keyword">if</span> (reltgt != 0) {
		<span class="enscript-comment">/* Print symbol or effective address for reltgt */</span>

		(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;\t&lt;&quot;</span>, buflen);
		curlen = strlen(buf);
		lookup(dis-&gt;d86_data, reltgt, buf + curlen,
		    buflen - curlen);
		(<span class="enscript-type">void</span>) strlcat(buf, <span class="enscript-string">&quot;&gt;&quot;</span>, buflen);
	}
}

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* DIS_TEXT */</span>
</pre>
<hr />
</body></html>