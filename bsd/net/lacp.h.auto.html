<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>lacp.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">lacp.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

<span class="enscript-comment">/*
 * lacp.h
 * - definitions for the Link Aggregation Control Protocol (LACP) and
 *   the Link Aggregation Marker Protocol
 */</span>

<span class="enscript-comment">/* 
 * Modification History
 *
 * May 14, 2004	Dieter Siegmund (<a href="mailto:dieter@apple.com">dieter@apple.com</a>)
 * - created
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NET_LACP_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_NET_LACP_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/types.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;string.h&gt;</span>

<span class="enscript-comment">/**
 ** Link Aggregation Control Protocol (LACP) definitions
 **/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_VERSION_1</span>		1

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_TLV_TYPE_TERMINATOR</span>	0x00
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_TLV_TYPE_ACTOR</span>		0x01
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_TLV_TYPE_PARTNER</span>	0x02
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_TLV_TYPE_COLLECTOR</span>	0x03

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_ACTOR_TLV_LENGTH</span>	20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_PARTNER_TLV_LENGTH</span>	20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACPDU_COLLECTOR_TLV_LENGTH</span>	16

<span class="enscript-type">typedef</span> u_char lacp_actor_partner_state;
<span class="enscript-type">typedef</span> u_int16_t lacp_key;
<span class="enscript-type">typedef</span> u_int16_t lacp_system_priority, lacp_port_priority, lacp_port;
<span class="enscript-type">typedef</span> u_int16_t lacp_collector_max_delay;
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> {
    u_char 	system_id[6];
} lacp_system, *lacp_system_ref;

<span class="enscript-comment">/*
 * LACP Actor/Partner TLV 
 */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> lacp_actor_partner_tlv_s {
    u_char	lap_tlv_type;		<span class="enscript-comment">/* 0x01 or 0x02 */</span>
    u_char	lap_length;		<span class="enscript-comment">/* 20 */</span>
    u_char	lap_system_priority[2];
    u_char	lap_system[6];
    u_char	lap_key[2];
    u_char	lap_port_priority[2];
    u_char	lap_port[2];
    u_char	lap_state;
    u_char	lap_reserved[3];
} lacp_actor_partner_tlv, *lacp_actor_partner_tlv_ref;

<span class="enscript-comment">/*
 * LACP Collector TLV
 */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> lacp_collector_tlv_s {
    u_char	lac_tlv_type;		<span class="enscript-comment">/* 0x03 */</span>
    u_char	lac_length;		<span class="enscript-comment">/* 16 */</span>
    u_char	lac_max_delay[2];
    u_char	lac_reserved[12];
} lacp_collector_tlv, *lacp_collector_tlv_ref;


<span class="enscript-comment">/* 
 * LACP Actor/Partner State bits
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_LACP_ACTIVITY</span>		0x01
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_LACP_TIMEOUT</span>		0x02
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_AGGREGATION</span>		0x04
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_SYNCHRONIZATION</span>	0x08
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_COLLECTING</span>		0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_DISTRIBUTING</span>		0x20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_DEFAULTED</span>		0x40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_ACTOR_PARTNER_STATE_EXPIRED</span>		0x80

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_active_lacp</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_LACP_ACTIVITY);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_passive_lacp</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_LACP_ACTIVITY);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">int</span>
<span class="enscript-function-name">lacp_actor_partner_state_active_lacp</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_LACP_ACTIVITY) != 0);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_short_timeout</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_LACP_TIMEOUT);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_long_timeout</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_LACP_TIMEOUT);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">int</span>
<span class="enscript-function-name">lacp_actor_partner_state_short_timeout</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_LACP_TIMEOUT) != 0);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_aggregatable</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_AGGREGATION);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_individual</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_AGGREGATION);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_aggregatable</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_AGGREGATION) != 0);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_in_sync</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_SYNCHRONIZATION);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_out_of_sync</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_SYNCHRONIZATION);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">int</span>
<span class="enscript-function-name">lacp_actor_partner_state_in_sync</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_SYNCHRONIZATION) != 0);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_collecting</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_COLLECTING);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_not_collecting</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_COLLECTING);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_collecting</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_COLLECTING) != 0);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_distributing</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_DISTRIBUTING);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_not_distributing</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_DISTRIBUTING);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_distributing</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_DISTRIBUTING) != 0);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_defaulted</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_DEFAULTED);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_not_defaulted</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_DEFAULTED);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_defaulted</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_DEFAULTED) != 0);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_expired</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state | LACP_ACTOR_PARTNER_STATE_EXPIRED);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_set_not_expired</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> (state &amp;= ~LACP_ACTOR_PARTNER_STATE_EXPIRED);
}

<span class="enscript-type">static</span> __inline__ lacp_actor_partner_state
<span class="enscript-function-name">lacp_actor_partner_state_expired</span>(lacp_actor_partner_state state)
{
    <span class="enscript-keyword">return</span> ((state &amp; LACP_ACTOR_PARTNER_STATE_EXPIRED) != 0);
}

<span class="enscript-comment">/*
 * Function: lacp_uint16_set
 * Purpose:
 *   Set a field in a structure that's at least 16 bits to the given
 *   value, putting it into network byte order
 */</span>
<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">lacp_uint16_set</span>(uint8_t * field, uint16_t value)
{
    uint16_t tmp_value = htons(value);
    memcpy((<span class="enscript-type">void</span> *)field, (<span class="enscript-type">void</span> *)&amp;tmp_value, <span class="enscript-keyword">sizeof</span>(uint16_t));
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-comment">/*
 * Function: lacp_uint16_get
 * Purpose:
 *   Get a field in a structure that's at least 16 bits, converting
 *   to host byte order.
 */</span>
<span class="enscript-type">static</span> __inline__ uint16_t
<span class="enscript-function-name">lacp_uint16_get</span>(<span class="enscript-type">const</span> uint8_t * field)
{
    uint16_t tmp_field;
    memcpy((<span class="enscript-type">void</span> *)&amp;tmp_field, (<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)field, <span class="enscript-keyword">sizeof</span>(uint16_t));
    <span class="enscript-keyword">return</span> (ntohs(tmp_field));
}

<span class="enscript-comment">/*
 * Function: lacp_uint32_set
 * Purpose:
 *   Set a field in a structure that's at least 32 bits to the given
 *   value, putting it into network byte order
 */</span>
<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">lacp_uint32_set</span>(uint8_t * field, uint32_t value)
{
    uint32_t tmp_value = htonl(value);
    memcpy((<span class="enscript-type">void</span> *)field, (<span class="enscript-type">void</span> *)&amp;tmp_value, <span class="enscript-keyword">sizeof</span>(uint32_t));
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-comment">/*
 * Function: lacp_uint32_get
 * Purpose:
 *   Get a field in a structure that's at least 32 bits, converting
 *   to host byte order.
 */</span>
<span class="enscript-type">static</span> __inline__ uint32_t
<span class="enscript-function-name">lacp_uint32_get</span>(<span class="enscript-type">const</span> uint8_t * field)
{
    uint32_t tmp_field;
    memcpy((<span class="enscript-type">void</span> *)&amp;tmp_field, (<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)field, <span class="enscript-keyword">sizeof</span>(uint32_t));
    <span class="enscript-keyword">return</span> (ntohl(tmp_field));
}

<span class="enscript-comment">/*
 * LACP Actor/Partner TLV access functions
 */</span>
<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">lacp_actor_partner_tlv_set_system_priority</span>(lacp_actor_partner_tlv_ref tlv, 
					   lacp_system_priority system_priority)
{
    lacp_uint16_set(tlv-&gt;lap_system_priority, system_priority);
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ lacp_system_priority
<span class="enscript-function-name">lacp_actor_partner_tlv_get_system_priority</span>(<span class="enscript-type">const</span> lacp_actor_partner_tlv_ref tlv)
{
    <span class="enscript-keyword">return</span> (lacp_system_priority)lacp_uint16_get(tlv-&gt;lap_system_priority);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">lacp_actor_partner_tlv_set_key</span>(lacp_actor_partner_tlv_ref tlv, lacp_key key)
{
    lacp_uint16_set(tlv-&gt;lap_key, key);
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ lacp_key
<span class="enscript-function-name">lacp_actor_partner_tlv_get_key</span>(<span class="enscript-type">const</span> lacp_actor_partner_tlv_ref tlv)
{
    <span class="enscript-keyword">return</span> (lacp_key)lacp_uint16_get(tlv-&gt;lap_key);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">lacp_actor_partner_tlv_set_port_priority</span>(lacp_actor_partner_tlv_ref tlv, 
					 lacp_port_priority port_priority)
{
    lacp_uint16_set(tlv-&gt;lap_port_priority, port_priority);
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ lacp_port_priority
<span class="enscript-function-name">lacp_actor_partner_tlv_get_port_priority</span>(<span class="enscript-type">const</span> lacp_actor_partner_tlv_ref tlv)
{
    <span class="enscript-keyword">return</span> (lacp_port_priority)lacp_uint16_get(tlv-&gt;lap_port_priority);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">lacp_actor_partner_tlv_set_port</span>(lacp_actor_partner_tlv_ref tlv, lacp_port port)
{
    lacp_uint16_set(tlv-&gt;lap_port, port);
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ lacp_port
<span class="enscript-function-name">lacp_actor_partner_tlv_get_port</span>(<span class="enscript-type">const</span> lacp_actor_partner_tlv_ref tlv)
{
    <span class="enscript-keyword">return</span> (lacp_port)lacp_uint16_get(tlv-&gt;lap_port);
}

<span class="enscript-comment">/*
 * LACP Collector TLV access functions
 */</span>
<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">lacp_collector_tlv_set_max_delay</span>(lacp_collector_tlv_ref tlv, 
				 lacp_collector_max_delay delay)
{
    lacp_uint16_set(tlv-&gt;lac_max_delay, delay);
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ lacp_collector_max_delay
<span class="enscript-function-name">lacp_collector_tlv_get_max_delay</span>(<span class="enscript-type">const</span> lacp_collector_tlv_ref tlv)
{
    <span class="enscript-keyword">return</span> (lacp_collector_max_delay)lacp_uint16_get(tlv-&gt;lac_max_delay);
}

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> lacpdu_s {
    u_char		la_subtype;
    u_char		la_version;
    u_char		la_actor_tlv[LACPDU_ACTOR_TLV_LENGTH];
    u_char		la_partner_tlv[LACPDU_PARTNER_TLV_LENGTH];
    u_char		la_collector_tlv[LACPDU_COLLECTOR_TLV_LENGTH];
    u_char		la_terminator_type;
    u_char		la_terminator_length;
    u_char		la_reserved[50];
} lacpdu, *lacpdu_ref;

<span class="enscript-comment">/* timer values in seconds */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_FAST_PERIODIC_TIME</span>		1 
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_SLOW_PERIODIC_TIME</span>		30
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_SHORT_TIMEOUT_TIME</span>		3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_LONG_TIMEOUT_TIME</span>		90
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_CHURN_DETECTION_TIME</span>	60
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_AGGREGATE_WAIT_TIME</span>	2

<span class="enscript-comment">/* packet rate per second */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LACP_PACKET_RATE</span>		3

<span class="enscript-comment">/**
 ** Link Aggregation Marker Protocol definitions
 **/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LA_MARKER_PDU_VERSION_1</span>			1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LA_MARKER_TLV_TYPE_TERMINATOR</span>		0x00
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LA_MARKER_TLV_TYPE_MARKER</span>		0x01
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LA_MARKER_TLV_TYPE_MARKER_RESPONSE</span>	0x02

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LA_MARKER_TLV_LENGTH</span>			16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LA_MARKER_RESPONSE_TLV_LENGTH</span>		16

<span class="enscript-type">typedef</span> u_int32_t la_marker_transaction_id;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> la_marker_pdu_s {
    u_char		lm_subtype;		<span class="enscript-comment">/* 0x02 */</span>
    u_char		lm_version;		<span class="enscript-comment">/* 0x01 */</span>
    u_char		lm_marker_tlv_type;	<span class="enscript-comment">/* 0x01 or 0x02 */</span>
    u_char		lm_marker_tlv_length;	<span class="enscript-comment">/* 16 */</span>
    u_char		lm_requestor_port[2];
    u_char		lm_requestor_system[6];
    u_char		lm_requestor_transaction_id[4];
    u_char		lm_pad[2];
    u_char		lm_terminator_type;	<span class="enscript-comment">/* 0x00 */</span>
    u_char		lm_terminator_length;	<span class="enscript-comment">/* 0 */</span>
    u_char		lm_reserved[90];
} la_marker_pdu, *la_marker_pdu_ref, 
    la_marker_response_pdu, * la_marker_response_pdu_ref;

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">la_marker_pdu_set_requestor_port</span>(la_marker_pdu_ref lmpdu, lacp_port port)
{
    lacp_uint16_set(lmpdu-&gt;lm_requestor_port, port);
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ lacp_port
<span class="enscript-function-name">la_marker_pdu_get_requestor_port</span>(la_marker_pdu_ref lmpdu)
{
    <span class="enscript-keyword">return</span> (lacp_port)lacp_uint16_get(lmpdu-&gt;lm_requestor_port);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">la_marker_pdu_set_requestor_transaction_id</span>(la_marker_pdu_ref lmpdu, 
					   la_marker_transaction_id xid)
{
    lacp_uint32_set(lmpdu-&gt;lm_requestor_transaction_id, xid);
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ la_marker_transaction_id
<span class="enscript-function-name">la_marker_pdu_get_requestor_transaction_id</span>(la_marker_pdu_ref lmpdu)
{
    <span class="enscript-keyword">return</span> (la_marker_transaction_id)lacp_uint32_get(lmpdu-&gt;lm_requestor_transaction_id);
}

<span class="enscript-type">static</span> __inline__ <span class="enscript-type">void</span>
<span class="enscript-function-name">la_marker_pdu_set_requestor_system</span>(la_marker_pdu_ref lmpdu, lacp_system sys)
{
    *((lacp_system_ref)lmpdu-&gt;lm_requestor_system) = sys;
    <span class="enscript-keyword">return</span>;
}

<span class="enscript-type">static</span> __inline__ lacp_system
<span class="enscript-function-name">la_marker_pdu_get_requestor_system</span>(la_marker_pdu_ref lmpdu)
{
    <span class="enscript-keyword">return</span> (*(lacp_system_ref)(lmpdu-&gt;lm_requestor_system));
}

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _NET_LACP_H_ */</span>
</pre>
<hr />
</body></html>