<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>bpf.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">bpf.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2014 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*
 * Copyright (c) 1990, 1991, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * This code is derived from the Stanford/CMU enet packet filter,
 * (net/enet.c) distributed as part of 4.3BSD, and code contributed
 * to Berkeley by Steven McCanne and Van Jacobson both of Lawrence
 * Berkeley Laboratory.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *      @(#)bpf.h	8.1 (Berkeley) 6/10/93
 *	@(#)bpf.h	1.34 (LBL)     6/16/96
 *
 * $FreeBSD: src/sys/net/bpf.h,v 1.21.2.3 2001/08/01 00:23:13 fenner Exp $
 */</span>
<span class="enscript-comment">/*
 * NOTICE: This file was modified by SPARTA, Inc. in 2006 to introduce
 * support for mandatory and extensible security protections.  This notice
 * is included in support of clause 2.2 (b) of the Apple Public License,
 * Version 2.0.
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NET_BPF_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_NET_BPF_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/param.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/types.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/time.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/cdefs.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;stdint.h&gt;</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/kernel_types.h&gt;</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* BSD style release date */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BPF_RELEASE</span> 199606

<span class="enscript-type">typedef</span>	int32_t	  bpf_int32;
<span class="enscript-type">typedef</span>	u_int32_t bpf_u_int32;

<span class="enscript-comment">/*
 * Alignment macros.  BPF_WORDALIGN rounds up to the next
 * even multiple of BPF_ALIGNMENT.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_ALIGNMENT</span> sizeof(int32_t)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_WORDALIGN</span>(x) (((x)+(BPF_ALIGNMENT-1))&amp;~(BPF_ALIGNMENT-1))

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_MAXINSNS</span> 512
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_MAXBUFSIZE</span> 0x80000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_MINBUFSIZE</span> 32

<span class="enscript-comment">/*
 *  Structure for BIOCSETF.
 */</span>
<span class="enscript-type">struct</span> bpf_program {
	u_int bf_len;
	<span class="enscript-type">struct</span> bpf_insn *bf_insns;
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-comment">/* LP64 version of bpf_program.  all pointers 
 * grow when we're dealing with a 64-bit process.
 * WARNING - keep in sync with bpf_program
 */</span>
<span class="enscript-type">struct</span> bpf_program64 {
	u_int		bf_len;
	user64_addr_t	bf_insns __attribute__((aligned(8)));
};

<span class="enscript-type">struct</span> bpf_program32 {
	u_int		bf_len;
	user32_addr_t	bf_insns;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

<span class="enscript-comment">/*
 * Struct returned by BIOCGSTATS.
 */</span>
<span class="enscript-type">struct</span> bpf_stat {
	u_int bs_recv;		<span class="enscript-comment">/* number of packets received */</span>
	u_int bs_drop;		<span class="enscript-comment">/* number of packets dropped */</span>
};

<span class="enscript-comment">/*
 * Struct return by BIOCVERSION.  This represents the version number of
 * the filter language described by the instruction encodings below.
 * bpf understands a program iff kernel_major == filter_major &amp;&amp;
 * kernel_minor &gt;= filter_minor, that is, if the value returned by the
 * running kernel has the same major number and a minor number equal
 * equal to or less than the filter being downloaded.  Otherwise, the
 * results are undefined, meaning an error may be returned or packets
 * may be accepted haphazardly.
 * It has nothing to do with the source code version.
 */</span>
<span class="enscript-type">struct</span> bpf_version {
	u_short bv_major;
	u_short bv_minor;
};
#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__LP64__</span>)
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_timeval32.h&gt;</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_TIMEVAL</span> timeval32
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_TIMEVAL</span> timeval
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __LP64__ */</span>
<span class="enscript-comment">/* Current version number of filter architecture. */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_MAJOR_VERSION</span> 1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_MINOR_VERSION</span> 1

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCGBLEN</span>	_IOR(<span class="enscript-string">'B'</span>,102, u_int)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSBLEN</span>	_IOWR(<span class="enscript-string">'B'</span>,102, u_int)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSETF</span>	_IOW(<span class="enscript-string">'B'</span>,103, struct bpf_program)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSETF64</span>	_IOW(<span class="enscript-string">'B'</span>,103, struct bpf_program64)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSETF32</span>	_IOW(<span class="enscript-string">'B'</span>,103, struct bpf_program32)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCFLUSH</span>	_IO(<span class="enscript-string">'B'</span>,104)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCPROMISC</span>	_IO(<span class="enscript-string">'B'</span>,105)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCGDLT</span>	_IOR(<span class="enscript-string">'B'</span>,106, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGETIF</span>	_IOR(<span class="enscript-string">'B'</span>,107, struct ifreq)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSETIF</span>	_IOW(<span class="enscript-string">'B'</span>,108, struct ifreq)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSRTIMEOUT</span>	_IOW(<span class="enscript-string">'B'</span>,109, struct timeval)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSRTIMEOUT64</span>	_IOW(<span class="enscript-string">'B'</span>,109, struct user64_timeval)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSRTIMEOUT32</span>	_IOW(<span class="enscript-string">'B'</span>,109, struct user32_timeval)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGRTIMEOUT</span>	_IOR(<span class="enscript-string">'B'</span>,110, struct timeval)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGRTIMEOUT64</span>	_IOR(<span class="enscript-string">'B'</span>,110, struct user64_timeval)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGRTIMEOUT32</span>	_IOR(<span class="enscript-string">'B'</span>,110, struct user32_timeval)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGSTATS</span>	_IOR(<span class="enscript-string">'B'</span>,111, struct bpf_stat)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCIMMEDIATE</span>	_IOW(<span class="enscript-string">'B'</span>,112, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCVERSION</span>	_IOR(<span class="enscript-string">'B'</span>,113, struct bpf_version)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGRSIG</span>	_IOR(<span class="enscript-string">'B'</span>,114, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSRSIG</span>	_IOW(<span class="enscript-string">'B'</span>,115, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGHDRCMPLT</span>	_IOR(<span class="enscript-string">'B'</span>,116, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSHDRCMPLT</span>	_IOW(<span class="enscript-string">'B'</span>,117, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGSEESENT</span>	_IOR(<span class="enscript-string">'B'</span>,118, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSSEESENT</span>	_IOW(<span class="enscript-string">'B'</span>,119, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSDLT</span>        _IOW(<span class="enscript-string">'B'</span>,120, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGDLTLIST</span>    _IOWR(<span class="enscript-string">'B'</span>,121, struct bpf_dltlist)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCGETTC</span>	_IOR(<span class="enscript-string">'B'</span>, 122, int)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSETTC</span>	_IOW(<span class="enscript-string">'B'</span>, 123, int)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSEXTHDR</span>	_IOW(<span class="enscript-string">'B'</span>, 124, u_int)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCGIFATTACHCOUNT</span>	_IOWR(<span class="enscript-string">'B'</span>, 125, struct ifreq)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSETFNR</span>      _IOW(<span class="enscript-string">'B'</span>, 126, struct bpf_program)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSETFNR64</span>	_IOW(<span class="enscript-string">'B'</span>,126, struct bpf_program64)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSETFNR32</span>	_IOW(<span class="enscript-string">'B'</span>,126, struct bpf_program32)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCGWANTPKTAP</span>	_IOR(<span class="enscript-string">'B'</span>, 127, u_int)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BIOCSWANTPKTAP</span>	_IOWR(<span class="enscript-string">'B'</span>, 127, u_int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCSHEADDROP</span>   _IOW(<span class="enscript-string">'B'</span>, 128, int)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BIOCGHEADDROP</span>   _IOR(<span class="enscript-string">'B'</span>, 128, int)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>
<span class="enscript-comment">/*
 * Structure prepended to each packet.
 */</span>
<span class="enscript-type">struct</span> bpf_hdr {
	<span class="enscript-type">struct</span> BPF_TIMEVAL bh_tstamp;	<span class="enscript-comment">/* time stamp */</span>
	bpf_u_int32	bh_caplen;	<span class="enscript-comment">/* length of captured portion */</span>
	bpf_u_int32	bh_datalen;	<span class="enscript-comment">/* original length of packet */</span>
	u_short		bh_hdrlen;	<span class="enscript-comment">/* length of bpf header (this struct
					   plus alignment padding) */</span>
};
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/*
 * Because the structure above is not a multiple of 4 bytes, some compilers
 * will insist on inserting padding; hence, sizeof(struct bpf_hdr) won't work.
 * Only the kernel needs to know about it; applications use bh_hdrlen.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIZEOF_BPF_HDR</span>	(sizeof(struct bpf_hdr) &lt;= 20 ? 18 : \
    <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">struct</span> bpf_hdr))
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/*
 * This structure must be a multiple of 4 bytes.
 * It includes padding and spare fields that we can use later if desired.
 */</span>
<span class="enscript-type">struct</span> bpf_hdr_ext {
	<span class="enscript-type">struct</span> BPF_TIMEVAL bh_tstamp;	<span class="enscript-comment">/* time stamp */</span>
	bpf_u_int32	bh_caplen;	<span class="enscript-comment">/* length of captured portion */</span>
	bpf_u_int32	bh_datalen;	<span class="enscript-comment">/* original length of packet */</span>
	u_short		bh_hdrlen;	<span class="enscript-comment">/* length of bpf header */</span>
	u_short		bh_flags;
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_HDR_EXT_FLAGS_DIR_IN</span>	0x0000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_HDR_EXT_FLAGS_DIR_OUT</span>	0x0001
	pid_t		bh_pid;		<span class="enscript-comment">/* process PID */</span>
	<span class="enscript-type">char</span>		bh_comm[MAXCOMLEN+1]; <span class="enscript-comment">/* process command */</span>
	u_char		_bh_pad2[2];
	u_char		bh_proto;	<span class="enscript-comment">/* kernel reserved; 0 in userland */</span>
	bpf_u_int32	bh_svc;		<span class="enscript-comment">/* service class */</span>
	bpf_u_int32	bh_flowid;	<span class="enscript-comment">/* kernel reserved; 0 in userland */</span>
};

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_CONTROL_NAME</span>	<span class="enscript-string">&quot;com.apple.net.bpf&quot;</span>

<span class="enscript-type">struct</span> bpf_mtag {
	<span class="enscript-type">char</span>		bt_comm[MAXCOMLEN];
	pid_t		bt_pid;
	bpf_u_int32	bt_svc;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">char</span>	bt_direction;
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BPF_MTAG_DIR_IN</span>		0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BPF_MTAG_DIR_OUT</span>	1
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

<span class="enscript-comment">/*
 * Data-link level type codes.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_NULL</span>	0	<span class="enscript-comment">/* no link-layer encapsulation */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_EN10MB</span>	1	<span class="enscript-comment">/* Ethernet (10Mb) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_EN3MB</span>	2	<span class="enscript-comment">/* Experimental Ethernet (3Mb) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_AX25</span>	3	<span class="enscript-comment">/* Amateur Radio AX.25 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PRONET</span>	4	<span class="enscript-comment">/* Proteon ProNET Token Ring */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_CHAOS</span>	5	<span class="enscript-comment">/* Chaos */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802</span>	6	<span class="enscript-comment">/* IEEE 802 Networks */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ARCNET</span>	7	<span class="enscript-comment">/* ARCNET */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_SLIP</span>	8	<span class="enscript-comment">/* Serial Line IP */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPP</span>		9	<span class="enscript-comment">/* Point-to-point Protocol */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_FDDI</span>	10	<span class="enscript-comment">/* FDDI */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ATM_RFC1483</span>	11	<span class="enscript-comment">/* LLC/SNAP encapsulated atm */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_RAW</span>		12	<span class="enscript-comment">/* raw IP */</span>

<span class="enscript-comment">/*
 * These are values from BSD/OS's &quot;bpf.h&quot;.
 * These are not the same as the values from the traditional libpcap
 * &quot;bpf.h&quot;; however, these values shouldn't be generated by any
 * OS other than BSD/OS, so the correct values to use here are the
 * BSD/OS values.
 *
 * Platforms that have already assigned these values to other
 * DLT_ codes, however, should give these codes the values
 * from that platform, so that programs that use these codes will
 * continue to compile - even though they won't correctly read
 * files of these types.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_SLIP_BSDOS</span>	15	<span class="enscript-comment">/* BSD/OS Serial Line IP */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPP_BSDOS</span>	16	<span class="enscript-comment">/* BSD/OS Point-to-point Protocol */</span>

<span class="enscript-comment">/*
 * 17 was used for DLT_PFLOG in OpenBSD; it no longer is.
 *
 * It was DLT_LANE8023 in SuSE 6.3, so we defined LINKTYPE_PFLOG
 * as 117 so that pflog captures would use a link-layer header type
 * value that didn't collide with any other values.  On all
 * platforms other than OpenBSD, we defined DLT_PFLOG as 117,
 * and we mapped between LINKTYPE_PFLOG and DLT_PFLOG.
 *
 * OpenBSD eventually switched to using 117 for DLT_PFLOG as well.
 *
 * Don't use 17 for anything else.
 */</span>

<span class="enscript-comment">/*
 * 18 is used for DLT_PFSYNC in OpenBSD, NetBSD, DragonFly BSD and
 * Mac OS X; don't use it for anything else.  (FreeBSD uses 121,
 * which collides with DLT_HHDLC, even though it doesn't use 18
 * for anything and doesn't appear to have ever used it for anything.)
 *
 * We define it as 18 on those platforms; it is, unfortunately, used
 * for DLT_CIP in Suse 6.3, so we don't define it as DLT_PFSYNC
 * in general.  As the packet format for it, like that for
 * DLT_PFLOG, is not only OS-dependent but OS-version-dependent,
 * we don't support printing it in tcpdump except on OSes that
 * have the relevant header files, so it's not that useful on
 * other platforms.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DLT_PFSYNC</span>	18	<span class="enscript-comment">/* Packet filter state syncing */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ATM_CLIP</span>	19	<span class="enscript-comment">/* Linux Classical-IP over ATM */</span>

<span class="enscript-comment">/*
 * These values are defined by NetBSD; other platforms should refrain from
 * using them for other purposes, so that NetBSD savefiles with link
 * types of 50 or 51 can be read as this type on all platforms.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPP_SERIAL</span>	50	<span class="enscript-comment">/* PPP over serial with HDLC encapsulation */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPP_ETHER</span>	51	<span class="enscript-comment">/* PPP over Ethernet */</span>

<span class="enscript-comment">/*
 * The Axent Raptor firewall - now the Symantec Enterprise Firewall - uses
 * a link-layer type of 99 for the tcpdump it supplies.  The link-layer
 * header has 6 bytes of unknown data, something that appears to be an
 * Ethernet type, and 36 bytes that appear to be 0 in at least one capture
 * I've seen.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_SYMANTEC_FIREWALL</span>	99

<span class="enscript-comment">/*
 * Values between 100 and 103 are used in capture file headers as
 * link-layer header type LINKTYPE_ values corresponding to DLT_ types
 * that differ between platforms; don't use those values for new DLT_
 * new types.
 */</span>

<span class="enscript-comment">/*
 * Values starting with 104 are used for newly-assigned link-layer
 * header type values; for those link-layer header types, the DLT_
 * value returned by pcap_datalink() and passed to pcap_open_dead(),
 * and the LINKTYPE_ value that appears in capture files, are the
 * same.
 *
 * DLT_MATCHING_MIN is the lowest such value; DLT_MATCHING_MAX is
 * the highest such value.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MATCHING_MIN</span>	104

<span class="enscript-comment">/*
 * This value was defined by libpcap 0.5; platforms that have defined
 * it with a different value should define it here with that value -
 * a link type of 104 in a save file will be mapped to DLT_C_HDLC,
 * whatever value that happens to be, so programs will correctly
 * handle files with that link type regardless of the value of
 * DLT_C_HDLC.
 *
 * The name DLT_C_HDLC was used by BSD/OS; we use that name for source
 * compatibility with programs written for BSD/OS.
 *
 * libpcap 0.5 defined it as DLT_CHDLC; we define DLT_CHDLC as well,
 * for source compatibility with programs written for libpcap 0.5.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_C_HDLC</span>	104	<span class="enscript-comment">/* Cisco HDLC */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_CHDLC</span>	DLT_C_HDLC

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_11</span>	105	<span class="enscript-comment">/* IEEE 802.11 wireless */</span>

<span class="enscript-comment">/*
 * Values between 106 and 107 are used in capture file headers as
 * link-layer types corresponding to DLT_ types that might differ
 * between platforms; don't use those values for new DLT_ new types.
 */</span>

<span class="enscript-comment">/*
 * Frame Relay; BSD/OS has a DLT_FR with a value of 11, but that collides
 * with other values.
 * DLT_FR and DLT_FRELAY packets start with the Q.922 Frame Relay header
 * (DLCI, etc.).
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_FRELAY</span>	107

<span class="enscript-comment">/*
 * OpenBSD DLT_LOOP, for loopback devices; it's like DLT_NULL, except
 * that the AF_ type in the link-layer header is in network byte order.
 *
 * OpenBSD defines it as 12, but that collides with DLT_RAW, so we
 * define it as 108 here.  If OpenBSD picks up this file, it should
 * define DLT_LOOP as 12 in its version, as per the comment above -
 * and should not use 108 for any purpose.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LOOP</span>	108

<span class="enscript-comment">/*
 * Values between 109 and 112 are used in capture file headers as
 * link-layer types corresponding to DLT_ types that might differ
 * between platforms; don't use those values for new DLT_ new types.
 */</span>

<span class="enscript-comment">/*
 * Encapsulated packets for IPsec; DLT_ENC is 13 in OpenBSD, but that's
 * DLT_SLIP_BSDOS in NetBSD, so we don't use 13 for it in OSes other
 * than OpenBSD.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ENC</span>	109

<span class="enscript-comment">/*
 * This is for Linux cooked sockets.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LINUX_SLL</span>	113

<span class="enscript-comment">/*
 * Apple LocalTalk hardware.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LTALK</span>	114

<span class="enscript-comment">/*
 * Acorn Econet.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ECONET</span>	115

<span class="enscript-comment">/*
 * Reserved for use with OpenBSD ipfilter.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IPFILTER</span>	116

<span class="enscript-comment">/*
 * For use in capture-file headers as a link-layer type corresponding
 * to OpenBSD PF (Packet Filter) log.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DLT_PFLOG</span>	117

<span class="enscript-comment">/*
 * Registered for Cisco-internal use.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_CISCO_IOS</span>	118

<span class="enscript-comment">/*
 * Reserved for 802.11 cards using the Prism II chips, with a link-layer
 * header including Prism monitor mode information plus an 802.11
 * header.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PRISM_HEADER</span>	119

<span class="enscript-comment">/*
 * Reserved for Aironet 802.11 cards, with an Aironet link-layer header
 * (see Doug Ambrisko's FreeBSD patches).
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_AIRONET_HEADER</span>	120

<span class="enscript-comment">/*
 * Reserved for Siemens HiPath HDLC. XXX
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_HHDLC</span>	121

<span class="enscript-comment">/*
 * Reserved for RFC 2625 IP-over-Fibre Channel.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IP_OVER_FC</span>	122

<span class="enscript-comment">/*
 * Reserved for Full Frontal ATM on Solaris.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_SUNATM</span>	123

<span class="enscript-comment">/*
 * Reserved as per request from Kent Dahlgren &lt;<a href="mailto:kent@praesum.com">kent@praesum.com</a>&gt;
 * for private use.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_RIO</span>		124	<span class="enscript-comment">/* RapidIO */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PCI_EXP</span>	125	<span class="enscript-comment">/* PCI Express */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_AURORA</span>	126	<span class="enscript-comment">/* Xilinx Aurora link layer */</span>

<span class="enscript-comment">/*
 * BSD header for 802.11 plus a number of bits of link-layer information
 * including radio information.
 */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">DLT_IEEE802_11_RADIO</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_11_RADIO</span>	127
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Reserved for TZSP encapsulation.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_TZSP</span>		128	<span class="enscript-comment">/* Tazmen Sniffer Protocol */</span>

<span class="enscript-comment">/*
 * Reserved for Linux ARCNET.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ARCNET_LINUX</span>	129

<span class="enscript-comment">/*
 * Juniper-private data link types.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_MLPPP</span>	130
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_MLFR</span>	131
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_ES</span>		132
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_GGSN</span>	133
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_MFR</span>		134
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_ATM2</span>	135
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_SERVICES</span>	136
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_ATM1</span>	137

<span class="enscript-comment">/*
 * Apple IP-over-IEEE 1394, as per a request from Dieter Siegmund
 * &lt;<a href="mailto:dieter@apple.com">dieter@apple.com</a>&gt;.  The header that's presented is an Ethernet-like
 * header:
 *
 *	#define FIREWIRE_EUI64_LEN	8
 *	struct firewire_header {
 *		u_char  firewire_dhost[FIREWIRE_EUI64_LEN];
 *		u_char  firewire_shost[FIREWIRE_EUI64_LEN];
 *		u_short firewire_type;
 *	};
 *
 * with &quot;firewire_type&quot; being an Ethernet type value, rather than,
 * for example, raw GASP frames being handed up.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_APPLE_IP_OVER_IEEE1394</span>	138

<span class="enscript-comment">/*
 * Various SS7 encapsulations, as per a request from Jeff Morriss
 * &lt;jeff.morriss[AT]ulticom.com&gt; and subsequent discussions.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MTP2_WITH_PHDR</span>	139	<span class="enscript-comment">/* pseudo-header with various info, followed by MTP2 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MTP2</span>		140	<span class="enscript-comment">/* MTP2, without pseudo-header */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MTP3</span>		141	<span class="enscript-comment">/* MTP3, without pseudo-header or MTP2 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_SCCP</span>		142	<span class="enscript-comment">/* SCCP, without pseudo-header or MTP2 or MTP3 */</span>

<span class="enscript-comment">/*
 * Reserved for DOCSIS.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_DOCSIS</span>	143

<span class="enscript-comment">/*
 * Reserved for Linux IrDA.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LINUX_IRDA</span>	144

<span class="enscript-comment">/*
 * Reserved for IBM SP switch and IBM Next Federation switch.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IBM_SP</span>	145
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IBM_SN</span>	146

<span class="enscript-comment">/*
 * Reserved for private use.  If you have some link-layer header type
 * that you want to use within your organization, with the capture files
 * using that link-layer header type not ever be sent outside your
 * organization, you can use these values.
 *
 * No libpcap release will use these for any purpose, nor will any
 * tcpdump release use them, either.
 *
 * Do *NOT* use these in capture files that you expect anybody not using
 * your private versions of capture-file-reading tools to read; in
 * particular, do *NOT* use them in products, otherwise you may find that
 * people won't be able to use tcpdump, or snort, or Ethereal, or... to
 * read capture files from your firewall/intrusion detection/traffic
 * monitoring/etc. appliance, or whatever product uses that DLT_ value,
 * and you may also find that the developers of those applications will
 * not accept patches to let them read those files.
 *
 * Also, do not use them if somebody might send you a capture using them
 * for *their* private type and tools using them for *your* private type
 * would have to read them.
 *
 * Instead, ask &quot;<a href="mailto:tcpdump-workers@tcpdump.org">tcpdump-workers@tcpdump.org</a>&quot; for a new DLT_ value,
 * as per the comment above, and use the type you're given.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER0</span>		147
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER1</span>		148
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER2</span>		149
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER3</span>		150
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER4</span>		151
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER5</span>		152
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER6</span>		153
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER7</span>		154
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER8</span>		155
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER9</span>		156
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER10</span>		157
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER11</span>		158
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER12</span>		159
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER13</span>		160
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER14</span>		161
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER15</span>		162

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/*
 * For Apple private usage
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER0_APPLE_INTERNAL</span>        DLT_USER0       <span class="enscript-comment">/* rdar://12019509 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER1_APPLE_INTERNAL</span>        DLT_USER1       <span class="enscript-comment">/* rdar://12019509 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PKTAP</span>			DLT_USER2	<span class="enscript-comment">/* rdar://11779467 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER3_APPLE_INTERNAL</span>        DLT_USER3       <span class="enscript-comment">/* rdar://19614531 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USER4_APPLE_INTERNAL</span>	DLT_USER4	<span class="enscript-comment">/* rdar://19614531 */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

<span class="enscript-comment">/*
 * For future use with 802.11 captures - defined by AbsoluteValue
 * Systems to store a number of bits of link-layer information
 * including radio information:
 *
 *	<a href="http://www.shaftnet.org/~pizza/software/capturefrm.txt">http://www.shaftnet.org/~pizza/software/capturefrm.txt</a>
 *
 * but it might be used by some non-AVS drivers now or in the
 * future.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_11_RADIO_AVS</span> 163	<span class="enscript-comment">/* 802.11 plus AVS radio header */</span>

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.  The DLT_s are used
 * for passing on chassis-internal metainformation such as
 * QOS profiles, etc..
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_MONITOR</span>     164

<span class="enscript-comment">/*
 * Reserved for BACnet MS/TP.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_BACNET_MS_TP</span>	165

<span class="enscript-comment">/*
 * Another PPP variant as per request from Karsten Keil &lt;<a href="mailto:kkeil@suse.de">kkeil@suse.de</a>&gt;.
 *
 * This is used in some OSes to allow a kernel socket filter to distinguish
 * between incoming and outgoing packets, on a socket intended to
 * supply pppd with outgoing packets so it can do dial-on-demand and
 * hangup-on-lack-of-demand; incoming packets are filtered out so they
 * don't cause pppd to hold the connection up (you don't want random
 * input packets such as port scans, packets from old lost connections,
 * etc. to force the connection to stay up).
 *
 * The first byte of the PPP header (0xff03) is modified to accomodate
 * the direction - 0x00 = IN, 0x01 = OUT.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPP_PPPD</span>		166

<span class="enscript-comment">/*
 * Names for backwards compatibility with older versions of some PPP
 * software; new software should use DLT_PPP_PPPD.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPP_WITH_DIRECTION</span>	DLT_PPP_PPPD
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LINUX_PPP_WITHDIRECTION</span>	DLT_PPP_PPPD

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.  The DLT_s are used
 * for passing on chassis-internal metainformation such as
 * QOS profiles, cookies, etc..
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_PPPOE</span>       167
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_PPPOE_ATM</span>   168

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_GPRS_LLC</span>		169	<span class="enscript-comment">/* GPRS LLC */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_GPF_T</span>		170	<span class="enscript-comment">/* GPF-T (ITU-T G.7041/Y.1303) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_GPF_F</span>		171	<span class="enscript-comment">/* GPF-F (ITU-T G.7041/Y.1303) */</span>

<span class="enscript-comment">/*
 * Requested by Oolan Zimmer &lt;<a href="mailto:oz@gcom.com">oz@gcom.com</a>&gt; for use in Gcom's T1/E1 line
 * monitoring equipment.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_GCOM_T1E1</span>		172
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_GCOM_SERIAL</span>		173

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.  The DLT_ is used
 * for internal communication to Physical Interface Cards (PIC)
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_PIC_PEER</span>    174

<span class="enscript-comment">/*
 * Link types requested by Gregor Maier &lt;<a href="mailto:gregor@endace.com">gregor@endace.com</a>&gt; of Endace
 * Measurement Systems.  They add an ERF header (see
 * <a href="http://www.endace.com/support/EndaceRecordFormat.pdf">http://www.endace.com/support/EndaceRecordFormat.pdf</a>) in front of
 * the link-layer header.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ERF_ETH</span>		175	<span class="enscript-comment">/* Ethernet */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ERF_POS</span>		176	<span class="enscript-comment">/* Packet-over-SONET */</span>

<span class="enscript-comment">/*
 * Requested by Daniele Orlandi &lt;<a href="mailto:daniele@orlandi.com">daniele@orlandi.com</a>&gt; for raw LAPD
 * for vISDN (<a href="http://www.orlandi.com/visdn/">http://www.orlandi.com/visdn/</a>).  Its link-layer header
 * includes additional information before the LAPD header, so it's
 * not necessarily a generic LAPD header.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LINUX_LAPD</span>		177

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.
 * The DLT_ are used for prepending meta-information
 * like interface index, interface name
 * before standard Ethernet, PPP, Frelay &amp; C-HDLC Frames
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_ETHER</span>       178
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_PPP</span>         179
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_FRELAY</span>      180
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_CHDLC</span>       181

<span class="enscript-comment">/*
 * Multi Link Frame Relay (FRF.16)
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MFR</span>                 182

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.
 * The DLT_ is used for internal communication with a
 * voice Adapter Card (PIC)
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_VP</span>          183

<span class="enscript-comment">/*
 * Arinc 429 frames.
 * DLT_ requested by Gianluca Varenni &lt;<a href="mailto:gianluca.varenni@cacetech.com">gianluca.varenni@cacetech.com</a>&gt;.
 * Every frame contains a 32bit A429 label.
 * More documentation on Arinc 429 can be found at
 * <a href="http://www.condoreng.com/support/downloads/tutorials/ARINCTutorial.pdf">http://www.condoreng.com/support/downloads/tutorials/ARINCTutorial.pdf</a>
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_A429</span>                184

<span class="enscript-comment">/*
 * Arinc 653 Interpartition Communication messages.
 * DLT_ requested by Gianluca Varenni &lt;<a href="mailto:gianluca.varenni@cacetech.com">gianluca.varenni@cacetech.com</a>&gt;.
 * Please refer to the A653-1 standard for more information.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_A653_ICM</span>            185

<span class="enscript-comment">/*
 * USB packets, beginning with a USB setup header; requested by
 * Paolo Abeni &lt;<a href="mailto:paolo.abeni@email.it">paolo.abeni@email.it</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USB</span>			186

<span class="enscript-comment">/*
 * Bluetooth HCI UART transport layer (part H:4); requested by
 * Paolo Abeni.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_BLUETOOTH_HCI_H4</span>	187

<span class="enscript-comment">/*
 * IEEE 802.16 MAC Common Part Sublayer; requested by Maria Cruz
 * &lt;<a href="mailto:cruz_petagay@bah.com">cruz_petagay@bah.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_16_MAC_CPS</span>	188

<span class="enscript-comment">/*
 * USB packets, beginning with a Linux USB header; requested by
 * Paolo Abeni &lt;<a href="mailto:paolo.abeni@email.it">paolo.abeni@email.it</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USB_LINUX</span>		189

<span class="enscript-comment">/*
 * Controller Area Network (CAN) v. 2.0B packets.
 * DLT_ requested by Gianluca Varenni &lt;<a href="mailto:gianluca.varenni@cacetech.com">gianluca.varenni@cacetech.com</a>&gt;.
 * Used to dump CAN packets coming from a CAN Vector board.
 * More documentation on the CAN v2.0B frames can be found at
 * <a href="http://www.can-cia.org/downloads/">http://www.can-cia.org/downloads/</a>?269
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_CAN20B</span>              190

<span class="enscript-comment">/*
 * IEEE 802.15.4, with address fields padded, as is done by Linux
 * drivers; requested by Juergen Schimmer.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_15_4_LINUX</span>	191

<span class="enscript-comment">/*
 * Per Packet Information encapsulated packets.
 * DLT_ requested by Gianluca Varenni &lt;<a href="mailto:gianluca.varenni@cacetech.com">gianluca.varenni@cacetech.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPI</span>			192

<span class="enscript-comment">/*
 * Header for 802.16 MAC Common Part Sublayer plus a radiotap radio header;
 * requested by Charles Clancy.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_16_MAC_CPS_RADIO</span>	193

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.
 * The DLT_ is used for internal communication with a
 * integrated service module (ISM).
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_ISM</span>         194

<span class="enscript-comment">/*
 * IEEE 802.15.4, exactly as it appears in the spec (no padding, no
 * nothing); requested by Mikko Saarnivala &lt;<a href="mailto:mikko.saarnivala@sensinode.com">mikko.saarnivala@sensinode.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_15_4</span>	195

<span class="enscript-comment">/*
 * Various link-layer types, with a pseudo-header, for SITA
 * (<a href="http://www.sita.aero/">http://www.sita.aero/</a>); requested by Fulko Hew (<a href="mailto:fulko.hew@gmail.com">fulko.hew@gmail.com</a>).
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_SITA</span>		196

<span class="enscript-comment">/*
 * Various link-layer types, with a pseudo-header, for Endace DAG cards;
 * encapsulates Endace ERF records.  Requested by Stephen Donnelly
 * &lt;<a href="mailto:stephen@endace.com">stephen@endace.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_ERF</span>			197

<span class="enscript-comment">/*
 * Special header prepended to Ethernet packets when capturing from a
 * u10 Networks board.  Requested by Phil Mulholland
 * &lt;<a href="mailto:phil@u10networks.com">phil@u10networks.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_RAIF1</span>		198

<span class="enscript-comment">/*
 * IPMB packet for IPMI, beginning with the I2C slave address, followed
 * by the netFn and LUN, etc..  Requested by Chanthy Toeung
 * &lt;<a href="mailto:chanthy.toeung@ca.kontron.com">chanthy.toeung@ca.kontron.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IPMB</span>		199

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.
 * The DLT_ is used for capturing data on a secure tunnel interface.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_ST</span>          200

<span class="enscript-comment">/*
 * Bluetooth HCI UART transport layer (part H:4), with pseudo-header
 * that includes direction information; requested by Paolo Abeni.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_BLUETOOTH_HCI_H4_WITH_PHDR</span>	201

<span class="enscript-comment">/*
 * AX.25 packet with a 1-byte KISS header; see
 *
 *      <a href="http://www.ax25.net/kiss.htm">http://www.ax25.net/kiss.htm</a>
 *
 * as per Richard Stearn &lt;<a href="mailto:richard@rns-stearn.demon.co.uk">richard@rns-stearn.demon.co.uk</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_AX25_KISS</span>           202

<span class="enscript-comment">/*
 * LAPD packets from an ISDN channel, starting with the address field,
 * with no pseudo-header.
 * Requested by Varuna De Silva &lt;<a href="mailto:varunax@gmail.com">varunax@gmail.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LAPD</span>                203

<span class="enscript-comment">/*
 * Variants of various link-layer headers, with a one-byte direction
 * pseudo-header prepended - zero means &quot;received by this host&quot;,
 * non-zero (any non-zero value) means &quot;sent by this host&quot; - as per
 * Will Barker &lt;<a href="mailto:w.barker@zen.co.uk">w.barker@zen.co.uk</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_PPP_WITH_DIR</span>        204     <span class="enscript-comment">/* PPP - don't confuse with DLT_PPP_WITH_DIRECTION */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_C_HDLC_WITH_DIR</span>     205     <span class="enscript-comment">/* Cisco HDLC */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_FRELAY_WITH_DIR</span>     206     <span class="enscript-comment">/* Frame Relay */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LAPB_WITH_DIR</span>       207     <span class="enscript-comment">/* LAPB */</span>

<span class="enscript-comment">/*
 * 208 is reserved for an as-yet-unspecified proprietary link-layer
 * type, as requested by Will Barker.
 */</span>

<span class="enscript-comment">/*
 * IPMB with a Linux-specific pseudo-header; as requested by Alexey Neyman
 * &lt;<a href="mailto:avn@pigeonpoint.com">avn@pigeonpoint.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IPMB_LINUX</span>          209

<span class="enscript-comment">/*
 * FlexRay automotive bus - <a href="http://www.flexray.com/">http://www.flexray.com/</a> - as requested
 * by Hannes Kaelber &lt;<a href="mailto:hannes.kaelber@x2e.de">hannes.kaelber@x2e.de</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_FLEXRAY</span>             210

<span class="enscript-comment">/*
 * Media Oriented Systems Transport (MOST) bus for multimedia
 * transport - <a href="http://www.mostcooperation.com/">http://www.mostcooperation.com/</a> - as requested
 * by Hannes Kaelber &lt;<a href="mailto:hannes.kaelber@x2e.de">hannes.kaelber@x2e.de</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MOST</span>                211

<span class="enscript-comment">/*
 * Local Interconnect Network (LIN) bus for vehicle networks -
 * <a href="http://www.lin-subbus.org/">http://www.lin-subbus.org/</a> - as requested by Hannes Kaelber
 * &lt;<a href="mailto:hannes.kaelber@x2e.de">hannes.kaelber@x2e.de</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LIN</span>                 212

<span class="enscript-comment">/*
 * X2E-private data link type used for serial line capture,
 * as requested by Hannes Kaelber &lt;<a href="mailto:hannes.kaelber@x2e.de">hannes.kaelber@x2e.de</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_X2E_SERIAL</span>          213

<span class="enscript-comment">/*
 * X2E-private data link type used for the Xoraya data logger
 * family, as requested by Hannes Kaelber &lt;<a href="mailto:hannes.kaelber@x2e.de">hannes.kaelber@x2e.de</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_X2E_XORAYA</span>          214

<span class="enscript-comment">/*
 * IEEE 802.15.4, exactly as it appears in the spec (no padding, no
 * nothing), but with the PHY-level data for non-ASK PHYs (4 octets
 * of 0 as preamble, one octet of SFD, one octet of frame length+
 * reserved bit, and then the MAC-layer data, starting with the
 * frame control field).
 *
 * Requested by Max Filippov &lt;<a href="mailto:jcmvbkbc@gmail.com">jcmvbkbc@gmail.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_15_4_NONASK_PHY</span>     215

<span class="enscript-comment">/* 
 * David Gibson &lt;<a href="mailto:david@gibson.dropbear.id.au">david@gibson.dropbear.id.au</a>&gt; requested this for
 * captures from the Linux kernel /dev/input/eventN devices. This
 * is used to communicate keystrokes and mouse movements from the
 * Linux kernel to display systems, such as Xorg. 
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_LINUX_EVDEV</span>		216

<span class="enscript-comment">/*
 * GSM Um and Abis interfaces, preceded by a &quot;gsmtap&quot; header.
 *
 * Requested by Harald Welte &lt;<a href="mailto:laforge@gnumonks.org">laforge@gnumonks.org</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_GSMTAP_UM</span>		217
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_GSMTAP_ABIS</span>		218

<span class="enscript-comment">/*
 * MPLS, with an MPLS label as the link-layer header.
 * Requested by Michele Marchetto &lt;<a href="mailto:michele@openbsd.org">michele@openbsd.org</a>&gt; on behalf
 * of OpenBSD.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MPLS</span>		219

<span class="enscript-comment">/*
 * USB packets, beginning with a Linux USB header, with the USB header
 * padded to 64 bytes; required for memory-mapped access.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_USB_LINUX_MMAPPED</span>	220

<span class="enscript-comment">/*
 * DECT packets, with a pseudo-header; requested by
 * Matthias Wenzel &lt;<a href="mailto:tcpdump@mazzoo.de">tcpdump@mazzoo.de</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_DECT</span>		221

<span class="enscript-comment">/*
 * From: &quot;Lidwa, Eric (GSFC-582.0)[SGT INC]&quot; &lt;<a href="mailto:eric.lidwa-1@nasa.gov">eric.lidwa-1@nasa.gov</a>&gt;
 * Date: Mon, 11 May 2009 11:18:30 -0500
 *
 * DLT_AOS. We need it for AOS Space Data Link Protocol.
 *   I have already written dissectors for but need an OK from
 *   legal before I can submit a patch.
 *
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_AOS</span>                 222

<span class="enscript-comment">/*
 * Wireless HART (Highway Addressable Remote Transducer)
 * From the HART Communication Foundation
 * IES/PAS 62591
 *
 * Requested by Sam Roberts &lt;<a href="mailto:vieuxtech@gmail.com">vieuxtech@gmail.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_WIHART</span>		223

<span class="enscript-comment">/*
 * Fibre Channel FC-2 frames, beginning with a Frame_Header.
 * Requested by Kahou Lei &lt;<a href="mailto:kahou82@gmail.com">kahou82@gmail.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_FC_2</span>		224

<span class="enscript-comment">/*
 * Fibre Channel FC-2 frames, beginning with an encoding of the
 * SOF, and ending with an encoding of the EOF.
 *
 * The encodings represent the frame delimiters as 4-byte sequences
 * representing the corresponding ordered sets, with K28.5
 * represented as 0xBC, and the D symbols as the corresponding
 * byte values; for example, SOFi2, which is K28.5 - D21.5 - D1.2 - D21.2,
 * is represented as 0xBC 0xB5 0x55 0x55.
 *
 * Requested by Kahou Lei &lt;<a href="mailto:kahou82@gmail.com">kahou82@gmail.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_FC_2_WITH_FRAME_DELIMS</span>	225

<span class="enscript-comment">/*
 * Solaris ipnet pseudo-header; requested by Darren Reed &lt;<a href="mailto:Darren.Reed@Sun.COM">Darren.Reed@Sun.COM</a>&gt;.
 *
 * The pseudo-header starts with a one-byte version number; for version 2,
 * the pseudo-header is:
 *
 * struct dl_ipnetinfo {
 *     u_int8_t   dli_version;
 *     u_int8_t   dli_family;
 *     u_int16_t  dli_htype;
 *     u_int32_t  dli_pktlen;
 *     u_int32_t  dli_ifindex;
 *     u_int32_t  dli_grifindex;
 *     u_int32_t  dli_zsrc;
 *     u_int32_t  dli_zdst;
 * };
 *
 * dli_version is 2 for the current version of the pseudo-header.
 *
 * dli_family is a Solaris address family value, so it's 2 for IPv4
 * and 26 for IPv6.
 *
 * dli_htype is a &quot;hook type&quot; - 0 for incoming packets, 1 for outgoing
 * packets, and 2 for packets arriving from another zone on the same
 * machine.
 *
 * dli_pktlen is the length of the packet data following the pseudo-header
 * (so the captured length minus dli_pktlen is the length of the
 * pseudo-header, assuming the entire pseudo-header was captured).
 *
 * dli_ifindex is the interface index of the interface on which the
 * packet arrived.
 *
 * dli_grifindex is the group interface index number (for IPMP interfaces).
 *
 * dli_zsrc is the zone identifier for the source of the packet.
 *
 * dli_zdst is the zone identifier for the destination of the packet.
 *
 * A zone number of 0 is the global zone; a zone number of 0xffffffff
 * means that the packet arrived from another host on the network, not
 * from another zone on the same machine.
 *
 * An IPv4 or IPv6 datagram follows the pseudo-header; dli_family indicates
 * which of those it is.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IPNET</span>		226

<span class="enscript-comment">/*
 * CAN (Controller Area Network) frames, with a pseudo-header as supplied
 * by Linux SocketCAN.  See Documentation/networking/can.txt in the Linux
 * source.
 *
 * Requested by Felix Obenhuber &lt;<a href="mailto:felix@obenhuber.de">felix@obenhuber.de</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_CAN_SOCKETCAN</span>	227

<span class="enscript-comment">/*
 * Raw IPv4/IPv6; different from DLT_RAW in that the DLT_ value specifies
 * whether it's v4 or v6.  Requested by Darren Reed &lt;<a href="mailto:Darren.Reed@Sun.COM">Darren.Reed@Sun.COM</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IPV4</span>		228
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IPV6</span>		229

<span class="enscript-comment">/*
 * IEEE 802.15.4, exactly as it appears in the spec (no padding, no
 * nothing), and with no FCS at the end of the frame; requested by
 * Jon Smirl &lt;<a href="mailto:jonsmirl@gmail.com">jonsmirl@gmail.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IEEE802_15_4_NOFCS</span>	230

<span class="enscript-comment">/*
 * Raw D-Bus:
 *
 *	<a href="http://www.freedesktop.org/wiki/Software/dbus">http://www.freedesktop.org/wiki/Software/dbus</a>
 *
 * messages:
 *
 *	<a href="http://dbus.freedesktop.org/doc/dbus-specification.html#message-protocol-messages">http://dbus.freedesktop.org/doc/dbus-specification.html#message-protocol-messages</a>
 *
 * starting with the endianness flag, followed by the message type, etc.,
 * but without the authentication handshake before the message sequence:
 *
 *	<a href="http://dbus.freedesktop.org/doc/dbus-specification.html#auth-protocol">http://dbus.freedesktop.org/doc/dbus-specification.html#auth-protocol</a>
 *
 * Requested by Martin Vidner &lt;<a href="mailto:martin@vidner.net">martin@vidner.net</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_DBUS</span>		231

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_VS</span>			232
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_SRX_E2E</span>		233
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_FIBRECHANNEL</span>	234

<span class="enscript-comment">/*
 * DVB-CI (DVB Common Interface for communication between a PC Card
 * module and a DVB receiver).  See
 *
 *	<a href="http://www.kaiser.cx/pcap-dvbci.html">http://www.kaiser.cx/pcap-dvbci.html</a>
 *
 * for the specification.
 *
 * Requested by Martin Kaiser &lt;<a href="mailto:martin@kaiser.cx">martin@kaiser.cx</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_DVB_CI</span>		235

<span class="enscript-comment">/*
 * Variant of 3GPP TS 27.010 multiplexing protocol (similar to, but
 * *not* the same as, 27.010).  Requested by Hans-Christoph Schemmel
 * &lt;<a href="mailto:hans-christoph.schemmel@cinterion.com">hans-christoph.schemmel@cinterion.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MUX27010</span>		236

<span class="enscript-comment">/*
 * STANAG 5066 D_PDUs.  Requested by M. Baris Demiray
 * &lt;<a href="mailto:barisdemiray@gmail.com">barisdemiray@gmail.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_STANAG_5066_D_PDU</span>	237

<span class="enscript-comment">/*
 * Juniper-private data link type, as per request from
 * Hannes Gredler &lt;<a href="mailto:hannes@juniper.net">hannes@juniper.net</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_JUNIPER_ATM_CEMIC</span>	238

<span class="enscript-comment">/*
 * NetFilter LOG messages 
 * (payload of netlink NFNL_SUBSYS_ULOG/NFULNL_MSG_PACKET packets)
 *
 * Requested by Jakub Zawadzki &lt;<a href="mailto:darkjames-ws@darkjames.pl">darkjames-ws@darkjames.pl</a>&gt;
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_NFLOG</span>		239

<span class="enscript-comment">/*
 * Hilscher Gesellschaft fuer Systemautomation mbH link-layer type
 * for Ethernet packets with a 4-byte pseudo-header and always
 * with the payload including the FCS, as supplied by their
 * netANALYZER hardware and software.
 *
 * Requested by Holger P. Frommer &lt;<a href="mailto:HPfrommer@hilscher.com">HPfrommer@hilscher.com</a>&gt;
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_NETANALYZER</span>		240

<span class="enscript-comment">/*
 * Hilscher Gesellschaft fuer Systemautomation mbH link-layer type
 * for Ethernet packets with a 4-byte pseudo-header and FCS and
 * with the Ethernet header preceded by 7 bytes of preamble and
 * 1 byte of SFD, as supplied by their netANALYZER hardware and
 * software.
 *
 * Requested by Holger P. Frommer &lt;<a href="mailto:HPfrommer@hilscher.com">HPfrommer@hilscher.com</a>&gt;
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_NETANALYZER_TRANSPARENT</span>	241

<span class="enscript-comment">/*
 * IP-over-Infiniband, as specified by RFC 4391.
 *
 * Requested by Petr Sumbera &lt;<a href="mailto:petr.sumbera@oracle.com">petr.sumbera@oracle.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_IPOIB</span>		242

<span class="enscript-comment">/*
 * MPEG-2 transport stream (ISO 13818-1/ITU-T H.222.0).
 *
 * Requested by Guy Martin &lt;<a href="mailto:gmsoft@tuxicoman.be">gmsoft@tuxicoman.be</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MPEG_2_TS</span>		243

<span class="enscript-comment">/*
 * ng4T GmbH's UMTS Iub/Iur-over-ATM and Iub/Iur-over-IP format as
 * used by their ng40 protocol tester.
 *
 * Requested by Jens Grimmer &lt;<a href="mailto:jens.grimmer@ng4t.com">jens.grimmer@ng4t.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_NG40</span>		244

<span class="enscript-comment">/*
 * Pseudo-header giving adapter number and flags, followed by an NFC
 * (Near-Field Communications) Logical Link Control Protocol (LLCP) PDU,
 * as specified by NFC Forum Logical Link Control Protocol Technical
 * Specification LLCP 1.1.
 *
 * Requested by Mike Wakerly &lt;<a href="mailto:mikey@google.com">mikey@google.com</a>&gt;.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_NFC_LLCP</span>		245


#<span class="enscript-reference">define</span> <span class="enscript-variable-name">DLT_MATCHING_MAX</span>	245	<span class="enscript-comment">/* highest value in the &quot;matching&quot; range */</span>

<span class="enscript-comment">/*
 * The instruction encodings.
 */</span>
<span class="enscript-comment">/* instruction classes */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_CLASS</span>(code) ((code) &amp; 0x07)
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_LD</span>		0x00
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_LDX</span>		0x01
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_ST</span>		0x02
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_STX</span>		0x03
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_ALU</span>		0x04
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_JMP</span>		0x05
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_RET</span>		0x06
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_MISC</span>	0x07

<span class="enscript-comment">/* ld/ldx fields */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_SIZE</span>(code)	((code) &amp; 0x18)
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_W</span>		0x00
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_H</span>		0x08
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_B</span>		0x10
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_MODE</span>(code)	((code) &amp; 0xe0)
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_IMM</span> 	0x00
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_ABS</span>		0x20
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_IND</span>		0x40
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_MEM</span>		0x60
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_LEN</span>		0x80
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_MSH</span>		0xa0

<span class="enscript-comment">/* alu/jmp fields */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_OP</span>(code)	((code) &amp; 0xf0)
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_ADD</span>		0x00
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_SUB</span>		0x10
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_MUL</span>		0x20
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_DIV</span>		0x30
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_OR</span>		0x40
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_AND</span>		0x50
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_LSH</span>		0x60
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_RSH</span>		0x70
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_NEG</span>		0x80
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_JA</span>		0x00
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_JEQ</span>		0x10
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_JGT</span>		0x20
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_JGE</span>		0x30
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_JSET</span>	0x40
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_SRC</span>(code)	((code) &amp; 0x08)
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_K</span>		0x00
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_X</span>		0x08

<span class="enscript-comment">/* ret - BPF_K and BPF_X also apply */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_RVAL</span>(code)	((code) &amp; 0x18)
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_A</span>		0x10

<span class="enscript-comment">/* misc */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_MISCOP</span>(code) ((code) &amp; 0xf8)
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_TAX</span>		0x00
#<span class="enscript-reference">define</span>		<span class="enscript-variable-name">BPF_TXA</span>		0x80

<span class="enscript-comment">/*
 * The instruction data structure.
 */</span>
<span class="enscript-type">struct</span> bpf_insn {
	u_short		code;
	u_char		jt;
	u_char		jf;
	bpf_u_int32	k;
};

<span class="enscript-comment">/*
 * Macros for insn array initializers.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_STMT</span>(code, k) { (u_short)(code), 0, 0, k }
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BPF_JUMP</span>(code, k, jt, jf) { (u_short)(code), jt, jf, k }

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>(4)

<span class="enscript-comment">/*
 * Structure to retrieve available DLTs for the interface.
 */</span>
<span class="enscript-type">struct</span> bpf_dltlist {
	u_int32_t		bfl_len;	<span class="enscript-comment">/* number of bfd_list array */</span>
	<span class="enscript-type">union</span> {
		u_int32_t	*bflu_list;	<span class="enscript-comment">/* array of DLTs */</span>
		u_int64_t	bflu_pad;
	} bfl_u;
};
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">bfl_list</span> bfl_u.bflu_list

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>()

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-comment">/* Forward declerations */</span>
<span class="enscript-type">struct</span> ifnet;
<span class="enscript-type">struct</span> mbuf;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span>	bpf_validate(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> bpf_insn *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span>	bpfdetach(<span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span>	bpfilterattach(<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> u_int	bpf_filter(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> bpf_insn *, u_char *, u_int, u_int);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">BPF_TAP_MODE_T</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_TAP_MODE_T</span>
<span class="enscript-comment">/*!
	@enum BPF tap mode
	@abstract Constants defining interface families.
	@constant BPF_MODE_DISABLED Disable bpf.
	@constant BPF_MODE_INPUT Enable input only.
	@constant BPF_MODE_OUTPUT Enable output only.
	@constant BPF_MODE_INPUT_OUTPUT Enable input and output.
*/</span>

<span class="enscript-type">enum</span> {
	BPF_MODE_DISABLED	= 0,
	BPF_MODE_INPUT		= 1,
	BPF_MODE_OUTPUT		= 2,
	BPF_MODE_INPUT_OUTPUT	= 3
};
<span class="enscript-comment">/*!
	@typedef bpf_tap_mode
	@abstract Mode for tapping. BPF_MODE_DISABLED/BPF_MODE_INPUT_OUTPUT etc.
*/</span>
<span class="enscript-type">typedef</span> u_int32_t bpf_tap_mode;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !BPF_TAP_MODE_T */</span>

<span class="enscript-comment">/*!
	@typedef bpf_send_func
	@discussion bpf_send_func is called when a bpf file descriptor is
		used to send a raw packet on the interface. The mbuf and data
		link type are specified. The callback is responsible for
		releasing the mbuf whether or not it returns an error.
	@param interface The interface the packet is being sent on.
	@param dlt The data link type the bpf device is attached to.
	@param packet The packet to be sent.
 */</span>
<span class="enscript-type">typedef</span> <span class="enscript-function-name">errno_t</span> (*bpf_send_func)(ifnet_t interface, u_int32_t data_link_type,
								 mbuf_t packet);

<span class="enscript-comment">/*!
	@typedef bpf_tap_func
	@discussion bpf_tap_func is called when the tap state of the
		interface changes. This happens when a bpf device attaches to an
		interface or detaches from an interface. The tap mode will join
		together (bit or) the modes of all bpf devices using that
		interface for that dlt. If you return an error from this
		function, the bpf device attach attempt that triggered the tap
		will fail. If this function was called bacuse the tap state was
		decreasing (tap in or out is stopping), the error will be
		ignored.
	@param interface The interface being tapped.
	@param dlt The data link type being tapped.
	@param direction The direction of the tap.
 */</span>
<span class="enscript-type">typedef</span> <span class="enscript-function-name">errno_t</span> (*bpf_tap_func)(ifnet_t interface, u_int32_t data_link_type,
								bpf_tap_mode direction);

<span class="enscript-comment">/*!
	@function bpfattach
	@discussion Registers an interface with BPF. This allows bpf devices
		to attach to your interface to capture packets. Your interface
		will be unregistered automatically when your interface is
		detached.
	@param interface The interface to register with BPF.
	@param data_link_type The data link type of the interface. See the
		DLT_* defines in bpf.h.
	@param header_length The length, in bytes, of the data link header.
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span>  <span class="enscript-function-name">bpfattach</span>(ifnet_t interface, u_int data_link_type,
    u_int header_length);

<span class="enscript-comment">/*!
	@function bpf_attach
	@discussion Registers an interface with BPF. This allows bpf devices
		to attach to your interface to capture and transmit packets.
		Your interface will be unregistered automatically when your
		interface is detached. You may register multiple times with
		different data link types. An 802.11 interface would use this to
		allow clients to pick whether they want just an ethernet style
		frame or the 802.11 wireless headers as well. The first dlt you
		register will be considered the default. Any bpf device attaches
		that do not specify a data link type will use the default.
	@param interface The interface to register with BPF.
	@param data_link_type The data link type of the interface. See the
		DLT_* defines in bpf.h.
	@param header_length The length, in bytes, of the data link header.
	@param send See the bpf_send_func described above.
	@param tap See the bpf_tap_func described above.
 */</span>
<span class="enscript-type">extern</span> errno_t  <span class="enscript-function-name">bpf_attach</span>(ifnet_t interface, u_int32_t data_link_type,
    u_int32_t header_length, bpf_send_func send, bpf_tap_func tap);

<span class="enscript-comment">/*!
	@function bpf_tap_in
	@discussion Call this function when your interface receives a
		packet. This function will check if any bpf devices need a
		a copy of the packet.
	@param interface The interface the packet was received on.
	@param dlt The data link type of the packet.
	@param packet The packet received.
	@param header An optional pointer to a header that will be prepended.
	@param headerlen If the header was specified, the length of the header.
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">bpf_tap_in</span>(ifnet_t interface, u_int32_t dlt, mbuf_t packet,
    <span class="enscript-type">void</span> *header, size_t header_len);

<span class="enscript-comment">/*!
	@function bpf_tap_out
	@discussion Call this function when your interface trasmits a
		packet. This function will check if any bpf devices need a
		a copy of the packet.
	@param interface The interface the packet was or will be transmitted on.
	@param dlt The data link type of the packet.
	@param packet The packet received.
	@param header An optional pointer to a header that will be prepended.
	@param headerlen If the header was specified, the length of the header.
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">bpf_tap_out</span>(ifnet_t interface, u_int32_t dlt, mbuf_t packet,
    <span class="enscript-type">void</span> *header, size_t header_len);

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

<span class="enscript-comment">/*
 * Number of scratch memory words (for BPF_LD|BPF_MEM and BPF_ST).
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">BPF_MEMWORDS</span> 16

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _NET_BPF_H_ */</span>
</pre>
<hr />
</body></html>