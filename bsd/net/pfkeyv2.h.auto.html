<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>pfkeyv2.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">pfkeyv2.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2011 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*	$KAME: pfkeyv2.h,v 1.10 2000/03/22 07:04:20 sakane Exp $	*/</span>

<span class="enscript-comment">/*
 * Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the project nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */</span>

<span class="enscript-comment">/*
 * This file has been derived rfc 2367,
 * And added some flags of SADB_KEY_FLAGS_ as SADB_X_EXT_.
 *	<a href="mailto:sakane@ydc.co.jp">sakane@ydc.co.jp</a>
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NET_PFKEYV2_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_NET_PFKEYV2_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/if.h&gt;</span>

<span class="enscript-comment">/*
This file defines structures and symbols for the PF_KEY Version 2
key management interface. It was written at the U.S. Naval Research
Laboratory. This file is in the public domain. The authors ask that
you leave this credit intact on any copies of this file.
*/</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">__PFKEY_V2_H</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__PFKEY_V2_H</span> 1

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PF_KEY_V2</span> 2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PFKEYV2_REVISION</span>        199806L

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_RESERVED</span>    0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_GETSPI</span>      1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_UPDATE</span>      2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_ADD</span>         3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_DELETE</span>      4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_GET</span>         5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_ACQUIRE</span>     6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_REGISTER</span>    7
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXPIRE</span>      8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_FLUSH</span>       9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_DUMP</span>        10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_PROMISC</span>   11
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_PCHANGE</span>   12

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDUPDATE</span>  13
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDADD</span>     14
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDDELETE</span>  15	<span class="enscript-comment">/* by policy index */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDGET</span>     16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDACQUIRE</span> 17
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDDUMP</span>    18
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDFLUSH</span>   19
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDSETIDX</span>  20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDEXPIRE</span>  21
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDDELETE2</span> 22	<span class="enscript-comment">/* by policy id */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_GETSASTAT</span>    23
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDENABLE</span>  24	<span class="enscript-comment">/* by policy id */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SPDDISABLE</span> 25	<span class="enscript-comment">/* by policy id */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_MIGRATE</span>      26
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_MAX</span>          26

<span class="enscript-type">struct</span> sadb_msg {
  u_int8_t sadb_msg_version;
  u_int8_t sadb_msg_type;
  u_int8_t sadb_msg_errno;
  u_int8_t sadb_msg_satype;
  u_int16_t sadb_msg_len;
  u_int16_t sadb_msg_reserved;
  u_int32_t sadb_msg_seq;
  u_int32_t sadb_msg_pid;
};

<span class="enscript-type">struct</span> sadb_ext {
  u_int16_t sadb_ext_len;
  u_int16_t sadb_ext_type;
};

<span class="enscript-type">struct</span> sadb_sa {
  u_int16_t sadb_sa_len;
  u_int16_t sadb_sa_exttype;
  u_int32_t sadb_sa_spi;
  u_int8_t sadb_sa_replay;
  u_int8_t sadb_sa_state;
  u_int8_t sadb_sa_auth;
  u_int8_t sadb_sa_encrypt;
  u_int32_t sadb_sa_flags;
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-type">struct</span> sadb_sa_2 {
	<span class="enscript-type">struct</span> sadb_sa	sa;
	u_int16_t		sadb_sa_natt_port;
	<span class="enscript-type">union</span> {
		u_int16_t		sadb_reserved0;
		u_int16_t		sadb_sa_natt_interval;
	};

	<span class="enscript-type">union</span> {
		u_int32_t		sadb_reserved1;
		u_int16_t		sadb_sa_natt_offload_interval;
	};
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

<span class="enscript-type">struct</span> sadb_lifetime {
  u_int16_t sadb_lifetime_len;
  u_int16_t sadb_lifetime_exttype;
  u_int32_t sadb_lifetime_allocations;
  u_int64_t sadb_lifetime_bytes;
  u_int64_t sadb_lifetime_addtime;
  u_int64_t sadb_lifetime_usetime;
};

<span class="enscript-type">struct</span> sadb_address {
  u_int16_t sadb_address_len;
  u_int16_t sadb_address_exttype;
  u_int8_t sadb_address_proto;
  u_int8_t sadb_address_prefixlen;
  u_int16_t sadb_address_reserved;
};

<span class="enscript-type">struct</span> sadb_key {
  u_int16_t sadb_key_len;
  u_int16_t sadb_key_exttype;
  u_int16_t sadb_key_bits;
  u_int16_t sadb_key_reserved;
};

<span class="enscript-type">struct</span> sadb_ident {
  u_int16_t sadb_ident_len;
  u_int16_t sadb_ident_exttype;
  u_int16_t sadb_ident_type;
  u_int16_t sadb_ident_reserved;
  u_int64_t sadb_ident_id;
};

<span class="enscript-type">struct</span> sadb_sens {
  u_int16_t sadb_sens_len;
  u_int16_t sadb_sens_exttype;
  u_int32_t sadb_sens_dpd;
  u_int8_t sadb_sens_sens_level;
  u_int8_t sadb_sens_sens_len;
  u_int8_t sadb_sens_integ_level;
  u_int8_t sadb_sens_integ_len;
  u_int32_t sadb_sens_reserved;
};

<span class="enscript-type">struct</span> sadb_prop {
  u_int16_t sadb_prop_len;
  u_int16_t sadb_prop_exttype;
  u_int8_t sadb_prop_replay;
  u_int8_t sadb_prop_reserved[3];
};

<span class="enscript-type">struct</span> sadb_comb {
  u_int8_t sadb_comb_auth;
  u_int8_t sadb_comb_encrypt;
  u_int16_t sadb_comb_flags;
  u_int16_t sadb_comb_auth_minbits;
  u_int16_t sadb_comb_auth_maxbits;
  u_int16_t sadb_comb_encrypt_minbits;
  u_int16_t sadb_comb_encrypt_maxbits;
  u_int32_t sadb_comb_reserved;
  u_int32_t sadb_comb_soft_allocations;
  u_int32_t sadb_comb_hard_allocations;
  u_int64_t sadb_comb_soft_bytes;
  u_int64_t sadb_comb_hard_bytes;
  u_int64_t sadb_comb_soft_addtime;
  u_int64_t sadb_comb_hard_addtime;
  u_int64_t sadb_comb_soft_usetime;
  u_int64_t sadb_comb_hard_usetime;
};

<span class="enscript-type">struct</span> sadb_supported {
  u_int16_t sadb_supported_len;
  u_int16_t sadb_supported_exttype;
  u_int32_t sadb_supported_reserved;
};

<span class="enscript-type">struct</span> sadb_alg {
  u_int8_t sadb_alg_id;
  u_int8_t sadb_alg_ivlen;
  u_int16_t sadb_alg_minbits;
  u_int16_t sadb_alg_maxbits;
  u_int16_t sadb_alg_reserved;
};

<span class="enscript-type">struct</span> sadb_spirange {
  u_int16_t sadb_spirange_len;
  u_int16_t sadb_spirange_exttype;
  u_int32_t sadb_spirange_min;
  u_int32_t sadb_spirange_max;
  u_int32_t sadb_spirange_reserved;
};

<span class="enscript-type">struct</span> sadb_x_kmprivate {
  u_int16_t sadb_x_kmprivate_len;
  u_int16_t sadb_x_kmprivate_exttype;
  u_int32_t sadb_x_kmprivate_reserved;
};

<span class="enscript-comment">/*
 * XXX Additional SA Extension.
 * mode: tunnel or transport
 * reqid: to make SA unique nevertheless the address pair of SA are same.
 *        Mainly it's for VPN.
 */</span>
<span class="enscript-type">struct</span> sadb_x_sa2 {
  u_int16_t sadb_x_sa2_len;
  u_int16_t sadb_x_sa2_exttype;
  u_int8_t sadb_x_sa2_mode;
  <span class="enscript-type">union</span> {
    u_int8_t sadb_x_sa2_reserved1;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
    u_int8_t sadb_x_sa2_alwaysexpire;
#<span class="enscript-reference">endif</span>
  };
  <span class="enscript-type">union</span> {
    u_int16_t sadb_x_sa2_reserved2;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
    u_int16_t sadb_x_sa2_flags;
#<span class="enscript-reference">endif</span>
  };
  u_int32_t sadb_x_sa2_sequence;
  u_int32_t sadb_x_sa2_reqid;
};

<span class="enscript-comment">/* XXX Policy Extension */</span>
<span class="enscript-comment">/* sizeof(struct sadb_x_policy) == 16 */</span>
<span class="enscript-type">struct</span> sadb_x_policy {
  u_int16_t sadb_x_policy_len;
  u_int16_t sadb_x_policy_exttype;
  u_int16_t sadb_x_policy_type;		<span class="enscript-comment">/* See policy type of ipsec.h */</span>
  u_int8_t sadb_x_policy_dir;		<span class="enscript-comment">/* direction, see ipsec.h */</span>
  u_int8_t sadb_x_policy_reserved;
  u_int32_t sadb_x_policy_id;
  u_int32_t sadb_x_policy_reserved2;
};
<span class="enscript-comment">/*
 * When policy_type == IPSEC, it is followed by some of
 * the ipsec policy request.
 * [total length of ipsec policy requests]
 *	= (sadb_x_policy_len * sizeof(uint64_t) - sizeof(struct sadb_x_policy))
 */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/* IPSec Interface Extension:
 * IPSec interface can be specified alone, or all three
 * of internal, outgoing, and IPSec interfaces must be
 * specified.
 */</span>
<span class="enscript-type">struct</span> sadb_x_ipsecif {
	u_int16_t sadb_x_ipsecif_len;
	u_int16_t sadb_x_ipsecif_exttype;
	<span class="enscript-type">char</span> sadb_x_ipsecif_internal_if[IFXNAMSIZ]; <span class="enscript-comment">/* Steal packets from this interface */</span>
	<span class="enscript-type">char</span> sadb_x_ipsecif_outgoing_if[IFXNAMSIZ]; <span class="enscript-comment">/* Send packets out on this interface */</span>
	<span class="enscript-type">char</span> sadb_x_ipsecif_ipsec_if[IFXNAMSIZ];  <span class="enscript-comment">/* Direct packets through ipsec interface */</span>
	u_int16_t sadb_x_ipsecif_init_disabled; <span class="enscript-comment">/* 0 or 1, flag to ignore policy */</span>
	u_int16_t reserved;
};
#<span class="enscript-reference">endif</span>
<span class="enscript-comment">/* XXX IPsec Policy Request Extension */</span>
<span class="enscript-comment">/*
 * This structure is aligned 8 bytes.
 */</span>
<span class="enscript-type">struct</span> sadb_x_ipsecrequest {
  u_int16_t sadb_x_ipsecrequest_len;	<span class="enscript-comment">/* structure length aligned to 8 bytes.
					 * This value is true length of bytes.
					 * Not in units of 64 bits. */</span>
  u_int16_t sadb_x_ipsecrequest_proto;	<span class="enscript-comment">/* See ipsec.h */</span>
  u_int8_t sadb_x_ipsecrequest_mode;	<span class="enscript-comment">/* See IPSEC_MODE_XX in ipsec.h. */</span>
  u_int8_t sadb_x_ipsecrequest_level;	<span class="enscript-comment">/* See IPSEC_LEVEL_XX in ipsec.h */</span>
  u_int16_t sadb_x_ipsecrequest_reqid;	<span class="enscript-comment">/* See ipsec.h */</span>

  <span class="enscript-comment">/*
   * followed by source IP address of SA, and immediately followed by
   * destination IP address of SA.  These encoded into two of sockaddr
   * structure without any padding.  Must set each sa_len exactly.
   * Each of length of the sockaddr structure are not aligned to 64bits,
   * but sum of x_request and addresses is aligned to 64bits.
   */</span>
};

<span class="enscript-type">struct</span> sadb_session_id {
        u_int16_t            sadb_session_id_len;
        u_int16_t            sadb_session_id_exttype;
       <span class="enscript-comment">/* [0] is an arbitrary handle that means something only for requester
        * [1] is a global session id for lookups in the kernel and racoon.
        */</span>
        u_int64_t            sadb_session_id_v[2];
} __attribute__ ((aligned(8)));

<span class="enscript-type">struct</span> sastat {
	u_int32_t            spi;		<span class="enscript-comment">/* SPI Value, network byte order */</span>
	u_int32_t            created;	        <span class="enscript-comment">/* for lifetime */</span>
	<span class="enscript-type">struct</span> sadb_lifetime lft_c;	        <span class="enscript-comment">/* CURRENT lifetime. */</span>
}; <span class="enscript-comment">// no need to align
</span>
<span class="enscript-type">struct</span> sadb_sastat {
        u_int16_t            sadb_sastat_len;
        u_int16_t            sadb_sastat_exttype;
        u_int32_t            sadb_sastat_dir;
        u_int32_t            sadb_sastat_reserved;
        u_int32_t            sadb_sastat_list_len;
        <span class="enscript-comment">/* list of struct sastat comes after */</span>
} __attribute__ ((aligned(8)));

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_RESERVED</span>             0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_SA</span>                   1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_LIFETIME_CURRENT</span>     2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_LIFETIME_HARD</span>        3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_LIFETIME_SOFT</span>        4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_ADDRESS_SRC</span>          5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_ADDRESS_DST</span>          6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_ADDRESS_PROXY</span>        7
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_KEY_AUTH</span>             8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_KEY_ENCRYPT</span>          9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_IDENTITY_SRC</span>         10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_IDENTITY_DST</span>         11
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_SENSITIVITY</span>          12
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_PROPOSAL</span>             13
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_SUPPORTED_AUTH</span>       14
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_SUPPORTED_ENCRYPT</span>    15
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_SPIRANGE</span>             16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_KMPRIVATE</span>          17
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_POLICY</span>             18
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_SA2</span>                19
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_SESSION_ID</span>           20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_SASTAT</span>               21
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_IPSECIF</span>            22
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_ADDR_RANGE_SRC_START</span> 23
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_ADDR_RANGE_SRC_END</span>   24
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_ADDR_RANGE_DST_START</span> 25
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_ADDR_RANGE_DST_END</span>   26
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_MIGRATE_ADDRESS_SRC</span>  27
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_MIGRATE_ADDRESS_DST</span>  28
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_MIGRATE_IPSECIF</span>    29
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EXT_MAX</span>                  29

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_UNSPEC</span>	0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_AH</span>		2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_ESP</span>		3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_RSVP</span>	5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_OSPFV2</span>	6
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_RIPV2</span>	7
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_MIP</span>		8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SATYPE_IPCOMP</span>	9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_SATYPE_POLICY</span>	10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SATYPE_MAX</span>		11

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SASTATE_LARVAL</span>   0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SASTATE_MATURE</span>   1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SASTATE_DYING</span>    2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SASTATE_DEAD</span>     3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SASTATE_MAX</span>      3

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_SAFLAGS_PFS</span>      1

<span class="enscript-comment">/* RFC2367 numbers - meets RFC2407 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_AALG_NONE</span>		0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_AALG_MD5HMAC</span>	1	<span class="enscript-comment">/*2*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_AALG_SHA1HMAC</span>	2	<span class="enscript-comment">/*3*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_AALG_MAX</span>		8
<span class="enscript-comment">/* private allocations - based on RFC2407/IANA assignment */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_AALG_SHA2_256</span>	6	<span class="enscript-comment">/*5*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_AALG_SHA2_384</span>	7	<span class="enscript-comment">/*6*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_AALG_SHA2_512</span>	8	<span class="enscript-comment">/*7*/</span>
<span class="enscript-comment">/* private allocations should use 249-255 (RFC2407) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_AALG_MD5</span>		3	<span class="enscript-comment">/*249*/</span>	<span class="enscript-comment">/* Keyed MD5 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_AALG_SHA</span>		4	<span class="enscript-comment">/*250*/</span>	<span class="enscript-comment">/* Keyed SHA */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_AALG_NULL</span>	5	<span class="enscript-comment">/*251*/</span>	<span class="enscript-comment">/* null authentication */</span>

<span class="enscript-comment">/* RFC2367 numbers - meets RFC2407 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EALG_NONE</span>		0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EALG_DESCBC</span>	1	<span class="enscript-comment">/*2*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EALG_3DESCBC</span>	2	<span class="enscript-comment">/*3*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EALG_NULL</span>		3	<span class="enscript-comment">/*11*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_EALG_MAX</span>		12
<span class="enscript-comment">/* private allocations - based on RFC2407/IANA assignment */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EALG_CAST128CBC</span>	5	<span class="enscript-comment">/*6*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EALG_BLOWFISHCBC</span>	4	<span class="enscript-comment">/*7*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EALG_RIJNDAELCBC</span>	12
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EALG_AESCBC</span>      12
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EALG_AES</span>		12
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EALG_AES_GCM</span>     13
<span class="enscript-comment">/* private allocations should use 249-255 (RFC2407) */</span>

#<span class="enscript-reference">if</span> 1	<span class="enscript-comment">/*nonstandard */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_CALG_NONE</span>	0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_CALG_OUI</span>		1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_CALG_DEFLATE</span>	2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_CALG_LZS</span>		3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_CALG_MAX</span>		4
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_IDENTTYPE_RESERVED</span>   0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_IDENTTYPE_PREFIX</span>     1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_IDENTTYPE_FQDN</span>       2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_IDENTTYPE_USERFQDN</span>   3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_IDENTTYPE_ADDR</span>     4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_IDENTTYPE_MAX</span>        4

<span class="enscript-comment">/* `flags' in sadb_sa structure holds followings */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_NONE</span>		0x0000	<span class="enscript-comment">/* i.e. new format. */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_OLD</span>		0x0001	<span class="enscript-comment">/* old format. */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_NATT</span>				0x0002	<span class="enscript-comment">/* Use UDP encapsulation to traverse NAT */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_NATT_KEEPALIVE</span>	0x0004	<span class="enscript-comment">/* Local node is behind NAT, send keepalives */</span>
											<span class="enscript-comment">/* Should only be set for outbound SAs */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_NATT_MULTIPLEUSERS</span> 0x0008	<span class="enscript-comment">/* For use on VPN server - support multiple users 	*/</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>	

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_IV4B</span>		0x0010	<span class="enscript-comment">/* IV length of 4 bytes in use */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_DERIV</span>	0x0020	<span class="enscript-comment">/* DES derived */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_CYCSEQ</span>	0x0040	<span class="enscript-comment">/* allowing to cyclic sequence. */</span>

	<span class="enscript-comment">/* three of followings are exclusive flags each them */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_PSEQ</span>		0x0000	<span class="enscript-comment">/* sequencial padding for ESP */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_PRAND</span>	0x0100	<span class="enscript-comment">/* random padding for ESP */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_PZERO</span>	0x0200	<span class="enscript-comment">/* zero padding for ESP */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_PMASK</span>	0x0300	<span class="enscript-comment">/* mask for padding flag */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_NATT_DETECTED_PEER</span> 0x1000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_ESP_KEEPALIVE</span>      0x2000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_PUNT_RX_KEEPALIVE</span>  0x4000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_NATT_KEEPALIVE_OFFLOAD</span>  0x8000
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>	

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NATT_KEEPALIVE_OFFLOAD_INTERVAL</span>	0x1
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> 1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_RAWCPI</span>	0x0080	<span class="enscript-comment">/* use well known CPI (IPComp) */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_KEY_FLAGS_MAX</span>	0x7fff

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_EXT_SA2_DELETE_ON_DETACH</span>   0x0001
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* SPI size for PF_KEYv2 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PFKEY_SPI_SIZE</span>	sizeof(u_int32_t)

<span class="enscript-comment">/* Identifier for menber of lifetime structure */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_LIFETIME_ALLOCATIONS</span>	0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_LIFETIME_BYTES</span>		1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_LIFETIME_ADDTIME</span>		2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SADB_X_LIFETIME_USETIME</span>		3

<span class="enscript-comment">/* The rate for SOFT lifetime against HARD one. */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PFKEY_SOFT_LIFETIME_RATE</span>	80

<span class="enscript-comment">/* Utilities */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">PFKEY_ALIGN8</span>(a) (1 + (((a) - 1) | (8 - 1)))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">PFKEY_EXTLEN</span>(msg) \
	PFKEY_UNUNIT64(((<span class="enscript-type">struct</span> sadb_ext *)(msg))-&gt;sadb_ext_len)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">PFKEY_ADDR_PREFIX</span>(ext) \
	(((<span class="enscript-type">struct</span> sadb_address *)(ext))-&gt;sadb_address_prefixlen)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">PFKEY_ADDR_PROTO</span>(ext) \
	(((<span class="enscript-type">struct</span> sadb_address *)(ext))-&gt;sadb_address_proto)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">PFKEY_ADDR_SADDR</span>(ext) \
	((<span class="enscript-type">struct</span> sockaddr *)((caddr_t)(ext) + <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">struct</span> sadb_address)))

<span class="enscript-comment">/* in 64bits */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">PFKEY_UNUNIT64</span>(a)	((a) &lt;&lt; 3)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">PFKEY_UNIT64</span>(a)		((a) &gt;&gt; 3)

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __PFKEY_V2_H */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _NET_PFKEYV2_H_ */</span>
</pre>
<hr />
</body></html>