<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>in6_proto.c</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">in6_proto.c&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2008-2015 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 *
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 *
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

<span class="enscript-comment">/*
 * Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the project nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */</span>

<span class="enscript-comment">/*
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)in_proto.c	8.1 (Berkeley) 6/10/93
 */</span>


#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/param.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/socket.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/socketvar.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/protosw.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/kernel.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/domain.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/mbuf.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/systm.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/sysctl.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/if.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/radix.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/route.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/in.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/in_systm.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/in_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/ip_encap.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/ip.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/ip_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/ip6.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ip6_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/in6_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/icmp6.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/tcp.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/tcp_timer.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/tcp_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/udp.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet/udp_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/tcp6_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/raw_ip6.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/udp6_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/nd6.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/mld6_var.h&gt;</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">IPSEC</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ipsec.h&gt;</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">INET6</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ipsec6.h&gt;</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ah.h&gt;</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">INET6</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ah6.h&gt;</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">IPSEC_ESP</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/esp.h&gt;</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">INET6</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/esp6.h&gt;</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ipcomp.h&gt;</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">INET6</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ipcomp6.h&gt;</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/*IPSEC*/</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/ip6protosw.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/net_osdep.h&gt;</span>

<span class="enscript-comment">/*
 * TCP/IP protocol family: IP6, ICMP6, UDP, TCP.
 */</span>

<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> domain inet6domain_s;
<span class="enscript-type">struct</span> domain *inet6domain = NULL;

<span class="enscript-type">static</span> <span class="enscript-type">struct</span> pr_usrreqs nousrreqs;
lck_mtx_t *inet6_domain_mutex;

<span class="enscript-type">static</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_dinit</span>(<span class="enscript-type">struct</span> domain *);
<span class="enscript-type">static</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip6_pr_output</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> socket *,
    <span class="enscript-type">struct</span> sockaddr_in6 *, <span class="enscript-type">struct</span> mbuf *);

<span class="enscript-type">struct</span> ip6protosw inet6sw[] = {
{
	.pr_type =		0,
	.pr_protocol =		IPPROTO_IPV6,
	.pr_init =		ip6_init,
	.pr_drain =		ip6_drain,
	.pr_usrreqs =		&amp;nousrreqs,
},
{
	.pr_type =		SOCK_DGRAM,
	.pr_protocol =		IPPROTO_UDP,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_PROTOLOCK|PR_PCBLOCK|
				PR_EVCONNINFO|PR_PRECONN_WRITE,
	.pr_input =		udp6_input,
	.pr_ctlinput =		udp6_ctlinput,
	.pr_ctloutput =		ip6_ctloutput,
#<span class="enscript-reference">if</span> !<span class="enscript-variable-name">INET</span>	<span class="enscript-comment">/* don't call initialization twice */</span>
	.pr_init =		udp_init,
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !INET */</span>
	.pr_usrreqs =		&amp;udp6_usrreqs,
	.pr_lock =		udp_lock,
	.pr_unlock =		udp_unlock,
	.pr_getlock =		udp_getlock,
},
{
	.pr_type =		SOCK_STREAM,
	.pr_protocol =		IPPROTO_TCP,
	.pr_flags =		PR_CONNREQUIRED|PR_WANTRCVD|PR_PCBLOCK|
				PR_PROTOLOCK|PR_DISPOSE|PR_EVCONNINFO|
				PR_PRECONN_WRITE|PR_DATA_IDEMPOTENT,
	.pr_input =		tcp6_input,
	.pr_ctlinput =		tcp6_ctlinput,
	.pr_ctloutput =		tcp_ctloutput,
#<span class="enscript-reference">if</span> !<span class="enscript-variable-name">INET</span>	<span class="enscript-comment">/* don't call initialization and timeout routines twice */</span>
	.pr_init =		tcp_init,
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !INET */</span>
	.pr_drain =		tcp_drain,
	.pr_usrreqs =		&amp;tcp6_usrreqs,
	.pr_lock =		tcp_lock,
	.pr_unlock =		tcp_unlock,
	.pr_getlock =		tcp_getlock,
},
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_RAW,
	.pr_flags =		PR_ATOMIC|PR_ADDR,
	.pr_input =		rip6_input,
	.pr_output =		rip6_pr_output,
	.pr_ctlinput =		rip6_ctlinput,
	.pr_ctloutput =		rip6_ctloutput,
#<span class="enscript-reference">if</span> !<span class="enscript-variable-name">INET</span>	<span class="enscript-comment">/* don't call initialization and timeout routines twice */</span>
	.pr_init =		rip_init,
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !INET */</span>
	.pr_usrreqs =		&amp;rip6_usrreqs,
	.pr_unlock =		rip_unlock,
},
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_ICMPV6,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_LASTHDR,
	.pr_input =		icmp6_input,
	.pr_output =		rip6_pr_output,
	.pr_ctlinput =		rip6_ctlinput,
	.pr_ctloutput =		rip6_ctloutput,
	.pr_init =		icmp6_init,
	.pr_usrreqs =		&amp;rip6_usrreqs,
	.pr_unlock =		rip_unlock,
},
{
	.pr_type =		SOCK_DGRAM,
	.pr_protocol =		IPPROTO_ICMPV6,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_LASTHDR,
	.pr_input =		icmp6_input,
	.pr_output =		rip6_pr_output,
	.pr_ctlinput =		rip6_ctlinput,
	.pr_ctloutput =		icmp6_dgram_ctloutput,
	.pr_init =		icmp6_init,
	.pr_usrreqs =		&amp;icmp6_dgram_usrreqs,
	.pr_unlock =		rip_unlock,
},
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_DSTOPTS,
	.pr_flags =		PR_ATOMIC|PR_ADDR,
	.pr_input =		dest6_input,
	.pr_usrreqs =		&amp;nousrreqs,
},
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_ROUTING,
	.pr_flags =		PR_ATOMIC|PR_ADDR,
	.pr_input =		route6_input,
	.pr_usrreqs =		&amp;nousrreqs,
},
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_FRAGMENT,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_PROTOLOCK,
	.pr_input =		frag6_input,
	.pr_usrreqs =		&amp;nousrreqs,
},
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">IPSEC</span>
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_AH,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_PROTOLOCK,
	.pr_input =		ah6_input,
	.pr_usrreqs =		&amp;nousrreqs,
},
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">IPSEC_ESP</span>
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_ESP,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_PROTOLOCK,
	.pr_input =		esp6_input,
	.pr_ctlinput =		esp6_ctlinput,
	.pr_usrreqs =		&amp;nousrreqs,
},
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* IPSEC_ESP */</span>
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_IPCOMP,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_PROTOLOCK,
	.pr_input =		ipcomp6_input,
	.pr_usrreqs =		&amp;nousrreqs,
},
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* IPSEC */</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">INET</span>
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_IPV4,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_LASTHDR,
	.pr_input =		encap6_input,
	.pr_output =		rip6_pr_output,
	.pr_ctloutput =		rip6_ctloutput,
	.pr_init =		encap6_init,
	.pr_usrreqs =		&amp;rip6_usrreqs,
	.pr_unlock =		rip_unlock,
},
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/*INET*/</span>
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		IPPROTO_IPV6,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_LASTHDR,
	.pr_input =		encap6_input,
	.pr_output =		rip6_pr_output,
	.pr_ctloutput =		rip6_ctloutput,
	.pr_init =		encap6_init,
	.pr_usrreqs =		&amp;rip6_usrreqs,
	.pr_unlock =		rip_unlock,
},
<span class="enscript-comment">/* raw wildcard */</span>
{
	.pr_type =		SOCK_RAW,
	.pr_protocol =		0,
	.pr_flags =		PR_ATOMIC|PR_ADDR|PR_LASTHDR,
	.pr_input =		rip6_input,
	.pr_output =		rip6_pr_output,
	.pr_ctloutput =		rip6_ctloutput,
	.pr_usrreqs =		&amp;rip6_usrreqs,
	.pr_unlock =		rip_unlock,
},
};

<span class="enscript-type">int</span> in6_proto_count = (<span class="enscript-keyword">sizeof</span> (inet6sw) / <span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> ip6protosw));

<span class="enscript-type">struct</span> domain inet6domain_s = {
	.dom_family =		PF_INET6,
	.dom_flags =		DOM_REENTRANT,
	.dom_name =		<span class="enscript-string">&quot;internet6&quot;</span>,
	.dom_init =		in6_dinit,
	.dom_rtattach =		in6_inithead,
	.dom_rtoffset =		offsetof(<span class="enscript-type">struct</span> sockaddr_in6, sin6_addr) &lt;&lt; 3,
	.dom_maxrtkey =		<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> sockaddr_in6),
	.dom_protohdrlen =	<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> sockaddr_in6),
};

<span class="enscript-comment">/* Initialize the PF_INET6 domain, and add in the pre-defined protos */</span>
<span class="enscript-type">void</span>
<span class="enscript-function-name">in6_dinit</span>(<span class="enscript-type">struct</span> domain *dp)
{
	<span class="enscript-type">struct</span> ip6protosw *pr;
	<span class="enscript-type">int</span> i;

	VERIFY(!(dp-&gt;dom_flags &amp; DOM_INITIALIZED));
	VERIFY(inet6domain == NULL);

	inet6domain = dp;

	_CASSERT(<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> protosw) == <span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> ip6protosw));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_entry) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_entry));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_domain) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_domain));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_protosw) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_protosw));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_type) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_type));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_protocol) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_protocol));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_flags) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_flags));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_input) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_input));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_output) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_output));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_ctlinput) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_ctlinput));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_ctloutput) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_ctloutput));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_usrreqs) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_usrreqs));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_init) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_init));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_drain) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_drain));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_sysctl) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_sysctl));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_lock) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_lock));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_unlock) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_unlock));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_getlock) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_getlock));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_filter_head) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_filter_head));
	_CASSERT(offsetof(<span class="enscript-type">struct</span> ip6protosw, pr_old) ==
	    offsetof(<span class="enscript-type">struct</span> protosw, pr_old));

	<span class="enscript-comment">/*
	 * Attach first, then initialize.  ip6_init() needs raw IP6 handler.
	 */</span>
	<span class="enscript-keyword">for</span> (i = 0, pr = &amp;inet6sw[0]; i &lt; in6_proto_count; i++, pr++)
		net_add_proto((<span class="enscript-type">struct</span> protosw *)pr, dp, 0);
	<span class="enscript-keyword">for</span> (i = 0, pr = &amp;inet6sw[0]; i &lt; in6_proto_count; i++, pr++)
		net_init_proto((<span class="enscript-type">struct</span> protosw *)pr, dp);

	inet6_domain_mutex = dp-&gt;dom_mtx;
}

<span class="enscript-type">static</span> <span class="enscript-type">int</span>
<span class="enscript-function-name">rip6_pr_output</span>(<span class="enscript-type">struct</span> mbuf *m, <span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr_in6 *sin6,
    <span class="enscript-type">struct</span> mbuf *m1)
{
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">unused</span>(<span class="enscript-variable-name">m</span>, <span class="enscript-variable-name">so</span>, <span class="enscript-variable-name">sin6</span>, <span class="enscript-variable-name">m1</span>)
	panic(<span class="enscript-string">&quot;%s\n&quot;</span>, __func__);
	<span class="enscript-comment">/* NOTREACHED */</span>
	<span class="enscript-keyword">return</span> (0);
}

<span class="enscript-comment">/*
 * Internet configuration info
 */</span>
#<span class="enscript-reference">ifndef</span>	<span class="enscript-variable-name">IPV6FORWARDING</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">GATEWAY6</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6FORWARDING</span>	1	<span class="enscript-comment">/* forward IP6 packets not for us */</span>
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6FORWARDING</span>	0	<span class="enscript-comment">/* don't forward IP6 packets not for us */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* GATEWAY6 */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !IPV6FORWARDING */</span>

#<span class="enscript-reference">ifndef</span>	<span class="enscript-variable-name">IPV6_SENDREDIRECTS</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_SENDREDIRECTS</span>	1
#<span class="enscript-reference">endif</span>

<span class="enscript-type">int</span>	ip6_forwarding = IPV6FORWARDING;	<span class="enscript-comment">/* act as router? */</span>
<span class="enscript-type">int</span>	ip6_sendredirects = IPV6_SENDREDIRECTS;
<span class="enscript-type">int</span>	ip6_defhlim = IPV6_DEFHLIM;
<span class="enscript-type">int</span>	ip6_defmcasthlim = IPV6_DEFAULT_MULTICAST_HOPS;
<span class="enscript-type">int</span>	ip6_accept_rtadv = 1;	<span class="enscript-comment">/* deprecated */</span>
<span class="enscript-type">int</span>	ip6_log_interval = 5;
<span class="enscript-type">int</span>	ip6_hdrnestlimit = 15;	<span class="enscript-comment">/* How many header options will we process? */</span>
<span class="enscript-type">int</span>	ip6_dad_count = 1;	<span class="enscript-comment">/* DupAddrDetectionTransmits */</span>
<span class="enscript-type">int</span>	ip6_auto_flowlabel = 1;
<span class="enscript-type">int</span>	ip6_gif_hlim = 0;
<span class="enscript-type">int</span>	ip6_use_deprecated = 1;	<span class="enscript-comment">/* allow deprecated addr [RFC 4862, 5.5.4] */</span>
<span class="enscript-type">int</span>	ip6_rr_prune = 5;	<span class="enscript-comment">/* router renumbering prefix
				 * walk list every 5 sec.    */</span>
<span class="enscript-type">int</span>	ip6_mcast_pmtu = 0;	<span class="enscript-comment">/* enable pMTU discovery for multicast? */</span>
<span class="enscript-type">int</span>	ip6_v6only = 0;		<span class="enscript-comment">/* Mapped addresses off by default -  Radar 3347718  -- REVISITING FOR 10.7 -- TESTING WITH MAPPED@ OFF */</span>

<span class="enscript-type">int</span>	ip6_neighborgcthresh = 1024;	<span class="enscript-comment">/* Threshold # of NDP entries for GC */</span>
<span class="enscript-type">int</span>	ip6_maxifprefixes = 16;		<span class="enscript-comment">/* Max acceptable prefixes via RA per IF */</span>
<span class="enscript-type">int</span>	ip6_maxifdefrouters = 16;	<span class="enscript-comment">/* Max acceptable def routers via RA */</span>
<span class="enscript-type">int</span>	ip6_maxdynroutes = 1024;	<span class="enscript-comment">/* Max # of routes created via redirect */</span>
<span class="enscript-type">int</span>	ip6_only_allow_rfc4193_prefix = 0;	<span class="enscript-comment">/* Only allow RFC4193 style Unique Local IPv6 Unicast prefixes */</span>

<span class="enscript-type">static</span> <span class="enscript-type">int</span> ip6_keepfaith = 0;
uint64_t ip6_log_time = 0;
<span class="enscript-type">int</span>	nd6_onlink_ns_rfc4861 = 0; <span class="enscript-comment">/* allow 'on-link' nd6 NS (as in RFC 4861) */</span>

<span class="enscript-comment">/* icmp6 */</span>
<span class="enscript-comment">/*
 * BSDI4 defines these variables in in_proto.c...
 * XXX: what if we don't define INET? Should we define pmtu6_expire
 * or so? (<a href="mailto:jinmei@kame.net">jinmei@kame.net</a> 19990310)
 */</span>
<span class="enscript-type">int</span> pmtu_expire = 60*10;
<span class="enscript-type">int</span> pmtu_probe = 60*2;

<span class="enscript-comment">/* raw IP6 parameters */</span>
<span class="enscript-comment">/*
 * Nominal space allocated to a raw ip socket.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">RIPV6SNDQ</span>	8192
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">RIPV6RCVQ</span>	8192

u_int32_t	rip6_sendspace = RIPV6SNDQ;
u_int32_t	rip6_recvspace = RIPV6RCVQ;

<span class="enscript-comment">/* ICMPV6 parameters */</span>
<span class="enscript-type">int</span>	icmp6_rediraccept = 0;		<span class="enscript-comment">/* accept and process redirects */</span>
<span class="enscript-type">int</span>	icmp6_redirtimeout = 10 * 60;	<span class="enscript-comment">/* 10 minutes */</span>
<span class="enscript-type">int</span>	icmp6errppslim = 500;		<span class="enscript-comment">/* 500 packets per second */</span>
<span class="enscript-type">int</span>	icmp6rappslim = 10;		<span class="enscript-comment">/* 10 packets per second */</span>
<span class="enscript-type">int</span>	icmp6_nodeinfo = 3;		<span class="enscript-comment">/* enable/disable NI response */</span>

<span class="enscript-comment">/* UDP on IP6 parameters */</span>
<span class="enscript-type">int</span>	udp6_sendspace = 9216;		<span class="enscript-comment">/* really max datagram size */</span>
<span class="enscript-type">int</span>	udp6_recvspace = 40 * (1024 + <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">struct</span> sockaddr_in6));
					<span class="enscript-comment">/* 40 1K datagrams */</span>

<span class="enscript-comment">/*
 * sysctl related items.
 */</span>
<span class="enscript-function-name">SYSCTL_NODE</span>(_net, PF_INET6, inet6,
	CTLFLAG_RW | CTLFLAG_LOCKED, 0, <span class="enscript-string">&quot;Internet6 Family&quot;</span>);

<span class="enscript-comment">/* net.inet6 */</span>
<span class="enscript-function-name">SYSCTL_NODE</span>(_net_inet6,	IPPROTO_IPV6, ip6,
	CTLFLAG_RW|CTLFLAG_LOCKED, 0, <span class="enscript-string">&quot;IP6&quot;</span>);
<span class="enscript-function-name">SYSCTL_NODE</span>(_net_inet6,	IPPROTO_ICMPV6, icmp6,
	CTLFLAG_RW|CTLFLAG_LOCKED, 0, <span class="enscript-string">&quot;ICMP6&quot;</span>);
<span class="enscript-function-name">SYSCTL_NODE</span>(_net_inet6,	IPPROTO_UDP, udp6,
	CTLFLAG_RW|CTLFLAG_LOCKED, 0, <span class="enscript-string">&quot;UDP6&quot;</span>);
<span class="enscript-function-name">SYSCTL_NODE</span>(_net_inet6,	IPPROTO_TCP, tcp6,
	CTLFLAG_RW|CTLFLAG_LOCKED, 0, <span class="enscript-string">&quot;TCP6&quot;</span>);
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">IPSEC</span>
<span class="enscript-function-name">SYSCTL_NODE</span>(_net_inet6,	IPPROTO_ESP, ipsec6,
	CTLFLAG_RW|CTLFLAG_LOCKED, 0, <span class="enscript-string">&quot;IPSEC6&quot;</span>);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* IPSEC */</span>

<span class="enscript-comment">/* net.inet6.ip6 */</span>
<span class="enscript-type">static</span> <span class="enscript-type">int</span>
sysctl_ip6_temppltime SYSCTL_HANDLER_ARGS
{
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">unused</span>(<span class="enscript-variable-name">oidp</span>, <span class="enscript-variable-name">arg2</span>)
	<span class="enscript-type">int</span> error = 0;
	<span class="enscript-type">int</span> old;

	error = SYSCTL_OUT(req, arg1, <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">int</span>));
	<span class="enscript-keyword">if</span> (error || !req-&gt;newptr)
		<span class="enscript-keyword">return</span> (error);
	old = ip6_temp_preferred_lifetime;
	error = SYSCTL_IN(req, arg1, <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">int</span>));
	<span class="enscript-keyword">if</span> (ip6_temp_preferred_lifetime &gt; ND6_MAX_LIFETIME ||
	    ip6_temp_preferred_lifetime &lt;
	    ip6_desync_factor + ip6_temp_regen_advance) {
		ip6_temp_preferred_lifetime = old;
		<span class="enscript-keyword">return</span> (EINVAL);
	}
	<span class="enscript-keyword">return</span> (error);
}

<span class="enscript-type">static</span> <span class="enscript-type">int</span>
sysctl_ip6_tempvltime SYSCTL_HANDLER_ARGS
{
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">unused</span>(<span class="enscript-variable-name">oidp</span>, <span class="enscript-variable-name">arg2</span>)
	<span class="enscript-type">int</span> error = 0;
	<span class="enscript-type">int</span> old;

	error = SYSCTL_OUT(req, arg1, <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">int</span>));
	<span class="enscript-keyword">if</span> (error || !req-&gt;newptr)
		<span class="enscript-keyword">return</span> (error);
	old = ip6_temp_valid_lifetime;
	error = SYSCTL_IN(req, arg1, <span class="enscript-keyword">sizeof</span>(<span class="enscript-type">int</span>));
	<span class="enscript-keyword">if</span> (ip6_temp_valid_lifetime &gt; ND6_MAX_LIFETIME ||
	    ip6_temp_valid_lifetime &lt; ip6_temp_preferred_lifetime) {
		ip6_temp_valid_lifetime = old;
		<span class="enscript-keyword">return</span> (EINVAL);
	}
	<span class="enscript-keyword">return</span> (error);
}

<span class="enscript-type">static</span> <span class="enscript-type">int</span>
ip6_getstat SYSCTL_HANDLER_ARGS
{
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">unused</span>(<span class="enscript-variable-name">oidp</span>, <span class="enscript-variable-name">arg1</span>, <span class="enscript-variable-name">arg2</span>)
	<span class="enscript-keyword">if</span> (req-&gt;oldptr == USER_ADDR_NULL)
		req-&gt;oldlen = (size_t)<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> ip6stat);

	<span class="enscript-keyword">return</span> (SYSCTL_OUT(req, &amp;ip6stat, MIN(<span class="enscript-keyword">sizeof</span> (ip6stat), req-&gt;oldlen)));
}

<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_FORWARDING,
	forwarding, CTLFLAG_RW | CTLFLAG_LOCKED, 	&amp;ip6_forwarding,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_SENDREDIRECTS,
	redirect, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_sendredirects,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_DEFHLIM,
	hlim, CTLFLAG_RW | CTLFLAG_LOCKED,		&amp;ip6_defhlim,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_PROC</span>(_net_inet6_ip6, IPV6CTL_STATS, stats,
	CTLTYPE_STRUCT | CTLFLAG_RD | CTLFLAG_LOCKED,
	0, 0, ip6_getstat, <span class="enscript-string">&quot;S,ip6stat&quot;</span>, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_ACCEPT_RTADV,
	accept_rtadv, CTLFLAG_RD | CTLFLAG_LOCKED,
	&amp;ip6_accept_rtadv,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_KEEPFAITH,
	keepfaith, CTLFLAG_RD | CTLFLAG_LOCKED,		&amp;ip6_keepfaith,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_LOG_INTERVAL,
	log_interval, CTLFLAG_RW | CTLFLAG_LOCKED, &amp;ip6_log_interval,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_HDRNESTLIMIT,
	hdrnestlimit, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_hdrnestlimit,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_DAD_COUNT,
	dad_count, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_dad_count,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_AUTO_FLOWLABEL,
	auto_flowlabel, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_auto_flowlabel,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_DEFMCASTHLIM,
	defmcasthlim, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_defmcasthlim,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_GIF_HLIM,
	gifhlim, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_gif_hlim,			0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_STRING</span>(_net_inet6_ip6, IPV6CTL_KAME_VERSION,
	kame_version, CTLFLAG_RD | CTLFLAG_LOCKED, (<span class="enscript-type">void</span> *)((uintptr_t)(__KAME_VERSION)),		0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_USE_DEPRECATED,
	use_deprecated, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_use_deprecated,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_RR_PRUNE,
	rr_prune, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_rr_prune,			0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_USETEMPADDR,
	use_tempaddr, CTLFLAG_RW | CTLFLAG_LOCKED, &amp;ip6_use_tempaddr,		0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_OID</span>(_net_inet6_ip6, IPV6CTL_TEMPPLTIME, temppltime,
	   CTLTYPE_INT|CTLFLAG_RW | CTLFLAG_LOCKED, &amp;ip6_temp_preferred_lifetime, 0,
	   sysctl_ip6_temppltime, <span class="enscript-string">&quot;I&quot;</span>, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_OID</span>(_net_inet6_ip6, IPV6CTL_TEMPVLTIME, tempvltime,
	   CTLTYPE_INT|CTLFLAG_RW | CTLFLAG_LOCKED, &amp;ip6_temp_valid_lifetime, 0,
	   sysctl_ip6_tempvltime, <span class="enscript-string">&quot;I&quot;</span>, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_V6ONLY,
	v6only,	CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_v6only,		0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_AUTO_LINKLOCAL,
	auto_linklocal, CTLFLAG_RW | CTLFLAG_LOCKED, &amp;ip6_auto_linklocal,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_STRUCT</span>(_net_inet6_ip6, IPV6CTL_RIP6STATS, rip6stats, CTLFLAG_RD | CTLFLAG_LOCKED,
	&amp;rip6stat, rip6stat, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_PREFER_TEMPADDR,
	prefer_tempaddr, CTLFLAG_RW | CTLFLAG_LOCKED, &amp;ip6_prefer_tempaddr,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_USE_DEFAULTZONE,
	use_defaultzone, CTLFLAG_RW | CTLFLAG_LOCKED, &amp;ip6_use_defzone,		0,<span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_MCAST_PMTU,
	mcast_pmtu, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_mcast_pmtu,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_NEIGHBORGCTHRESH,
	neighborgcthresh, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_neighborgcthresh,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_MAXIFPREFIXES,
	maxifprefixes, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_maxifprefixes,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_MAXIFDEFROUTERS,
	maxifdefrouters, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_maxifdefrouters,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, IPV6CTL_MAXDYNROUTES,
	maxdynroutes, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;ip6_maxdynroutes,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_ip6, OID_AUTO,
	only_allow_rfc4193_prefixes, CTLFLAG_RW | CTLFLAG_LOCKED,
	&amp;ip6_only_allow_rfc4193_prefix,	0, <span class="enscript-string">&quot;&quot;</span>);

<span class="enscript-comment">/* net.inet6.icmp6 */</span>
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_REDIRACCEPT,
	rediraccept, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;icmp6_rediraccept,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_REDIRTIMEOUT,
	redirtimeout, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;icmp6_redirtimeout,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_STRUCT</span>(_net_inet6_icmp6, ICMPV6CTL_STATS, stats, CTLFLAG_RD | CTLFLAG_LOCKED,
	&amp;icmp6stat, icmp6stat, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_PRUNE,
	nd6_prune, CTLFLAG_RW | CTLFLAG_LOCKED,		&amp;nd6_prune,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, OID_AUTO,
	nd6_prune_lazy, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;nd6_prune_lazy, 0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_DELAY,
	nd6_delay, CTLFLAG_RW | CTLFLAG_LOCKED,		&amp;nd6_delay,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_UMAXTRIES,
	nd6_umaxtries, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;nd6_umaxtries,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_MMAXTRIES,
	nd6_mmaxtries, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;nd6_mmaxtries,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_USELOOPBACK,
	nd6_useloopback, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;nd6_useloopback, 0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_ACCEPT_6TO4,
	nd6_accept_6to4, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;nd6_accept_6to4, 0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_NODEINFO,
	nodeinfo, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;icmp6_nodeinfo,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ERRPPSLIMIT,
	errppslimit, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;icmp6errppslim,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, OID_AUTO,
	rappslimit, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;icmp6rappslim,	0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_DEBUG,
	nd6_debug, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;nd6_debug,		0, <span class="enscript-string">&quot;&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_ONLINKNSRFC4861,
	nd6_onlink_ns_rfc4861, CTLFLAG_RW | CTLFLAG_LOCKED, &amp;nd6_onlink_ns_rfc4861, 0,
	<span class="enscript-string">&quot;Accept 'on-link' nd6 NS in compliance with RFC 4861.&quot;</span>);
<span class="enscript-function-name">SYSCTL_INT</span>(_net_inet6_icmp6, ICMPV6CTL_ND6_OPTIMISTIC_DAD,
	nd6_optimistic_dad, CTLFLAG_RW | CTLFLAG_LOCKED,	&amp;nd6_optimistic_dad,		0, <span class="enscript-string">&quot;&quot;</span>);
</pre>
<hr />
</body></html>