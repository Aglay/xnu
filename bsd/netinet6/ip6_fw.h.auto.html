<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>ip6_fw.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">ip6_fw.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2008-2013 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*
 * Copyright (c) 1993 Daniel Boulet
 * Copyright (c) 1994 Ugen J.S.Antsilevich
 *
 * Redistribution and use in source forms, with and without modification,
 * are permitted provided that this entire comment appears intact.
 *
 * Redistribution in binary form may occur without any restrictions.
 * Obviously, it would be nice if you gave credit where credit is due
 * but requiring it would be too onerous.
 *
 * This software is provided ``AS IS'' without any warranties of any kind.
 *
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_IP6_FW_H</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_IP6_FW_H</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE_API_OBSOLETE</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>

<span class="enscript-comment">/*
 * Define IPv6 Firewall event subclass, and associated events.
 */</span>

<span class="enscript-comment">/*!
	@defined KEV_IP6FW_SUBCLASS
	@discussion The kernel event subclass for IPv6 Firewall.
*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KEV_IP6FW_SUBCLASS</span>	2

<span class="enscript-comment">/*!
	@defined KEV_IP6FW_ADD
	@discussion The event code indicating a rule has been added.
*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KEV_IP6FW_ADD</span>		1

<span class="enscript-comment">/*!
	@defined KEV_IP6FW_DEL
	@discussion The event code indicating a rule has been removed.
*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KEV_IP6FW_DEL</span>		2

<span class="enscript-comment">/*!
	@defined KEV_IP6FW_FLUSH
	@discussion The event code indicating the rule set has been flushed.
*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KEV_IP6FW_FLUSH</span>		3

<span class="enscript-comment">/*!
	@defined KEV_IP6FW_FLUSH
	@discussion The event code indicating the enable flag has been changed 
*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KEV_IP6FW_ENABLE</span>	4


#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/if.h&gt;</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_CURRENT_API_VERSION</span> 20	<span class="enscript-comment">/* Version of this API */</span>


<span class="enscript-comment">/*
 * This union structure identifies an interface, either explicitly
 * by name or implicitly by IP address. The flags IP_FW_F_IIFNAME
 * and IP_FW_F_OIFNAME say how to interpret this structure. An
 * interface unit number of -1 matches any unit number, while an
 * IP address of 0.0.0.0 indicates matches any interface.
 *
 * The receive and transmit interfaces are only compared against the
 * the packet if the corresponding bit (IP_FW_F_IIFACE or IP_FW_F_OIFACE)
 * is set. Note some packets lack a receive or transmit interface
 * (in which case the missing &quot;interface&quot; never matches).
 */</span>

<span class="enscript-type">union</span> ip6_fw_if {
    <span class="enscript-type">struct</span> in6_addr fu_via_ip6;	<span class="enscript-comment">/* Specified by IPv6 address */</span>
    <span class="enscript-type">struct</span> {			<span class="enscript-comment">/* Specified by interface name */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IP6FW_IFNLEN</span>     IFNAMSIZ
	    <span class="enscript-type">char</span>  name[IP6FW_IFNLEN];
	    <span class="enscript-type">short</span> unit;		<span class="enscript-comment">/* -1 means match any unit */</span>
    } fu_via_if;
};

<span class="enscript-comment">/*
 * Format of an IP firewall descriptor
 *
 * fw_src, fw_dst, fw_smsk, fw_dmsk are always stored in network byte order.
 * fw_flg and fw_n*p are stored in host byte order (of course).
 * Port numbers are stored in HOST byte order.
 * Warning: setsockopt() will fail if sizeof(struct ip_fw) &gt; MLEN (108)
 */</span>


<span class="enscript-type">struct</span> ip6_fw {
	u_int32_t version;		<span class="enscript-comment">/* Version of this structure.  Should always be */</span>
							<span class="enscript-comment">/* set to IP6_FW_CURRENT_API_VERSION by clients. */</span>
	<span class="enscript-type">void</span> *context;			<span class="enscript-comment">/* Context that is usable by user processes to */</span>
							<span class="enscript-comment">/* identify this rule. */</span>
    u_int32_t fw_pcnt,fw_bcnt;		<span class="enscript-comment">/* Packet and byte counters */</span>
    <span class="enscript-type">struct</span> in6_addr fw_src, fw_dst;	<span class="enscript-comment">/* Source and destination IPv6 addr */</span>
    <span class="enscript-type">struct</span> in6_addr fw_smsk, fw_dmsk;	<span class="enscript-comment">/* Mask for src and dest IPv6 addr */</span>
    u_short fw_number;			<span class="enscript-comment">/* Rule number */</span>
    u_short fw_flg;			<span class="enscript-comment">/* Flags word */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_MAX_PORTS</span>	10	<span class="enscript-comment">/* A reasonable maximum */</span>
    u_int fw_ipflg;			<span class="enscript-comment">/* IP flags word */</span>
    u_short fw_pts[IPV6_FW_MAX_PORTS];	<span class="enscript-comment">/* Array of port numbers to match */</span>
    u_char fw_ip6opt,fw_ip6nopt;	<span class="enscript-comment">/* IPv6 options set/unset */</span>
    u_char fw_tcpf,fw_tcpnf;		<span class="enscript-comment">/* TCP flags set/unset */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_ICMPTYPES_DIM</span> (256 / (sizeof(unsigned) * 8))
    <span class="enscript-type">unsigned</span> fw_icmp6types[IPV6_FW_ICMPTYPES_DIM]; <span class="enscript-comment">/* ICMP types bitmap */</span>
    <span class="enscript-type">long</span> timestamp;			<span class="enscript-comment">/* timestamp (tv_sec) of last match */</span>
    <span class="enscript-type">union</span> ip6_fw_if fw_in_if, fw_out_if;<span class="enscript-comment">/* Incoming and outgoing interfaces */</span>
    <span class="enscript-type">union</span> {
	u_short fu_divert_port;		<span class="enscript-comment">/* Divert/tee port (options IP6DIVERT) */</span>
	u_short fu_skipto_rule;		<span class="enscript-comment">/* SKIPTO command rule number */</span>
	u_short fu_reject_code;		<span class="enscript-comment">/* REJECT response code */</span>
    } fw_un;
    u_char fw_prot;			<span class="enscript-comment">/* IPv6 protocol */</span>
    u_char fw_nports;			<span class="enscript-comment">/* N'of src ports and # of dst ports */</span>
					<span class="enscript-comment">/* in ports array (dst ports follow */</span>
					<span class="enscript-comment">/* src ports; max of 10 ports in all; */</span>
					<span class="enscript-comment">/* count of 0 means match all ports) */</span>
};

#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>)
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>(4)

<span class="enscript-type">struct</span> ip6_fw_32 {
	u_int32_t version;		<span class="enscript-comment">/* Version of this structure.  Should always be */</span>
	<span class="enscript-comment">/* set to IP6_FW_CURRENT_API_VERSION by clients. */</span>
	user32_addr_t context;			<span class="enscript-comment">/* Context that is usable by user processes to */</span>
	<span class="enscript-comment">/* identify this rule. */</span>
    u_int32_t fw_pcnt,fw_bcnt;		<span class="enscript-comment">/* Packet and byte counters */</span>
    <span class="enscript-type">struct</span> in6_addr fw_src, fw_dst;	<span class="enscript-comment">/* Source and destination IPv6 addr */</span>
    <span class="enscript-type">struct</span> in6_addr fw_smsk, fw_dmsk;	<span class="enscript-comment">/* Mask for src and dest IPv6 addr */</span>
    u_short fw_number;			<span class="enscript-comment">/* Rule number */</span>
    u_short fw_flg;			<span class="enscript-comment">/* Flags word */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_MAX_PORTS</span>	10	<span class="enscript-comment">/* A reasonable maximum */</span>
    u_int fw_ipflg;			<span class="enscript-comment">/* IP flags word */</span>
    u_short fw_pts[IPV6_FW_MAX_PORTS];	<span class="enscript-comment">/* Array of port numbers to match */</span>
    u_char fw_ip6opt,fw_ip6nopt;	<span class="enscript-comment">/* IPv6 options set/unset */</span>
    u_char fw_tcpf,fw_tcpnf;		<span class="enscript-comment">/* TCP flags set/unset */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_ICMPTYPES_DIM</span> (256 / (sizeof(unsigned) * 8))
    <span class="enscript-type">unsigned</span> fw_icmp6types[IPV6_FW_ICMPTYPES_DIM]; <span class="enscript-comment">/* ICMP types bitmap */</span>
    user32_time_t timestamp;			<span class="enscript-comment">/* timestamp (tv_sec) of last match */</span>
    <span class="enscript-type">union</span> ip6_fw_if fw_in_if, fw_out_if;<span class="enscript-comment">/* Incoming and outgoing interfaces */</span>
    <span class="enscript-type">union</span> {
		u_short fu_divert_port;		<span class="enscript-comment">/* Divert/tee port (options IP6DIVERT) */</span>
		u_short fu_skipto_rule;		<span class="enscript-comment">/* SKIPTO command rule number */</span>
		u_short fu_reject_code;		<span class="enscript-comment">/* REJECT response code */</span>
    } fw_un;
    u_char fw_prot;			<span class="enscript-comment">/* IPv6 protocol */</span>
    u_char fw_nports;			<span class="enscript-comment">/* N'of src ports and # of dst ports */</span>
	<span class="enscript-comment">/* in ports array (dst ports follow */</span>
	<span class="enscript-comment">/* src ports; max of 10 ports in all; */</span>
	<span class="enscript-comment">/* count of 0 means match all ports) */</span>
};

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>()

<span class="enscript-type">struct</span> ip6_fw_64 {
	u_int32_t version;	 	<span class="enscript-comment">/* Version of this structure.  Should always be */</span>
	<span class="enscript-comment">/* set to IP6_FW_CURRENT_API_VERSION by clients. */</span>
	__uint64_t context __attribute__((aligned(8)));			<span class="enscript-comment">/* Context that is usable by user processes to */</span>
	<span class="enscript-comment">/* identify this rule. */</span>
    u_int32_t fw_pcnt,fw_bcnt;		<span class="enscript-comment">/* Packet and byte counters */</span>
    <span class="enscript-type">struct</span> in6_addr fw_src, fw_dst;	<span class="enscript-comment">/* Source and destination IPv6 addr */</span>
    <span class="enscript-type">struct</span> in6_addr fw_smsk, fw_dmsk;	<span class="enscript-comment">/* Mask for src and dest IPv6 addr */</span>
    u_short fw_number;			<span class="enscript-comment">/* Rule number */</span>
    u_short fw_flg;			<span class="enscript-comment">/* Flags word */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_MAX_PORTS</span>	10	<span class="enscript-comment">/* A reasonable maximum */</span>
    u_int fw_ipflg;			<span class="enscript-comment">/* IP flags word */</span>
    u_short fw_pts[IPV6_FW_MAX_PORTS];	<span class="enscript-comment">/* Array of port numbers to match */</span>
    u_char fw_ip6opt,fw_ip6nopt;	<span class="enscript-comment">/* IPv6 options set/unset */</span>
    u_char fw_tcpf,fw_tcpnf;		<span class="enscript-comment">/* TCP flags set/unset */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_ICMPTYPES_DIM</span> (256 / (sizeof(unsigned) * 8))
    <span class="enscript-type">unsigned</span> fw_icmp6types[IPV6_FW_ICMPTYPES_DIM]; <span class="enscript-comment">/* ICMP types bitmap */</span>
    user64_time_t timestamp;			<span class="enscript-comment">/* timestamp (tv_sec) of last match */</span>
    <span class="enscript-type">union</span> ip6_fw_if fw_in_if, fw_out_if;<span class="enscript-comment">/* Incoming and outgoing interfaces */</span>
    <span class="enscript-type">union</span> {
		u_short fu_divert_port;		<span class="enscript-comment">/* Divert/tee port (options IP6DIVERT) */</span>
		u_short fu_skipto_rule;		<span class="enscript-comment">/* SKIPTO command rule number */</span>
		u_short fu_reject_code;		<span class="enscript-comment">/* REJECT response code */</span>
    } fw_un;
    u_char fw_prot;			<span class="enscript-comment">/* IPv6 protocol */</span>
    u_char fw_nports;			<span class="enscript-comment">/* N'of src ports and # of dst ports */</span>
	<span class="enscript-comment">/* in ports array (dst ports follow */</span>
	<span class="enscript-comment">/* src ports; max of 10 ports in all; */</span>
	<span class="enscript-comment">/* count of 0 means match all ports) */</span>
};


#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">IPV6_FW_GETNSRCP</span>(rule)		((rule)-&gt;fw_nports &amp; 0x0f)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IPV6_FW_SETNSRCP</span>(rule, n)		do {				\
					  (rule)-&gt;fw_nports &amp;= ~0x0f;	\
					  (rule)-&gt;fw_nports |= (n);	\
					} <span class="enscript-keyword">while</span> (0)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IPV6_FW_GETNDSTP</span>(rule)		((rule)-&gt;fw_nports &gt;&gt; 4)
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IPV6_FW_SETNDSTP</span>(rule, n)		do {				\
					  (rule)-&gt;fw_nports &amp;= ~0xf0;	\
					  (rule)-&gt;fw_nports |= (n) &lt;&lt; 4;\
					} <span class="enscript-keyword">while</span> (0)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">fw_divert_port</span>	fw_un.fu_divert_port
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">fw_skipto_rule</span>	fw_un.fu_skipto_rule
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">fw_reject_code</span>	fw_un.fu_reject_code

<span class="enscript-type">struct</span> ip6_fw_chain {
        LIST_ENTRY(ip6_fw_chain) chain;
        <span class="enscript-type">struct</span> ip6_fw    *rule;
};

<span class="enscript-comment">/*
 * Values for &quot;flags&quot; field .
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_IN</span>	0x0001	<span class="enscript-comment">/* Check inbound packets		*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_OUT</span>	0x0002	<span class="enscript-comment">/* Check outbound packets		*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_IIFACE</span>	0x0004	<span class="enscript-comment">/* Apply inbound interface test		*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_OIFACE</span>	0x0008	<span class="enscript-comment">/* Apply outbound interface test	*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_COMMAND</span> 0x0070	<span class="enscript-comment">/* Mask for type of chain entry:	*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_DENY</span>	0x0000	<span class="enscript-comment">/* This is a deny rule			*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_REJECT</span>	0x0010	<span class="enscript-comment">/* Deny and send a response packet	*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_ACCEPT</span>	0x0020	<span class="enscript-comment">/* This is an accept rule		*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_COUNT</span>	0x0030	<span class="enscript-comment">/* This is a count rule			*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_DIVERT</span>	0x0040	<span class="enscript-comment">/* This is a divert rule		*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_TEE</span>	0x0050	<span class="enscript-comment">/* This is a tee rule			*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_SKIPTO</span>	0x0060	<span class="enscript-comment">/* This is a skipto rule		*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_PRN</span>	0x0080	<span class="enscript-comment">/* Print if this rule matches		*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_SRNG</span>	0x0100	<span class="enscript-comment">/* The first two src ports are a min	*
				 * and max range (stored in host byte	*
				 * order).				*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_DRNG</span>	0x0200	<span class="enscript-comment">/* The first two dst ports are a min	*
				 * and max range (stored in host byte	*
				 * order).				*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_IIFNAME</span>	0x0400	<span class="enscript-comment">/* In interface by name/unit (not IP)	*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_OIFNAME</span>	0x0800	<span class="enscript-comment">/* Out interface by name/unit (not IP)	*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_INVSRC</span>	0x1000	<span class="enscript-comment">/* Invert sense of src check		*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_INVDST</span>	0x2000	<span class="enscript-comment">/* Invert sense of dst check		*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_FRAG</span>	0x4000	<span class="enscript-comment">/* Fragment				*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_ICMPBIT</span> 0x8000	<span class="enscript-comment">/* ICMP type bitmap is valid		*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_F_MASK</span>	0xFFFF	<span class="enscript-comment">/* All possible flag bits mask		*/</span>

<span class="enscript-comment">/* 
 * Flags for the 'fw_ipflg' field, for comparing values of ip and its protocols. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FW_IF_TCPEST</span> 0x00000020	<span class="enscript-comment">/* established TCP connection	*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IF_TCPMSK</span> 0x00000020	<span class="enscript-comment">/* mask of all TCP values */</span>

<span class="enscript-comment">/*
 * For backwards compatibility with rules specifying &quot;via iface&quot; but
 * not restricted to only &quot;in&quot; or &quot;out&quot; packets, we define this combination
 * of bits to represent this configuration.
 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IF6_FW_F_VIAHACK</span>	(IPV6_FW_F_IN|IPV6_FW_F_OUT|IPV6_FW_F_IIFACE|IPV6_FW_F_OIFACE)

<span class="enscript-comment">/*
 * Definitions for REJECT response codes.
 * Values less than 256 correspond to ICMP unreachable codes.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_REJECT_RST</span>	0x0100		<span class="enscript-comment">/* TCP packets: send RST */</span>

<span class="enscript-comment">/*
 * Definitions for IPv6 option names.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IP6OPT_HOPOPT</span>	0x01
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IP6OPT_ROUTE</span>	0x02
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IP6OPT_FRAG</span>	0x04
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IP6OPT_ESP</span>	0x08
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IP6OPT_AH</span>	0x10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IP6OPT_NONXT</span>	0x20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_IP6OPT_OPTS</span>	0x40

<span class="enscript-comment">/*
 * Definitions for TCP flags.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_TCPF_FIN</span>	TH_FIN
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_TCPF_SYN</span>	TH_SYN
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_TCPF_RST</span>	TH_RST
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_TCPF_PSH</span>	TH_PUSH
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_TCPF_ACK</span>	TH_ACK
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">IPV6_FW_TCPF_URG</span>	TH_URG

<span class="enscript-comment">/*
 * Main firewall chains definitions and global var's definitions.
 */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">M_IP6FW</span> M_IPFW


<span class="enscript-comment">/*
 * Function definitions.
 */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ip6_fw_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">void</span> <span class="enscript-function-name">load_ip6fw</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* Firewall hooks */</span>
<span class="enscript-type">struct</span> ip6_hdr;
<span class="enscript-type">struct</span> sockopt;
<span class="enscript-type">typedef</span>	<span class="enscript-type">int</span> ip6_fw_chk_t(<span class="enscript-type">struct</span> ip6_hdr**, <span class="enscript-type">struct</span> ifnet*,
				u_short *, <span class="enscript-type">struct</span> mbuf**);
<span class="enscript-type">typedef</span>	<span class="enscript-type">int</span> ip6_fw_ctl_t(<span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span>	ip6_fw_chk_t *ip6_fw_chk_ptr;
<span class="enscript-type">extern</span>	ip6_fw_ctl_t *ip6_fw_ctl_ptr;
<span class="enscript-type">extern</span>	<span class="enscript-type">int</span> ip6_fw_enable;

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __APPLE_API_OBSOLETE */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _IP6_FW_H */</span>
</pre>
<hr />
</body></html>