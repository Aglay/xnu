<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>ip6_var.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">ip6_var.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2015 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 *
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 *
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

<span class="enscript-comment">/*
 * Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the project nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */</span>

<span class="enscript-comment">/*
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)ip_var.h	8.1 (Berkeley) 6/10/93
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NETINET6_IP6_VAR_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_NETINET6_IP6_VAR_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/ethernet.h&gt;</span>

<span class="enscript-comment">/*
 * IP6 reassembly queue structure.  Each fragment
 * being reassembled is attached to one of these structures.
 */</span>
<span class="enscript-type">struct</span>	ip6q {
	<span class="enscript-type">struct</span> ip6asfrag *ip6q_down;
	<span class="enscript-type">struct</span> ip6asfrag *ip6q_up;
	u_int32_t	ip6q_ident;
	u_int8_t	ip6q_nxt;
	u_int8_t	ip6q_ecn;
	u_int8_t	ip6q_ttl;
	<span class="enscript-type">struct</span> in6_addr ip6q_src, ip6q_dst;
	<span class="enscript-type">struct</span> ip6q	*ip6q_next;
	<span class="enscript-type">struct</span> ip6q	*ip6q_prev;
	<span class="enscript-type">int</span>		ip6q_unfrglen;	<span class="enscript-comment">/* len of unfragmentable part */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">notyet</span>
	u_char	*ip6q_nxtp;
#<span class="enscript-reference">endif</span>
	<span class="enscript-type">int</span>		ip6q_nfrag;	<span class="enscript-comment">/* # of fragments */</span>
	uint32_t	ip6q_csum_flags; <span class="enscript-comment">/* checksum flags */</span>
	uint32_t	ip6q_csum;	<span class="enscript-comment">/* partial checksum value */</span>
};

<span class="enscript-type">struct</span>	ip6asfrag {
	<span class="enscript-type">struct</span> ip6asfrag *ip6af_down;
	<span class="enscript-type">struct</span> ip6asfrag *ip6af_up;
	<span class="enscript-type">struct</span> mbuf	*ip6af_m;
	<span class="enscript-type">int</span>		ip6af_offset;	<span class="enscript-comment">/* offset in ip6af_m to next header */</span>
	<span class="enscript-type">int</span>		ip6af_frglen;	<span class="enscript-comment">/* fragmentable part length */</span>
	<span class="enscript-type">int</span>		ip6af_off;	<span class="enscript-comment">/* fragment offset */</span>
	u_int16_t	ip6af_mff;	<span class="enscript-comment">/* more fragment bit in frag off */</span>
};

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IP6_REASS_MBUF</span>(ip6af) (*(struct mbuf **)&amp;((ip6af)-&gt;ip6af_m))

<span class="enscript-type">struct</span>	ip6_moptions {
	decl_lck_mtx_data(, im6o_lock);
	uint32_t im6o_refcnt;		<span class="enscript-comment">/* ref count */</span>
	uint32_t im6o_debug;		<span class="enscript-comment">/* see ifa_debug flags */</span>
	<span class="enscript-type">struct</span>	ifnet *im6o_multicast_ifp; <span class="enscript-comment">/* ifp for outgoing multicasts */</span>
	u_char	im6o_multicast_hlim;	<span class="enscript-comment">/* hoplimit for outgoing multicasts */</span>
	u_char	im6o_multicast_loop;	<span class="enscript-comment">/* 1 &gt;= hear sends if a member */</span>
	u_short	im6o_num_memberships;	<span class="enscript-comment">/* no. memberships this socket */</span>
	u_short	im6o_max_memberships;	<span class="enscript-comment">/* max memberships this socket */</span>
	<span class="enscript-type">struct</span>	in6_multi **im6o_membership;	<span class="enscript-comment">/* group memberships */</span>
	<span class="enscript-type">struct</span>	in6_mfilter *im6o_mfilters;	<span class="enscript-comment">/* source filters */</span>
	<span class="enscript-type">void</span> (*im6o_trace)		<span class="enscript-comment">/* callback fn for tracing refs */</span>
	    (<span class="enscript-type">struct</span> ip6_moptions *, <span class="enscript-type">int</span>);
};

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_LOCK_ASSERT_HELD</span>(_im6o)					\
	lck_mtx_assert(&amp;(_im6o)-&gt;im6o_lock, LCK_MTX_ASSERT_OWNED)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_LOCK_ASSERT_NOTHELD</span>(_im6o)					\
	lck_mtx_assert(&amp;(_im6o)-&gt;im6o_lock, LCK_MTX_ASSERT_NOTOWNED)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_LOCK</span>(_im6o)						\
	lck_mtx_lock(&amp;(_im6o)-&gt;im6o_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_LOCK_SPIN</span>(_im6o)						\
	lck_mtx_lock_spin(&amp;(_im6o)-&gt;im6o_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_CONVERT_LOCK</span>(_im6o) do {					\
	IM6O_LOCK_ASSERT_HELD(_im6o);					\
	lck_mtx_convert_spin(&amp;(_im6o)-&gt;im6o_lock);			\
} <span class="enscript-keyword">while</span> (0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_UNLOCK</span>(_im6o)						\
	lck_mtx_unlock(&amp;(_im6o)-&gt;im6o_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_ADDREF</span>(_im6o)						\
	im6o_addref(_im6o, 0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_ADDREF_LOCKED</span>(_im6o)					\
	im6o_addref(_im6o, 1)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IM6O_REMREF</span>(_im6o)						\
	im6o_remref(_im6o)

<span class="enscript-type">struct</span> ip6_exthdrs {
	<span class="enscript-type">struct</span> mbuf *ip6e_ip6;
	<span class="enscript-type">struct</span> mbuf *ip6e_hbh;
	<span class="enscript-type">struct</span> mbuf *ip6e_dest1;
	<span class="enscript-type">struct</span> mbuf *ip6e_rthdr;
	<span class="enscript-type">struct</span> mbuf *ip6e_dest2;
	boolean_t merged;
};

<span class="enscript-comment">/*
 * Control options for outgoing packets
 */</span>

<span class="enscript-comment">/* Routing header related info */</span>
<span class="enscript-type">struct</span>	ip6po_rhinfo {
	<span class="enscript-type">struct</span>	ip6_rthdr *ip6po_rhi_rthdr; <span class="enscript-comment">/* Routing header */</span>
	<span class="enscript-type">struct</span>	route_in6 ip6po_rhi_route; <span class="enscript-comment">/* Route to the 1st hop */</span>
};
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ip6po_rthdr</span>	ip6po_rhinfo.ip6po_rhi_rthdr
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ip6po_route</span>	ip6po_rhinfo.ip6po_rhi_route

<span class="enscript-comment">/* Nexthop related info */</span>
<span class="enscript-type">struct</span>	ip6po_nhinfo {
	<span class="enscript-type">struct</span>	sockaddr *ip6po_nhi_nexthop;
	<span class="enscript-type">struct</span>	route_in6 ip6po_nhi_route; <span class="enscript-comment">/* Route to the nexthop */</span>
};
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ip6po_nexthop</span>	ip6po_nhinfo.ip6po_nhi_nexthop
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ip6po_nextroute</span>	ip6po_nhinfo.ip6po_nhi_route

<span class="enscript-type">struct</span>	ip6_pktopts {
	<span class="enscript-type">struct</span>	mbuf *ip6po_m;	<span class="enscript-comment">/* Pointer to mbuf storing the data */</span>
	<span class="enscript-type">int</span>	ip6po_hlim;	<span class="enscript-comment">/* Hoplimit for outgoing packets */</span>

	<span class="enscript-comment">/* Outgoing IF/address information */</span>
	<span class="enscript-type">struct</span>	in6_pktinfo *ip6po_pktinfo;

	<span class="enscript-comment">/* Next-hop address information */</span>
	<span class="enscript-type">struct</span>	ip6po_nhinfo ip6po_nhinfo;

	<span class="enscript-type">struct</span>	ip6_hbh *ip6po_hbh; <span class="enscript-comment">/* Hop-by-Hop options header */</span>

	<span class="enscript-comment">/* Destination options header (before a routing header) */</span>
	<span class="enscript-type">struct</span>	ip6_dest *ip6po_dest1;

	<span class="enscript-comment">/* Routing header related info. */</span>
	<span class="enscript-type">struct</span>	ip6po_rhinfo ip6po_rhinfo;

	<span class="enscript-comment">/* Destination options header (after a routing header) */</span>
	<span class="enscript-type">struct</span>	ip6_dest *ip6po_dest2;

	<span class="enscript-type">int</span>	ip6po_tclass;	<span class="enscript-comment">/* traffic class */</span>

	<span class="enscript-type">int</span>	ip6po_minmtu;  <span class="enscript-comment">/* fragment vs PMTU discovery policy */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_MINMTU_MCASTONLY</span>	-1 <span class="enscript-comment">/* default; send at min MTU for multicast */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_MINMTU_DISABLE</span>	 0 <span class="enscript-comment">/* always perform pmtu disc */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_MINMTU_ALL</span>	 1 <span class="enscript-comment">/* always send at min MTU */</span>

	<span class="enscript-comment">/* whether temporary addresses are preferred as source address */</span>
	<span class="enscript-type">int</span>	ip6po_prefer_tempaddr;

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_TEMPADDR_SYSTEM</span>	-1 <span class="enscript-comment">/* follow the system default */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_TEMPADDR_NOTPREFER</span> 0 <span class="enscript-comment">/* not prefer temporary address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_TEMPADDR_PREFER</span>	 1 <span class="enscript-comment">/* prefer temporary address */</span>

	<span class="enscript-type">int</span> ip6po_flags;
#<span class="enscript-reference">if</span> 0	<span class="enscript-comment">/* parameters in this block is obsolete. do not reuse the values. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_REACHCONF</span>	0x01	<span class="enscript-comment">/* upper-layer reachability confirmation. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_MINMTU</span>	0x02	<span class="enscript-comment">/* use minimum MTU (IPV6_USE_MIN_MTU) */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_DONTFRAG</span>		0x04	<span class="enscript-comment">/* no fragmentation (IPV6_DONTFRAG) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6PO_USECOA</span>		0x08	<span class="enscript-comment">/* use care of address */</span>
};

<span class="enscript-comment">/*
 * Control options for incoming packets
 */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6S_SRCRULE_COUNT</span> 16
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/scope6_var.h&gt;</span>

<span class="enscript-type">struct</span>	ip6stat {
	u_quad_t ip6s_total;		<span class="enscript-comment">/* total packets received */</span>
	u_quad_t ip6s_tooshort;		<span class="enscript-comment">/* packet too short */</span>
	u_quad_t ip6s_toosmall;		<span class="enscript-comment">/* not enough data */</span>
	u_quad_t ip6s_fragments;	<span class="enscript-comment">/* fragments received */</span>
	u_quad_t ip6s_fragdropped;	<span class="enscript-comment">/* frags dropped(dups, out of space) */</span>
	u_quad_t ip6s_fragtimeout;	<span class="enscript-comment">/* fragments timed out */</span>
	u_quad_t ip6s_fragoverflow;	<span class="enscript-comment">/* fragments that exceeded limit */</span>
	u_quad_t ip6s_forward;		<span class="enscript-comment">/* packets forwarded */</span>
	u_quad_t ip6s_cantforward;	<span class="enscript-comment">/* packets rcvd for unreachable dest */</span>
	u_quad_t ip6s_redirectsent;	<span class="enscript-comment">/* packets forwarded on same net */</span>
	u_quad_t ip6s_delivered;	<span class="enscript-comment">/* datagrams delivered to upper level */</span>
	u_quad_t ip6s_localout;		<span class="enscript-comment">/* total ip packets generated here */</span>
	u_quad_t ip6s_odropped;		<span class="enscript-comment">/* lost packets due to nobufs, etc. */</span>
	u_quad_t ip6s_reassembled;	<span class="enscript-comment">/* total packets reassembled ok */</span>
	u_quad_t ip6s_fragmented;	<span class="enscript-comment">/* datagrams successfully fragmented */</span>
	u_quad_t ip6s_ofragments;	<span class="enscript-comment">/* output fragments created */</span>
	u_quad_t ip6s_cantfrag;		<span class="enscript-comment">/* don't fragment flag was set, etc. */</span>
	u_quad_t ip6s_badoptions;	<span class="enscript-comment">/* error in option processing */</span>
	u_quad_t ip6s_noroute;		<span class="enscript-comment">/* packets discarded due to no route */</span>
	u_quad_t ip6s_badvers;		<span class="enscript-comment">/* ip6 version != 6 */</span>
	u_quad_t ip6s_rawout;		<span class="enscript-comment">/* total raw ip packets generated */</span>
	u_quad_t ip6s_badscope;		<span class="enscript-comment">/* scope error */</span>
	u_quad_t ip6s_notmember;	<span class="enscript-comment">/* don't join this multicast group */</span>
	u_quad_t ip6s_nxthist[256];	<span class="enscript-comment">/* next header history */</span>
	u_quad_t ip6s_m1;		<span class="enscript-comment">/* one mbuf */</span>
	u_quad_t ip6s_m2m[32];		<span class="enscript-comment">/* two or more mbuf */</span>
	u_quad_t ip6s_mext1;		<span class="enscript-comment">/* one ext mbuf */</span>
	u_quad_t ip6s_mext2m;		<span class="enscript-comment">/* two or more ext mbuf */</span>
	u_quad_t ip6s_exthdrtoolong;	<span class="enscript-comment">/* ext hdr are not continuous */</span>
	u_quad_t ip6s_nogif;		<span class="enscript-comment">/* no match gif found */</span>
	u_quad_t ip6s_toomanyhdr;	<span class="enscript-comment">/* discarded due to too many headers */</span>

	<span class="enscript-comment">/*
	 * statistics for improvement of the source address selection
	 * algorithm:
	 */</span>
	<span class="enscript-comment">/* number of times that address selection fails */</span>
	u_quad_t ip6s_sources_none;
	<span class="enscript-comment">/* number of times that an address on the outgoing I/F is chosen */</span>
	u_quad_t ip6s_sources_sameif[SCOPE6_ID_MAX];
	<span class="enscript-comment">/* number of times that an address on a non-outgoing I/F is chosen */</span>
	u_quad_t ip6s_sources_otherif[SCOPE6_ID_MAX];
	<span class="enscript-comment">/*
	 * number of times that an address that has the same scope
	 * from the destination is chosen.
	 */</span>
	u_quad_t ip6s_sources_samescope[SCOPE6_ID_MAX];
	<span class="enscript-comment">/*
	 * number of times that an address that has a different scope
	 * from the destination is chosen.
	 */</span>
	u_quad_t ip6s_sources_otherscope[SCOPE6_ID_MAX];
	<span class="enscript-comment">/* number of times that a deprecated address is chosen */</span>
	u_quad_t ip6s_sources_deprecated[SCOPE6_ID_MAX];

	u_quad_t ip6s_forward_cachehit;
	u_quad_t ip6s_forward_cachemiss;

	<span class="enscript-comment">/* number of times that each rule of source selection is applied. */</span>
	u_quad_t ip6s_sources_rule[IP6S_SRCRULE_COUNT];

	<span class="enscript-comment">/* number of times we ignored address on expensive secondary interfaces */</span>
	u_quad_t ip6s_sources_skip_expensive_secondary_if;

	<span class="enscript-comment">/* pkt dropped, no mbufs for control data */</span>
	u_quad_t ip6s_pktdropcntrl;

	<span class="enscript-comment">/* total packets trimmed/adjusted  */</span>
	u_quad_t ip6s_adj;
	<span class="enscript-comment">/* hwcksum info discarded during adjustment */</span>
	u_quad_t ip6s_adj_hwcsum_clr;

	<span class="enscript-comment">/* duplicate address detection collisions */</span>
	u_quad_t ip6s_dad_collide;
};

<span class="enscript-type">enum</span> ip6s_sources_rule_index {
	IP6S_SRCRULE_0, IP6S_SRCRULE_1, IP6S_SRCRULE_2, IP6S_SRCRULE_3, IP6S_SRCRULE_4,
	IP6S_SRCRULE_5, IP6S_SRCRULE_5_5, IP6S_SRCRULE_6, IP6S_SRCRULE_7,
	IP6S_SRCRULE_7x, IP6S_SRCRULE_8
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * IPv6 onion peeling state.
 *
 * This is currently allocated for packets destined to the all-nodes
 * multicast address over Ethernet.  IPv6 destination address information
 * is now stored in the mbuf itself.
 */</span>
<span class="enscript-type">struct</span> ip6aux {
	u_int32_t ip6a_flags;
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6A_HASEEN</span>	0x01		<span class="enscript-comment">/* HA was present */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">notyet</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6A_SWAP</span>	0x02		<span class="enscript-comment">/* swapped home/care-of on packet */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6A_BRUID</span>	0x04		<span class="enscript-comment">/* BR Unique Identifier was present */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6A_RTALERTSEEN</span> 0x08		<span class="enscript-comment">/* rtalert present */</span>

	<span class="enscript-comment">/* ip6.ip6_src */</span>
	<span class="enscript-type">struct</span> in6_addr ip6a_careof;	<span class="enscript-comment">/* care-of address of the peer */</span>
	<span class="enscript-type">struct</span> in6_addr ip6a_home;	<span class="enscript-comment">/* home address of the peer */</span>
	u_int16_t	ip6a_bruid;	<span class="enscript-comment">/* BR unique identifier */</span>

	<span class="enscript-comment">/* rtalert */</span>
	u_int16_t ip6a_rtalert;		<span class="enscript-comment">/* rtalert option value */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* notyet */</span>

	<span class="enscript-comment">/* ether source address if all-nodes multicast destination */</span>
	u_char ip6a_ehsrc[ETHER_ADDR_LEN];
};

<span class="enscript-comment">/* flags passed to ip6_output as last parameter */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_UNSPECSRC</span>		0x01	<span class="enscript-comment">/* allow :: as the source address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FORWARDING</span>		0x02	<span class="enscript-comment">/* most of IPv6 header exists */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MINMTU</span>		0x04	<span class="enscript-comment">/* use minimum MTU (IPV6_USE_MIN_MTU) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FLAG_NOSRCIFSEL</span>	0x80	<span class="enscript-comment">/* bypas source address selection */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_OUTARGS</span>		0x100	<span class="enscript-comment">/* has ancillary output info */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IP6_HDR_ALIGNED_P</span>(_ip6)	((((uintptr_t)(_ip6)) &amp; ((uintptr_t)3)) == 0)

<span class="enscript-comment">/*
 * On platforms which require strict alignment (currently for anything but
 * i386 or x86_64), this macro checks whether the pointer to the IP header
 * is 32-bit aligned, and assert otherwise.
 */</span>
#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__i386__</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__x86_64__</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IP6_HDR_STRICT_ALIGNMENT_CHECK</span>(_ip6) do { } while (0)
#<span class="enscript-reference">else</span> <span class="enscript-comment">/* !__i386__ &amp;&amp; !__x86_64__ */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IP6_HDR_STRICT_ALIGNMENT_CHECK</span>(_ip6) do {			\
	<span class="enscript-keyword">if</span> (!IP_HDR_ALIGNED_P(_ip6)) {					\
		panic_plain(<span class="enscript-string">&quot;\n%s: Unaligned IPv6 header %p\n&quot;</span>,		\
		    __func__, _ip6);					\
	}								\
} <span class="enscript-keyword">while</span> (0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !__i386__ &amp;&amp; !__x86_64__ */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/flowadv.h&gt;</span>

<span class="enscript-comment">/*
 * Extra information passed to ip6_output when IPV6_OUTARGS is set.
 */</span>
<span class="enscript-type">struct</span> ip6_out_args {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	ip6oa_boundif;	<span class="enscript-comment">/* bound outgoing interface */</span>
	<span class="enscript-type">struct</span> flowadv	ip6oa_flowadv;	<span class="enscript-comment">/* flow advisory code */</span>
	u_int32_t	ip6oa_flags;	<span class="enscript-comment">/* IP6OAF flags (see below) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6OAF_SELECT_SRCIF</span>	0x00000001	<span class="enscript-comment">/* src interface selection */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6OAF_BOUND_IF</span>		0x00000002	<span class="enscript-comment">/* boundif value is valid */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6OAF_BOUND_SRCADDR</span>	0x00000004	<span class="enscript-comment">/* bound to src address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6OAF_NO_CELLULAR</span>	0x00000010	<span class="enscript-comment">/* skip IFT_CELLULAR */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6OAF_NO_EXPENSIVE</span>	0x00000020	<span class="enscript-comment">/* skip IFEF_EXPENSIVE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6OAF_AWDL_UNRESTRICTED</span> 0x00000040	<span class="enscript-comment">/* privileged AWDL */</span>
	u_int32_t	ip6oa_retflags;	<span class="enscript-comment">/* IP6OARF return flags (see below) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IP6OARF_IFDENIED</span>	0x00000001	<span class="enscript-comment">/* denied access to interface */</span>
};

<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> ip6stat ip6stat;	<span class="enscript-comment">/* statistics */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_defhlim;		<span class="enscript-comment">/* default hop limit */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_defmcasthlim;	<span class="enscript-comment">/* default multicast hop limit */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_forwarding;	<span class="enscript-comment">/* act as router? */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_gif_hlim;	<span class="enscript-comment">/* Hop limit for gif encap packet */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_use_deprecated;	<span class="enscript-comment">/* allow deprecated addr as source */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_rr_prune;	<span class="enscript-comment">/* router renumbering prefix */</span>
				<span class="enscript-comment">/*   walk list every 5 sec. */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_mcast_pmtu;	<span class="enscript-comment">/* enable pMTU discovery for multicast? */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ip6_mapped_addr_on</span>	(!ip6_v6only)
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_v6only;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_neighborgcthresh; <span class="enscript-comment">/* Threshold # of NDP entries for GC */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_maxifprefixes;	<span class="enscript-comment">/* Max acceptable prefixes via RA per IF */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_maxifdefrouters;	<span class="enscript-comment">/* Max acceptable def routers via RA */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_maxdynroutes;	<span class="enscript-comment">/* Max # of routes created via redirect */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_sendredirects;	<span class="enscript-comment">/* send IP redirects when forwarding? */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_accept_rtadv;	<span class="enscript-comment">/* deprecated */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_log_interval;
<span class="enscript-type">extern</span> uint64_t ip6_log_time;
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_hdrnestlimit;	<span class="enscript-comment">/* upper limit of # of extension headers */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_dad_count;	<span class="enscript-comment">/* DupAddrDetectionTransmits */</span>

<span class="enscript-comment">/* RFC4193 Unique Local Unicast Prefixes only */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_only_allow_rfc4193_prefix;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_auto_flowlabel;
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_auto_linklocal;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_anonportmin;		<span class="enscript-comment">/* minimum ephemeral port */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_anonportmax;		<span class="enscript-comment">/* maximum ephemeral port */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_lowportmin;		<span class="enscript-comment">/* minimum reserved port */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_lowportmax;		<span class="enscript-comment">/* maximum reserved port */</span>

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_use_tempaddr; <span class="enscript-comment">/* whether to use temporary addresses. */</span>

<span class="enscript-comment">/* whether to prefer temporary addresses in the source address selection */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_prefer_tempaddr;

<span class="enscript-comment">/* whether to use the default scope zone when unspecified */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_use_defzone;

<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> pr_usrreqs rip6_usrreqs;
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> pr_usrreqs icmp6_dgram_usrreqs;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> ip6_doscopedroute;

<span class="enscript-type">struct</span> sockopt;
<span class="enscript-type">struct</span> inpcb;
<span class="enscript-type">struct</span> in6_ifaddr;
<span class="enscript-type">struct</span> ip6protosw;
<span class="enscript-type">struct</span> domain;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">icmp6_ctloutput</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">icmp6_dgram_ctloutput</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">icmp6_dgram_send</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> mbuf *,
    <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> proc *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">icmp6_dgram_attach</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> proc *);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_init</span>(<span class="enscript-type">struct</span> ip6protosw *, <span class="enscript-type">struct</span> domain *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_input</span>(<span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_setsrcifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, <span class="enscript-type">struct</span> in6_ifaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_setdstifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, <span class="enscript-type">struct</span> in6_ifaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_getsrcifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t *, uint32_t *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_getdstifaddr_info</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t *, uint32_t *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_freepcbopts</span>(<span class="enscript-type">struct</span> ip6_pktopts *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_unknown_opt</span>(u_int8_t *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">char</span> *<span class="enscript-function-name">ip6_get_prevhdr</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_nexthdr</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_lasthdr</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span> *);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_moptions_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> ip6_moptions *<span class="enscript-function-name">ip6_allocmoptions</span>(<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">im6o_addref</span>(<span class="enscript-type">struct</span> ip6_moptions *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">im6o_remref</span>(<span class="enscript-type">struct</span> ip6_moptions *);

<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> ip6aux *<span class="enscript-function-name">ip6_addaux</span>(<span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> ip6aux *<span class="enscript-function-name">ip6_findaux</span>(<span class="enscript-type">struct</span> mbuf *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_delaux</span>(<span class="enscript-type">struct</span> mbuf *);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_process_hopopts</span>(<span class="enscript-type">struct</span> mbuf *, u_int8_t *, <span class="enscript-type">int</span>, u_int32_t *,
    u_int32_t *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> mbuf **<span class="enscript-function-name">ip6_savecontrol_v4</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> mbuf *,
    <span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">int</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_savecontrol</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> mbuf **);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> mbuf *<span class="enscript-function-name">ip6_forward</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> route_in6 *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_notify_pmtu</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> sockaddr_in6 *, u_int32_t *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_mloopback</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> mbuf *,
    <span class="enscript-type">struct</span> sockaddr_in6 *, uint32_t, int32_t);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_output</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> ip6_pktopts *, <span class="enscript-type">struct</span> route_in6 *,
    <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> ip6_moptions *, <span class="enscript-type">struct</span> ifnet **, <span class="enscript-type">struct</span> ip6_out_args *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_output_list</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> ip6_pktopts *,
    <span class="enscript-type">struct</span> route_in6 *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> ip6_moptions *, <span class="enscript-type">struct</span> ifnet **,
    <span class="enscript-type">struct</span> ip6_out_args *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_ctloutput</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_raw_ctloutput</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_initpktopts</span>(<span class="enscript-type">struct</span> ip6_pktopts *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_setpktoptions</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> ip6_pktopts *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_clearpktopts</span>(<span class="enscript-type">struct</span> ip6_pktopts *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> ip6_pktopts *<span class="enscript-function-name">ip6_copypktopts</span>(<span class="enscript-type">struct</span> ip6_pktopts *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_optlen</span>(<span class="enscript-type">struct</span> inpcb *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ip6_drain</span>(<span class="enscript-type">void</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">route6_input</span>(<span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">int</span> *, <span class="enscript-type">int</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">frag6_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">frag6_input</span>(<span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">int</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">frag6_drain</span>(<span class="enscript-type">void</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip6_input</span>(<span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">int</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">rip6_ctlinput</span>(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">void</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip6_ctloutput</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockopt *sopt);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">rip6_output</span>(<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr_in6 *,
    <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">dest6_input</span>(<span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">int</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_addr *<span class="enscript-function-name">in6_selectsrc</span>(<span class="enscript-type">struct</span> sockaddr_in6 *,
    <span class="enscript-type">struct</span> ip6_pktopts *, <span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> route_in6 *,
    <span class="enscript-type">struct</span> ifnet **, <span class="enscript-type">struct</span> in6_addr *, <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>, <span class="enscript-type">int</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_addrpolicy *<span class="enscript-function-name">in6_addrsel_lookup_policy</span>(<span class="enscript-type">struct</span> sockaddr_in6 *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_selectroute</span>(<span class="enscript-type">struct</span> sockaddr_in6 *, <span class="enscript-type">struct</span> sockaddr_in6 *,
    <span class="enscript-type">struct</span> ip6_pktopts *, <span class="enscript-type">struct</span> ip6_moptions *, <span class="enscript-type">struct</span> in6_ifaddr **,
    <span class="enscript-type">struct</span> route_in6 *, <span class="enscript-type">struct</span> ifnet **, <span class="enscript-type">struct</span> rtentry **, <span class="enscript-type">int</span>,
    <span class="enscript-type">struct</span> ip6_out_args *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_setpktopts</span>(<span class="enscript-type">struct</span> mbuf *control, <span class="enscript-type">struct</span> ip6_pktopts *opt,
    <span class="enscript-type">struct</span> ip6_pktopts *stickyopt, <span class="enscript-type">int</span> uproto);
<span class="enscript-type">extern</span> u_int32_t <span class="enscript-function-name">ip6_randomid</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> u_int32_t <span class="enscript-function-name">ip6_randomflowlabel</span>(<span class="enscript-type">void</span>);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_NETINET6_IP6_VAR_H_ */</span>
</pre>
<hr />
</body></html>