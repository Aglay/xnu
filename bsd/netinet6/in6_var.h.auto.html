<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>in6_var.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">in6_var.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2015 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 *
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 *
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

<span class="enscript-comment">/*
 * Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the project nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */</span>

<span class="enscript-comment">/*
 * Copyright (c) 1985, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)in_var.h	8.1 (Berkeley) 6/10/93
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NETINET6_IN6_VAR_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_NETINET6_IN6_VAR_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/tree.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/mcache.h&gt;</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/scope6_var.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/kern_event.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;net/ethernet.h&gt;</span>

<span class="enscript-comment">/*
 * pltime/vltime are just for future reference (required to implements 2
 * hour rule for hosts).  they should never be modified by nd6_timeout or
 * anywhere else.
 *	userland -&gt; kernel: accept pltime/vltime
 *	kernel -&gt; userland: throw up everything
 *	in kernel: modify preferred/expire only
 */</span>
<span class="enscript-type">struct</span> in6_addrlifetime {
	time_t ia6t_expire;	<span class="enscript-comment">/* valid lifetime expiration time */</span>
	time_t ia6t_preferred;	<span class="enscript-comment">/* preferred lifetime expiration time */</span>
	u_int32_t ia6t_vltime;	<span class="enscript-comment">/* valid lifetime */</span>
	u_int32_t ia6t_pltime;	<span class="enscript-comment">/* prefix lifetime */</span>
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-type">struct</span> in6_addrlifetime_32 {
	u_int32_t ia6t_expire;
	u_int32_t ia6t_preferred;
	u_int32_t ia6t_vltime;
	u_int32_t ia6t_pltime;
};

<span class="enscript-type">struct</span> in6_addrlifetime_64 {
	u_int64_t ia6t_expire;
	u_int64_t ia6t_preferred;
	u_int32_t ia6t_vltime;
	u_int32_t ia6t_pltime;
};

<span class="enscript-comment">/*
 * Internal representation of ia6_lifetime (expiration in uptime unit)
 */</span>
<span class="enscript-type">struct</span> in6_addrlifetime_i {
	u_int64_t ia6ti_expire;		<span class="enscript-comment">/* valid lifetime expiration time */</span>
	u_int64_t ia6ti_preferred;	<span class="enscript-comment">/* preferred lifetime expiration time */</span>
	u_int32_t ia6ti_vltime;		<span class="enscript-comment">/* valid lifetime */</span>
	u_int32_t ia6ti_pltime;		<span class="enscript-comment">/* prefix lifetime */</span>
	u_int64_t ia6ti_base_calendartime; <span class="enscript-comment">/* calendar time at creation */</span>
	u_int64_t ia6ti_base_uptime;	<span class="enscript-comment">/* uptime at creation */</span>
};

<span class="enscript-comment">/*
 * Interface address, IPv6 version.  One of these structures
 * is allocated for each interface with an IPv6 address.
 * The ifaddr structure contains the protocol-independent part
 * of the structure and is assumed to be first.
 */</span>

<span class="enscript-type">struct</span> in6_ifaddr {
	<span class="enscript-type">struct</span> ifaddr ia_ifa;		<span class="enscript-comment">/* protocol-independent info */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ia_ifp</span>		ia_ifa.ifa_ifp
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ia_flags</span>	ia_ifa.ifa_flags
	<span class="enscript-type">struct</span> sockaddr_in6 ia_addr;	<span class="enscript-comment">/* interface address */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 ia_net;	<span class="enscript-comment">/* network number of interface */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 ia_dstaddr; <span class="enscript-comment">/* space for destination addr */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 ia_prefixmask; <span class="enscript-comment">/* prefix mask */</span>
	u_int32_t ia_plen;		<span class="enscript-comment">/* prefix length */</span>
	<span class="enscript-type">struct</span> in6_ifaddr *ia_next;	<span class="enscript-comment">/* next in6 list of IP6 addresses */</span>
	<span class="enscript-type">int</span> ia6_flags;

	<span class="enscript-type">struct</span> in6_addrlifetime_i ia6_lifetime;
	<span class="enscript-comment">/*
	 * the creation time of this address, which is
	 * currently used for temporary addresses only.
	 */</span>
	u_int64_t ia6_createtime;
	u_int64_t ia6_updatetime;

	<span class="enscript-type">struct</span> ifprefix *ia6_ifpr;	<span class="enscript-comment">/* back pointer to ifprefix */</span>

	<span class="enscript-comment">/* back pointer to the ND prefix (for autoconfigured addresses only) */</span>
	<span class="enscript-type">struct</span> nd_prefix *ia6_ndpr;

	<span class="enscript-comment">/* multicast addresses joined from the kernel */</span>
	LIST_HEAD(, in6_multi_mship) ia6_memberships;
};

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">ifatoia6</span>(ifa)	((struct in6_ifaddr *)(void *)(ifa))
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-comment">/* control structure to manage address selection policy */</span>
<span class="enscript-type">struct</span> in6_addrpolicy {
	<span class="enscript-type">struct</span> sockaddr_in6 addr; <span class="enscript-comment">/* prefix address */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 addrmask; <span class="enscript-comment">/* prefix mask */</span>
	<span class="enscript-type">int</span> preced;		<span class="enscript-comment">/* precedence */</span>
	<span class="enscript-type">int</span> label;		<span class="enscript-comment">/* matching label */</span>
	u_quad_t use;		<span class="enscript-comment">/* statistics */</span>
};

<span class="enscript-comment">/*
 * IPv6 interface statistics, as defined in RFC2465 Ipv6IfStatsEntry (p12).
 */</span>
<span class="enscript-type">struct</span> in6_ifstat {
	u_quad_t ifs6_in_receive;	<span class="enscript-comment">/* # of total input datagram */</span>
	u_quad_t ifs6_in_hdrerr;	<span class="enscript-comment">/* # of datagrams with invalid hdr */</span>
	u_quad_t ifs6_in_toobig;	<span class="enscript-comment">/* # of datagrams exceeded MTU */</span>
	u_quad_t ifs6_in_noroute;	<span class="enscript-comment">/* # of datagrams with no route */</span>
	u_quad_t ifs6_in_addrerr;	<span class="enscript-comment">/* # of datagrams with invalid dst */</span>
	u_quad_t ifs6_in_protounknown;	<span class="enscript-comment">/* # of datagrams with unknown proto */</span>
					<span class="enscript-comment">/* NOTE: increment on final dst if */</span>
	u_quad_t ifs6_in_truncated;	<span class="enscript-comment">/* # of truncated datagrams */</span>
	u_quad_t ifs6_in_discard;	<span class="enscript-comment">/* # of discarded datagrams */</span>
					<span class="enscript-comment">/* NOTE: fragment timeout is not here */</span>
	u_quad_t ifs6_in_deliver;	<span class="enscript-comment">/* # of datagrams delivered to ULP */</span>
					<span class="enscript-comment">/* NOTE: increment on final dst if */</span>
	u_quad_t ifs6_out_forward;	<span class="enscript-comment">/* # of datagrams forwarded */</span>
					<span class="enscript-comment">/* NOTE: increment on outgoing if */</span>
	u_quad_t ifs6_out_request;	<span class="enscript-comment">/* # of outgoing datagrams from ULP */</span>
					<span class="enscript-comment">/* NOTE: does not include forwrads */</span>
	u_quad_t ifs6_out_discard;	<span class="enscript-comment">/* # of discarded datagrams */</span>
	u_quad_t ifs6_out_fragok;	<span class="enscript-comment">/* # of datagrams fragmented */</span>
	u_quad_t ifs6_out_fragfail;	<span class="enscript-comment">/* # of datagrams failed on fragment */</span>
	u_quad_t ifs6_out_fragcreat;	<span class="enscript-comment">/* # of fragment datagrams */</span>
					<span class="enscript-comment">/* NOTE: this is # after fragment */</span>
	u_quad_t ifs6_reass_reqd;	<span class="enscript-comment">/* # of incoming fragmented packets */</span>
					<span class="enscript-comment">/* NOTE: increment on final dst if */</span>
	u_quad_t ifs6_reass_ok;		<span class="enscript-comment">/* # of reassembled packets */</span>
					<span class="enscript-comment">/* NOTE: this is # after reass */</span>
					<span class="enscript-comment">/* NOTE: increment on final dst if */</span>
	u_quad_t ifs6_reass_fail;	<span class="enscript-comment">/* # of reass failures */</span>
					<span class="enscript-comment">/* NOTE: may not be packet count */</span>
					<span class="enscript-comment">/* NOTE: increment on final dst if */</span>
	u_quad_t ifs6_in_mcast;		<span class="enscript-comment">/* # of inbound multicast datagrams */</span>
	u_quad_t ifs6_out_mcast;	<span class="enscript-comment">/* # of outbound multicast datagrams */</span>
};

<span class="enscript-comment">/*
 * ICMPv6 interface statistics, as defined in RFC2466 Ipv6IfIcmpEntry.
 * XXX: I'm not sure if this file is the right place for this structure...
 */</span>
<span class="enscript-type">struct</span> icmp6_ifstat {
	<span class="enscript-comment">/*
	 * Input statistics
	 */</span>
	<span class="enscript-comment">/* ipv6IfIcmpInMsgs, total # of input messages */</span>
	u_quad_t ifs6_in_msg;
	<span class="enscript-comment">/* ipv6IfIcmpInErrors, # of input error messages */</span>
	u_quad_t ifs6_in_error;
	<span class="enscript-comment">/* ipv6IfIcmpInDestUnreachs, # of input dest unreach errors */</span>
	u_quad_t ifs6_in_dstunreach;
	<span class="enscript-comment">/* ipv6IfIcmpInAdminProhibs, # of input admin. prohibited errs */</span>
	u_quad_t ifs6_in_adminprohib;
	<span class="enscript-comment">/* ipv6IfIcmpInTimeExcds, # of input time exceeded errors */</span>
	u_quad_t ifs6_in_timeexceed;
	<span class="enscript-comment">/* ipv6IfIcmpInParmProblems, # of input parameter problem errors */</span>
	u_quad_t ifs6_in_paramprob;
	<span class="enscript-comment">/* ipv6IfIcmpInPktTooBigs, # of input packet too big errors */</span>
	u_quad_t ifs6_in_pkttoobig;
	<span class="enscript-comment">/* ipv6IfIcmpInEchos, # of input echo requests */</span>
	u_quad_t ifs6_in_echo;
	<span class="enscript-comment">/* ipv6IfIcmpInEchoReplies, # of input echo replies */</span>
	u_quad_t ifs6_in_echoreply;
	<span class="enscript-comment">/* ipv6IfIcmpInRouterSolicits, # of input router solicitations */</span>
	u_quad_t ifs6_in_routersolicit;
	<span class="enscript-comment">/* ipv6IfIcmpInRouterAdvertisements, # of input router advertisements */</span>
	u_quad_t ifs6_in_routeradvert;
	<span class="enscript-comment">/* ipv6IfIcmpInNeighborSolicits, # of input neighbor solicitations */</span>
	u_quad_t ifs6_in_neighborsolicit;
	<span class="enscript-comment">/* ipv6IfIcmpInNeighborAdvertisements, # of input neighbor advs. */</span>
	u_quad_t ifs6_in_neighboradvert;
	<span class="enscript-comment">/* ipv6IfIcmpInRedirects, # of input redirects */</span>
	u_quad_t ifs6_in_redirect;
	<span class="enscript-comment">/* ipv6IfIcmpInGroupMembQueries, # of input MLD queries */</span>
	u_quad_t ifs6_in_mldquery;
	<span class="enscript-comment">/* ipv6IfIcmpInGroupMembResponses, # of input MLD reports */</span>
	u_quad_t ifs6_in_mldreport;
	<span class="enscript-comment">/* ipv6IfIcmpInGroupMembReductions, # of input MLD done */</span>
	u_quad_t ifs6_in_mlddone;

	<span class="enscript-comment">/*
	 * Output statistics. We should solve unresolved routing problem...
	 */</span>
	<span class="enscript-comment">/* ipv6IfIcmpOutMsgs, total # of output messages */</span>
	u_quad_t ifs6_out_msg;
	<span class="enscript-comment">/* ipv6IfIcmpOutErrors, # of output error messages */</span>
	u_quad_t ifs6_out_error;
	<span class="enscript-comment">/* ipv6IfIcmpOutDestUnreachs, # of output dest unreach errors */</span>
	u_quad_t ifs6_out_dstunreach;
	<span class="enscript-comment">/* ipv6IfIcmpOutAdminProhibs, # of output admin. prohibited errs */</span>
	u_quad_t ifs6_out_adminprohib;
	<span class="enscript-comment">/* ipv6IfIcmpOutTimeExcds, # of output time exceeded errors */</span>
	u_quad_t ifs6_out_timeexceed;
	<span class="enscript-comment">/* ipv6IfIcmpOutParmProblems, # of output parameter problem errors */</span>
	u_quad_t ifs6_out_paramprob;
	<span class="enscript-comment">/* ipv6IfIcmpOutPktTooBigs, # of output packet too big errors */</span>
	u_quad_t ifs6_out_pkttoobig;
	<span class="enscript-comment">/* ipv6IfIcmpOutEchos, # of output echo requests */</span>
	u_quad_t ifs6_out_echo;
	<span class="enscript-comment">/* ipv6IfIcmpOutEchoReplies, # of output echo replies */</span>
	u_quad_t ifs6_out_echoreply;
	<span class="enscript-comment">/* ipv6IfIcmpOutRouterSolicits, # of output router solicitations */</span>
	u_quad_t ifs6_out_routersolicit;
	<span class="enscript-comment">/* ipv6IfIcmpOutRouterAdvertisements, # of output router advs. */</span>
	u_quad_t ifs6_out_routeradvert;
	<span class="enscript-comment">/* ipv6IfIcmpOutNeighborSolicits, # of output neighbor solicitations */</span>
	u_quad_t ifs6_out_neighborsolicit;
	<span class="enscript-comment">/* ipv6IfIcmpOutNeighborAdvertisements, # of output neighbor advs. */</span>
	u_quad_t ifs6_out_neighboradvert;
	<span class="enscript-comment">/* ipv6IfIcmpOutRedirects, # of output redirects */</span>
	u_quad_t ifs6_out_redirect;
	<span class="enscript-comment">/* ipv6IfIcmpOutGroupMembQueries, # of output MLD queries */</span>
	u_quad_t ifs6_out_mldquery;
	<span class="enscript-comment">/* ipv6IfIcmpOutGroupMembResponses, # of output MLD reports */</span>
	u_quad_t ifs6_out_mldreport;
	<span class="enscript-comment">/* ipv6IfIcmpOutGroupMembReductions, # of output MLD done */</span>
	u_quad_t ifs6_out_mlddone;
};

<span class="enscript-type">struct</span> in6_ifreq {
	<span class="enscript-type">char</span>	ifr_name[IFNAMSIZ];
	<span class="enscript-type">union</span> {
		<span class="enscript-type">struct</span>	sockaddr_in6 ifru_addr;
		<span class="enscript-type">struct</span>	sockaddr_in6 ifru_dstaddr;
		<span class="enscript-type">int</span>	ifru_flags;
		<span class="enscript-type">int</span>	ifru_flags6;
		<span class="enscript-type">int</span>	ifru_metric;
		<span class="enscript-type">int</span>	ifru_intval;
		caddr_t	ifru_data;
		<span class="enscript-type">struct</span> in6_addrlifetime ifru_lifetime;
		<span class="enscript-type">struct</span> in6_ifstat ifru_stat;
		<span class="enscript-type">struct</span> icmp6_ifstat ifru_icmp6stat;
		u_int32_t ifru_scope_id[SCOPE6_ID_MAX];
	} ifr_ifru;
};

<span class="enscript-type">struct</span> in6_aliasreq {
	<span class="enscript-type">char</span>	ifra_name[IFNAMSIZ];
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_addr;
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_dstaddr;
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_prefixmask;
	<span class="enscript-type">int</span>	ifra_flags;
	<span class="enscript-type">struct</span> in6_addrlifetime ifra_lifetime;
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_CGA_MODIFIER_LENGTH</span>	16

<span class="enscript-type">struct</span> in6_cga_modifier {
	u_int8_t octets[IN6_CGA_MODIFIER_LENGTH];
};

<span class="enscript-type">struct</span> in6_cga_prepare {
	<span class="enscript-type">struct</span> in6_cga_modifier cga_modifier;
	u_int8_t cga_security_level;
	u_int8_t reserved_A[15];
};

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_CGA_KEY_MAXSIZE</span>	2048	<span class="enscript-comment">/* octets */</span>

<span class="enscript-type">struct</span> in6_cga_nodecfg {
	<span class="enscript-type">struct</span> iovec cga_privkey;
	<span class="enscript-type">struct</span> iovec cga_pubkey;
	<span class="enscript-type">struct</span> in6_cga_prepare cga_prepare;
};

<span class="enscript-type">struct</span> in6_llstartreq {
	<span class="enscript-type">char</span> llsr_name[IFNAMSIZ];
	<span class="enscript-type">int</span> llsr_flags;
	<span class="enscript-type">struct</span> in6_cga_prepare llsr_cgaprep;
	<span class="enscript-type">struct</span> in6_addrlifetime llsr_lifetime;
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-type">struct</span> in6_llstartreq_32 {
	<span class="enscript-type">char</span> llsr_name[IFNAMSIZ];
	<span class="enscript-type">int</span> llsr_flags;
	<span class="enscript-type">struct</span> in6_cga_prepare llsr_cgaprep;
	<span class="enscript-type">struct</span> in6_addrlifetime_32 llsr_lifetime;
};

<span class="enscript-type">struct</span> in6_llstartreq_64 {
	<span class="enscript-type">char</span> llsr_name[IFNAMSIZ];
	<span class="enscript-type">int</span> llsr_flags;
	<span class="enscript-type">struct</span> in6_cga_prepare llsr_cgaprep;
	<span class="enscript-type">struct</span> in6_addrlifetime_64 llsr_lifetime;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-type">struct</span> in6_aliasreq_32 {
	<span class="enscript-type">char</span>	ifra_name[IFNAMSIZ];
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_addr;
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_dstaddr;
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_prefixmask;
	<span class="enscript-type">int</span>	ifra_flags;
	<span class="enscript-type">struct</span> in6_addrlifetime_32 ifra_lifetime;
};

<span class="enscript-type">struct</span> in6_aliasreq_64 {
	<span class="enscript-type">char</span>	ifra_name[IFNAMSIZ];
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_addr;
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_dstaddr;
	<span class="enscript-type">struct</span>	sockaddr_in6 ifra_prefixmask;
	<span class="enscript-type">int</span>	ifra_flags;
	<span class="enscript-type">struct</span> in6_addrlifetime_64 ifra_lifetime;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-comment">/* prefix type macro */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_PREFIX_ND</span>	1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_PREFIX_RR</span>	2

<span class="enscript-comment">/*
 * prefix related flags passed between kernel(NDP related part) and
 * user land command(ifconfig) and daemon(rtadvd).
 */</span>
<span class="enscript-type">struct</span> in6_prflags {
	<span class="enscript-type">struct</span> prf_ra {
		u_char onlink : 1;
		u_char autonomous : 1;
		u_char reserved : 6;
	} prf_ra;
	u_char prf_reserved1;
	u_short prf_reserved2;
	<span class="enscript-comment">/* want to put this on 4byte offset */</span>
	<span class="enscript-type">struct</span> prf_rr {
		u_char decrvalid : 1;
		u_char decrprefd : 1;
		u_char reserved : 6;
	} prf_rr;
	u_char prf_reserved3;
	u_short prf_reserved4;
};

<span class="enscript-type">struct</span>  in6_prefixreq {
	<span class="enscript-type">char</span>	ipr_name[IFNAMSIZ];
	u_char	ipr_origin;
	u_char	ipr_plen;
	u_int32_t ipr_vltime;
	u_int32_t ipr_pltime;
	<span class="enscript-type">struct</span> in6_prflags ipr_flags;
	<span class="enscript-type">struct</span>	sockaddr_in6 ipr_prefix;
};

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_ORIG_RA</span>	0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_ORIG_RR</span>	1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_ORIG_STATIC</span>	2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_ORIG_KERNEL</span>	3

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ipr_raf_onlink</span>		ipr_flags.prf_ra.onlink
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ipr_raf_auto</span>		ipr_flags.prf_ra.autonomous

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ipr_statef_onlink</span>	ipr_flags.prf_state.onlink

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ipr_rrf_decrvalid</span>	ipr_flags.prf_rr.decrvalid
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ipr_rrf_decrprefd</span>	ipr_flags.prf_rr.decrprefd

<span class="enscript-type">struct</span> in6_rrenumreq {
	<span class="enscript-type">char</span>	irr_name[IFNAMSIZ];
	u_char	irr_origin;
	u_char	irr_m_len;	<span class="enscript-comment">/* match len for matchprefix */</span>
	u_char	irr_m_minlen;	<span class="enscript-comment">/* minlen for matching prefix */</span>
	u_char	irr_m_maxlen;	<span class="enscript-comment">/* maxlen for matching prefix */</span>
	u_char	irr_u_uselen;	<span class="enscript-comment">/* uselen for adding prefix */</span>
	u_char	irr_u_keeplen;	<span class="enscript-comment">/* keeplen from matching prefix */</span>
	<span class="enscript-type">struct</span> irr_raflagmask {
		u_char onlink : 1;
		u_char autonomous : 1;
		u_char reserved : 6;
	} irr_raflagmask;
	u_int32_t irr_vltime;
	u_int32_t irr_pltime;
	<span class="enscript-type">struct</span> in6_prflags irr_flags;
	<span class="enscript-type">struct</span>	sockaddr_in6 irr_matchprefix;
	<span class="enscript-type">struct</span>	sockaddr_in6 irr_useprefix;
};

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_raf_mask_onlink</span>	irr_raflagmask.onlink
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_raf_mask_auto</span>	irr_raflagmask.autonomous
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_raf_mask_reserved</span>	irr_raflagmask.reserved

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_raf_onlink</span>		irr_flags.prf_ra.onlink
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_raf_auto</span>		irr_flags.prf_ra.autonomous

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_statef_onlink</span>	irr_flags.prf_state.onlink

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_rrf</span>			irr_flags.prf_rr
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_rrf_decrvalid</span>	irr_flags.prf_rr.decrvalid
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">irr_rrf_decrprefd</span>	irr_flags.prf_rr.decrprefd

<span class="enscript-comment">/*
 * Event data, inet6 style.
 */</span>
<span class="enscript-type">struct</span> kev_in6_addrlifetime {
	u_int32_t ia6t_expire;
	u_int32_t ia6t_preferred;
	u_int32_t ia6t_vltime;
	u_int32_t ia6t_pltime;
};

<span class="enscript-type">struct</span> kev_in6_data {
	<span class="enscript-type">struct</span> net_event_data link_data;
	<span class="enscript-type">struct</span> sockaddr_in6 ia_addr;	<span class="enscript-comment">/* interface address */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 ia_net;	<span class="enscript-comment">/* network number of interface */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 ia_dstaddr; <span class="enscript-comment">/* space for destination addr */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 ia_prefixmask; <span class="enscript-comment">/* prefix mask */</span>
	u_int32_t ia_plen;		<span class="enscript-comment">/* prefix length */</span>
	u_int32_t ia6_flags;		<span class="enscript-comment">/* address flags from in6_ifaddr */</span>
	<span class="enscript-type">struct</span> kev_in6_addrlifetime ia_lifetime; <span class="enscript-comment">/* address life info */</span>
	uint8_t	ia_mac[ETHER_ADDR_LEN];
};

<span class="enscript-comment">/*
 * Define inet6 event subclass and specific inet6 events.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KEV_INET6_SUBCLASS</span>		6 <span class="enscript-comment">/* inet6 subclass identifier */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KEV_INET6_NEW_USER_ADDR</span>		1 <span class="enscript-comment">/* Userland configured IPv6 address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KEV_INET6_CHANGED_ADDR</span>		2 <span class="enscript-comment">/* Address changed event (future) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KEV_INET6_ADDR_DELETED</span>		3 <span class="enscript-comment">/* IPv6 address was deleted */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KEV_INET6_NEW_LL_ADDR</span>		4 <span class="enscript-comment">/* Autoconf LL address appeared */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KEV_INET6_NEW_RTADV_ADDR</span>	5 <span class="enscript-comment">/* Autoconf address has appeared */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">KEV_INET6_DEFROUTER</span>		6 <span class="enscript-comment">/* Default router detected */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-comment">/* Utility function used inside netinet6 kernel code for generating events */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">in6_post_msg</span>(<span class="enscript-type">struct</span> ifnet *, u_int32_t, <span class="enscript-type">struct</span> in6_ifaddr *, uint8_t *mac);

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_ARE_MASKED_ADDR_EQUAL</span>(d, a, m)	(	\
	(((d)-&gt;s6_addr32[0] ^ (a)-&gt;s6_addr32[0]) &amp; (m)-&gt;s6_addr32[0]) == 0 &amp;&amp; \
	(((d)-&gt;s6_addr32[1] ^ (a)-&gt;s6_addr32[1]) &amp; (m)-&gt;s6_addr32[1]) == 0 &amp;&amp; \
	(((d)-&gt;s6_addr32[2] ^ (a)-&gt;s6_addr32[2]) &amp; (m)-&gt;s6_addr32[2]) == 0 &amp;&amp; \
	(((d)-&gt;s6_addr32[3] ^ (a)-&gt;s6_addr32[3]) &amp; (m)-&gt;s6_addr32[3]) == 0)

<span class="enscript-comment">/*
 * Given a pointer to an in6_ifaddr (ifaddr),
 * return a pointer to the addr as a sockaddr_in6
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IA6_IN6</span>(ia)	(&amp;((ia)-&gt;ia_addr.sin6_addr))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IA6_DSTIN6</span>(ia)	(&amp;((ia)-&gt;ia_dstaddr.sin6_addr))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IA6_MASKIN6</span>(ia)	(&amp;((ia)-&gt;ia_prefixmask.sin6_addr))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IA6_SIN6</span>(ia)	(&amp;((ia)-&gt;ia_addr))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IA6_DSTSIN6</span>(ia)	(&amp;((ia)-&gt;ia_dstaddr))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IFA_IN6</span>(x)	\
	(&amp;((<span class="enscript-type">struct</span> sockaddr_in6 *)(<span class="enscript-type">void</span> *)((x)-&gt;ifa_addr))-&gt;sin6_addr)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IFA_DSTIN6</span>(x)	\
	(&amp;((<span class="enscript-type">struct</span> sockaddr_in6 *)(<span class="enscript-type">void</span> *)((x)-&gt;ifa_dstaddr))-&gt;sin6_addr)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IFPR_IN6</span>(x)	\
	(&amp;((<span class="enscript-type">struct</span> sockaddr_in6 *)(<span class="enscript-type">void</span> *)((x)-&gt;ifpr_prefix))-&gt;sin6_addr)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFADDR_IN6</span>		 _IOW(<span class="enscript-string">'i'</span>, 12, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFADDR_IN6</span>		_IOWR(<span class="enscript-string">'i'</span>, 33, struct in6_ifreq)

<span class="enscript-comment">/*
 * SIOCSxxx ioctls should be unused (see comments in in6.c), but
 * we do not shift numbers for binary compatibility.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFDSTADDR_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 14, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFNETMASK_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 22, struct in6_ifreq)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFDSTADDR_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 34, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFNETMASK_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 37, struct in6_ifreq)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDIFADDR_IN6</span>		_IOW(<span class="enscript-string">'i'</span>, 25, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCAIFADDR_IN6</span>		_IOW(<span class="enscript-string">'i'</span>, 26, struct in6_aliasreq)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCAIFADDR_IN6_32</span>	_IOW(<span class="enscript-string">'i'</span>, 26, struct in6_aliasreq_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCAIFADDR_IN6_64</span>	_IOW(<span class="enscript-string">'i'</span>, 26, struct in6_aliasreq_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFPHYADDR_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 62, struct in6_aliasreq)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFPHYADDR_IN6_32</span>	_IOW(<span class="enscript-string">'i'</span>, 62, struct in6_aliasreq_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFPHYADDR_IN6_64</span>	_IOW(<span class="enscript-string">'i'</span>, 62, struct in6_aliasreq_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFPSRCADDR_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 63, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFPDSTADDR_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 64, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFAFLAG_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 73, struct in6_ifreq)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGDRLST_IN6</span>		_IOWR(<span class="enscript-string">'i'</span>, 74, struct in6_drlist)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGDRLST_IN6_32</span>	_IOWR(<span class="enscript-string">'i'</span>, 74, struct in6_drlist_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGDRLST_IN6_64</span>	_IOWR(<span class="enscript-string">'i'</span>, 74, struct in6_drlist_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGPRLST_IN6</span>		_IOWR(<span class="enscript-string">'i'</span>, 75, struct in6_prlist)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGPRLST_IN6_32</span>	_IOWR(<span class="enscript-string">'i'</span>, 75, struct in6_prlist_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGPRLST_IN6_64</span>	_IOWR(<span class="enscript-string">'i'</span>, 75, struct in6_prlist_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">OSIOCGIFINFO_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 108, struct in6_ondireq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFINFO_IN6</span>		_IOWR(<span class="enscript-string">'i'</span>, 76, struct in6_ondireq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSNDFLUSH_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 77, struct in6_ifreq)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGNBRINFO_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 78, struct in6_nbrinfo)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGNBRINFO_IN6_32</span>	_IOWR(<span class="enscript-string">'i'</span>, 78, struct in6_nbrinfo_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGNBRINFO_IN6_64</span>	_IOWR(<span class="enscript-string">'i'</span>, 78, struct in6_nbrinfo_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSPFXFLUSH_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 79, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSRTRFLUSH_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 80, struct in6_ifreq)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFALIFETIME_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 81, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFALIFETIME_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 82, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFSTAT_IN6</span>		_IOWR(<span class="enscript-string">'i'</span>, 83, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFSTAT_ICMP6</span>	_IOWR(<span class="enscript-string">'i'</span>, 84, struct in6_ifreq)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSDEFIFACE_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 85, struct in6_ndifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGDEFIFACE_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 86, struct in6_ndifreq)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSDEFIFACE_IN6_32</span>	_IOWR(<span class="enscript-string">'i'</span>, 85, struct in6_ndifreq_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSDEFIFACE_IN6_64</span>	_IOWR(<span class="enscript-string">'i'</span>, 85, struct in6_ndifreq_64)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGDEFIFACE_IN6_32</span>	_IOWR(<span class="enscript-string">'i'</span>, 86, struct in6_ndifreq_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGDEFIFACE_IN6_64</span>	_IOWR(<span class="enscript-string">'i'</span>, 86, struct in6_ndifreq_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFINFO_FLAGS</span>	_IOWR(<span class="enscript-string">'i'</span>, 87, struct in6_ndireq) <span class="enscript-comment">/* XXX */</span>

<span class="enscript-comment">/* N.B.: These 3 ioctls are deprecated and won't work */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSSCOPE6</span>		_IOW(<span class="enscript-string">'i'</span>, 88, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGSCOPE6</span>		_IOWR(<span class="enscript-string">'i'</span>, 89, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGSCOPE6DEF</span>		_IOWR(<span class="enscript-string">'i'</span>, 90, struct in6_ifreq)

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSIFPREFIX_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 100, struct in6_prefixreq) <span class="enscript-comment">/* set */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGIFPREFIX_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 101, struct in6_prefixreq) <span class="enscript-comment">/* get */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDIFPREFIX_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 102, struct in6_prefixreq) <span class="enscript-comment">/* del */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCAIFPREFIX_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 103, struct in6_rrenumreq) <span class="enscript-comment">/* add */</span>

<span class="enscript-comment">/* change */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCCIFPREFIX_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 104, struct in6_rrenumreq)

<span class="enscript-comment">/* set global */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSGIFPREFIX_IN6</span>	_IOW(<span class="enscript-string">'i'</span>, 105, struct in6_rrenumreq)

<span class="enscript-comment">/*
 * multicast routing, get s/g pkt cnt, pkt cnt per interface.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGETSGCNT_IN6</span>	_IOWR(<span class="enscript-string">'u'</span>, 28, struct sioc_sg_req6)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGETMIFCNT_IN6</span>	_IOWR(<span class="enscript-string">'u'</span>, 107, struct sioc_mif_req6)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGETMIFCNT_IN6_32</span>	_IOWR(<span class="enscript-string">'u'</span>, 107, struct sioc_mif_req6_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCGETMIFCNT_IN6_64</span>	_IOWR(<span class="enscript-string">'u'</span>, 107, struct sioc_mif_req6_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCAADDRCTL_POLICY</span>	_IOW(<span class="enscript-string">'u'</span>, 108, struct in6_addrpolicy)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDADDRCTL_POLICY</span>	_IOW(<span class="enscript-string">'u'</span>, 109, struct in6_addrpolicy)

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/*
 * temporary control calls to attach/detach IPv6 to/from an interface.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCPROTOATTACH_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 110, struct in6_aliasreq)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCPROTOATTACH_IN6_32</span>	_IOWR(<span class="enscript-string">'i'</span>, 110, struct in6_aliasreq_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCPROTOATTACH_IN6_64</span>	_IOWR(<span class="enscript-string">'i'</span>, 110, struct in6_aliasreq_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCPROTODETACH_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 111, struct in6_ifreq)

<span class="enscript-comment">/*
 * start/stop aquiring linklocal on interface
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCLL_START</span>		_IOWR(<span class="enscript-string">'i'</span>, 130, struct in6_aliasreq)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCLL_START_32</span>		_IOWR(<span class="enscript-string">'i'</span>, 130, struct in6_aliasreq_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCLL_START_64</span>		_IOWR(<span class="enscript-string">'i'</span>, 130, struct in6_aliasreq_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCLL_STOP</span>		_IOWR(<span class="enscript-string">'i'</span>, 131, struct in6_ifreq)

<span class="enscript-comment">/*
 * accept rtadvd (and stop accepting) on this interface.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCAUTOCONF_START</span>	_IOWR(<span class="enscript-string">'i'</span>, 132, struct in6_ifreq)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCAUTOCONF_STOP</span>	_IOWR(<span class="enscript-string">'i'</span>, 133, struct in6_ifreq)

<span class="enscript-comment">/*
 * add/remove default IPv6 router.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDRADD_IN6</span>		_IOWR(<span class="enscript-string">'u'</span>, 134, struct in6_defrouter)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDRADD_IN6_32</span>	_IOWR(<span class="enscript-string">'u'</span>, 134, struct in6_defrouter_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDRADD_IN6_64</span>	_IOWR(<span class="enscript-string">'u'</span>, 134, struct in6_defrouter_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDRDEL_IN6</span>		_IOWR(<span class="enscript-string">'u'</span>, 135, struct in6_defrouter)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDRDEL_IN6_32</span>	_IOWR(<span class="enscript-string">'u'</span>, 135, struct in6_defrouter_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCDRDEL_IN6_64</span>	_IOWR(<span class="enscript-string">'u'</span>, 135, struct in6_defrouter_64)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-comment">/*
 * enable/disable IPv6 router mode on interface.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCSETROUTERMODE_IN6</span>	_IOWR(<span class="enscript-string">'i'</span>, 136, struct in6_ifreq)

<span class="enscript-comment">/*
 * start secure link-local interface addresses
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCLL_CGASTART</span>		_IOW(<span class="enscript-string">'i'</span>, 160, struct in6_llstartreq)
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCLL_CGASTART_32</span>	_IOW(<span class="enscript-string">'i'</span>, 160, struct in6_llstartreq_32)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIOCLL_CGASTART_64</span>	_IOW(<span class="enscript-string">'i'</span>, 160, struct in6_llstartreq_64)
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * XXX: Do not extend IN6_IFF values beyond 16-bit.  We currently copy the
 *	values from ia6_flags as is into m_pkthdr.{src,dst}_iff which are
 *	defined as 16-bit variables.  We can relax this once we define a
 *	unified set of interface flags for {ia,ia6}_flags and perform
 *	translation between those and the publicly-defined ones below.
 */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_ANYCAST</span>		0x0001	<span class="enscript-comment">/* anycast address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_TENTATIVE</span>	0x0002	<span class="enscript-comment">/* tentative address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_DUPLICATED</span>	0x0004	<span class="enscript-comment">/* DAD detected duplicate */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_DETACHED</span>	0x0008	<span class="enscript-comment">/* may be detached from the link */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_DEPRECATED</span>	0x0010	<span class="enscript-comment">/* deprecated address */</span>

<span class="enscript-comment">/* don't perform DAD on this address (used only at first SIOC* call) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_NODAD</span>		0x0020

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_AUTOCONF</span>	0x0040	<span class="enscript-comment">/* autoconfigurable address. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_TEMPORARY</span>	0x0080	<span class="enscript-comment">/* temporary (anonymous) address. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_DYNAMIC</span>		0x0100	<span class="enscript-comment">/* assigned by DHCPv6 service */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_OPTIMISTIC</span>	0x0200	<span class="enscript-comment">/* optimistic DAD, i.e. RFC 4429 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_SECURED</span>		0x0400	<span class="enscript-comment">/* cryptographically generated */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_SWIFTDAD</span>	0x0800  <span class="enscript-comment">/* DAD with no delay */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_NOPFX</span>		0x8000	<span class="enscript-comment">/* Depreciated. Don't use. */</span>

<span class="enscript-comment">/* Duplicate Address Detection [DAD] in progress. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_DADPROGRESS</span>	(IN6_IFF_TENTATIVE|IN6_IFF_OPTIMISTIC)

<span class="enscript-comment">/* do not input/output */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFF_NOTREADY</span>	(IN6_IFF_TENTATIVE|IN6_IFF_DUPLICATED)

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_ARE_SCOPE_CMP</span>(a, b)		((a) - (b))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_ARE_SCOPE_EQUAL</span>(a, b)	((a) == (b))
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_ifaddr *in6_ifaddrs;

<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> icmp6stat icmp6stat;
<span class="enscript-type">extern</span> lck_rw_t in6_ifaddr_rwlock;
<span class="enscript-type">extern</span> lck_mtx_t proxy6_lock;
<span class="enscript-type">extern</span> u_char inet6ctlerrmap[];
<span class="enscript-type">extern</span> u_int32_t in6_maxmtu;

<span class="enscript-comment">/* N.B.: if_inet6data is never freed once set, so we don't need to lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in6_ifstat_inc_common</span>(_ifp, _tag, _atomic) do {			\
	<span class="enscript-keyword">if</span> (_ifp != NULL &amp;&amp; IN6_IFEXTRA(_ifp) != NULL) {		\
		<span class="enscript-keyword">if</span> (_atomic)						\
			atomic_add_64(					\
			    &amp;IN6_IFEXTRA(_ifp)-&gt;in6_ifstat._tag, 1);	\
		<span class="enscript-keyword">else</span>							\
			IN6_IFEXTRA(_ifp)-&gt;in6_ifstat._tag++;		\
	}								\
} <span class="enscript-keyword">while</span> (0)

<span class="enscript-comment">/* atomic version */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in6_ifstat_inc</span>(_ifp, _tag) \
	in6_ifstat_inc_common(_ifp, _tag, TRUE)

<span class="enscript-comment">/* non-atomic version (for fast paths) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in6_ifstat_inc_na</span>(_ifp, _tag) \
	in6_ifstat_inc_common(_ifp, _tag, FALSE)

<span class="enscript-comment">/*
 * Macro for finding the internet address structure (in6_ifaddr) corresponding
 * to a given interface (ifnet structure).
 */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IFP_TO_IA6</span>(ifp, ia)						\
	<span class="enscript-comment">/* struct ifnet *ifp; */</span>					\
	<span class="enscript-comment">/* struct in6_ifaddr *ia; */</span>					\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-type">struct</span> ifaddr *_ifa;						\
	ifnet_lock_assert(ifp, LCK_RW_ASSERT_HELD);			\
	<span class="enscript-keyword">for</span> (_ifa = (ifp)-&gt;if_addrlist.tqh_first; _ifa != NULL;		\
	    _ifa = _ifa-&gt;ifa_list.tqe_next) {				\
		IFA_LOCK(_ifa);						\
		<span class="enscript-keyword">if</span> (_ifa-&gt;ifa_addr-&gt;sa_family == AF_INET6) {		\
			IFA_ADDREF_LOCKED(_ifa);			\
			IFA_UNLOCK(_ifa);				\
			<span class="enscript-keyword">break</span>;						\
		}							\
		IFA_UNLOCK(_ifa);					\
	}								\
	(ia) = (<span class="enscript-type">struct</span> in6_ifaddr *)_ifa;				\
} <span class="enscript-keyword">while</span> (0)

<span class="enscript-comment">/*
 * IPv6 multicast MLD-layer source entry.
 */</span>
<span class="enscript-type">struct</span> ip6_msource {
	RB_ENTRY(ip6_msource)	im6s_link;	<span class="enscript-comment">/* RB tree links */</span>
	<span class="enscript-type">struct</span> in6_addr		im6s_addr;
	<span class="enscript-type">struct</span> im6s_st {
		uint16_t	ex;		<span class="enscript-comment">/* # of exclusive members */</span>
		uint16_t	in;		<span class="enscript-comment">/* # of inclusive members */</span>
	}			im6s_st[2];	<span class="enscript-comment">/* state at t0, t1 */</span>
	uint8_t			im6s_stp;	<span class="enscript-comment">/* pending query */</span>
};

<span class="enscript-function-name">RB_HEAD</span>(ip6_msource_tree, ip6_msource);

<span class="enscript-function-name">RB_PROTOTYPE_SC_PREV</span>(__private_extern__, ip6_msource_tree, ip6_msource,
    im6s_link, ip6_msource_cmp);

<span class="enscript-comment">/*
 * IPv6 multicast PCB-layer source entry.
 *
 * NOTE: overlapping use of struct ip6_msource fields at start.
 */</span>
<span class="enscript-type">struct</span> in6_msource {
	RB_ENTRY(ip6_msource)	im6s_link;	<span class="enscript-comment">/* Common field */</span>
	<span class="enscript-type">struct</span> in6_addr		im6s_addr;	<span class="enscript-comment">/* Common field */</span>
	uint8_t			im6sl_st[2];	<span class="enscript-comment">/* state before/at commit */</span>
};

<span class="enscript-comment">/*
 * IPv6 multicast PCB-layer group filter descriptor.
 */</span>
<span class="enscript-type">struct</span> in6_mfilter {
	<span class="enscript-type">struct</span> ip6_msource_tree	im6f_sources; <span class="enscript-comment">/* source list for (S,G) */</span>
	u_long			im6f_nsrc;    <span class="enscript-comment">/* # of source entries */</span>
	uint8_t			im6f_st[2];   <span class="enscript-comment">/* state before/at commit */</span>
};

<span class="enscript-comment">/*
 * Legacy KAME IPv6 multicast membership descriptor.
 */</span>
<span class="enscript-type">struct</span> in6_multi_mship {
	<span class="enscript-type">struct</span>	in6_multi *i6mm_maddr;	<span class="enscript-comment">/* Multicast address pointer */</span>
	LIST_ENTRY(in6_multi_mship) i6mm_chain;  <span class="enscript-comment">/* multicast options chain */</span>
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;netinet6/nd6_var.h&gt;</span>
<span class="enscript-comment">/*
 *  * Per-interface IPv6 structures.
 *   */</span>
<span class="enscript-type">struct</span> in6_ifextra {
	<span class="enscript-type">struct</span> scope6_id        scope6_id;
	<span class="enscript-type">struct</span> in6_ifstat       in6_ifstat;
	<span class="enscript-type">struct</span> icmp6_ifstat     icmp6_ifstat;
	<span class="enscript-type">struct</span> nd_ifinfo        nd_ifinfo;
	uint32_t                netsig_len;
	u_int8_t                netsig[IFNET_SIGNATURELEN];
};
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IN6_IFEXTRA</span>(_ifp)       ((struct in6_ifextra *)(_ifp-&gt;if_inet6data))
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-type">struct</span> mld_ifinfo;

<span class="enscript-comment">/*
 * IPv6 group descriptor.
 *
 * For every entry on an ifnet's if_multiaddrs list which represents
 * an IP multicast group, there is one of these structures.
 *
 * If any source filters are present, then a node will exist in the RB-tree
 * to permit fast lookup by source whenever an operation takes place.
 * This permits pre-order traversal when we issue reports.
 * Source filter trees are kept separately from the socket layer to
 * greatly simplify locking.
 *
 * When MLDv2 is active, in6m_timer is the response to group query timer.
 * The state-change timer in6m_sctimer is separate; whenever state changes
 * for the group the state change record is generated and transmitted,
 * and kept if retransmissions are necessary.
 *
 * The request count here is a count of requests for this address, not a
 * count of pointers to this structure.
 *
 * FUTURE: in6m_entry is now only used when groups are being purged
 * on a detaching ifnet.  It could be demoted to a SLIST_ENTRY.
 */</span>
<span class="enscript-type">struct</span> in6_multi {
	decl_lck_mtx_data(, in6m_lock);
	u_int32_t in6m_refcount;	<span class="enscript-comment">/* reference count */</span>
	u_int32_t in6m_reqcnt;		<span class="enscript-comment">/* request count for this address */</span>
	u_int32_t in6m_debug;		<span class="enscript-comment">/* see ifa_debug flags */</span>
	LIST_ENTRY(in6_multi) in6m_entry; <span class="enscript-comment">/* list glue */</span>
	<span class="enscript-type">struct</span>	in6_addr in6m_addr;	<span class="enscript-comment">/* IP6 multicast address */</span>
	<span class="enscript-type">struct</span>	ifnet *in6m_ifp;	<span class="enscript-comment">/* back pointer to ifnet */</span>
	<span class="enscript-type">struct</span>	ifmultiaddr *in6m_ifma;	<span class="enscript-comment">/* back pointer to ifmultiaddr */</span>
	u_int	in6m_state;		<span class="enscript-comment">/* state of the membership */</span>
	u_int	in6m_timer;		<span class="enscript-comment">/* MLD6 listener report timer */</span>

	<span class="enscript-comment">/* New fields for MLDv2 follow. */</span>
	<span class="enscript-type">struct</span> mld_ifinfo	*in6m_mli;	<span class="enscript-comment">/* MLD info */</span>
	SLIST_ENTRY(in6_multi)	 in6m_dtle;	<span class="enscript-comment">/* detached waiting for rele  */</span>
	SLIST_ENTRY(in6_multi)	 in6m_nrele;	<span class="enscript-comment">/* to-be-released by MLD */</span>
	u_int32_t		 in6m_nrelecnt;	<span class="enscript-comment">/* deferred release count */</span>
	<span class="enscript-type">struct</span> ip6_msource_tree	 in6m_srcs;	<span class="enscript-comment">/* tree of sources */</span>
	u_long			 in6m_nsrc;	<span class="enscript-comment">/* # of tree entries */</span>

	<span class="enscript-type">struct</span> ifqueue		 in6m_scq;  <span class="enscript-comment">/* pending state-change packets */</span>
	<span class="enscript-type">struct</span> timeval		 in6m_lastgsrtv;	<span class="enscript-comment">/* last G-S-R query */</span>
	uint16_t		 in6m_sctimer;	<span class="enscript-comment">/* state-change timer */</span>
	uint16_t		 in6m_scrv;	<span class="enscript-comment">/* state-change rexmit count */</span>

	<span class="enscript-comment">/*
	 * SSM state counters which track state at T0 (the time the last
	 * state-change report's RV timer went to zero) and T1
	 * (time of pending report, i.e. now).
	 * Used for computing MLDv2 state-change reports. Several refcounts
	 * are maintained here to optimize for common use-cases.
	 */</span>
	<span class="enscript-type">struct</span> in6m_st {
		uint16_t	iss_fmode;	<span class="enscript-comment">/* MLD filter mode */</span>
		uint16_t	iss_asm;	<span class="enscript-comment">/* # of ASM listeners */</span>
		uint16_t	iss_ex;		<span class="enscript-comment">/* # of exclusive members */</span>
		uint16_t	iss_in;		<span class="enscript-comment">/* # of inclusive members */</span>
		uint16_t	iss_rec;	<span class="enscript-comment">/* # of recorded sources */</span>
	}			in6m_st[2];	<span class="enscript-comment">/* state at t0, t1 */</span>

	<span class="enscript-type">void</span> (*in6m_trace)		<span class="enscript-comment">/* callback fn for tracing refs */</span>
	    (<span class="enscript-type">struct</span> in6_multi *, <span class="enscript-type">int</span>);
};

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_LOCK_ASSERT_HELD</span>(_in6m)					\
	lck_mtx_assert(&amp;(_in6m)-&gt;in6m_lock, LCK_MTX_ASSERT_OWNED)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_LOCK_ASSERT_NOTHELD</span>(_in6m)					\
	lck_mtx_assert(&amp;(_in6m)-&gt;in6m_lock, LCK_MTX_ASSERT_NOTOWNED)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_LOCK</span>(_in6m)						\
	lck_mtx_lock(&amp;(_in6m)-&gt;in6m_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_LOCK_SPIN</span>(_in6m)						\
	lck_mtx_lock_spin(&amp;(_in6m)-&gt;in6m_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_CONVERT_LOCK</span>(_in6m) do {					\
	IN6M_LOCK_ASSERT_HELD(_in6m);					\
	lck_mtx_convert_spin(&amp;(_in6m)-&gt;in6m_lock);			\
} <span class="enscript-keyword">while</span> (0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_UNLOCK</span>(_in6m)						\
	lck_mtx_unlock(&amp;(_in6m)-&gt;in6m_lock)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_ADDREF</span>(_in6m)						\
	in6m_addref(_in6m, 0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_ADDREF_LOCKED</span>(_in6m)					\
	in6m_addref(_in6m, 1)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_REMREF</span>(_in6m)						\
	in6m_remref(_in6m, 0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6M_REMREF_LOCKED</span>(_in6m)					\
	in6m_remref(_in6m, 1)

<span class="enscript-comment">/* flags to in6_update_ifa */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFAUPDATE_NOWAIT</span>	0x1 <span class="enscript-comment">/* don't block allocating memory */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFAUPDATE_1STADDR</span>	0x2 <span class="enscript-comment">/* first address on interface */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFAUPDATE_NEWADDR</span>	0x4 <span class="enscript-comment">/* new address on interface */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6_IFAUPDATE_DADDELAY</span>	0x8 <span class="enscript-comment">/* must delay initial DAD probe */</span>

<span class="enscript-type">struct</span> ip6_moptions;
<span class="enscript-type">struct</span> sockopt;
<span class="enscript-type">struct</span> inpcb;

<span class="enscript-type">extern</span> <span class="enscript-function-name">LIST_HEAD</span>(in6_multihead, in6_multi) in6_multihead;

<span class="enscript-comment">/*
 * Structure used by macros below to remember position when stepping through
 * all of the in6_multi records.
 */</span>
<span class="enscript-type">struct</span> in6_multistep {
	<span class="enscript-type">struct</span> in6_ifaddr *i_ia;
	<span class="enscript-type">struct</span> in6_multi *i_in6m;
};

<span class="enscript-comment">/*
 * Macros for looking up the in6_multi record for a given IP6 multicast
 * address on a given interface. If no matching record is found, &quot;in6m&quot;
 * returns NULL.
 *
 * We do this differently compared other BSD implementations; instead of
 * walking the if_multiaddrs list at the interface and returning the
 * ifma_protospec value of a matching entry, we search the global list
 * of in6_multi records and find it that way.  Otherwise either the two
 * structures (in6_multi, ifmultiaddr) need to be ref counted both ways,
 * which will make things too complicated, or they need to reside in the
 * same protected domain, which they aren't.
 *
 * Must be called with in6_multihead_lock held.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_LOOKUP_MULTI</span>(addr, ifp, in6m)				\
	<span class="enscript-comment">/* struct in6_addr *addr; */</span>					\
	<span class="enscript-comment">/* struct ifnet *ifp; */</span>					\
	<span class="enscript-comment">/* struct in6_multi *in6m; */</span>					\
<span class="enscript-keyword">do</span> {									\
	<span class="enscript-type">struct</span> in6_multistep _step;					\
	IN6_FIRST_MULTI(_step, in6m);					\
	<span class="enscript-keyword">while</span> ((in6m) != NULL) {					\
		IN6M_LOCK_SPIN(in6m);					\
		<span class="enscript-keyword">if</span> ((in6m)-&gt;in6m_ifp == (ifp) &amp;&amp;			\
		    IN6_ARE_ADDR_EQUAL(&amp;(in6m)-&gt;in6m_addr, (addr))) {	\
			IN6M_ADDREF_LOCKED(in6m);			\
			IN6M_UNLOCK(in6m);				\
			<span class="enscript-keyword">break</span>;						\
		}							\
		IN6M_UNLOCK(in6m);					\
		IN6_NEXT_MULTI(_step, in6m);				\
	}								\
} <span class="enscript-keyword">while</span> (0)

<span class="enscript-comment">/*
 * Macro to step through all of the in6_multi records, one at a time.
 * The current position is remembered in &quot;step&quot;, which the caller must
 * provide.  IN6_FIRST_MULTI(), below, must be called to initialize &quot;step&quot;
 * and get the first record.  Both macros return a NULL &quot;in6m&quot; when there
 * are no remaining records.
 *
 * Must be called with in6_multihead_lock held.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_NEXT_MULTI</span>(step, in6m)					\
	<span class="enscript-comment">/* struct in6_multistep step; */</span>				\
	<span class="enscript-comment">/* struct in6_multi *in6m; */</span>					\
<span class="enscript-keyword">do</span> {									\
	in6_multihead_lock_assert(LCK_RW_ASSERT_HELD);			\
	<span class="enscript-keyword">if</span> (((in6m) = (step).i_in6m) != NULL)				\
		(step).i_in6m = (step).i_in6m-&gt;in6m_entry.le_next;	\
} <span class="enscript-keyword">while</span> (0)

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_FIRST_MULTI</span>(step, in6m)					\
	<span class="enscript-comment">/* struct in6_multistep step; */</span>				\
	<span class="enscript-comment">/* struct in6_multi *in6m */</span>					\
<span class="enscript-keyword">do</span> {									\
	in6_multihead_lock_assert(LCK_RW_ASSERT_HELD);			\
	(step).i_in6m = in6_multihead.lh_first;				\
		IN6_NEXT_MULTI((step), (in6m));				\
} <span class="enscript-keyword">while</span> (0)

<span class="enscript-type">extern</span> lck_mtx_t *inet6_domain_mutex;
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> domain *inet6domain;

<span class="enscript-type">struct</span> ip6_pktopts;

<span class="enscript-comment">/* Multicast private KPIs. */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">im6o_mc_filter</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ip6_moptions *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> ifnet *,
    <span class="enscript-type">const</span> <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> sockaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_mc_join</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *,
    <span class="enscript-type">struct</span> in6_mfilter *, <span class="enscript-type">struct</span> in6_multi **, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_mc_leave</span>(<span class="enscript-type">struct</span> in6_multi *, <span class="enscript-type">struct</span> in6_mfilter *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6m_clear_recorded</span>(<span class="enscript-type">struct</span> in6_multi *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6m_commit</span>(<span class="enscript-type">struct</span> in6_multi *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6m_purge</span>(<span class="enscript-type">struct</span> in6_multi *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6m_print</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_multi *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6m_record_source</span>(<span class="enscript-type">struct</span> in6_multi *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_getmoptions</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">ip6_setmoptions</span>(<span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-comment">/* Legacy KAME multicast private KPIs. */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_multi_mship *<span class="enscript-function-name">in6_joingroup</span>(<span class="enscript-type">struct</span> ifnet *,
    <span class="enscript-type">struct</span> in6_addr *, <span class="enscript-type">int</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_leavegroup</span>(<span class="enscript-type">struct</span> in6_multi_mship *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_multi_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6m_addref</span>(<span class="enscript-type">struct</span> in6_multi *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6m_remref</span>(<span class="enscript-type">struct</span> in6_multi *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_multi_detach</span>(<span class="enscript-type">struct</span> in6_multi *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_ifindex2scopeid</span>(<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_mask2len</span>(<span class="enscript-type">struct</span> in6_addr *, u_char *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_len2mask</span>(<span class="enscript-type">struct</span> in6_addr *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_control</span>(<span class="enscript-type">struct</span> socket *, u_long, caddr_t, <span class="enscript-type">struct</span> ifnet *,
    <span class="enscript-type">struct</span> proc *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_update_ifa</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> in6_aliasreq *, <span class="enscript-type">int</span>,
    <span class="enscript-type">struct</span> in6_ifaddr **);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_purgeaddr</span>(<span class="enscript-type">struct</span> ifaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6if_do_dad</span>(<span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_purgeif</span>(<span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_savemkludge</span>(<span class="enscript-type">struct</span> in6_ifaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_setmaxmtu</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_restoremkludge</span>(<span class="enscript-type">struct</span> in6_ifaddr *, <span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_purgemkludge</span>(<span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_ifaddr *<span class="enscript-function-name">in6ifa_ifpforlinklocal</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_ifaddr *<span class="enscript-function-name">in6ifa_ifpwithaddr</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_ifaddr *<span class="enscript-function-name">in6ifa_prproxyaddr</span>(<span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6ifa_getlifetime</span>(<span class="enscript-type">struct</span> in6_ifaddr *,
    <span class="enscript-type">struct</span> in6_addrlifetime *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6ifa_setlifetime</span>(<span class="enscript-type">struct</span> in6_ifaddr *, <span class="enscript-type">struct</span> in6_addrlifetime *);
<span class="enscript-type">extern</span> <span class="enscript-type">char</span> *<span class="enscript-function-name">ip6_sprintf</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_addr2scopeid</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_matchlen</span>(<span class="enscript-type">struct</span> in6_addr *, <span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_are_prefix_equal</span>(<span class="enscript-type">struct</span> in6_addr *p1, <span class="enscript-type">struct</span> in6_addr *p2,
    <span class="enscript-type">int</span> len);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_prefixlen2mask</span>(<span class="enscript-type">struct</span> in6_addr *maskp, <span class="enscript-type">int</span> len);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_prefix_add_ifid</span>(<span class="enscript-type">int</span> iilen, <span class="enscript-type">struct</span> in6_ifaddr *ia);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_prefix_remove_ifid</span>(<span class="enscript-type">int</span> iilen, <span class="enscript-type">struct</span> in6_ifaddr *ia);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_purgeprefix</span>(<span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_purgeaddrs</span>(<span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_is_addr_deprecated</span>(<span class="enscript-type">struct</span> sockaddr_in6 *);
<span class="enscript-type">extern</span> uint8_t <span class="enscript-function-name">im6s_get_mode</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_multi *,
    <span class="enscript-type">const</span> <span class="enscript-type">struct</span> ip6_msource *, uint8_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">im6f_leave</span>(<span class="enscript-type">struct</span> in6_mfilter *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">im6f_purge</span>(<span class="enscript-type">struct</span> in6_mfilter *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_embedscope</span>(<span class="enscript-type">struct</span> in6_addr *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> sockaddr_in6 *,
    <span class="enscript-type">struct</span> inpcb *, <span class="enscript-type">struct</span> ifnet **, <span class="enscript-type">struct</span> ip6_pktopts *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_recoverscope</span>(<span class="enscript-type">struct</span> sockaddr_in6 *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *,
    <span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_aliasreq_64_to_32</span>(<span class="enscript-type">struct</span> in6_aliasreq_64 *,
    <span class="enscript-type">struct</span> in6_aliasreq_32 *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_aliasreq_32_to_64</span>(<span class="enscript-type">struct</span> in6_aliasreq_32 *,
    <span class="enscript-type">struct</span> in6_aliasreq_64 *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_ifaddr_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_inithead</span>(<span class="enscript-type">void</span> **, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_rtqdrain</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> radix_node *<span class="enscript-function-name">in6_validate</span>(<span class="enscript-type">struct</span> radix_node *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span>  <span class="enscript-function-name">in6_if2idlen</span>(<span class="enscript-type">struct</span> ifnet *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_src_ioctl</span>(u_long, caddr_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_multihead_lock_exclusive</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_multihead_lock_shared</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_multihead_lock_assert</span>(<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_multihead_lock_done</span>(<span class="enscript-type">void</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_cga_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_cga_node_lock</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_cga_node_unlock</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_cga_query</span>(<span class="enscript-type">struct</span> in6_cga_nodecfg *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_cga_start</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_cga_nodecfg *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_cga_stop</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> ssize_t <span class="enscript-function-name">in6_cga_parameters_prepare</span>(<span class="enscript-type">void</span> *, size_t,
    <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *, u_int8_t, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_cga_modifier *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_cga_generate</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_cga_prepare *, u_int8_t,
    <span class="enscript-type">struct</span> in6_addr *);

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _NETINET6_IN6_VAR_H_ */</span>
</pre>
<hr />
</body></html>