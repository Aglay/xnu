<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>in6.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">in6.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2008-2015 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 *
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 *
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

<span class="enscript-comment">/*
 * Copyright (C) 1995, 1996, 1997, and 1998 WIDE Project.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the project nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE PROJECT AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE PROJECT OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 */</span>

<span class="enscript-comment">/*
 * Copyright (c) 1982, 1986, 1990, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)in.h	8.3 (Berkeley) 1/3/94
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">__KAME_NETINET_IN_H_INCLUDED_</span>
#<span class="enscript-reference">error</span> <span class="enscript-string">&quot;do not include netinet6/in6.h directly, include netinet/in.h. &quot;</span> \
	<span class="enscript-string">&quot; see RFC2553&quot;</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_NETINET6_IN6_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_NETINET6_IN6_H_</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_sa_family_t.h&gt;</span>

<span class="enscript-comment">/*
 * Identification of the network protocol stack
 * for *BSD-current/release: <a href="http://www.kame.net/dev/cvsweb.cgi/kame/COVERAGE">http://www.kame.net/dev/cvsweb.cgi/kame/COVERAGE</a>
 * has the table of implementation/integration differences.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__KAME__</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__KAME_VERSION</span>		<span class="enscript-string">&quot;2009/apple-darwin&quot;</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
<span class="enscript-comment">/*
 * Local port number conventions:
 *
 * Ports &lt; IPPORT_RESERVED are reserved for privileged processes (e.g. root),
 * unless a kernel is compiled with IPNOPRIVPORTS defined.
 *
 * When a user does a bind(2) or connect(2) with a port number of zero,
 * a non-conflicting local port address is chosen.
 *
 * The default range is IPPORT_ANONMIN to IPPORT_ANONMAX, although
 * that is settable by sysctl(3); net.inet.ip.anonportmin and
 * net.inet.ip.anonportmax respectively.
 *
 * A user may set the IPPROTO_IP option IP_PORTRANGE to change this
 * default assignment range.
 *
 * The value IP_PORTRANGE_DEFAULT causes the default behavior.
 *
 * The value IP_PORTRANGE_HIGH is the same as IP_PORTRANGE_DEFAULT,
 * and exists only for FreeBSD compatibility purposes.
 *
 * The value IP_PORTRANGE_LOW changes the range to the &quot;low&quot; are
 * that is (by convention) restricted to privileged processes.
 * This convention is based on &quot;vouchsafe&quot; principles only.
 * It is only secure if you trust the remote host to restrict these ports.
 * The range is IPPORT_RESERVEDMIN to IPPORT_RESERVEDMAX.
 */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6PORT_RESERVED</span>	1024
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6PORT_ANONMIN</span>	49152
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6PORT_ANONMAX</span>	65535
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6PORT_RESERVEDMIN</span>	600
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6PORT_RESERVEDMAX</span>	(IPV6PORT_RESERVED-1)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

<span class="enscript-comment">/*
 * IPv6 address
 */</span>
<span class="enscript-type">struct</span> in6_addr {
	<span class="enscript-type">union</span> {
		__uint8_t   __u6_addr8[16];
		__uint16_t  __u6_addr16[8];
		__uint32_t  __u6_addr32[4];
	} __u6_addr;			<span class="enscript-comment">/* 128-bit IP6 address */</span>
};

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">s6_addr</span>   __u6_addr.__u6_addr8
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>	<span class="enscript-comment">/* XXX nonstandard */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">s6_addr8</span>  __u6_addr.__u6_addr8
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">s6_addr16</span> __u6_addr.__u6_addr16
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">s6_addr32</span> __u6_addr.__u6_addr32
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">INET6_ADDRSTRLEN</span>	46

<span class="enscript-comment">/*
 * Socket address for IPv6
 */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SIN6_LEN</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>
<span class="enscript-type">struct</span> sockaddr_in6 {
	__uint8_t	sin6_len;	<span class="enscript-comment">/* length of this struct(sa_family_t) */</span>
	sa_family_t	sin6_family;	<span class="enscript-comment">/* AF_INET6 (sa_family_t) */</span>
	in_port_t	sin6_port;	<span class="enscript-comment">/* Transport layer port # (in_port_t) */</span>
	__uint32_t	sin6_flowinfo;	<span class="enscript-comment">/* IP6 flow information */</span>
	<span class="enscript-type">struct</span> in6_addr	sin6_addr;	<span class="enscript-comment">/* IP6 address */</span>
	__uint32_t	sin6_scope_id;	<span class="enscript-comment">/* scope zone index */</span>
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>	<span class="enscript-comment">/* XXX nonstandard */</span>
<span class="enscript-comment">/*
 * Local definition for masks
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6MASK0</span>	{{{ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6MASK7</span>	{{{ 0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
			    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6MASK16</span>	{{{ 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
			    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6MASK32</span>	{{{ 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, \
			    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6MASK64</span>	{{{ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, \
			    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6MASK96</span>	{{{ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, \
			    0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6MASK128</span>	{{{ 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, \
			    0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff }}}
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> sockaddr_in6 sa6_any;

<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6mask0;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6mask7;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6mask16;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6mask32;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6mask64;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6mask96;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6mask128;

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">SIN6</span>(s)		((struct sockaddr_in6 *)(void *)s)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">satosin6</span>(sa)	SIN6(sa)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">sin6tosa</span>(sin6)	((struct sockaddr *)(void *)(sin6))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">SIN6IFSCOPE</span>(s)	SIN6(s)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>	<span class="enscript-comment">/* XXX nonstandard */</span>
<span class="enscript-comment">/*
 * Macros started with IPV6_ADDR is KAME local
 */</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">BIG_ENDIAN</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_ONE</span>	1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_TWO</span>	2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_MNL</span>	0xff010000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_MLL</span>	0xff020000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_SMP</span>	0x0000ffff
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT16_ULL</span>	0xfe80
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT16_USL</span>	0xfec0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT16_MLL</span>	0xff02
#<span class="enscript-reference">elif</span> <span class="enscript-variable-name">BYTE_ORDER</span> == <span class="enscript-variable-name">LITTLE_ENDIAN</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_ONE</span>	0x01000000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_TWO</span>	0x02000000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_MNL</span>	0x000001ff
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_MLL</span>	0x000002ff
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT32_SMP</span>	0xffff0000
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT16_ULL</span>	0x80fe
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT16_USL</span>	0xc0fe
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_INT16_MLL</span>	0x02ff
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Definition of some useful macros to handle IP6 addresses
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_ANY_INIT</span> \
	{{{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_LOOPBACK_INIT</span> \
	{{{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_NODELOCAL_ALLNODES_INIT</span> \
	{{{ 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_INTFACELOCAL_ALLNODES_INIT</span> \
	{{{ 0xff, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_LINKLOCAL_ALLNODES_INIT</span> \
	{{{ 0xff, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_LINKLOCAL_ALLROUTERS_INIT</span> \
	{{{ 0xff, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_LINKLOCAL_ALLV2ROUTERS_INIT</span> \
	{{{ 0xff, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x16 }}}
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IN6ADDR_V4MAPPED_INIT</span> \
	{{{ 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, \
	    0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00 }}}
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6addr_any;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6addr_loopback;
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6addr_nodelocal_allnodes;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6addr_linklocal_allnodes;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6addr_linklocal_allrouters;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr in6addr_linklocal_allv2routers;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

<span class="enscript-comment">/*
 * Equality
 * NOTE: Some of kernel programming environment (for example, openbsd/sparc)
 * does not supply memcmp().  For userland memcmp() is preferred as it is
 * in ANSI standard.
 */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_ARE_ADDR_EQUAL</span>(a, b) \
	(bcmp(&amp;(a)-&gt;s6_addr[0], &amp;(b)-&gt;s6_addr[0], \
	<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> in6_addr)) == 0)
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_ARE_ADDR_EQUAL</span>(a, b) \
	(memcmp(&amp;(a)-&gt;s6_addr[0], &amp;(b)-&gt;s6_addr[0], <span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> in6_addr)) \
	== 0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>			<span class="enscript-comment">/* non standard */</span>
<span class="enscript-comment">/* see if two addresses are equal in a scope-conscious manner. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">SA6_ARE_ADDR_EQUAL</span>(a, b) \
	(((a)-&gt;sin6_scope_id == 0 || (b)-&gt;sin6_scope_id == 0 || \
	((a)-&gt;sin6_scope_id == (b)-&gt;sin6_scope_id)) &amp;&amp; \
	(bcmp(&amp;(a)-&gt;sin6_addr, &amp;(b)-&gt;sin6_addr, <span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> in6_addr)) == 0))
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Unspecified
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_UNSPECIFIED</span>(a)	\
	((*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[0]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[4]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[8]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[12]) == 0))

<span class="enscript-comment">/*
 * Loopback
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_LOOPBACK</span>(a)		\
	((*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[0]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[4]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[8]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[12]) == ntohl(1)))

<span class="enscript-comment">/*
 * IPv4 compatible
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_V4COMPAT</span>(a)		\
	((*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[0]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[4]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[8]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[12]) != 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[12]) != ntohl(1)))

<span class="enscript-comment">/*
 * Mapped
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_V4MAPPED</span>(a)		      \
	((*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[0]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[4]) == 0) &amp;&amp; \
	(*(<span class="enscript-type">const</span> __uint32_t *)(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *)(&amp;(a)-&gt;s6_addr[8]) == \
	ntohl(0x0000ffff)))

<span class="enscript-comment">/*
 * 6to4
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_6TO4</span>(x)	(ntohs((x)-&gt;s6_addr16[0]) == 0x2002)

<span class="enscript-comment">/*
 * KAME Scope Values
 */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>	<span class="enscript-comment">/* XXX nonstandard */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_SCOPE_NODELOCAL</span>	0x01
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_SCOPE_INTFACELOCAL</span>	0x01
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_SCOPE_LINKLOCAL</span>	0x02
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_SCOPE_SITELOCAL</span>	0x05
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_SCOPE_ORGLOCAL</span>	0x08	<span class="enscript-comment">/* just used in this file */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_ADDR_SCOPE_GLOBAL</span>		0x0e
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__IPV6_ADDR_SCOPE_NODELOCAL</span>	0x01
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__IPV6_ADDR_SCOPE_INTFACELOCAL</span>	0x01
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__IPV6_ADDR_SCOPE_LINKLOCAL</span>	0x02
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__IPV6_ADDR_SCOPE_SITELOCAL</span>	0x05
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__IPV6_ADDR_SCOPE_ORGLOCAL</span>	0x08	<span class="enscript-comment">/* just used in this file */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__IPV6_ADDR_SCOPE_GLOBAL</span>	0x0e
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Unicast Scope
 * Note that we must check topmost 10 bits only, not 16 bits (see RFC2373).
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_LINKLOCAL</span>(a)	\
	(((a)-&gt;s6_addr[0] == 0xfe) &amp;&amp; (((a)-&gt;s6_addr[1] &amp; 0xc0) == 0x80))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_SITELOCAL</span>(a)	\
	(((a)-&gt;s6_addr[0] == 0xfe) &amp;&amp; (((a)-&gt;s6_addr[1] &amp; 0xc0) == 0xc0))

<span class="enscript-comment">/*
 * Multicast
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MULTICAST</span>(a)	((a)-&gt;s6_addr[0] == 0xff)

<span class="enscript-comment">/*
 * Unique Local IPv6 Unicast Addresses (per RFC 4193)
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_UNIQUE_LOCAL</span>(a) \
	(((a)-&gt;s6_addr[0] == 0xfc) || ((a)-&gt;s6_addr[0] == 0xfd))

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>	<span class="enscript-comment">/* XXX nonstandard */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IPV6_ADDR_MC_SCOPE</span>(a)		((a)-&gt;s6_addr[1] &amp; 0x0f)
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">__IPV6_ADDR_MC_SCOPE</span>(a)		((a)-&gt;s6_addr[1] &amp; 0x0f)
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Multicast Scope
 */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>	<span class="enscript-comment">/* refers nonstandard items */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_NODELOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(IPV6_ADDR_MC_SCOPE(a) == IPV6_ADDR_SCOPE_NODELOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_INTFACELOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(IPV6_ADDR_MC_SCOPE(a) == IPV6_ADDR_SCOPE_INTFACELOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_LINKLOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(IPV6_ADDR_MC_SCOPE(a) == IPV6_ADDR_SCOPE_LINKLOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_SITELOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp; 	\
	(IPV6_ADDR_MC_SCOPE(a) == IPV6_ADDR_SCOPE_SITELOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_ORGLOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(IPV6_ADDR_MC_SCOPE(a) == IPV6_ADDR_SCOPE_ORGLOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_GLOBAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(IPV6_ADDR_MC_SCOPE(a) == IPV6_ADDR_SCOPE_GLOBAL))
#<span class="enscript-reference">else</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_NODELOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(__IPV6_ADDR_MC_SCOPE(a) == __IPV6_ADDR_SCOPE_NODELOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_LINKLOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(__IPV6_ADDR_MC_SCOPE(a) == __IPV6_ADDR_SCOPE_LINKLOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_SITELOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp; 	\
	(__IPV6_ADDR_MC_SCOPE(a) == __IPV6_ADDR_SCOPE_SITELOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_ORGLOCAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(__IPV6_ADDR_MC_SCOPE(a) == __IPV6_ADDR_SCOPE_ORGLOCAL))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_ADDR_MC_GLOBAL</span>(a)	\
	(IN6_IS_ADDR_MULTICAST(a) &amp;&amp;	\
	(__IPV6_ADDR_MC_SCOPE(a) == __IPV6_ADDR_SCOPE_GLOBAL))
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>	<span class="enscript-comment">/* nonstandard */</span>
<span class="enscript-comment">/*
 * KAME Scope
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_SCOPE_LINKLOCAL</span>(a)	\
	((IN6_IS_ADDR_LINKLOCAL(a)) ||	\
	(IN6_IS_ADDR_MC_LINKLOCAL(a)))

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IN6_IS_SCOPE_EMBED</span>(a)			\
	((IN6_IS_ADDR_LINKLOCAL(a)) ||		\
	(IN6_IS_ADDR_MC_LINKLOCAL(a)) ||	\
	(IN6_IS_ADDR_MC_INTFACELOCAL(a)))

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IFA6_IS_DEPRECATED</span>(a, t) \
	((a)-&gt;ia6_lifetime.ia6ti_preferred != 0 &amp;&amp; \
	(a)-&gt;ia6_lifetime.ia6ti_preferred &lt; (t))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">IFA6_IS_INVALID</span>(a, t) \
	((a)-&gt;ia6_lifetime.ia6ti_expire != 0 &amp;&amp; \
	(a)-&gt;ia6_lifetime.ia6ti_expire &lt; (t))
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-type">struct</span> route_in6_old {
	<span class="enscript-type">void</span>		*ro_rt;
	uint32_t	ro_flags;
	<span class="enscript-type">struct</span> sockaddr_in6 ro_dst;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * IP6 route structure
 *
 * A route consists of a destination address and a reference
 * to a routing entry.  These are often held by protocols
 * in their control blocks, e.g. inpcb.
 */</span>
<span class="enscript-type">struct</span> route_in6 {
	<span class="enscript-comment">/*
	 * N.B: struct route_in6 must begin with ro_{rt,srcia,flags}
	 * because the code does some casts of a 'struct route_in6 *'
	 * to a 'struct route *'.
	 */</span>
	<span class="enscript-type">struct</span> rtentry	*ro_rt;
	<span class="enscript-type">struct</span> ifaddr	*ro_srcia;
	uint32_t	ro_flags;	<span class="enscript-comment">/* route flags */</span>
	<span class="enscript-type">struct</span> sockaddr_in6 ro_dst;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-comment">/*
 * Options for use with [gs]etsockopt at the IPV6 level.
 * First word of comment is data type; bool is stored in int.
 */</span>
<span class="enscript-comment">/* no hdrincl */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
<span class="enscript-comment">/*
 * RFC 3542 define the following socket options in a manner incompatible
 * with RFC 2292:
 *   IPV6_PKTINFO
 *   IPV6_HOPLIMIT
 *   IPV6_NEXTHOP
 *   IPV6_HOPOPTS
 *   IPV6_DSTOPTS
 *   IPV6_RTHDR
 *
 * To use the new IPv6 Sockets options introduced by RFC 3542
 * the constant __APPLE_USE_RFC_3542 must be defined before
 * including &lt;netinet/in.h&gt;
 *
 * To use the old IPv6 Sockets options from RFC 2292
 * the constant __APPLE_USE_RFC_2292 must be defined before
 * including &lt;netinet/in.h&gt;
 *
 * Note that eventually RFC 3542 is going to be the
 * default and RFC 2292 will be obsolete.
 */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">__APPLE_USE_RFC_3542</span> 1
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__APPLE_USE_RFC_3542</span>) &amp;&amp; <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__APPLE_USE_RFC_2292</span>)
#<span class="enscript-reference">error</span> <span class="enscript-string">&quot;__APPLE_USE_RFC_3542 and __APPLE_USE_RFC_2292 cannot be both defined&quot;</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> 0 <span class="enscript-comment">/* the followings are relic in IPv4 and hence are disabled */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_OPTIONS</span>		1  <span class="enscript-comment">/* buf/ip6_opts; set/get IP6 options */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVOPTS</span>		5  <span class="enscript-comment">/* bool; receive all IP6 opts w/dgram */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVRETOPTS</span>	6  <span class="enscript-comment">/* bool; receive IP6 opts for response */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVDSTADDR</span>	7  <span class="enscript-comment">/* bool; receive IP6 dst addr w/dgram */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RETOPTS</span>		8  <span class="enscript-comment">/* ip6_opts; set/get IP6 options */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* 0 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_SOCKOPT_RESERVED1</span>	3  <span class="enscript-comment">/* reserved for future use */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_UNICAST_HOPS</span>	4  <span class="enscript-comment">/* int; IP6 hops */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MULTICAST_IF</span>	9  <span class="enscript-comment">/* __uint8_t; set/get IP6 multicast i/f  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MULTICAST_HOPS</span>	10 <span class="enscript-comment">/* __uint8_t; set/get IP6 multicast hops */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MULTICAST_LOOP</span>	11 <span class="enscript-comment">/* __uint8_t; set/get IP6 mcast loopback */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_JOIN_GROUP</span>		12 <span class="enscript-comment">/* ip6_mreq; join a group membership */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_LEAVE_GROUP</span>	13 <span class="enscript-comment">/* ip6_mreq; leave a group membership */</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PORTRANGE</span>		14 <span class="enscript-comment">/* int; range to choose for unspec port */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ICMP6_FILTER</span>		18 <span class="enscript-comment">/* icmp6_filter; icmp6 filter */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_2292PKTINFO</span>	19 <span class="enscript-comment">/* bool; send/recv if, src/dst addr */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_2292HOPLIMIT</span>	20 <span class="enscript-comment">/* bool; hop limit */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_2292NEXTHOP</span>	21 <span class="enscript-comment">/* bool; next hop addr */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_2292HOPOPTS</span>	22 <span class="enscript-comment">/* bool; hop-by-hop option */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_2292DSTOPTS</span>	23 <span class="enscript-comment">/* bool; destinaion option */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_2292RTHDR</span>		24 <span class="enscript-comment">/* ip6_rthdr: routing header */</span>

<span class="enscript-comment">/* buf/cmsghdr; set/get IPv6 options [obsoleted by RFC3542] */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_2292PKTOPTIONS</span>	25

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE_USE_RFC_2292</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PKTINFO</span>	IPV6_2292PKTINFO
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_HOPLIMIT</span>	IPV6_2292HOPLIMIT
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_NEXTHOP</span>	IPV6_2292NEXTHOP
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_HOPOPTS</span>	IPV6_2292HOPOPTS
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_DSTOPTS</span>	IPV6_2292DSTOPTS
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RTHDR</span>	IPV6_2292RTHDR
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PKTOPTIONS</span>	IPV6_2292PKTOPTIONS
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __APPLE_USE_RFC_2292 */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_CHECKSUM</span>		26 <span class="enscript-comment">/* int; checksum offset for raw socket */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_V6ONLY</span>		27 <span class="enscript-comment">/* bool; only bind INET6 at wildcard bind */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_BINDV6ONLY</span>		IPV6_V6ONLY
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>


#<span class="enscript-reference">if</span> 1 <span class="enscript-comment">/* IPSEC */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_IPSEC_POLICY</span>	28 <span class="enscript-comment">/* struct; get/set security policy */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* 1 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FAITH</span>		29 <span class="enscript-comment">/* deprecated */</span>

#<span class="enscript-reference">if</span> 1 <span class="enscript-comment">/* IPV6FIREWALL */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FW_ADD</span>		30 <span class="enscript-comment">/* add a firewall rule to chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FW_DEL</span>		31 <span class="enscript-comment">/* delete a firewall rule from chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FW_FLUSH</span>		32 <span class="enscript-comment">/* flush firewall rule chain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FW_ZERO</span>		33 <span class="enscript-comment">/* clear single/all firewall counter(s) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_FW_GET</span>		34 <span class="enscript-comment">/* get entire firewall rule chain */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* 1 */</span>

<span class="enscript-comment">/*
 * APPLE: NOTE the value of those 2 options is kept unchanged from
 *   previous version of darwin/OS X for binary compatibility reasons
 *   and differ from FreeBSD (values 57 and 61). See below.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVTCLASS</span>		35 <span class="enscript-comment">/* bool; recv traffic class values */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_TCLASS</span>		36 <span class="enscript-comment">/* int; send traffic class value */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__APPLE_USE_RFC_3542</span>
<span class="enscript-comment">/* new socket options introduced in RFC3542 */</span>
<span class="enscript-comment">/*
 * ip6_dest; send dst option before rthdr
 * APPLE: Value purposely different than FreeBSD (35) to avoid
 * collision with definition of IPV6_RECVTCLASS in previous
 * darwin implementations
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RTHDRDSTOPTS</span>	57

<span class="enscript-comment">/*
 * bool; recv if, dst addr
 * APPLE: Value purposely different than FreeBSD(36) to avoid
 * collision with definition of IPV6_TCLASS in previous
 * darwin implementations
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVPKTINFO</span>	61

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVHOPLIMIT</span>	37 <span class="enscript-comment">/* bool; recv hop limit */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVRTHDR</span>		38 <span class="enscript-comment">/* bool; recv routing header */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVHOPOPTS</span>	39 <span class="enscript-comment">/* bool; recv hop-by-hop option */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVDSTOPTS</span>	40 <span class="enscript-comment">/* bool; recv dst option after rthdr */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVRTHDRDSTOPTS</span>	41 <span class="enscript-comment">/* bool; recv dst option before rthdr */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_USE_MIN_MTU</span>	42 <span class="enscript-comment">/* bool; send packets at the minimum MTU */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RECVPATHMTU</span>	43 <span class="enscript-comment">/* bool; notify an according MTU */</span>

<span class="enscript-comment">/*
 * mtuinfo; get the current path MTU (sopt), 4 bytes int;
 * MTU notification (cmsg)
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PATHMTU</span>		44

#<span class="enscript-reference">if</span> 0 <span class="enscript-comment">/* obsoleted during 2292bis -&gt; 3542 */</span>
<span class="enscript-comment">/* no data; ND reachability confirm (cmsg only/not in of RFC3542) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_REACHCONF</span>		45
#<span class="enscript-reference">endif</span>
<span class="enscript-comment">/* more new socket options introduced in RFC3542 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_3542PKTINFO</span>	46 <span class="enscript-comment">/* in6_pktinfo; send if, src addr */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_3542HOPLIMIT</span>	47 <span class="enscript-comment">/* int; send hop limit */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_3542NEXTHOP</span>	48 <span class="enscript-comment">/* sockaddr; next hop addr */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_3542HOPOPTS</span>	49 <span class="enscript-comment">/* ip6_hbh; send hop-by-hop option */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_3542DSTOPTS</span>	50 <span class="enscript-comment">/* ip6_dest; send dst option befor rthdr */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_3542RTHDR</span>		51 <span class="enscript-comment">/* ip6_rthdr; send routing header */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PKTINFO</span>	IPV6_3542PKTINFO
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_HOPLIMIT</span>	IPV6_3542HOPLIMIT
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_NEXTHOP</span>	IPV6_3542NEXTHOP
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_HOPOPTS</span>	IPV6_3542HOPOPTS
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_DSTOPTS</span>	IPV6_3542DSTOPTS
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RTHDR</span>	IPV6_3542RTHDR

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_AUTOFLOWLABEL</span>	59 <span class="enscript-comment">/* bool; attach flowlabel automagically */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_DONTFRAG</span>		62 <span class="enscript-comment">/* bool; disable IPv6 fragmentation */</span>

<span class="enscript-comment">/* int; prefer temporary addresses as the source address. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PREFER_TEMPADDR</span>	63

<span class="enscript-comment">/*
 * The following option is private; do not use it from user applications.
 * It is deliberately defined to the same value as IP_MSFILTER.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MSFILTER</span>		74 <span class="enscript-comment">/* struct __msfilterreq; */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __APPLE_USE_RFC_3542 */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_BOUND_IF</span>		125 <span class="enscript-comment">/* int; set/get bound interface */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_NO_IFT_CELLULAR</span>	6969 <span class="enscript-comment">/* for internal use only */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_OUT_IF</span>		9696 <span class="enscript-comment">/* for internal use only */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

<span class="enscript-comment">/* to define items, should talk with KAME guys first, for *BSD compatibility */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RTHDR_LOOSE</span>	0 <span class="enscript-comment">/* this hop need not be a neighbor. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RTHDR_STRICT</span>	1 <span class="enscript-comment">/* this hop must be a neighbor. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_RTHDR_TYPE_0</span>	0 <span class="enscript-comment">/* IPv6 routing header type 0 */</span>

<span class="enscript-comment">/*
 * Defaults and limits for options
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_DEFAULT_MULTICAST_HOPS</span> 1	<span class="enscript-comment">/* normally limit m'casts to 1 hop  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_DEFAULT_MULTICAST_LOOP</span> 1	<span class="enscript-comment">/* normally hear sends if a member  */</span>

<span class="enscript-comment">/*
 * The im6o_membership vector for each socket is now dynamically allocated at
 * run-time, bounded by USHRT_MAX, and is reallocated when needed, sized
 * according to a power-of-two increment.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MIN_MEMBERSHIPS</span>	31
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MAX_MEMBERSHIPS</span>	4095

<span class="enscript-comment">/*
 * Default resource limits for IPv6 multicast source filtering.
 * These may be modified by sysctl.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MAX_GROUP_SRC_FILTER</span>	512	<span class="enscript-comment">/* sources per group */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_MAX_SOCK_SRC_FILTER</span>	128	<span class="enscript-comment">/* sources per socket/group */</span>

<span class="enscript-comment">/*
 * Argument structure for IPV6_JOIN_GROUP and IPV6_LEAVE_GROUP.
 */</span>
<span class="enscript-type">struct</span> ipv6_mreq {
	<span class="enscript-type">struct</span> in6_addr	ipv6mr_multiaddr;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	ipv6mr_interface;
};

<span class="enscript-comment">/*
 * IPV6_2292PKTINFO: Packet information(RFC2292 sec 5)
 */</span>
<span class="enscript-type">struct</span> in6_pktinfo {
	<span class="enscript-type">struct</span> in6_addr	ipi6_addr;	<span class="enscript-comment">/* src/dst IPv6 address */</span>
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	ipi6_ifindex;	<span class="enscript-comment">/* send/recv interface index */</span>
};

<span class="enscript-comment">/*
 * Control structure for IPV6_RECVPATHMTU socket option.
 */</span>
<span class="enscript-type">struct</span> ip6_mtuinfo {
	<span class="enscript-type">struct</span> sockaddr_in6 ip6m_addr;	<span class="enscript-comment">/* or sockaddr_storage? */</span>
	uint32_t ip6m_mtu;
};

<span class="enscript-comment">/*
 * Argument for IPV6_PORTRANGE:
 * - which range to search when port is unspecified at bind() or connect()
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PORTRANGE_DEFAULT</span>	0	<span class="enscript-comment">/* default range */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PORTRANGE_HIGH</span>	1	<span class="enscript-comment">/* &quot;high&quot; - request firewall bypass */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6_PORTRANGE_LOW</span>	2	<span class="enscript-comment">/* &quot;low&quot; - vouchsafe security */</span>

<span class="enscript-comment">/*
 * Definitions for inet6 sysctl operations.
 *
 * Third level is protocol number.
 * Fourth level is desired variable within that protocol.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6PROTO_MAXID</span>	(IPPROTO_PIM + 1)  <span class="enscript-comment">/* don't list to IPV6PROTO_MAX */</span>

<span class="enscript-comment">/*
 * Names for IP sysctl objects
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_FORWARDING</span>	1	<span class="enscript-comment">/* act as router */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_SENDREDIRECTS</span>	2	<span class="enscript-comment">/* may send redirects when forwarding */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_DEFHLIM</span>		3	<span class="enscript-comment">/* default Hop-Limit */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">notyet</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_DEFMTU</span>		4	<span class="enscript-comment">/* default MTU */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_FORWSRCRT</span>	5	<span class="enscript-comment">/* forward source-routed dgrams */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_STATS</span>		6	<span class="enscript-comment">/* stats */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MRTSTATS</span>	7	<span class="enscript-comment">/* multicast forwarding stats */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MRTPROTO</span>	8	<span class="enscript-comment">/* multicast routing protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MAXFRAGPACKETS</span>	9	<span class="enscript-comment">/* max packets reassembly queue */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_SOURCECHECK</span>	10	<span class="enscript-comment">/* verify source route and intf */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_SOURCECHECK_LOGINT</span> 11	<span class="enscript-comment">/* minimume logging interval */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_ACCEPT_RTADV</span>	12
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_KEEPFAITH</span>	13	<span class="enscript-comment">/* deprecated */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_LOG_INTERVAL</span>	14
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_HDRNESTLIMIT</span>	15
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_DAD_COUNT</span>	16
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_AUTO_FLOWLABEL</span>	17
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_DEFMCASTHLIM</span>	18
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_GIF_HLIM</span>	19	<span class="enscript-comment">/* default HLIM for gif encap packet */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_KAME_VERSION</span>	20
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_USE_DEPRECATED</span>	21	<span class="enscript-comment">/* use deprec addr (RFC2462 5.5.4) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_RR_PRUNE</span>	22	<span class="enscript-comment">/* walk timer for router renumbering */</span>
#<span class="enscript-reference">if</span> 0	<span class="enscript-comment">/* obsolete */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MAPPED_ADDR</span>	23
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_V6ONLY</span>		24
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_RTEXPIRE</span>	25	<span class="enscript-comment">/* cloned route expiration time */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_RTMINEXPIRE</span>	26	<span class="enscript-comment">/* min value for expiration time */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_RTMAXCACHE</span>	27	<span class="enscript-comment">/* trigger level for dynamic expire */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_USETEMPADDR</span>	32	<span class="enscript-comment">/* use temporary addresses [RFC 4941] */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_TEMPPLTIME</span>	33	<span class="enscript-comment">/* preferred lifetime for tmpaddrs */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_TEMPVLTIME</span>	34	<span class="enscript-comment">/* valid lifetime for tmpaddrs */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_AUTO_LINKLOCAL</span>	35	<span class="enscript-comment">/* automatic link-local addr assign */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_RIP6STATS</span>	36	<span class="enscript-comment">/* raw_ip6 stats */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_PREFER_TEMPADDR</span>	37	<span class="enscript-comment">/* prefer temporary addr as src */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_ADDRCTLPOLICY</span>	38	<span class="enscript-comment">/* get/set address selection policy */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_USE_DEFAULTZONE</span>	39	<span class="enscript-comment">/* use default scope zone */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MAXFRAGS</span>	41	<span class="enscript-comment">/* max fragments */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MCAST_PMTU</span>	44	<span class="enscript-comment">/* enable pMTU discovery for mcast? */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_NEIGHBORGCTHRESH</span> 46
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MAXIFPREFIXES</span>	47
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MAXIFDEFROUTERS</span> 48
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MAXDYNROUTES</span>	49
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ICMPV6CTL_ND6_ONLINKNSRFC4861</span>	50

<span class="enscript-comment">/* New entries should be added here from current IPV6CTL_MAXID value. */</span>
<span class="enscript-comment">/* to define items, should talk with KAME guys first, for *BSD compatibility */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IPV6CTL_MAXID</span>		51

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">CTL_IPV6PROTO_NAMES</span> { \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;tcp6&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;udp6&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;ip6&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;ipsec6&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ <span class="enscript-string">&quot;icmp6&quot;</span>, CTLTYPE_NODE }, \
	{ 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, { 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
	{ 0, 0 }, \
}
<span class="enscript-comment">/*
 * Redefinition of mbuf flags
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">M_AUTHIPHDR</span>	M_PROTO2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">M_DECRYPTED</span>	M_PROTO3
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">M_AUTHIPDGM</span>	M_PROTO5

<span class="enscript-type">struct</span> cmsghdr;
<span class="enscript-type">struct</span> mbuf;
<span class="enscript-type">struct</span> ifnet;
<span class="enscript-type">struct</span> in6_aliasreq;

<span class="enscript-type">extern</span> uint16_t <span class="enscript-function-name">in6_pseudo</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *,
    uint32_t);
<span class="enscript-type">extern</span> u_int16_t <span class="enscript-function-name">inet6_cksum</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, uint32_t, uint32_t);

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in6_cksum</span>(_m, _n, _o, _l)		\
	inet6_cksum(_m, _n, _o, _l)

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_addrscope</span>(<span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_ifaddr *<span class="enscript-function-name">in6_ifawithscope</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_ifaddr *<span class="enscript-function-name">in6_ifawithifp</span>(<span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> in6_addr *);

<span class="enscript-type">struct</span> sockaddr;

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_sin6_2_sin</span>(<span class="enscript-type">struct</span> sockaddr_in *sin, <span class="enscript-type">struct</span> sockaddr_in6 *sin6);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_sin_2_v4mapsin6</span>(<span class="enscript-type">struct</span> sockaddr_in *sin,
    <span class="enscript-type">struct</span> sockaddr_in6 *sin6);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">in6_sin6_2_sin_in_sock</span>(<span class="enscript-type">struct</span> sockaddr *nam);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_sin_2_v4mapsin6_in_sock</span>(<span class="enscript-type">struct</span> sockaddr **nam);

<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">in6_finalize_cksum</span>(<span class="enscript-type">struct</span> mbuf *, uint32_t, int32_t,
    int32_t, uint32_t);

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in6_delayed_cksum</span>(_m)			\
	((<span class="enscript-type">void</span>) in6_finalize_cksum(_m, 0, 0, -1, CSUM_DELAY_IPV6_DATA))
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">in6_delayed_cksum_offset</span>(_m, _o, _s, _p)	\
	((<span class="enscript-type">void</span>) in6_finalize_cksum(_m, _o, _s, _p, CSUM_DELAY_IPV6_DATA))
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-comment">/* exporte for ApplicationFirewall */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6_localaddr</span>(<span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">in6addr_local</span>(<span class="enscript-type">struct</span> in6_addr *);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
__BEGIN_DECLS
<span class="enscript-type">struct</span> cmsghdr;

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_option_space</span>(<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_option_init</span>(<span class="enscript-type">void</span> *, <span class="enscript-type">struct</span> cmsghdr **, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_option_append</span>(<span class="enscript-type">struct</span> cmsghdr *, <span class="enscript-type">const</span> __uint8_t *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> __uint8_t *<span class="enscript-function-name">inet6_option_alloc</span>(<span class="enscript-type">struct</span> cmsghdr *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_option_next</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> cmsghdr *, __uint8_t **);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_option_find</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> cmsghdr *, __uint8_t **, <span class="enscript-type">int</span>);

<span class="enscript-type">extern</span> size_t <span class="enscript-function-name">inet6_rthdr_space</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> cmsghdr *<span class="enscript-function-name">inet6_rthdr_init</span>(<span class="enscript-type">void</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rthdr_add</span>(<span class="enscript-type">struct</span> cmsghdr *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *,
    <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rthdr_lasthop</span>(<span class="enscript-type">struct</span> cmsghdr *, <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>);
#<span class="enscript-reference">if</span> 0 <span class="enscript-comment">/* not implemented yet */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rthdr_reverse</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> cmsghdr *, <span class="enscript-type">struct</span> cmsghdr *);
#<span class="enscript-reference">endif</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rthdr_segments</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> cmsghdr *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_addr *<span class="enscript-function-name">inet6_rthdr_getaddr</span>(<span class="enscript-type">struct</span> cmsghdr *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rthdr_getflags</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> cmsghdr *, <span class="enscript-type">int</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_opt_init</span>(<span class="enscript-type">void</span> *, socklen_t);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_opt_append</span>(<span class="enscript-type">void</span> *, socklen_t, <span class="enscript-type">int</span>, __uint8_t, socklen_t,
    __uint8_t, <span class="enscript-type">void</span> **);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_opt_finish</span>(<span class="enscript-type">void</span> *, socklen_t, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_opt_set_val</span>(<span class="enscript-type">void</span> *, <span class="enscript-type">int</span>, <span class="enscript-type">void</span> *, socklen_t);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_opt_next</span>(<span class="enscript-type">void</span> *, socklen_t, <span class="enscript-type">int</span>, __uint8_t *, socklen_t *,
    <span class="enscript-type">void</span> **);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_opt_find</span>(<span class="enscript-type">void</span> *, socklen_t, <span class="enscript-type">int</span>, __uint8_t, socklen_t *,
    <span class="enscript-type">void</span> **);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_opt_get_val</span>(<span class="enscript-type">void</span> *, <span class="enscript-type">int</span>, <span class="enscript-type">void</span> *, socklen_t);
<span class="enscript-type">extern</span> socklen_t <span class="enscript-function-name">inet6_rth_space</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> *<span class="enscript-function-name">inet6_rth_init</span>(<span class="enscript-type">void</span> *, socklen_t, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rth_add</span>(<span class="enscript-type">void</span> *, <span class="enscript-type">const</span> <span class="enscript-type">struct</span> in6_addr *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rth_reverse</span>(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *, <span class="enscript-type">void</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">inet6_rth_segments</span>(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> in6_addr *<span class="enscript-function-name">inet6_rth_getaddr</span>(<span class="enscript-type">const</span> <span class="enscript-type">void</span> *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">addrsel_policy_init</span>(<span class="enscript-type">void</span>);
__END_DECLS
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !KERNEL */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_NETINET6_IN6_H_ */</span>
</pre>
<hr />
</body></html>