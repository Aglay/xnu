<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>protosw.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">protosw.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2015 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 *
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 *
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/* Copyright (c) 1998, 1999 Apple Computer, Inc. All Rights Reserved */</span>
<span class="enscript-comment">/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */</span>
<span class="enscript-comment">/*
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)protosw.h	8.1 (Berkeley) 6/2/93
 * $FreeBSD: src/sys/sys/protosw.h,v 1.28.2.2 2001/07/03 11:02:01 ume Exp $
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_SYS_PROTOSW_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_SYS_PROTOSW_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/cdefs.h&gt;</span>

<span class="enscript-comment">/* XXX: this will go away */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_SLOWHZ</span>	2		<span class="enscript-comment">/* 2 slow timeouts per second */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/socket.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/socketvar.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/queue.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;kern/locks.h&gt;</span>

<span class="enscript-comment">/* Forward declare these structures referenced from prototypes below. */</span>
<span class="enscript-type">struct</span> mbuf;
<span class="enscript-type">struct</span> proc;
<span class="enscript-type">struct</span> sockaddr;
<span class="enscript-type">struct</span> socket;
<span class="enscript-type">struct</span> sockopt;
<span class="enscript-type">struct</span> socket_filter;
<span class="enscript-type">struct</span> uio;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-type">struct</span> domain_old;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>(4)

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * Legacy protocol switch table.
 *
 * NOTE: Do not modify this structure, as there are modules outside of xnu
 * which rely on the size and layout for binary compatibility.  This structure
 * is simply used by the exported net_{add,del}_proto_old, pffindproto_old
 * routines, and by the domain_old structure.  Internally, protocol switch
 * tables are stored in the private variant of protosw defined down below.
 */</span>
<span class="enscript-type">struct</span> protosw_old {
#<span class="enscript-reference">else</span>
<span class="enscript-type">struct</span> protosw {
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !XNU_KERNEL_PRIVATE */</span>
	<span class="enscript-type">short</span>	pr_type;		<span class="enscript-comment">/* socket type used for */</span>
	<span class="enscript-type">struct</span>	domain *pr_domain;	<span class="enscript-comment">/* domain protocol a member of */</span>
	<span class="enscript-type">short</span>	pr_protocol;		<span class="enscript-comment">/* protocol number */</span>
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> pr_flags;		<span class="enscript-comment">/* see below */</span>
	<span class="enscript-comment">/*
	 * protocol-protocol hooks
	 */</span>
	<span class="enscript-type">void</span>	(*pr_input)		<span class="enscript-comment">/* input to protocol (from below) */</span>
		    (<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span> len);
	<span class="enscript-type">int</span>	(*pr_output)		<span class="enscript-comment">/* output to protocol (from above) */</span>
		    (<span class="enscript-type">struct</span> mbuf *m, <span class="enscript-type">struct</span> socket *so);
	<span class="enscript-type">void</span>	(*pr_ctlinput)		<span class="enscript-comment">/* control input (from below) */</span>
		    (<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">void</span> *);
	<span class="enscript-type">int</span>	(*pr_ctloutput)		<span class="enscript-comment">/* control output (from above) */</span>
		    (<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
	<span class="enscript-comment">/*
	 * user-protocol hook
	 */</span>
	<span class="enscript-type">void</span>	*pr_ousrreq;
	<span class="enscript-comment">/*
	 * utility hooks
	 */</span>
	<span class="enscript-type">void</span>	(*pr_init)(<span class="enscript-type">void</span>);	<span class="enscript-comment">/* initialization hook */</span>
	<span class="enscript-type">void</span>	(*pr_unused)(<span class="enscript-type">void</span>);	<span class="enscript-comment">/* placeholder - fasttimo is removed */</span>
	<span class="enscript-type">void</span>	(*pr_unused2)(<span class="enscript-type">void</span>);	<span class="enscript-comment">/* placeholder - slowtimo is removed */</span>
	<span class="enscript-type">void</span>	(*pr_drain)(<span class="enscript-type">void</span>);	<span class="enscript-comment">/* flush any excess space possible */</span>
	<span class="enscript-type">int</span>	(*pr_sysctl)		<span class="enscript-comment">/* sysctl for protocol */</span>
		    (<span class="enscript-type">int</span> *, u_int, <span class="enscript-type">void</span> *, size_t *, <span class="enscript-type">void</span> *, size_t);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
	<span class="enscript-type">struct</span>	pr_usrreqs_old *pr_usrreqs; <span class="enscript-comment">/* supersedes pr_usrreq() */</span>
#<span class="enscript-reference">else</span>
	<span class="enscript-type">struct</span>	pr_usrreqs *pr_usrreqs;	<span class="enscript-comment">/* supersedes pr_usrreq() */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !XNU_KERNEL_PRIVATE */</span>
	<span class="enscript-type">int</span>	(*pr_lock)		<span class="enscript-comment">/* lock function for protocol */</span>
		    (<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> locktype, <span class="enscript-type">void</span> *debug);
	<span class="enscript-type">int</span>	(*pr_unlock)		<span class="enscript-comment">/* unlock for protocol */</span>
		    (<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> locktype, <span class="enscript-type">void</span> *debug);
	lck_mtx_t *(*pr_getlock)	<span class="enscript-comment">/* retrieve protocol lock */</span>
		    (<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> locktype);
	<span class="enscript-comment">/*
	 * Implant hooks
	 */</span>
	TAILQ_HEAD(, socket_filter) pr_filter_head;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
	<span class="enscript-type">struct</span> protosw_old *pr_next;	<span class="enscript-comment">/* chain for domain */</span>
#<span class="enscript-reference">else</span>
	<span class="enscript-type">struct</span> protosw *pr_next;	<span class="enscript-comment">/* chain for domain */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !XNU_KERNEL_PRIVATE */</span>
	u_int32_t	reserved[1];	<span class="enscript-comment">/* padding for future use */</span>
};

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>()

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * Protocol switch table.
 *
 * Each protocol has a handle initializing one of these structures,
 * which is used for protocol-protocol and system-protocol communication.
 *
 * A protocol is called through the pr_init entry before any other.
 * The system will call the pr_drain entry if it is low on space and this
 * should throw away any non-critical data.
 *
 * Protocols pass data between themselves as chains of mbufs using
 * the pr_input and pr_output hooks.  Pr_input passes data up (towards
 * the users) and pr_output passes it down (towards the interfaces); control
 * information passes up and down on pr_ctlinput and pr_ctloutput.
 * The protocol is responsible for the space occupied by any the
 * arguments to these entries and must dispose it.
 *
 * The userreq routine interfaces protocols to the system and is
 * described below.
 *
 * After a protocol is attached, its pr_domain will be set to the domain
 * which the protocol belongs to, and its pr_protosw will be set to the
 * address of the protosw instance.  The latter is useful for finding
 * the real/original protosw instance, in the event so_proto is altered
 * to point to an alternative/derivative protosw.  E.g. the list of
 * socket filters is only applicable on the original protosw instance.
 *
 * Internal, private and extendable representation of protosw.
 */</span>
<span class="enscript-type">struct</span> protosw {
	TAILQ_ENTRY(protosw) pr_entry; <span class="enscript-comment">/* chain for domain */</span>
	<span class="enscript-type">struct</span>	domain *pr_domain;	<span class="enscript-comment">/* domain protocol a member of */</span>
	<span class="enscript-type">struct</span> protosw *pr_protosw;	<span class="enscript-comment">/* pointer to self */</span>
	u_int16_t pr_type;		<span class="enscript-comment">/* socket type used for */</span>
	u_int16_t pr_protocol;		<span class="enscript-comment">/* protocol number */</span>
	u_int32_t pr_flags;		<span class="enscript-comment">/* see below */</span>
	<span class="enscript-comment">/*
	 * protocol-protocol hooks
	 */</span>
	<span class="enscript-type">void</span>	(*pr_input)		<span class="enscript-comment">/* input to protocol (from below) */</span>
		    (<span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span> len);
	<span class="enscript-type">int</span>	(*pr_output)		<span class="enscript-comment">/* output to protocol (from above) */</span>
		    (<span class="enscript-type">struct</span> mbuf *m, <span class="enscript-type">struct</span> socket *so);
	<span class="enscript-type">void</span>	(*pr_ctlinput)		<span class="enscript-comment">/* control input (from below) */</span>
		    (<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">void</span> *);
	<span class="enscript-type">int</span>	(*pr_ctloutput)		<span class="enscript-comment">/* control output (from above) */</span>
		    (<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
	<span class="enscript-comment">/*
	 * user-protocol hook
	 */</span>
	<span class="enscript-type">struct</span>	pr_usrreqs *pr_usrreqs;	<span class="enscript-comment">/* user request; see list below */</span>
	<span class="enscript-comment">/*
	 * utility hooks
	 */</span>
	<span class="enscript-type">void</span>	(*pr_init)		<span class="enscript-comment">/* initialization hook */</span>
		    (<span class="enscript-type">struct</span> protosw *, <span class="enscript-type">struct</span> domain *);
	<span class="enscript-type">void</span>	(*pr_drain)(<span class="enscript-type">void</span>);	<span class="enscript-comment">/* flush any excess space possible */</span>
	<span class="enscript-type">int</span>	(*pr_sysctl)		<span class="enscript-comment">/* sysctl for protocol */</span>
		    (<span class="enscript-type">int</span> *, u_int, <span class="enscript-type">void</span> *, size_t *, <span class="enscript-type">void</span> *, size_t);
	<span class="enscript-type">int</span>	(*pr_lock)		<span class="enscript-comment">/* lock function for protocol */</span>
		    (<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> locktype, <span class="enscript-type">void</span> *debug);
	<span class="enscript-type">int</span>	(*pr_unlock)		<span class="enscript-comment">/* unlock for protocol */</span>
		    (<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> locktype, <span class="enscript-type">void</span> *debug);
	lck_mtx_t *(*pr_getlock)	<span class="enscript-comment">/* retrieve protocol lock */</span>
		    (<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> locktype);
	<span class="enscript-comment">/*
	 * misc
	 */</span>
	TAILQ_HEAD(, socket_filter) pr_filter_head;
	<span class="enscript-type">struct</span> protosw_old *pr_old;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>

<span class="enscript-comment">/*
 * Values for pr_flags.
 * PR_ADDR requires PR_ATOMIC;
 * PR_ADDR and PR_CONNREQUIRED are mutually exclusive.
 * PR_IMPLOPCL means that the protocol allows sendto without prior connect,
 *	and the protocol understands the MSG_EOF flag.  The first property is
 *	is only relevant if PR_CONNREQUIRED is set (otherwise sendto is allowed
 *	anyhow).
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_ATOMIC</span>	0x01	<span class="enscript-comment">/* exchange atomic messages only */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_ADDR</span>		0x02	<span class="enscript-comment">/* addresses given with messages */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_CONNREQUIRED</span>	0x04	<span class="enscript-comment">/* connection required by protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_WANTRCVD</span>	0x08	<span class="enscript-comment">/* want PRU_RCVD calls */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_RIGHTS</span>	0x10	<span class="enscript-comment">/* passes capabilities */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_IMPLOPCL</span>	0x20	<span class="enscript-comment">/* implied open/close */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_LASTHDR</span>	0x40	<span class="enscript-comment">/* enforce ipsec policy; last header */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_PROTOLOCK</span>	0x80	<span class="enscript-comment">/* protocol takes care of it's own locking */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_PCBLOCK</span>	0x100	<span class="enscript-comment">/* protocol supports per pcb locking */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_DISPOSE</span>	0x200	<span class="enscript-comment">/* protocol requires late lists disposal */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_INITIALIZED</span>	0x400	<span class="enscript-comment">/* protocol has been initialized */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_ATTACHED</span>	0x800	<span class="enscript-comment">/* protocol is attached to a domain */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_MULTICONN</span>	0x1000	<span class="enscript-comment">/* supports multiple connect calls */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_EVCONNINFO</span>	0x2000	<span class="enscript-comment">/* protocol generates conninfo event */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_PRECONN_WRITE</span>	0x4000	<span class="enscript-comment">/* protocol supports preconnect write */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_DATA_IDEMPOTENT</span>	0x8000  <span class="enscript-comment">/* protocol supports idempotent data at connectx-time */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PR_OLD</span>		0x10000000 <span class="enscript-comment">/* added via net_add_proto */</span>

<span class="enscript-comment">/* pseudo-public domain flags */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRF_USERFLAGS</span>							\
	(PR_ATOMIC|PR_ADDR|PR_CONNREQUIRED|PR_WANTRCVD|PR_RIGHTS|	\
	PR_IMPLOPCL|PR_LASTHDR|PR_PROTOLOCK|PR_PCBLOCK|PR_DISPOSE)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">BSD_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * The arguments to the ctlinput routine are
 *	(*protosw[].pr_ctlinput)(cmd, sa, arg);
 * where cmd is one of the commands below, sa is a pointer to a sockaddr,
 * and arg is a `void *' argument used within a protocol family.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_IFDOWN</span>		0	<span class="enscript-comment">/* interface transition */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_ROUTEDEAD</span>		1	<span class="enscript-comment">/* select new route if possible ??? */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_IFUP</span>		2	<span class="enscript-comment">/* interface has come back up */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_QUENCH2</span>		3	<span class="enscript-comment">/* DEC congestion bit says slow down */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_QUENCH</span>		4	<span class="enscript-comment">/* some one said to slow down */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_MSGSIZE</span>		5	<span class="enscript-comment">/* message size forced drop */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_HOSTDEAD</span>		6	<span class="enscript-comment">/* host appears to be down */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_HOSTUNREACH</span>		7	<span class="enscript-comment">/* deprecated (use PRC_UNREACH_HOST) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_UNREACH_NET</span>		8	<span class="enscript-comment">/* no route to network */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_UNREACH_HOST</span>	9	<span class="enscript-comment">/* no route to host */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_UNREACH_PROTOCOL</span>	10	<span class="enscript-comment">/* dst says bad protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_UNREACH_PORT</span>	11	<span class="enscript-comment">/* bad port # */</span>
<span class="enscript-comment">/* was	PRC_UNREACH_NEEDFRAG	12	   (use PRC_MSGSIZE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_UNREACH_SRCFAIL</span>	13	<span class="enscript-comment">/* source route failed */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_REDIRECT_NET</span>	14	<span class="enscript-comment">/* net routing redirect */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_REDIRECT_HOST</span>	15	<span class="enscript-comment">/* host routing redirect */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_REDIRECT_TOSNET</span>	16	<span class="enscript-comment">/* redirect for type of service &amp; net */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_REDIRECT_TOSHOST</span>	17	<span class="enscript-comment">/* redirect for tos &amp; host */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_TIMXCEED_INTRANS</span>	18	<span class="enscript-comment">/* packet lifetime expired in transit */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_TIMXCEED_REASS</span>	19	<span class="enscript-comment">/* lifetime expired on reass q */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_PARAMPROB</span>		20	<span class="enscript-comment">/* header incorrect */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_UNREACH_ADMIN_PROHIB</span> 21	<span class="enscript-comment">/* packet administrativly prohibited */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRC_NCMDS</span>		22

#<span class="enscript-reference">define</span>	<span class="enscript-function-name">PRC_IS_REDIRECT</span>(cmd)	\
	((cmd) &gt;= PRC_REDIRECT_NET &amp;&amp; (cmd) &lt;= PRC_REDIRECT_TOSHOST)

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRCREQUESTS</span>
<span class="enscript-type">char</span>	*prcrequests[] = {
	<span class="enscript-string">&quot;IFDOWN&quot;</span>, <span class="enscript-string">&quot;ROUTEDEAD&quot;</span>, <span class="enscript-string">&quot;IFUP&quot;</span>, <span class="enscript-string">&quot;DEC-BIT-QUENCH2&quot;</span>,
	<span class="enscript-string">&quot;QUENCH&quot;</span>, <span class="enscript-string">&quot;MSGSIZE&quot;</span>, <span class="enscript-string">&quot;HOSTDEAD&quot;</span>, <span class="enscript-string">&quot;#7&quot;</span>,
	<span class="enscript-string">&quot;NET-UNREACH&quot;</span>, <span class="enscript-string">&quot;HOST-UNREACH&quot;</span>, <span class="enscript-string">&quot;PROTO-UNREACH&quot;</span>, <span class="enscript-string">&quot;PORT-UNREACH&quot;</span>,
	<span class="enscript-string">&quot;#12&quot;</span>, <span class="enscript-string">&quot;SRCFAIL-UNREACH&quot;</span>, <span class="enscript-string">&quot;NET-REDIRECT&quot;</span>, <span class="enscript-string">&quot;HOST-REDIRECT&quot;</span>,
	<span class="enscript-string">&quot;TOSNET-REDIRECT&quot;</span>, <span class="enscript-string">&quot;TOSHOST-REDIRECT&quot;</span>, <span class="enscript-string">&quot;TX-INTRANS&quot;</span>, <span class="enscript-string">&quot;TX-REASS&quot;</span>,
	<span class="enscript-string">&quot;PARAMPROB&quot;</span>, <span class="enscript-string">&quot;ADMIN-UNREACH&quot;</span>
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRCREQUESTS */</span>

<span class="enscript-comment">/*
 * The arguments to ctloutput are:
 *	(*protosw[].pr_ctloutput)(req, so, level, optname, optval, p);
 * req is one of the actions listed below, so is a (struct socket *),
 * level is an indication of which protocol layer the option is intended.
 * optname is a protocol dependent socket option request,
 * optval is a pointer to a mbuf-chain pointer, for value-return results.
 * The protocol is responsible for disposal of the mbuf chain *optval
 * if supplied,
 * the caller is responsible for any space held by *optval, when returned.
 * A non-zero return from usrreq gives an
 * UNIX error number which should be passed to higher level software.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRCO_GETOPT</span>	0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRCO_SETOPT</span>	1

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRCO_NCMDS</span>	2

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRCOREQUESTS</span>
<span class="enscript-type">char</span>	*prcorequests[] = {
	<span class="enscript-string">&quot;GETOPT&quot;</span>, <span class="enscript-string">&quot;SETOPT&quot;</span>,
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRCOREQUESTS */</span>

<span class="enscript-comment">/*
 * In earlier BSD network stacks, a single pr_usrreq() function pointer was
 * invoked with an operation number indicating what operation was desired.
 * We now provide individual function pointers which protocols can implement,
 * which offers a number of benefits (such as type checking for arguments).
 * These older constants are still present in order to support TCP debugging.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_ATTACH</span>		0	<span class="enscript-comment">/* attach protocol to up */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_DETACH</span>		1	<span class="enscript-comment">/* detach protocol from up */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_BIND</span>		2	<span class="enscript-comment">/* bind socket to address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_LISTEN</span>		3	<span class="enscript-comment">/* listen for connection */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_CONNECT</span>		4	<span class="enscript-comment">/* establish connection to peer */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_ACCEPT</span>		5	<span class="enscript-comment">/* accept connection from peer */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_DISCONNECT</span>		6	<span class="enscript-comment">/* disconnect from peer */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_SHUTDOWN</span>		7	<span class="enscript-comment">/* won't send any more data */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_RCVD</span>		8	<span class="enscript-comment">/* have taken data; more room now */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_SEND</span>		9	<span class="enscript-comment">/* send this data */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_ABORT</span>		10	<span class="enscript-comment">/* abort (fast DISCONNECT, DETATCH) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_CONTROL</span>		11	<span class="enscript-comment">/* control operations on protocol */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_SENSE</span>		12	<span class="enscript-comment">/* return status into m */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_RCVOOB</span>		13	<span class="enscript-comment">/* retrieve out of band data */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_SENDOOB</span>		14	<span class="enscript-comment">/* send out of band data */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_SOCKADDR</span>		15	<span class="enscript-comment">/* fetch socket's address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_PEERADDR</span>		16	<span class="enscript-comment">/* fetch peer's address */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_CONNECT2</span>		17	<span class="enscript-comment">/* connect two sockets */</span>
<span class="enscript-comment">/* begin for protocols internal use */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_FASTTIMO</span>		18	<span class="enscript-comment">/* 200ms timeout */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_SLOWTIMO</span>		19	<span class="enscript-comment">/* 500ms timeout */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_PROTORCV</span>		20	<span class="enscript-comment">/* receive from below */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_PROTOSEND</span>		21	<span class="enscript-comment">/* send to below */</span>
<span class="enscript-comment">/* end for protocol's internal use */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_SEND_EOF</span>		22	<span class="enscript-comment">/* send and close */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRU_NREQ</span>		22

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRUREQUESTS</span>
<span class="enscript-type">char</span> *prurequests[] = {
	<span class="enscript-string">&quot;ATTACH&quot;</span>,	<span class="enscript-string">&quot;DETACH&quot;</span>,	<span class="enscript-string">&quot;BIND&quot;</span>,		<span class="enscript-string">&quot;LISTEN&quot;</span>,
	<span class="enscript-string">&quot;CONNECT&quot;</span>,	<span class="enscript-string">&quot;ACCEPT&quot;</span>,	<span class="enscript-string">&quot;DISCONNECT&quot;</span>,	<span class="enscript-string">&quot;SHUTDOWN&quot;</span>,
	<span class="enscript-string">&quot;RCVD&quot;</span>,		<span class="enscript-string">&quot;SEND&quot;</span>,		<span class="enscript-string">&quot;ABORT&quot;</span>,	<span class="enscript-string">&quot;CONTROL&quot;</span>,
	<span class="enscript-string">&quot;SENSE&quot;</span>,	<span class="enscript-string">&quot;RCVOOB&quot;</span>,	<span class="enscript-string">&quot;SENDOOB&quot;</span>,	<span class="enscript-string">&quot;SOCKADDR&quot;</span>,
	<span class="enscript-string">&quot;PEERADDR&quot;</span>,	<span class="enscript-string">&quot;CONNECT2&quot;</span>,	<span class="enscript-string">&quot;FASTTIMO&quot;</span>,	<span class="enscript-string">&quot;SLOWTIMO&quot;</span>,
	<span class="enscript-string">&quot;PROTORCV&quot;</span>,	<span class="enscript-string">&quot;PROTOSEND&quot;</span>,	<span class="enscript-string">&quot;SEND_EOF&quot;</span>,
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRUREQUESTS */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* BSD_KERNEL_PRIVATE */</span>

<span class="enscript-type">struct</span> ifnet;
<span class="enscript-type">struct</span> stat;
<span class="enscript-type">struct</span> ucred;
<span class="enscript-type">struct</span> uio;
<span class="enscript-type">struct</span> recv_msg_elem;

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * Legacy user-protocol hooks.
 *
 * NOTE: Do not modify this structure, as there are modules outside of xnu
 * which rely on the size and layout for binary compatibility.  This structure
 * is simply used by the protosw_old structure.  Internally, user-protocol
 * hooks use the private variant of pr_usrreqs defined down below.
 */</span>
<span class="enscript-type">struct</span> pr_usrreqs_old {
#<span class="enscript-reference">else</span>
<span class="enscript-type">struct</span> pr_usrreqs {
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !XNU_KERNEL_PRIVATE */</span>
	<span class="enscript-type">int</span>	(*pru_abort)(<span class="enscript-type">struct</span> socket *so);
	<span class="enscript-type">int</span>	(*pru_accept)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr **nam);
	<span class="enscript-type">int</span>	(*pru_attach)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> proto, <span class="enscript-type">struct</span> proc *p);
	<span class="enscript-type">int</span>	(*pru_bind)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr *nam,
		    <span class="enscript-type">struct</span> proc *p);
	<span class="enscript-type">int</span>	(*pru_connect)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr *nam,
		    <span class="enscript-type">struct</span> proc *p);
	<span class="enscript-type">int</span>	(*pru_connect2)(<span class="enscript-type">struct</span> socket *so1, <span class="enscript-type">struct</span> socket *so2);
	<span class="enscript-type">int</span>	(*pru_control)(<span class="enscript-type">struct</span> socket *so, u_long cmd, caddr_t data,
		    <span class="enscript-type">struct</span> ifnet *ifp, <span class="enscript-type">struct</span> proc *p);
	<span class="enscript-type">int</span>	(*pru_detach)(<span class="enscript-type">struct</span> socket *so);
	<span class="enscript-type">int</span>	(*pru_disconnect)(<span class="enscript-type">struct</span> socket *so);
	<span class="enscript-type">int</span>	(*pru_listen)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> proc *p);
	<span class="enscript-type">int</span>	(*pru_peeraddr)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr **nam);
	<span class="enscript-type">int</span>	(*pru_rcvd)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> flags);
	<span class="enscript-type">int</span>	(*pru_rcvoob)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> mbuf *m, <span class="enscript-type">int</span> flags);
	<span class="enscript-type">int</span>	(*pru_send)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> flags, <span class="enscript-type">struct</span> mbuf *m,
		    <span class="enscript-type">struct</span> sockaddr *addr, <span class="enscript-type">struct</span> mbuf *control,
		    <span class="enscript-type">struct</span> proc *p);
	<span class="enscript-type">int</span>	(*pru_sense)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">void</span>  *sb, <span class="enscript-type">int</span> isstat64);
	<span class="enscript-type">int</span>	(*pru_shutdown)(<span class="enscript-type">struct</span> socket *so);
	<span class="enscript-type">int</span>	(*pru_sockaddr)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr **nam);
	<span class="enscript-type">int</span>	(*pru_sosend)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr *addr,
		    <span class="enscript-type">struct</span> uio *uio, <span class="enscript-type">struct</span> mbuf *top, <span class="enscript-type">struct</span> mbuf *control,
		    <span class="enscript-type">int</span> flags);
	<span class="enscript-type">int</span>	(*pru_soreceive)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr **paddr,
		    <span class="enscript-type">struct</span> uio *uio, <span class="enscript-type">struct</span> mbuf **mp0, <span class="enscript-type">struct</span> mbuf **controlp,
		    <span class="enscript-type">int</span> *flagsp);
	<span class="enscript-type">int</span>	(*pru_sopoll)(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> events,
		    <span class="enscript-type">struct</span> ucred *cred, <span class="enscript-type">void</span> *);
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-comment">/*
 * If the ordering here looks odd, that's because it's alphabetical.  These
 * should eventually be merged back into struct protosw.
 *
 * Internal, private and extendable representation of pr_usrreqs.
 *
 * NOTE: When adding new ones, also add default callbacks in pru_sanitize().
 */</span>
<span class="enscript-type">struct</span> pr_usrreqs {
	uint32_t pru_flags;	<span class="enscript-comment">/* see PRUF flags below */</span>
	<span class="enscript-type">int</span>	(*pru_abort)(<span class="enscript-type">struct</span> socket *);
	<span class="enscript-type">int</span>	(*pru_accept)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr **);
	<span class="enscript-type">int</span>	(*pru_attach)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span> proto, <span class="enscript-type">struct</span> proc *);
	<span class="enscript-type">int</span>	(*pru_bind)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">struct</span> proc *);
	<span class="enscript-type">int</span>	(*pru_connect)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr *,
		    <span class="enscript-type">struct</span> proc *);
	<span class="enscript-type">int</span>	(*pru_connect2)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> socket *);
	<span class="enscript-type">int</span>	(*pru_connectx)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr_list **,
		    <span class="enscript-type">struct</span> sockaddr_list **, <span class="enscript-type">struct</span> proc *, uint32_t,
		    sae_associd_t, sae_connid_t *, uint32_t, <span class="enscript-type">void</span> *, uint32_t,
		    <span class="enscript-type">struct</span> uio *, user_ssize_t *);
	<span class="enscript-type">int</span>	(*pru_control)(<span class="enscript-type">struct</span> socket *, u_long, caddr_t,
		    <span class="enscript-type">struct</span> ifnet *, <span class="enscript-type">struct</span> proc *);
	<span class="enscript-type">int</span>	(*pru_detach)(<span class="enscript-type">struct</span> socket *);
	<span class="enscript-type">int</span>	(*pru_disconnect)(<span class="enscript-type">struct</span> socket *);
	<span class="enscript-type">int</span>	(*pru_disconnectx)(<span class="enscript-type">struct</span> socket *,
		    sae_associd_t, sae_connid_t);
	<span class="enscript-type">int</span>	(*pru_listen)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> proc *);
	<span class="enscript-type">int</span>	(*pru_peeloff)(<span class="enscript-type">struct</span> socket *,
		    sae_associd_t, <span class="enscript-type">struct</span> socket **);
	<span class="enscript-type">int</span>	(*pru_peeraddr)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr **);
	<span class="enscript-type">int</span>	(*pru_rcvd)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>);
	<span class="enscript-type">int</span>	(*pru_rcvoob)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);
	<span class="enscript-type">int</span>	(*pru_send)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> mbuf *,
		    <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> proc *);
	<span class="enscript-type">int</span>	(*pru_send_list)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> mbuf *,
		    <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> proc *);
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRUS_OOB</span>	0x1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRUS_EOF</span>	0x2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRUS_MORETOCOME</span>	0x4
	<span class="enscript-type">int</span>	(*pru_sense)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">void</span> *, <span class="enscript-type">int</span>);
	<span class="enscript-type">int</span>	(*pru_shutdown)(<span class="enscript-type">struct</span> socket *);
	<span class="enscript-type">int</span>	(*pru_sockaddr)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr **);
	<span class="enscript-type">int</span>	(*pru_sopoll)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> ucred *, <span class="enscript-type">void</span> *);
	<span class="enscript-type">int</span>	(*pru_soreceive)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr **,
		    <span class="enscript-type">struct</span> uio *, <span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">struct</span> mbuf **, <span class="enscript-type">int</span> *);
	<span class="enscript-type">int</span>	(*pru_soreceive_list)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> recv_msg_elem *, u_int,
		    <span class="enscript-type">int</span> *);
	<span class="enscript-type">int</span>	(*pru_sosend)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr *,
		    <span class="enscript-type">struct</span> uio *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">struct</span> mbuf *, <span class="enscript-type">int</span>);
	<span class="enscript-type">int</span>	(*pru_sosend_list)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> uio **, u_int, <span class="enscript-type">int</span>);
	<span class="enscript-type">int</span>	(*pru_socheckopt)(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
	<span class="enscript-type">int</span>	(*pru_preconnect)(<span class="enscript-type">struct</span> socket *so);
};

<span class="enscript-comment">/* Values for pru_flags  */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">PRUF_OLD</span>	0x10000000	<span class="enscript-comment">/* added via net_add_proto */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>

__BEGIN_DECLS
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_abort_notsupp</span>(<span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_accept_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr **nam);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_attach_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> proto, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_bind_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr *nam,
    <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_connect_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr *nam,
    <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_connect2_notsupp</span>(<span class="enscript-type">struct</span> socket *so1, <span class="enscript-type">struct</span> socket *so2);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_connectx_notsupp</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockaddr_list **,
    <span class="enscript-type">struct</span> sockaddr_list **, <span class="enscript-type">struct</span> proc *, uint32_t, sae_associd_t,
    sae_connid_t *, uint32_t, <span class="enscript-type">void</span> *, uint32_t, <span class="enscript-type">struct</span> uio *, user_ssize_t *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_disconnectx_notsupp</span>(<span class="enscript-type">struct</span> socket *, sae_associd_t,
    sae_connid_t);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_socheckopt_null</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> sockopt *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_peeloff_notsupp</span>(<span class="enscript-type">struct</span> socket *, sae_associd_t, <span class="enscript-type">struct</span> socket **);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_control_notsupp</span>(<span class="enscript-type">struct</span> socket *so, u_long cmd, caddr_t data,
    <span class="enscript-type">struct</span> ifnet *ifp, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_detach_notsupp</span>(<span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_disconnect_notsupp</span>(<span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_listen_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_peeraddr_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr **nam);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_rcvd_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> flags);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_rcvoob_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> mbuf *m, <span class="enscript-type">int</span> flags);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_send_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> flags, <span class="enscript-type">struct</span> mbuf *m,
    <span class="enscript-type">struct</span> sockaddr *addr, <span class="enscript-type">struct</span> mbuf *control, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_send_list_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> flags, <span class="enscript-type">struct</span> mbuf *m,
    <span class="enscript-type">struct</span> sockaddr *addr, <span class="enscript-type">struct</span> mbuf *control, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_sense_null</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">void</span> * sb, <span class="enscript-type">int</span> isstat64);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_shutdown_notsupp</span>(<span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_sockaddr_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr **nam);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_sosend_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> sockaddr *addr,
    <span class="enscript-type">struct</span> uio *uio,  <span class="enscript-type">struct</span> mbuf *top, <span class="enscript-type">struct</span> mbuf *control, <span class="enscript-type">int</span> flags);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_sosend_list_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> uio **uio,
    u_int, <span class="enscript-type">int</span> flags);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_soreceive_notsupp</span>(<span class="enscript-type">struct</span> socket *so,
    <span class="enscript-type">struct</span> sockaddr **paddr, <span class="enscript-type">struct</span> uio *uio, <span class="enscript-type">struct</span> mbuf **mp0,
    <span class="enscript-type">struct</span> mbuf **controlp, <span class="enscript-type">int</span> *flagsp);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_soreceive_list_notsupp</span>(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">struct</span> recv_msg_elem *, u_int,
    <span class="enscript-type">int</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">pru_sopoll_notsupp</span>(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">int</span> events,
    <span class="enscript-type">struct</span> ucred *cred, <span class="enscript-type">void</span> *);
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">pru_sanitize</span>(<span class="enscript-type">struct</span> pr_usrreqs *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">domaininit</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">domainfin</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">pfctlinput</span>(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">pfctlinput2</span>(<span class="enscript-type">int</span>, <span class="enscript-type">struct</span> sockaddr *, <span class="enscript-type">void</span> *);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> protosw *<span class="enscript-function-name">pffindproto_locked</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> protosw *<span class="enscript-function-name">pffindprotonotype</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> protosw *<span class="enscript-function-name">pffindtype</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> protosw_old *<span class="enscript-function-name">pffindproto_old</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">net_add_proto</span>(<span class="enscript-type">struct</span> protosw *, <span class="enscript-type">struct</span> domain *, <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">net_init_proto</span>(<span class="enscript-type">struct</span> protosw *, <span class="enscript-type">struct</span> domain *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">net_del_proto</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> domain *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">net_add_proto_old</span>(<span class="enscript-type">struct</span> protosw_old *, <span class="enscript-type">struct</span> domain_old *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">net_del_proto_old</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> domain_old *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">net_update_uptime</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">net_update_uptime_secs</span>(uint64_t secs);
<span class="enscript-type">extern</span> u_int64_t <span class="enscript-function-name">net_uptime</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">net_uptime2timeval</span>(<span class="enscript-type">struct</span> timeval *);
#<span class="enscript-reference">else</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">net_add_proto</span>(<span class="enscript-type">struct</span> protosw *, <span class="enscript-type">struct</span> domain *);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">net_del_proto</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">struct</span> domain *);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> protosw *<span class="enscript-function-name">pffindproto</span>(<span class="enscript-type">int</span> family, <span class="enscript-type">int</span> protocol, <span class="enscript-type">int</span> type);
__END_DECLS
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* !_SYS_PROTOSW_H_ */</span>
</pre>
<hr />
</body></html>