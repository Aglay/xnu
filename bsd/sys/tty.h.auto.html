<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>tty.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">tty.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/* Copyright (c) 1997 Apple Computer, Inc. All Rights Reserved */</span>
<span class="enscript-comment">/*-
 * Copyright (c) 1982, 1986, 1993
 *	The Regents of the University of California.  All rights reserved.
 * (c) UNIX System Laboratories, Inc.
 * All or some portions of this file are derived from material licensed
 * to the University of California by American Telephone and Telegraph
 * Co. or Unix System Laboratories, Inc. and are reproduced herein with
 * the permission of UNIX System Laboratories, Inc.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed by the University of
 *      California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)tty.h	8.6 (Berkeley) 1/21/94
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_SYS_TTY_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_SYS_TTY_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/cdefs.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/termios.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/select.h&gt;</span>		<span class="enscript-comment">/* For struct selinfo. */</span>


#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>

__BEGIN_DECLS
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;kern/locks.h&gt;</span>
__END_DECLS

<span class="enscript-comment">/*
 * NetBSD Clists are actually ring buffers. The c_cc, c_cf, c_cl fields have
 * exactly the same behaviour as in true clists.
 * if c_cq is NULL, the ring buffer has no TTY_QUOTE functionality
 * (but, saves memory and cpu time)
 * 
 * *DON'T* play with c_cs, c_ce, c_cq, or c_cl outside tty_subr.c!!!
 */</span>
<span class="enscript-type">struct</span> clist {
	<span class="enscript-type">int</span>	c_cc;		<span class="enscript-comment">/* count of characters in queue */</span>
	<span class="enscript-type">int</span>	c_cn;		<span class="enscript-comment">/* total ring buffer length */</span>
	u_char	*c_cf;		<span class="enscript-comment">/* points to first character */</span>
	u_char	*c_cl;		<span class="enscript-comment">/* points to next open character */</span>
	u_char	*c_cs;		<span class="enscript-comment">/* start of ring buffer */</span>
	u_char	*c_ce;		<span class="enscript-comment">/* c_ce + c_len */</span>
	u_char	*c_cq;		<span class="enscript-comment">/* N bits/bytes long, see tty_subr.c */</span>
};

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">TTYCLSIZE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TTYCLSIZE</span> 1024
#<span class="enscript-reference">endif</span>


<span class="enscript-comment">/*
 * Per-tty structure.
 *
 * Should be split in two, into device and tty drivers.
 * Glue could be masks of what to echo and circular buffer
 * (low, high, timeout).
 */</span>
<span class="enscript-type">struct</span> tty {
	lck_mtx_t	t_lock;		<span class="enscript-comment">/* Per tty lock */</span>

	<span class="enscript-type">struct</span>	clist t_rawq;		<span class="enscript-comment">/* Device raw input queue. */</span>
	<span class="enscript-type">long</span>	t_rawcc;		<span class="enscript-comment">/* Raw input queue statistics. */</span>
	<span class="enscript-type">struct</span>	clist t_canq;		<span class="enscript-comment">/* Device canonical queue. */</span>
	<span class="enscript-type">long</span>	t_cancc;		<span class="enscript-comment">/* Canonical queue statistics. */</span>
	<span class="enscript-type">struct</span>	clist t_outq;		<span class="enscript-comment">/* Device output queue. */</span>
	<span class="enscript-type">long</span>	t_outcc;		<span class="enscript-comment">/* Output queue statistics. */</span>
	<span class="enscript-type">int</span>	t_line;			<span class="enscript-comment">/* Interface to device drivers. */</span>
	dev_t	t_dev;			<span class="enscript-comment">/* Device. */</span>
	<span class="enscript-type">int</span>	t_state;		<span class="enscript-comment">/* Device and driver (TS*) state. */</span>
	<span class="enscript-type">int</span>	t_flags;		<span class="enscript-comment">/* Tty flags. */</span>
	<span class="enscript-type">int</span>     t_timeout;              <span class="enscript-comment">/* Timeout for ttywait() */</span>
	<span class="enscript-type">struct</span>	pgrp *t_pgrp;		<span class="enscript-comment">/* Foreground process group. */</span>
	<span class="enscript-type">struct</span>	session *t_session;	<span class="enscript-comment">/* Enclosing session. */</span>
	<span class="enscript-type">struct</span>	selinfo t_rsel;		<span class="enscript-comment">/* Tty read/oob select. */</span>
	<span class="enscript-type">struct</span>	selinfo t_wsel;		<span class="enscript-comment">/* Tty write select. */</span>
	<span class="enscript-type">struct</span>	termios t_termios;	<span class="enscript-comment">/* Termios state. */</span>
	<span class="enscript-type">struct</span>	winsize t_winsize;	<span class="enscript-comment">/* Window size. */</span>
					<span class="enscript-comment">/* Start output. */</span>
	<span class="enscript-type">void</span>	(*t_oproc)(<span class="enscript-type">struct</span> tty *);
					<span class="enscript-comment">/* Stop output. */</span>
	<span class="enscript-type">void</span>	(*t_stop)(<span class="enscript-type">struct</span> tty *, <span class="enscript-type">int</span>);
					<span class="enscript-comment">/* Set hardware state. */</span>
	<span class="enscript-type">int</span>	(*t_param)(<span class="enscript-type">struct</span> tty *, <span class="enscript-type">struct</span> termios *);
	<span class="enscript-type">void</span>	*t_sc;			<span class="enscript-comment">/* XXX: net/if_sl.c:sl_softc. */</span>
	<span class="enscript-type">int</span>	t_column;		<span class="enscript-comment">/* Tty output column. */</span>
	<span class="enscript-type">int</span>	t_rocount, t_rocol;	<span class="enscript-comment">/* Tty. */</span>
	<span class="enscript-type">int</span>	t_hiwat;		<span class="enscript-comment">/* High water mark. */</span>
	<span class="enscript-type">int</span>	t_lowat;		<span class="enscript-comment">/* Low water mark. */</span>
	<span class="enscript-type">int</span>	t_gen;			<span class="enscript-comment">/* Generation number. */</span>
	<span class="enscript-type">void</span>	*t_iokit;		<span class="enscript-comment">/* IOKit management */</span>
	<span class="enscript-type">int</span>	t_refcnt;		<span class="enscript-comment">/* reference count */</span>
};

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TTY_NULL</span> (struct tty *)0

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_cc</span>		t_termios.c_cc
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_cflag</span>		t_termios.c_cflag
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_iflag</span>		t_termios.c_iflag
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_ispeed</span>	t_termios.c_ispeed
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_lflag</span>		t_termios.c_lflag
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_min</span>		t_termios.c_min
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_oflag</span>		t_termios.c_oflag
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_ospeed</span>	t_termios.c_ospeed
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">t_time</span>		t_termios.c_time


#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTIPRI</span>	25			<span class="enscript-comment">/* Sleep priority for tty reads. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTOPRI</span>	26			<span class="enscript-comment">/* Sleep priority for tty writes. */</span>

<span class="enscript-comment">/*
 * User data unfortunately has to be copied through buffers on the way to
 * and from clists.  The buffers are on the stack so their sizes must be
 * fairly small.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">IBUFSIZ</span>	384			<span class="enscript-comment">/* Should be &gt;= max value of MIN. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">OBUFSIZ</span>	100

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">TTYHOG</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTYHOG</span>	1024
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTMAXHIWAT</span>	roundup(2048, CBSIZE)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTMINHIWAT</span>	roundup(100, CBSIZE)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTMAXLOWAT</span>	256
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTMINLOWAT</span>	32
#<span class="enscript-reference">else</span>
<span class="enscript-type">struct</span> tty;
<span class="enscript-type">struct</span> clist;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

<span class="enscript-comment">/* These flags are kept in t_state. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_SO_OLOWAT</span>	0x00001		<span class="enscript-comment">/* Wake up when output &lt;= low water. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_ASYNC</span>	0x00002		<span class="enscript-comment">/* Tty in async I/O mode. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_BUSY</span>		0x00004		<span class="enscript-comment">/* Draining output. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_CARR_ON</span>	0x00008		<span class="enscript-comment">/* Carrier is present. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_FLUSH</span>	0x00010		<span class="enscript-comment">/* Outq has been flushed during DMA. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_ISOPEN</span>	0x00020		<span class="enscript-comment">/* Open has completed. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_TBLOCK</span>	0x00040		<span class="enscript-comment">/* Further input blocked. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_TIMEOUT</span>	0x00080		<span class="enscript-comment">/* Wait for output char processing. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_TTSTOP</span>	0x00100		<span class="enscript-comment">/* Output paused. */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">notyet</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_WOPEN</span>	0x00200		<span class="enscript-comment">/* Open in progress. */</span>
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_XCLUDE</span>	0x00400		<span class="enscript-comment">/* Tty requires exclusivity. */</span>

<span class="enscript-comment">/* State for intra-line fancy editing work. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_BKSL</span>		0x00800		<span class="enscript-comment">/* State for lowercase \ work. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_CNTTB</span>	0x01000		<span class="enscript-comment">/* Counting tab width, ignore FLUSHO. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_ERASE</span>	0x02000		<span class="enscript-comment">/* Within a \.../ for PRTRUB. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_LNCH</span>		0x04000		<span class="enscript-comment">/* Next character is literal. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_TYPEN</span>	0x08000		<span class="enscript-comment">/* Retyping suspended input (PENDIN). */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_LOCAL</span>	(TS_BKSL | TS_CNTTB | TS_ERASE | TS_LNCH | TS_TYPEN)

<span class="enscript-comment">/* Extras. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_CAN_BYPASS_L_RINT</span> 0x010000	<span class="enscript-comment">/* Device in &quot;raw&quot; mode. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_CONNECTED</span>	0x020000	<span class="enscript-comment">/* Connection open. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_SNOOP</span>	0x040000	<span class="enscript-comment">/* Device is being snooped on. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_SO_OCOMPLETE</span>	0x080000	<span class="enscript-comment">/* Wake up when output completes. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_ZOMBIE</span>	0x100000	<span class="enscript-comment">/* Connection lost. */</span>

<span class="enscript-comment">/* Hardware flow-control-invoked bits. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_CAR_OFLOW</span>	0x200000	<span class="enscript-comment">/* For MDMBUF (XXX handle in driver). */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">notyet</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_CTS_OFLOW</span>	0x400000	<span class="enscript-comment">/* For CCTS_OFLOW. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_DSR_OFLOW</span>	0x800000	<span class="enscript-comment">/* For CDSR_OFLOW. */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_IOCTL_NOT_OK</span>	0x1000000	<span class="enscript-comment">/* Workaround &lt;rdar://....&gt; */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TS_PGRPHUP</span>	0x2000000       <span class="enscript-comment">/* Don't change Foregroud process group */</span>


<span class="enscript-comment">/* Character type information. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">ORDINARY</span>	0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">CONTROL</span>		1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">BACKSPACE</span>	2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">NEWLINE</span>		3
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TAB</span>		4
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VTAB</span>		5
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">RETURN</span>		6

<span class="enscript-type">struct</span> speedtab {
	<span class="enscript-type">int</span> sp_speed;			<span class="enscript-comment">/* Speed. */</span>
	<span class="enscript-type">int</span> sp_code;			<span class="enscript-comment">/* Code. */</span>
};

<span class="enscript-comment">/* Modem control commands (driver). */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DMSET</span>		0
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DMBIS</span>		1
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DMBIC</span>		2
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">DMGET</span>		3

<span class="enscript-comment">/* Flags on a character passed to ttyinput. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTY_CHARMASK</span>	0x000000ff	<span class="enscript-comment">/* Character mask */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTY_QUOTE</span>	0x00000100	<span class="enscript-comment">/* Character quoted */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTY_ERRORMASK</span>	0xff000000	<span class="enscript-comment">/* Error mask */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTY_FE</span>		0x01000000	<span class="enscript-comment">/* Framing error */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTY_PE</span>		0x02000000	<span class="enscript-comment">/* Parity error */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTY_OE</span>		0x04000000	<span class="enscript-comment">/* Overrun error */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TTY_BI</span>		0x08000000	<span class="enscript-comment">/* Break condition */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>

<span class="enscript-comment">/* Unique sleep addresses. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSA_CARR_ON</span>(tp)		((void *)&amp;(tp)-&gt;t_rawq)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSA_HUP_OR_INPUT</span>(tp)	((void *)&amp;(tp)-&gt;t_rawq.c_cf)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSA_OCOMPLETE</span>(tp)	((void *)&amp;(tp)-&gt;t_outq.c_cl)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSA_OLOWAT</span>(tp)		((void *)&amp;(tp)-&gt;t_outq)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSA_PTC_READ</span>(tp)	((void *)&amp;(tp)-&gt;t_outq.c_cf)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSA_PTC_WRITE</span>(tp)	((void *)&amp;(tp)-&gt;t_rawq.c_cl)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">TSA_PTS_READ</span>(tp)	((void *)&amp;(tp)-&gt;t_canq)


__BEGIN_DECLS

<span class="enscript-type">int</span>	 b_to_q(<span class="enscript-type">const</span> u_char *cp, <span class="enscript-type">int</span> cc, <span class="enscript-type">struct</span> clist *q);
<span class="enscript-type">void</span>	 catq(<span class="enscript-type">struct</span> clist *from, <span class="enscript-type">struct</span> clist *to);
<span class="enscript-type">void</span>	 clist_init(<span class="enscript-type">void</span>);
<span class="enscript-type">int</span>	 getc(<span class="enscript-type">struct</span> clist *q);
<span class="enscript-type">void</span>	 ndflush(<span class="enscript-type">struct</span> clist *q, <span class="enscript-type">int</span> cc);
<span class="enscript-type">int</span>	 ndqb(<span class="enscript-type">struct</span> clist *q, <span class="enscript-type">int</span> flag);
u_char	*firstc          (<span class="enscript-type">struct</span> clist *clp, <span class="enscript-type">int</span> *c);
u_char	*nextc(<span class="enscript-type">struct</span> clist *q, u_char *cp, <span class="enscript-type">int</span> *c);
<span class="enscript-type">int</span>	 putc(<span class="enscript-type">int</span> c, <span class="enscript-type">struct</span> clist *q);
<span class="enscript-type">int</span>	 q_to_b(<span class="enscript-type">struct</span> clist *q, u_char *cp, <span class="enscript-type">int</span> cc);
<span class="enscript-type">int</span>	 unputc(<span class="enscript-type">struct</span> clist *q);
<span class="enscript-type">int</span>	 clalloc(<span class="enscript-type">struct</span> clist *clp, <span class="enscript-type">int</span> size, <span class="enscript-type">int</span> quot);
<span class="enscript-type">void</span>	 clfree(<span class="enscript-type">struct</span> clist *clp);
<span class="enscript-type">void</span>	cinit(<span class="enscript-type">void</span>);
<span class="enscript-type">void</span>	clrbits(u_char *cp, <span class="enscript-type">int</span> off, <span class="enscript-type">int</span> len);

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL_PRIVATE</span>
<span class="enscript-type">void</span>	tty_init(<span class="enscript-type">void</span>);
<span class="enscript-comment">/*
 * The locked version of this function is used from routines which hold
 * the tty_lock(), such as ttcompat() in tty_compat.c
 */</span>
<span class="enscript-type">int</span>	ttioctl_locked(<span class="enscript-type">struct</span> tty *tp, u_long com, caddr_t data, <span class="enscript-type">int</span> flag,
	    <span class="enscript-type">struct</span> proc *p);

<span class="enscript-type">int</span>	ttcompat(<span class="enscript-type">struct</span> tty *tp, u_long com, caddr_t data, <span class="enscript-type">int</span> flag,
	    <span class="enscript-type">struct</span> proc *p);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL_PRIVATE */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">tty_lock</span>(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">void</span> <span class="enscript-function-name">tty_unlock</span>(<span class="enscript-type">struct</span> tty *tp);

<span class="enscript-type">void</span>	 termioschars(<span class="enscript-type">struct</span> termios *t);
<span class="enscript-type">int</span>	 tputchar(<span class="enscript-type">int</span> c, <span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">int</span>	 ttioctl(<span class="enscript-type">struct</span> tty *tp, u_long com, caddr_t data, <span class="enscript-type">int</span> flag,
	    <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">int</span>	 ttread(<span class="enscript-type">struct</span> tty *tp, <span class="enscript-type">struct</span> uio *uio, <span class="enscript-type">int</span> flag);
<span class="enscript-type">int</span>	 ttyselect(<span class="enscript-type">struct</span> tty *tp, <span class="enscript-type">int</span> rw, <span class="enscript-type">void</span> * wql, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">int</span>	 ttselect(dev_t dev, <span class="enscript-type">int</span> rw, <span class="enscript-type">void</span> * wql, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">void</span>	 ttsetwater(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">int</span>	 ttspeedtab(<span class="enscript-type">int</span> speed, <span class="enscript-type">struct</span> speedtab *table);
<span class="enscript-type">int</span>	 ttstart(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">void</span>	 ttwakeup(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">int</span>	 ttwrite(<span class="enscript-type">struct</span> tty *tp, <span class="enscript-type">struct</span> uio *uio, <span class="enscript-type">int</span> flag);
<span class="enscript-type">void</span>	 ttwwakeup(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">void</span>	 ttyblock(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">int</span>	 ttycheckoutq(<span class="enscript-type">struct</span> tty *tp, <span class="enscript-type">int</span> wait);
<span class="enscript-type">int</span>	 ttyclose(<span class="enscript-type">struct</span> tty *tp);	<span class="enscript-comment">/* LEGACY: avoid using */</span>
<span class="enscript-type">void</span>	 ttyflush(<span class="enscript-type">struct</span> tty *tp, <span class="enscript-type">int</span> rw);
<span class="enscript-type">void</span>	 ttyinfo(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">void</span>	 ttyinfo_locked(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">int</span>	 ttyinput(<span class="enscript-type">int</span> c, <span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">int</span>	 ttylclose(<span class="enscript-type">struct</span> tty *tp, <span class="enscript-type">int</span> flag);
<span class="enscript-type">int</span>	 ttymodem(<span class="enscript-type">struct</span> tty *tp, <span class="enscript-type">int</span> flag);
<span class="enscript-type">int</span>	 ttyopen(dev_t device, <span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">int</span>	 ttysleep(<span class="enscript-type">struct</span> tty *tp,
	    <span class="enscript-type">void</span> *chan, <span class="enscript-type">int</span> pri, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *wmesg, <span class="enscript-type">int</span> timeout);
<span class="enscript-type">int</span>	 ttywait(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">struct</span> tty *<span class="enscript-function-name">ttymalloc</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">void</span>     <span class="enscript-function-name">ttyfree</span>(<span class="enscript-type">struct</span> tty *);
<span class="enscript-type">void</span>     <span class="enscript-function-name">ttysetpgrphup</span>(<span class="enscript-type">struct</span> tty *tp);
<span class="enscript-type">void</span>     <span class="enscript-function-name">ttyclrpgrphup</span>(<span class="enscript-type">struct</span> tty *tp);

__END_DECLS

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>


#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_SYS_TTY_H_ */</span>
</pre>
<hr />
</body></html>