<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>fcntl.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">fcntl.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2013 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/* Copyright (c) 1995 NeXT Computer, Inc. All Rights Reserved */</span>
<span class="enscript-comment">/*-
 * Copyright (c) 1983, 1990, 1993
 *	The Regents of the University of California.  All rights reserved.
 * (c) UNIX System Laboratories, Inc.
 * All or some portions of this file are derived from material licensed
 * to the University of California by American Telephone and Telegraph
 * Co. or Unix System Laboratories, Inc. and are reproduced herein with
 * the permission of UNIX System Laboratories, Inc.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *	This product includes software developed by the University of
 *	California, Berkeley and its contributors.
 * 4. Neither the name of the University nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 *	@(#)fcntl.h	8.3 (Berkeley) 1/21/94
 */</span>


#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_SYS_FCNTL_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_SYS_FCNTL_H_</span>

<span class="enscript-comment">/*
 * This file includes the definitions for open and fcntl
 * described by POSIX for &lt;fcntl.h&gt;; it also includes
 * related kernel definitions.
 */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/cdefs.h&gt;</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;Availability.h&gt;</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* We should not be exporting size_t here.  Temporary for gcc bootstrapping. */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_size_t.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_mode_t.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_off_t.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_pid_t.h&gt;</span>

<span class="enscript-comment">/*
 * File status flags: these are used by open(2), fcntl(2).
 * They are also used (indirectly) in the kernel file structure f_flags,
 * which is a superset of the open/fcntl flags.  Open flags and f_flags
 * are inter-convertible using OFLAGS(fflags) and FFLAGS(oflags).
 * Open/fcntl flags begin with O_; kernel-internal flags begin with F.
 */</span>
<span class="enscript-comment">/* open-only flags */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_RDONLY</span>	0x0000		<span class="enscript-comment">/* open for reading only */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_WRONLY</span>	0x0001		<span class="enscript-comment">/* open for writing only */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_RDWR</span>		0x0002		<span class="enscript-comment">/* open for reading and writing */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_ACCMODE</span>	0x0003		<span class="enscript-comment">/* mask for above modes */</span>

<span class="enscript-comment">/*
 * Kernel encoding of open mode; separate read and write bits that are
 * independently testable: 1 greater than the above.
 *
 * XXX
 * FREAD and FWRITE are excluded from the #ifdef KERNEL so that TIOCFLUSH,
 * which was documented to use FREAD/FWRITE, continues to work.
 */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FREAD</span>		0x0001
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FWRITE</span>		0x0002
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_NONBLOCK</span>	0x0004		<span class="enscript-comment">/* no delay */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_APPEND</span>	0x0008		<span class="enscript-comment">/* set append mode */</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_o_sync.h&gt;</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_SHLOCK</span>	0x0010		<span class="enscript-comment">/* open with shared file lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_EXLOCK</span>	0x0020		<span class="enscript-comment">/* open with exclusive file lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_ASYNC</span>		0x0040		<span class="enscript-comment">/* signal pgrp when data ready */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_FSYNC</span>		O_SYNC		<span class="enscript-comment">/* source compatibility: do not use */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">O_NOFOLLOW</span>  0x0100      <span class="enscript-comment">/* don't follow symlinks */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_CREAT</span>		0x0200		<span class="enscript-comment">/* create if nonexistant */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_TRUNC</span>		0x0400		<span class="enscript-comment">/* truncate to zero length */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_EXCL</span>		0x0800		<span class="enscript-comment">/* error if already exists */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FMARK</span>		0x1000		<span class="enscript-comment">/* mark during gc() */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FDEFER</span>		0x2000		<span class="enscript-comment">/* defer for next gc pass */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FHASLOCK</span>	0x4000		<span class="enscript-comment">/* descriptor holds advisory lock */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__DARWIN_C_LEVEL</span> &gt;= 200809L 
<span class="enscript-comment">/*
 * Descriptor value for the current working directory
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AT_FDCWD</span>	-2

<span class="enscript-comment">/*
 * Flags for the at functions
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AT_EACCESS</span>		0x0010	<span class="enscript-comment">/* Use effective ids in access check */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AT_SYMLINK_NOFOLLOW</span>	0x0020	<span class="enscript-comment">/* Act on the symlink itself not the target */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AT_SYMLINK_FOLLOW</span>	0x0040	<span class="enscript-comment">/* Act on target of symlink */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">AT_REMOVEDIR</span>		0x0080	<span class="enscript-comment">/* Path refers to directory */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_EVTONLY</span>	0x8000		<span class="enscript-comment">/* descriptor requested for event notifications only */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FWASWRITTEN</span>	0x10000		<span class="enscript-comment">/* descriptor was written */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_NOCTTY</span>	0x20000		<span class="enscript-comment">/* don't assign controlling terminal */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FNOCACHE</span>	0x40000		<span class="enscript-comment">/* fcntl(F_NOCACHE, 1) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FNORDAHEAD</span>	0x80000		<span class="enscript-comment">/* fcntl(F_RDAHEAD, 0) */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">O_DIRECTORY</span>	0x100000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">O_SYMLINK</span>	0x200000	<span class="enscript-comment">/* allow open of a symlink */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_o_dsync.h&gt;</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FNODIRECT</span>	0x800000	<span class="enscript-comment">/* fcntl(F_NODIRECT, 1) */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__DARWIN_C_LEVEL</span> &gt;= 200809L
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_CLOEXEC</span>	0x1000000	<span class="enscript-comment">/* implicitly set FD_CLOEXEC */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FENCRYPTED</span>	0x2000000
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FSINGLE_WRITER</span>	0x4000000       <span class="enscript-comment">/* fcntl(F_SINGLE_WRITER, 1) */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">O_CLOFORK</span>	0x8000000	<span class="enscript-comment">/* implicitly set FD_CLOFORK */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FUNENCRYPTED</span>	0x10000000
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* Data Protection Flags */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">O_DP_GETRAWENCRYPTED</span>	0x0001
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">O_DP_GETRAWUNENCRYPTED</span>	0x0002
#<span class="enscript-reference">endif</span>


#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/* convert from open() flags to/from fflags; convert O_RD/WR to FREAD/FWRITE */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">FFLAGS</span>(oflags)	((oflags) + 1)
#<span class="enscript-reference">define</span>	<span class="enscript-function-name">OFLAGS</span>(fflags)	((fflags) - 1)

<span class="enscript-comment">/* bits to save after open */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FMASK</span>		(FREAD|FWRITE|FAPPEND|FASYNC|FFSYNC|FFDSYNC|FNONBLOCK)
<span class="enscript-comment">/* bits settable by fcntl(F_SETFL, ...) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FCNTLFLAGS</span>	(FAPPEND|FASYNC|FFSYNC|FFDSYNC|FNONBLOCK)
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * The O_* flags used to have only F* names, which were used in the kernel
 * and by fcntl.  We retain the F* names for the kernel f_flags field
 * and for backward compatibility for fcntl.
 */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FAPPEND</span>		O_APPEND	<span class="enscript-comment">/* kernel/compat */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FASYNC</span>		O_ASYNC		<span class="enscript-comment">/* kernel/compat */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FFSYNC</span>		O_FSYNC		<span class="enscript-comment">/* kernel */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FFDSYNC</span>		O_DSYNC		<span class="enscript-comment">/* kernel */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FNONBLOCK</span>	O_NONBLOCK	<span class="enscript-comment">/* kernel */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FNDELAY</span>		O_NONBLOCK	<span class="enscript-comment">/* compat */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_NDELAY</span>	O_NONBLOCK	<span class="enscript-comment">/* compat */</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Flags used for copyfile(2)
 */</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CPF_OVERWRITE</span>    0x0001
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CPF_IGNORE_MODE</span>  0x0002
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CPF_MASK</span> (CPF_OVERWRITE|CPF_IGNORE_MODE)
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Constants used for fcntl(2)
 */</span>

<span class="enscript-comment">/* command values */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_DUPFD</span>		0		<span class="enscript-comment">/* duplicate file descriptor */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_GETFD</span>		1		<span class="enscript-comment">/* get file descriptor flags */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_SETFD</span>		2		<span class="enscript-comment">/* set file descriptor flags */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_GETFL</span>		3		<span class="enscript-comment">/* get file status flags */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_SETFL</span>		4		<span class="enscript-comment">/* set file status flags */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_GETOWN</span>	5		<span class="enscript-comment">/* get SIGIO/SIGURG proc/pgrp */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETOWN</span>	6		<span class="enscript-comment">/* set SIGIO/SIGURG proc/pgrp */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_GETLK</span>		7		<span class="enscript-comment">/* get record locking information */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_SETLK</span>		8		<span class="enscript-comment">/* set record locking information */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_SETLKW</span>	9		<span class="enscript-comment">/* F_SETLK; wait if blocked */</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__DARWIN_C_LEVEL</span> &gt;= <span class="enscript-variable-name">__DARWIN_C_FULL</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETLKWTIMEOUT</span> 10		<span class="enscript-comment">/* F_SETLK; wait if blocked, return on timeout */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __DARWIN_C_LEVEL &gt;= __DARWIN_C_FULL */</span>
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_FLUSH_DATA</span>    40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_CHKCLEAN</span>      41              <span class="enscript-comment">/* Used for regression test */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_PREALLOCATE</span>   42		<span class="enscript-comment">/* Preallocate storage */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETSIZE</span>       43		<span class="enscript-comment">/* Truncate a file without zeroing space */</span>	
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_RDADVISE</span>      44              <span class="enscript-comment">/* Issue an advisory read async with no copy to user */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_RDAHEAD</span>       45              <span class="enscript-comment">/* turn read ahead off/on for this fd */</span>
<span class="enscript-comment">/*
 * 46,47 used to be F_READBOOTSTRAP and F_WRITEBOOTSTRAP 
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_NOCACHE</span>       48              <span class="enscript-comment">/* turn data caching off/on for this fd */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_LOG2PHYS</span>	49		<span class="enscript-comment">/* file offset to device offset */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETPATH</span>       50              <span class="enscript-comment">/* return the full path of the fd */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_FULLFSYNC</span>     51		<span class="enscript-comment">/* fsync + ask the drive to flush to the media */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_PATHPKG_CHECK</span> 52              <span class="enscript-comment">/* find which component (if any) is a package */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_FREEZE_FS</span>     53              <span class="enscript-comment">/* &quot;freeze&quot; all fs operations */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_THAW_FS</span>       54              <span class="enscript-comment">/* &quot;thaw&quot; all fs operations */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_GLOBAL_NOCACHE</span> 55		<span class="enscript-comment">/* turn data caching off/on (globally) for this file */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_OPENFROM</span>	56		<span class="enscript-comment">/* SPI: open a file relative to fd (must be a dir) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_UNLINKFROM</span>	57		<span class="enscript-comment">/* SPI: open a file relative to fd (must be a dir) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_CHECK_OPENEVT</span> 58		<span class="enscript-comment">/* SPI: if a process is marked OPENEVT, or in O_EVTONLY on opens of this vnode */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_ADDSIGS</span>	59		<span class="enscript-comment">/* add detached signatures */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/* Deprecated/Removed in 10.9 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_MARKDEPENDENCY</span> 60             <span class="enscript-comment">/* this process hosts the device supporting the fs backing this fd */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_ADDFILESIGS</span>	61		<span class="enscript-comment">/* add signature from same file (used by dyld for shared libs) */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_NODIRECT</span>	62		<span class="enscript-comment">/* used in conjunction with F_NOCACHE to indicate that DIRECT, synchonous writes */</span>
                                        <span class="enscript-comment">/* should not be used (i.e. its ok to temporaily create cached pages) */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETPROTECTIONCLASS</span>	63		<span class="enscript-comment">/* Get the protection class of a file from the EA, returns int */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETPROTECTIONCLASS</span>	64		<span class="enscript-comment">/* Set the protection class of a file for the EA, requires int */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_LOG2PHYS_EXT</span>  65		<span class="enscript-comment">/* file offset to device offset, extended */</span>

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_GETLKPID</span>		66		<span class="enscript-comment">/* get record locking information, per-process */</span>

<span class="enscript-comment">/* See F_DUPFD_CLOEXEC below for 67 */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETSTATICCONTENT</span> 		68		<span class="enscript-comment">/* 
										 * indicate to the filesystem/storage driver that the content to be 
										 * written is usually static.  a nonzero value enables it, 0 disables it.
										 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_MOVEDATAEXTENTS</span>	69		<span class="enscript-comment">/* Swap only the data associated with two files */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETBACKINGSTORE</span>	70	<span class="enscript-comment">/* Mark the file as being the backing store for another filesystem */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETPATH_MTMINFO</span>	71 	<span class="enscript-comment">/* return the full path of the FD, but error in specific mtmd circumstances */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETCODEDIR</span>		72	<span class="enscript-comment">/* Returns the code directory, with associated hashes, to the caller */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETNOSIGPIPE</span>		73	<span class="enscript-comment">/* No SIGPIPE generated on EPIPE */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETNOSIGPIPE</span>		74	<span class="enscript-comment">/* Status of SIGPIPE for this fd */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_TRANSCODEKEY</span>		75 	<span class="enscript-comment">/* For some cases, we need to rewrap the key for AKS/MKB */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SINGLE_WRITER</span>		76	<span class="enscript-comment">/* file being written to a by single writer... if throttling enabled, writes */</span>
                                        <span class="enscript-comment">/* may be broken into smaller chunks with throttling in between */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETPROTECTIONLEVEL</span>	77	<span class="enscript-comment">/* Get the protection version number for this filesystem */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_FINDSIGS</span>		78	<span class="enscript-comment">/* Add detached code signatures (used by dyld for shared libs) */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETDEFAULTPROTLEVEL</span>	79 <span class="enscript-comment">/* Get the default protection level for the filesystem */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_MAKECOMPRESSED</span>		80 <span class="enscript-comment">/* Make the file compressed; truncate &amp; toggle BSD bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SET_GREEDY_MODE</span>		81	<span class="enscript-comment">/* 
					* indicate to the filesystem/storage driver that the content to be
					* written should be written in greedy mode for additional speed at
					* the cost of storage efficiency. A nonzero value enables it, 0 disables it.
					*/</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETIOTYPE</span>		82  <span class="enscript-comment">/* 
							 * Use parameters to describe content being written to the FD. See
							 * flag definitions below for argument bits.
							 */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_ADDFILESIGS_FOR_DYLD_SIM</span> 83	<span class="enscript-comment">/* Add signature from same file, only if it is signed by Apple (used by dyld for simulator) */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_RECYCLE</span>			84	<span class="enscript-comment">/* Recycle vnode; debug/development builds only */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_BARRIERFSYNC</span>		85	<span class="enscript-comment">/* fsync + issue barrier to drive */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_OFD_SETLK</span>		90	<span class="enscript-comment">/* Acquire or release open file description lock */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_OFD_SETLKW</span>		91	<span class="enscript-comment">/* (as F_OFD_SETLK but blocking if conflicting lock) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_OFD_GETLK</span>		92	<span class="enscript-comment">/* Examine OFD lock */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_OFD_SETLKWTIMEOUT</span>	93	<span class="enscript-comment">/* (as F_OFD_SETLKW but return if timeout) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_OFD_GETLKPID</span>		94	<span class="enscript-comment">/* get record locking information */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_SETCONFINED</span>		95	<span class="enscript-comment">/* &quot;confine&quot; OFD to process */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_GETCONFINED</span>		96	<span class="enscript-comment">/* is-fd-confined? */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_ADDFILESIGS_RETURN</span>	97	<span class="enscript-comment">/* Add signature from same file, return end offset in structure on sucess */</span>


<span class="enscript-comment">// FS-specific fcntl()'s numbers begin at 0x00010000 and go up
</span>#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FCNTL_FS_SPECIFIC_BASE</span>  0x00010000

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__DARWIN_C_LEVEL</span> &gt;= 200809L
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_DUPFD_CLOEXEC</span>		67	<span class="enscript-comment">/* mark the dup with FD_CLOEXEC */</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* file descriptor flags (F_GETFD, F_SETFD) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FD_CLOEXEC</span>	1		<span class="enscript-comment">/* close-on-exec flag */</span>
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">FD_CLOFORK</span>	2		<span class="enscript-comment">/* close-on-fork flag */</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/* record locking flags (F_GETLK, F_SETLK, F_SETLKW) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_RDLCK</span>		1		<span class="enscript-comment">/* shared or read lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_UNLCK</span>		2		<span class="enscript-comment">/* unlock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_WRLCK</span>		3		<span class="enscript-comment">/* exclusive or write lock */</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_WAIT</span>		0x010		<span class="enscript-comment">/* Wait until lock is granted */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_FLOCK</span>		0x020	 	<span class="enscript-comment">/* Use flock(2) semantics for lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_POSIX</span>		0x040	 	<span class="enscript-comment">/* Use POSIX semantics for lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_PROV</span>		0x080		<span class="enscript-comment">/* Non-coalesced provisional lock */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_WAKE1_SAFE</span>    0x100           <span class="enscript-comment">/* its safe to only wake one waiter */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_ABORT</span>		0x200		<span class="enscript-comment">/* lock attempt aborted (force umount) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">F_OFD_LOCK</span>	0x400		<span class="enscript-comment">/* Use &quot;OFD&quot; semantics for lock */</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/* 
 * ISOCHRONOUS attempts to sustain a minimum platform-dependent throughput 
 * for the duration of the I/O delivered to the driver.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_IOTYPE_ISOCHRONOUS</span> 0x0001 
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * [XSI] The values used for l_whence shall be defined as described
 * in &lt;unistd.h&gt;
 */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_seek_set.h&gt;</span>

<span class="enscript-comment">/*
 * [XSI] The symbolic names for file modes for use as values of mode_t
 * shall be defined as described in &lt;sys/stat.h&gt;
 */</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_s_ifmt.h&gt;</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
<span class="enscript-comment">/* allocate flags (F_PREALLOCATE) */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_ALLOCATECONTIG</span>  0x00000002    <span class="enscript-comment">/* allocate contigious space */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_ALLOCATEALL</span>     0x00000004	<span class="enscript-comment">/* allocate all requested space or no space at all */</span>

<span class="enscript-comment">/* Position Modes (fst_posmode) for F_PREALLOCATE */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_PEOFPOSMODE</span> 3			<span class="enscript-comment">/* Make it past all of the SEEK pos modes so that */</span>
					<span class="enscript-comment">/* we can keep them in sync should we desire */</span>	
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">F_VOLPOSMODE</span>	4		<span class="enscript-comment">/* specify volume starting postion */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

<span class="enscript-comment">/*
 * Advisory file segment locking data type -
 * information passed to system by user
 */</span>
<span class="enscript-type">struct</span> flock {
	off_t	l_start;	<span class="enscript-comment">/* starting offset */</span>
	off_t	l_len;		<span class="enscript-comment">/* len = 0 means until end of file */</span>
	pid_t	l_pid;		<span class="enscript-comment">/* lock owner */</span>
	<span class="enscript-type">short</span>	l_type;		<span class="enscript-comment">/* lock type: read/write, etc. */</span>
	<span class="enscript-type">short</span>	l_whence;	<span class="enscript-comment">/* type of l_start */</span>
};

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_timespec.h&gt;</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__DARWIN_C_LEVEL</span> &gt;= <span class="enscript-variable-name">__DARWIN_C_FULL</span>
<span class="enscript-comment">/*
 * Advisory file segment locking with time out -
 * Information passed to system by user for F_SETLKWTIMEOUT
 */</span>
<span class="enscript-type">struct</span> flocktimeout {
	<span class="enscript-type">struct</span> flock    fl;             <span class="enscript-comment">/* flock passed for file locking */</span>
	<span class="enscript-type">struct</span> timespec timeout;        <span class="enscript-comment">/* timespec struct for timeout */</span>
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __DARWIN_C_LEVEL &gt;= __DARWIN_C_FULL */</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)
<span class="enscript-comment">/*
 * advisory file read data type -
 * information passed by user to system
 */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>(4) <span class="enscript-comment">/* prevent structure padding in kernel */</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

<span class="enscript-type">struct</span> radvisory {
       off_t   ra_offset;
       <span class="enscript-type">int</span>     ra_count;
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>()
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

#<span class="enscript-reference">ifndef</span>	<span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/** Information the user passes in to get the codeblobs out of the kernel */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> fcodeblobs {
	<span class="enscript-type">void</span> 		*f_cd_hash;
	size_t		f_hash_size;
	<span class="enscript-type">void</span>		*f_cd_buffer;
	size_t		f_cd_size;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	*f_out_size;
	<span class="enscript-type">int</span>		f_arch;
	<span class="enscript-type">int</span>		__padding;
} fcodeblobs_t;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> user32_fcodeblobs {
	user32_addr_t	f_cd_hash;
	user32_size_t	f_hash_size;
	user32_addr_t	f_cd_buffer;
	user32_size_t	f_cd_size;
	user32_addr_t	f_out_size;
	<span class="enscript-type">int</span>		f_arch;
} user32_fcodeblobs_t;

<span class="enscript-comment">/* LP64 version of fcodeblobs */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> user64_fcodeblobs {
	user64_addr_t	f_cd_hash;
	user64_size_t	f_hash_size;
	user64_addr_t	f_cd_buffer;
	user64_size_t	f_cd_size;
	user64_addr_t	f_out_size;
	<span class="enscript-type">int</span>		f_arch;
	<span class="enscript-type">int</span>		__padding;
} user64_fcodeblobs_t;

<span class="enscript-comment">/* kernel version of fcodeblobs */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> user_fcodeblobs {
	user_addr_t	f_cd_hash;
	user_size_t	f_hash_size;
	user_addr_t	f_cd_buffer;
	user_size_t	f_cd_size;
	user_addr_t	f_out_size;
	<span class="enscript-type">int</span>		f_arch;
} user_fcodeblobs_t;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

<span class="enscript-comment">/*
 * detached code signatures data type -
 * information passed by user to system used by F_ADDSIGS and F_ADDFILESIGS.
 * F_ADDFILESIGS is a shortcut for files that contain their own signature and
 * doesn't require mapping of the file in order to load the signature.
 */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> fsignatures {
	off_t		fs_file_start;
	<span class="enscript-type">void</span>		*fs_blob_start;
	size_t		fs_blob_size;
} fsignatures_t;
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/* LP64 version of fsignatures.  all pointers 
 * grow when we're dealing with a 64-bit process.
 * WARNING - keep in sync with fsignatures
 */</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> user32_fsignatures {
	off_t		fs_file_start;
	user32_addr_t	fs_blob_start;
	user32_size_t	fs_blob_size;
} user32_fsignatures_t;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> user_fsignatures {
	off_t		fs_file_start;	<span class="enscript-comment">/* offset of Mach-O image in FAT file */</span>
	user_addr_t	fs_blob_start;	<span class="enscript-comment">/* F_ADDSIGS: mem address of signature*/</span>
					<span class="enscript-comment">/* F_ADDFILESIGS: offset of signature */</span>
					<span class="enscript-comment">/*                in Mach-O image     */</span>
	user_size_t	fs_blob_size;	<span class="enscript-comment">/* size of signature blob             */</span>
} user_fsignatures_t;
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

<span class="enscript-comment">/* lock operations for flock(2) */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">LOCK_SH</span>		0x01		<span class="enscript-comment">/* shared file lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">LOCK_EX</span>		0x02		<span class="enscript-comment">/* exclusive file lock */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">LOCK_NB</span>		0x04		<span class="enscript-comment">/* don't block when locking */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">LOCK_UN</span>		0x08		<span class="enscript-comment">/* unlock file */</span>

<span class="enscript-comment">/*  fstore_t type used by F_DEALLOCATE and F_PREALLOCATE commands */</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> fstore {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> fst_flags;	<span class="enscript-comment">/* IN: flags word */</span>
	<span class="enscript-type">int</span> 	fst_posmode;	<span class="enscript-comment">/* IN: indicates use of offset field */</span>
	off_t	fst_offset;	<span class="enscript-comment">/* IN: start of the region */</span>
	off_t	fst_length;	<span class="enscript-comment">/* IN: size of the region */</span>
	off_t   fst_bytesalloc;	<span class="enscript-comment">/* OUT: number of bytes allocated */</span>
} fstore_t;

<span class="enscript-comment">/* fbootstraptransfer_t used by F_READBOOTSTRAP and F_WRITEBOOTSTRAP commands */</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> fbootstraptransfer {
  off_t fbt_offset;             <span class="enscript-comment">/* IN: offset to start read/write */</span>
  size_t fbt_length;          <span class="enscript-comment">/* IN: number of bytes to transfer */</span>
  <span class="enscript-type">void</span> *fbt_buffer;             <span class="enscript-comment">/* IN: buffer to be read/written */</span>
} fbootstraptransfer_t;

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/* LP64 version of fbootstraptransfer.  all pointers 
 * grow when we're dealing with a 64-bit process.
 * WARNING - keep in sync with fbootstraptransfer
 */</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> user32_fbootstraptransfer {
  off_t fbt_offset;             <span class="enscript-comment">/* IN: offset to start read/write */</span>
  user32_size_t fbt_length;          <span class="enscript-comment">/* IN: number of bytes to transfer */</span>
  user32_addr_t fbt_buffer;             <span class="enscript-comment">/* IN: buffer to be read/written */</span>
} user32_fbootstraptransfer_t;

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> user_fbootstraptransfer {
  off_t fbt_offset;             <span class="enscript-comment">/* IN: offset to start read/write */</span>
  user_size_t fbt_length;		<span class="enscript-comment">/* IN: number of bytes to transfer */</span>
  user_addr_t fbt_buffer;		<span class="enscript-comment">/* IN: buffer to be read/written */</span>
} user_fbootstraptransfer_t;

#<span class="enscript-reference">endif</span> // <span class="enscript-variable-name">KERNEL</span>

<span class="enscript-comment">/*
 * For F_LOG2PHYS this information is passed back to user
 * Currently only devoffset is returned - that is the VOP_BMAP
 * result - the disk device address corresponding to the
 * current file offset (likely set with an lseek).
 *
 * The flags could hold an indication of whether the # of 
 * contiguous bytes reflects the true extent length on disk,
 * or is an advisory value that indicates there is at least that
 * many bytes contiguous.  For some filesystems it might be too
 * inefficient to provide anything beyond the advisory value.
 * Flags and contiguous bytes return values are not yet implemented.
 * For them the fcntl will nedd to switch from using BMAP to CMAP
 * and a per filesystem type flag will be needed to interpret the
 * contiguous bytes count result from CMAP.
 *
 * F_LOG2PHYS_EXT is a variant of F_LOG2PHYS that uses a passed in
 * file offset and length instead of the current file offset.
 * F_LOG2PHYS_EXT operates on the same structure as F_LOG2PHYS, but
 * treats it as an in/out.
 */</span>
#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>(4)

<span class="enscript-type">struct</span> log2phys {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	l2p_flags;	 <span class="enscript-comment">/* unused so far */</span>
	off_t		l2p_contigbytes; <span class="enscript-comment">/* F_LOG2PHYS:     unused so far */</span>
					 <span class="enscript-comment">/* F_LOG2PHYS_EXT: IN:  number of bytes to be queried */</span>
					 <span class="enscript-comment">/*                 OUT: number of contiguous bytes at this position */</span>
	off_t		l2p_devoffset;   <span class="enscript-comment">/* F_LOG2PHYS:     OUT: bytes into device */</span>
					 <span class="enscript-comment">/* F_LOG2PHYS_EXT: IN:  bytes into file */</span>
					 <span class="enscript-comment">/*                 OUT: bytes into device */</span>
};

#<span class="enscript-reference">pragma</span> <span class="enscript-variable-name">pack</span>()

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_POPUP</span>	   0x80000000   <span class="enscript-comment">/* force window to popup on open */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">O_ALERT</span>	   0x20000000	<span class="enscript-comment">/* small, clean popup window */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/*
 * SPI: Argument data for F_OPENFROM
 */</span>
<span class="enscript-type">struct</span> fopenfrom {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	o_flags;	<span class="enscript-comment">/* same as open(2) */</span>
	mode_t		o_mode;		<span class="enscript-comment">/* same as open(2) */</span>
	<span class="enscript-type">char</span> *		o_pathname;	<span class="enscript-comment">/* relative pathname */</span>
};

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">KERNEL</span>
<span class="enscript-comment">/*
 * LP64 version of fopenfrom.  Memory pointers 
 * grow when we're dealing with a 64-bit process.
 *
 * WARNING - keep in sync with fopenfrom (above)
 */</span>
<span class="enscript-type">struct</span> user32_fopenfrom {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	o_flags;
	mode_t		o_mode;
	user32_addr_t	o_pathname;
};

<span class="enscript-type">struct</span> user_fopenfrom {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	o_flags;
	mode_t		o_mode;
	user_addr_t	o_pathname;
};
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* KERNEL */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/_types/_filesec_t.h&gt;</span>

<span class="enscript-type">typedef</span> <span class="enscript-type">enum</span> {
	FILESEC_OWNER = 1,
	FILESEC_GROUP = 2,
	FILESEC_UUID = 3,
	FILESEC_MODE = 4,
	FILESEC_ACL = 5,
	FILESEC_GRPUUID = 6,

<span class="enscript-comment">/* XXX these are private to the implementation */</span>
	FILESEC_ACL_RAW = 100,
	FILESEC_ACL_ALLOCSIZE = 101
} filesec_property_t;

<span class="enscript-comment">/* XXX backwards compatibility */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FILESEC_GUID</span> FILESEC_UUID
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (_POSIX_C_SOURCE &amp;&amp; !_DARWIN_C_SOURCE) */</span>

__BEGIN_DECLS
<span class="enscript-type">int</span>	open(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *, <span class="enscript-type">int</span>, ...) __DARWIN_ALIAS_C(open);
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__DARWIN_C_LEVEL</span> &gt;= 200809L
<span class="enscript-type">int</span>	openat(<span class="enscript-type">int</span>, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *, <span class="enscript-type">int</span>, ...) __DARWIN_NOCANCEL(openat) __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_8_0);
#<span class="enscript-reference">endif</span>
<span class="enscript-type">int</span>	creat(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *, mode_t) __DARWIN_ALIAS_C(creat);
<span class="enscript-type">int</span>	fcntl(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>, ...) __DARWIN_ALIAS_C(fcntl);
#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_POSIX_C_SOURCE</span>) || <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">_DARWIN_C_SOURCE</span>)

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>
<span class="enscript-comment">/*
 * These definitions are retained temporarily for compatibility.
 * If you want to use fileports, please use
 *	#include &lt;sys/fileport.h&gt;
 * or
 *	#include &lt;System/sys/fileport.h&gt;
 */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_FILEPORT_T</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_FILEPORT_T</span>
<span class="enscript-type">typedef</span> __darwin_mach_port_t fileport_t;
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">FILEPORT_NULL</span> ((fileport_t)0)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _FILEPORT_T */</span>

<span class="enscript-type">int</span>     <span class="enscript-function-name">fileport_makeport</span>(<span class="enscript-type">int</span>, fileport_t*);
<span class="enscript-type">int</span>     <span class="enscript-function-name">fileport_makefd</span>(fileport_t);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>
<span class="enscript-type">int</span>	openx_np(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *, <span class="enscript-type">int</span>, filesec_t);
<span class="enscript-comment">/* 
 * data-protected non-portable open(2) :
 int open_dprotected_np(user_addr_t path, int flags, int class, int dpflags, int mode)
 */</span> 
<span class="enscript-type">int</span> <span class="enscript-function-name">open_dprotected_np</span> ( <span class="enscript-type">const</span> <span class="enscript-type">char</span> *, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, <span class="enscript-type">int</span>, ...);
<span class="enscript-type">int</span>	flock(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>);
filesec_t <span class="enscript-function-name">filesec_init</span>(<span class="enscript-type">void</span>);
filesec_t <span class="enscript-function-name">filesec_dup</span>(filesec_t);
<span class="enscript-type">void</span>	filesec_free(filesec_t);
<span class="enscript-type">int</span>	filesec_get_property(filesec_t, filesec_property_t, <span class="enscript-type">void</span> *);
<span class="enscript-type">int</span>	filesec_query_property(filesec_t, filesec_property_t, <span class="enscript-type">int</span> *);
<span class="enscript-type">int</span>	filesec_set_property(filesec_t, filesec_property_t, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *);
<span class="enscript-type">int</span>	filesec_unset_property(filesec_t, filesec_property_t) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_2);
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_FILESEC_UNSET_PROPERTY</span>	((void *)0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_FILESEC_REMOVE_ACL</span>	((void *)1)
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */</span>
__END_DECLS
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_SYS_FCNTL_H_ */</span>
</pre>
<hr />
</body></html>