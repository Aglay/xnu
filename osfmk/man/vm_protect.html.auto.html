<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>vm_protect.html</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">vm_protect.html&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-keyword">&lt;h2&gt;</span>vm_protect<span class="enscript-keyword">&lt;/h2&gt;</span>
<span class="enscript-keyword">&lt;hr&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>Function<span class="enscript-keyword">&lt;/strong&gt;</span> - Set access privilege attribute for a region of virtual memory.
<span class="enscript-keyword">&lt;h3&gt;</span>SYNOPSIS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;pre&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>kern_return_t   vm_protect<span class="enscript-keyword">&lt;/strong&gt;</span>
                 <span class="enscript-keyword">&lt;strong&gt;</span>(vm_task_t<span class="enscript-keyword">&lt;/strong&gt;</span>           <span class="enscript-keyword">&lt;var&gt;</span>target_task<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_address_t<span class="enscript-keyword">&lt;/strong&gt;</span>            <span class="enscript-keyword">&lt;var&gt;</span>address<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_size_t<span class="enscript-keyword">&lt;/strong&gt;</span>                  <span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>boolean_t<span class="enscript-keyword">&lt;/strong&gt;</span>           <span class="enscript-keyword">&lt;var&gt;</span>set_maximum<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_prot_t<span class="enscript-keyword">&lt;/strong&gt;</span>        <span class="enscript-keyword">&lt;var&gt;</span>new_protection<span class="enscript-keyword">&lt;/var&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>);<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;/pre&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>PARAMETERS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>target_task<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in task send right]
The port for the task whose address space contains 
the region.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>address<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The starting address for the region.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The number of bytes in the region.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>set_maximum<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
Maximum/current indicator.  If true, the new protection sets 
the maximum protection for the region.  If false, the new protection sets 
the current protection for the region.  If the maximum protection is set 
below the current protection, the current protection is also
     reset to the new 
maximum.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>new_protection<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The new protection for the region.  Valid values are obtained 
by or'ing together the following values:
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_READ<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Allows read access.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_WRITE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Allows write access.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_EXECUTE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Allows execute access.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>DESCRIPTION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
The <span class="enscript-keyword">&lt;strong&gt;</span>vm_protect<span class="enscript-keyword">&lt;/strong&gt;</span> function sets access privileges for
a region within the specified 
task's address space.
The <span class="enscript-keyword">&lt;var&gt;</span>new_protection<span class="enscript-keyword">&lt;/var&gt;</span> parameter specifies a combination
of read, write, and 
execute accesses that are allowed (rather than prohibited).
<span class="enscript-keyword">&lt;p&gt;</span>
The region starts at the beginning of the virtual page containing
<span class="enscript-keyword">&lt;var&gt;</span>address<span class="enscript-keyword">&lt;/var&gt;</span>; it ends 
at the end of the virtual page containing <span class="enscript-keyword">&lt;var&gt;</span>address<span class="enscript-keyword">&lt;/var&gt;</span> + 
<span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span> - 1.  Because of this 
rounding to virtual page boundaries, the amount of memory protected may be 
greater than <span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span>.  Use <span class="enscript-keyword">&lt;strong&gt;</span>host_page_size<span class="enscript-keyword">&lt;/strong&gt;</span> 
to find the current virtual page size.
<span class="enscript-keyword">&lt;p&gt;</span>
The enforcement of virtual memory protection is machine-dependent.
Nominally read access requires <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_READ<span class="enscript-keyword">&lt;/strong&gt;</span> permission,
write access requires 
<span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_WRITE<span class="enscript-keyword">&lt;/strong&gt;</span> permission, and execute access requires
<span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_EXECUTE<span class="enscript-keyword">&lt;/strong&gt;</span> permission.  However, some combinations
of access rights may not be 
supported.  In particular, the kernel interface allows write access to require 
<span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_READ<span class="enscript-keyword">&lt;/strong&gt;</span> and <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_WRITE<span class="enscript-keyword">&lt;/strong&gt;</span> permission and execute access to
require <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_READ<span class="enscript-keyword">&lt;/strong&gt;</span> permission.
<span class="enscript-keyword">&lt;h3&gt;</span>NOTES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
This interface is machine word length specific because of the virtual address
parameter.
<span class="enscript-keyword">&lt;h3&gt;</span>RETURN VALUES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>KERN_PROTECTION_FAILURE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
The new protection increased the current or maximum protection
beyond the existing maximum protection.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>KERN_INVALID_ADDRESS<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
The address is illegal or specifies a non-allocated region.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>RELATED INFORMATION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
Functions:
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;host_page_size.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>host_page_size<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;vm_inherit.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>vm_inherit<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;vm_region.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>vm_region<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>.
</pre>
<hr />
</body></html>