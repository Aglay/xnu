<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>vm_remap.html</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">vm_remap.html&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-keyword">&lt;h2&gt;</span>vm_remap<span class="enscript-keyword">&lt;/h2&gt;</span>
<span class="enscript-keyword">&lt;hr&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>Function<span class="enscript-keyword">&lt;/strong&gt;</span> - Map memory objects in one task's address space to that of another task's.
<span class="enscript-keyword">&lt;h3&gt;</span>SYNOPSIS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;pre&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>kern_return_t   vm_remap<span class="enscript-keyword">&lt;/strong&gt;</span>
                 <span class="enscript-keyword">&lt;strong&gt;</span>(mach_port_t<span class="enscript-keyword">&lt;/strong&gt;</span>	           <span class="enscript-keyword">&lt;var&gt;</span>target_task<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_address_t<span class="enscript-keyword">&lt;/strong&gt;</span>	        <span class="enscript-keyword">&lt;var&gt;</span>target_address<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_size_t<span class="enscript-keyword">&lt;/strong&gt;</span>	                  <span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_address_t<span class="enscript-keyword">&lt;/strong&gt;</span>	                  <span class="enscript-keyword">&lt;var&gt;</span>mask<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>boolean_t<span class="enscript-keyword">&lt;/strong&gt;</span>	              <span class="enscript-keyword">&lt;var&gt;</span>anywhere<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>mach_port_t<span class="enscript-keyword">&lt;/strong&gt;</span>	           <span class="enscript-keyword">&lt;var&gt;</span>source_task<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_address_t<span class="enscript-keyword">&lt;/strong&gt;</span>	        <span class="enscript-keyword">&lt;var&gt;</span>source_address<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>boolean_t<span class="enscript-keyword">&lt;/strong&gt;</span>	                  <span class="enscript-keyword">&lt;var&gt;</span>copy<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_prot_t<span class="enscript-keyword">&lt;/strong&gt;</span>	        <span class="enscript-keyword">&lt;var&gt;</span>cur_protection<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_prot_t<span class="enscript-keyword">&lt;/strong&gt;</span>	        <span class="enscript-keyword">&lt;var&gt;</span>max_protection<span class="enscript-keyword">&lt;/var&gt;</span>,
                  <span class="enscript-keyword">&lt;strong&gt;</span>vm_inherit_t<span class="enscript-keyword">&lt;/strong&gt;</span>            <span class="enscript-keyword">&lt;var&gt;</span>inheritance<span class="enscript-keyword">&lt;/var&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>);<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;/pre&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>PARAMETERS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>target_task<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in task send right]
The port for the task in whose address space the 
memory is to be mapped.
     <span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>target_address<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[pointer to in/out scalar]
The starting address for the mapped memory 
in the target task.  The mapped memory will start at the beginning of 
the page containing <span class="enscript-keyword">&lt;var&gt;</span>target_address<span class="enscript-keyword">&lt;/var&gt;</span>.  If there is not enough room
following the address, the kernel does not map the memory.  The kernel
returns the starting address actually used for the mapped memory.
     <span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The number of bytes to map.  The kernel rounds this number 
up to an integral number of virtual pages.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>mask<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
Alignment restrictions for starting address.  Bits turned on in 
the mask will not be turned on in the starting address.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>anywhere<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
Placement indicator.
     The valid values are:
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
  <span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>TRUE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
The kernel allocates the region in the next unused space that 
is sufficient within the address space.  The kernel returns the 
starting address actually used in <span class="enscript-keyword">&lt;var&gt;</span>address<span class="enscript-keyword">&lt;/var&gt;</span>.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>FALSE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
The kernel allocates the region starting at <span class="enscript-keyword">&lt;var&gt;</span>address<span class="enscript-keyword">&lt;/var&gt;</span> unless that 
space is already allocated.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>source_task<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in task send right]
The port for the task whose address space is to be 
mapped.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>source_address<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The starting address for the memory to be mapped from the 
source task.  The memory to be mapped will start at the beginning of 
the page containing <span class="enscript-keyword">&lt;var&gt;</span>source_address<span class="enscript-keyword">&lt;/var&gt;</span>.  If not enough memory exists
following the address, the kernel does not map the memory.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>copy<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
Copy indicator.  If true, the kernel copies the region for the 
memory to the specified task's address space.  If false, the region is 
mapped read-write.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>cur_protection<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[out scalar]
The most restrictive current protection for the memory in 
the region.  Valid values are obtained by or'ing together the following 
values:
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
  <span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_READ<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Allows read access.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_WRITE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Allows write access.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_EXECUTE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Allows execute access.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>max_protection<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[out scalar]
The most restrictive maximum protection for the memory 
in the region.  Values are the same as for <span class="enscript-keyword">&lt;var&gt;</span>cur_protection<span class="enscript-keyword">&lt;/var&gt;</span>.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>inheritance<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The initial inheritance attribute for the region.  Valid values 
are:
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
  <span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_INHERIT_SHARE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Allows child tasks to share the region.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_INHERIT_COPY<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Gives child tasks a copy of the region.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_INHERIT_NONE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Provides no access to the region for child tasks.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>DESCRIPTION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
The <span class="enscript-keyword">&lt;strong&gt;</span>vm_remap<span class="enscript-keyword">&lt;/strong&gt;</span> function maps the memory objects underlying
a portion of the 
specified <span class="enscript-keyword">&lt;var&gt;</span>source_task<span class="enscript-keyword">&lt;/var&gt;</span>'s virtual address space into the address
space belonging to 
<span class="enscript-keyword">&lt;var&gt;</span>target_task<span class="enscript-keyword">&lt;/var&gt;</span>.  The target task can be the calling task or another
task, identified by 
its task kernel port.  The effect is as if the target task performed
a <span class="enscript-keyword">&lt;strong&gt;</span>vm_map<span class="enscript-keyword">&lt;/strong&gt;</span> call 
given the same memory object, maximum protection, current
protection, and inheritance as the source task.
However, the two 
tasks must reside on the same host.  The kernel maps the memory objects
starting at <span class="enscript-keyword">&lt;var&gt;</span>target_address<span class="enscript-keyword">&lt;/var&gt;</span>, so that access to <span class="enscript-keyword">&lt;var&gt;</span>target_address<span class="enscript-keyword">&lt;/var&gt;</span>
is as if the source task
accessed its <span class="enscript-keyword">&lt;var&gt;</span>source_address<span class="enscript-keyword">&lt;/var&gt;</span>.
<span class="enscript-keyword">&lt;p&gt;</span>
The <span class="enscript-keyword">&lt;var&gt;</span>mask<span class="enscript-keyword">&lt;/var&gt;</span> parameter 
specifies additional alignment restrictions on the kernel's 
selection of the starting address.  Uses for this mask include:
<span class="enscript-keyword">&lt;ul&gt;</span>
<span class="enscript-keyword">&lt;li&gt;</span>
Forcing the memory address alignment for a mapping to be the same as the 
alignment within the source task.
<span class="enscript-keyword">&lt;li&gt;</span>
Quickly finding the beginning of an allocated region by performing bit
arithmetic on an address known to be in the region.
<span class="enscript-keyword">&lt;li&gt;</span>
Emulating a larger virtual page size.
<span class="enscript-keyword">&lt;/ul&gt;</span>
The <span class="enscript-keyword">&lt;var&gt;</span>cur_protection<span class="enscript-keyword">&lt;/var&gt;</span> and <span class="enscript-keyword">&lt;var&gt;</span>max_protection<span class="enscript-keyword">&lt;/var&gt;</span> parameters return the protection
attributes for the mapped memory.  If all memory within the range had the same
attributes, these attributes are returned; otherwise the call returns the most 
restrictive values for any memory in the region.
<span class="enscript-keyword">&lt;h3&gt;</span>NOTES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
This interface is machine word length specific because of the virtual address
parameter.
<span class="enscript-keyword">&lt;h3&gt;</span>RETURN VALUES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
  <span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>KERN_NO_SPACE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
There is not enough space in the task's address space to allocate the 
new region for the memory object.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>KERN_PROTECTION_FAILURE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Specified memory is valid, but the backing memory manager is
not permitted by the requesting task.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>RELATED INFORMATION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
Functions:
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;vm_map.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>vm_map<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;vm_read.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>vm_read<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;vm_write.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>vm_write<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>.
</pre>
<hr />
</body></html>