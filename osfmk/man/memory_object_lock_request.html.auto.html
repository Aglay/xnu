<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>memory_object_lock_request.html</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">memory_object_lock_request.html&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-keyword">&lt;h2&gt;</span>memory_object_lock_request<span class="enscript-keyword">&lt;/h2&gt;</span>
<span class="enscript-keyword">&lt;hr&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>Function<span class="enscript-keyword">&lt;/strong&gt;</span> - Restrict access to memory object data.
<span class="enscript-keyword">&lt;h3&gt;</span>SYNOPSIS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;pre&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>kern_return_t   memory_object_lock_request<span class="enscript-keyword">&lt;/strong&gt;</span>
                <span class="enscript-keyword">&lt;strong&gt;</span>(memory_object_control_t<span class="enscript-keyword">&lt;/strong&gt;</span>         <span class="enscript-keyword">&lt;var&gt;</span>memory_control<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>vm_offset_t<span class="enscript-keyword">&lt;/strong&gt;</span>                             <span class="enscript-keyword">&lt;var&gt;</span>offset<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>vm_size_t<span class="enscript-keyword">&lt;/strong&gt;</span>                                 <span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_return_t<span class="enscript-keyword">&lt;/strong&gt;</span>           <span class="enscript-keyword">&lt;var&gt;</span>should_return<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>boolean_t<span class="enscript-keyword">&lt;/strong&gt;</span>                         <span class="enscript-keyword">&lt;var&gt;</span>should_flush<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>vm_prot_t<span class="enscript-keyword">&lt;/strong&gt;</span>                           <span class="enscript-keyword">&lt;var&gt;</span>lock_value<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>mach_port_t<span class="enscript-keyword">&lt;/strong&gt;</span>                         <span class="enscript-keyword">&lt;var&gt;</span>reply_port<span class="enscript-keyword">&lt;/var&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>);<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;/pre&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>PARAMETERS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>memory_control<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in memory-cache-control send right]
The memory cache control port 
to be used by the memory manager for cache management requests. 
This port is provided by the kernel in a <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_init<span class="enscript-keyword">&lt;/strong&gt;</span> call.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>offset<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The offset within the memory object, in bytes.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>size<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
The number of bytes of data (starting at <span class="enscript-keyword">&lt;var&gt;</span>offset<span class="enscript-keyword">&lt;/var&gt;</span>) to be
affected.  The number must convert to an integral number of memory object 
pages.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>should_return<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
Clean indicator.  Values are:
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>MEMORY_OBJECT_RETURN_NONE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Don't return any pages.  If <span class="enscript-keyword">&lt;var&gt;</span>should_flush<span class="enscript-keyword">&lt;/var&gt;</span> is <span class="enscript-keyword">&lt;strong&gt;</span>TRUE<span class="enscript-keyword">&lt;/strong&gt;</span>, pages will 
be discarded.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>MEMORY_OBJECT_RETURN_DIRTY<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Return only dirty (modified) pages.  If <span class="enscript-keyword">&lt;var&gt;</span>should_flush<span class="enscript-keyword">&lt;/var&gt;</span> is <span class="enscript-keyword">&lt;strong&gt;</span>TRUE<span class="enscript-keyword">&lt;/strong&gt;</span>, 
precious pages will be discarded; otherwise, the kernel
maintains responsibility for precious pages.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>MEMORY_OBJECT_RETURN_ALL<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Both dirty and precious pages are returned.  If <span class="enscript-keyword">&lt;var&gt;</span>should_flush<span class="enscript-keyword">&lt;/var&gt;</span> is 
<span class="enscript-keyword">&lt;strong&gt;</span>FALSE<span class="enscript-keyword">&lt;/strong&gt;</span>, the kernel maintains responsibility for the precious 
pages.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>MEMORY_OBJECT_RETURN_ANYTHING<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Any resident pages are returned.   If <span class="enscript-keyword">&lt;var&gt;</span>should_flush<span class="enscript-keyword">&lt;/var&gt;</span> is <span class="enscript-keyword">&lt;strong&gt;</span>TRUE<span class="enscript-keyword">&lt;/strong&gt;</span>, 
precious pages will be discarded; otherwise, the kernel
maintains responsibility for precious pages.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>should_flush<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
Flush indicator.  If true, the kernel discards all pages within 
the range.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>lock_value<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar]
One or more forms of access <span class="enscript-keyword">&lt;var&gt;</span>not<span class="enscript-keyword">&lt;/var&gt;</span> permitted for the specified 
data.  Valid values are:
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_NO_CHANGE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Do not change the protection of any pages.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_NONE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Prohibits no access (that is, all forms of access are permitted).
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_READ<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Prohibits read access.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_WRITE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Prohibits write access.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_EXECUTE<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Prohibits execute access.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;strong&gt;</span>VM_PROT_ALL<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
Prohibits all forms of access.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>reply_port<span class="enscript-keyword">&lt;/var&gt;</span> 
<span class="enscript-keyword">&lt;dd&gt;</span>
[in reply receive (to be converted to send) right]
The response port to 
be used by the kernel on a call to <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_lock_completed<span class="enscript-keyword">&lt;/strong&gt;</span>, 
or <span class="enscript-keyword">&lt;strong&gt;</span>MACH_PORT_NULL<span class="enscript-keyword">&lt;/strong&gt;</span> if no response is required.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>DESCRIPTION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
The <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_lock_request<span class="enscript-keyword">&lt;/strong&gt;</span> function allows the memory manager to 
make the following requests of the kernel:
<span class="enscript-keyword">&lt;ul&gt;</span>
<span class="enscript-keyword">&lt;li&gt;</span>
Clean the pages within the specified range by writing back all changed (that 
is, dirty) and precious pages.  The kernel uses the
<span class="enscript-keyword">&lt;strong&gt;</span>memory_object_data_return<span class="enscript-keyword">&lt;/strong&gt;</span> call to write back the data.
The <span class="enscript-keyword">&lt;var&gt;</span>should_return<span class="enscript-keyword">&lt;/var&gt;</span> parameter must be set to 
non-zero.
     <span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;li&gt;</span>
Flush all cached data within the specified range.  The kernel invalidates the 
range of data and revokes all uses of that data.  The <span class="enscript-keyword">&lt;var&gt;</span>should_flush<span class="enscript-keyword">&lt;/var&gt;</span> 
parameter must be set to true.
     <span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;li&gt;</span>
Alter access restrictions specified in the <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_data_supply<span class="enscript-keyword">&lt;/strong&gt;</span>
call 
or a previous <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_lock_request<span class="enscript-keyword">&lt;/strong&gt;</span> call.  The
<span class="enscript-keyword">&lt;var&gt;</span>lock_value<span class="enscript-keyword">&lt;/var&gt;</span> parameter 
must specify the new access restrictions.  Note that this parameter can be 
used to unlock previously locked data.
<span class="enscript-keyword">&lt;/ul&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
Once the kernel performs all of the actions requested by this
call, it issues a 
<span class="enscript-keyword">&lt;strong&gt;</span>memory_object_lock_completed<span class="enscript-keyword">&lt;/strong&gt;</span> call using the <span class="enscript-keyword">&lt;var&gt;</span>reply_to<span class="enscript-keyword">&lt;/var&gt;</span> port.
<span class="enscript-keyword">&lt;h3&gt;</span>NOTES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
The <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_lock_request<span class="enscript-keyword">&lt;/strong&gt;</span> call affects only data
that is cached at the 
time of the call.  Access restrictions cannot be applied to pages
for which data 
has not been provided.
<span class="enscript-keyword">&lt;p&gt;</span>
When a running thread requires an access that is currently prohibited,
the kernel 
issues a <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_data_unlock<span class="enscript-keyword">&lt;/strong&gt;</span> call specifying
the access required.  The 
memory manager can then use <span class="enscript-keyword">&lt;strong&gt;</span>memory_object_lock_request<span class="enscript-keyword">&lt;/strong&gt;</span> to relax its
access restrictions on the data.
<span class="enscript-keyword">&lt;p&gt;</span>
To indicate that an unlock request is invalid (that is, requires
permission that can 
never be granted), the memory manager must first flush the page.  When the
kernel requests the data again with the higher permission, the
memory manager can 
indicate the error by responding with a call to 
<span class="enscript-keyword">&lt;strong&gt;</span>memory_object_data_error<span class="enscript-keyword">&lt;/strong&gt;</span>.
<span class="enscript-keyword">&lt;h3&gt;</span>RETURN VALUES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
Only generic errors apply.
<span class="enscript-keyword">&lt;h3&gt;</span>RELATED INFORMATION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
Functions:
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;memory_object_data_supply.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>memory_object_data_supply<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;memory_object_data_unlock.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>memory_object_data_unlock<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;MO_lock_completed.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>memory_object_lock_completed<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>.

</pre>
<hr />
</body></html>