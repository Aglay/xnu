<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>thread_activation_create.html</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">thread_activation_create.html&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-keyword">&lt;h2&gt;</span>thread_activation_create<span class="enscript-keyword">&lt;/h2&gt;</span>
<span class="enscript-keyword">&lt;hr&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>Function<span class="enscript-keyword">&lt;/strong&gt;</span> - Create a thread activation.
<span class="enscript-keyword">&lt;h3&gt;</span>SYNOPSIS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;pre&gt;</span>
<span class="enscript-keyword">&lt;strong&gt;</span>kern_return_t   thread_activation_create<span class="enscript-keyword">&lt;/strong&gt;</span>
                <span class="enscript-keyword">&lt;strong&gt;</span>(task_t<span class="enscript-keyword">&lt;/strong&gt;</span>                                    <span class="enscript-keyword">&lt;var&gt;</span>task<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>mach_port_name_t<span class="enscript-keyword">&lt;/strong&gt;</span>                      <span class="enscript-keyword">&lt;var&gt;</span>RPC_port<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>vm_offset_t<span class="enscript-keyword">&lt;/strong&gt;</span>                         <span class="enscript-keyword">&lt;var&gt;</span>user_stack<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>vm_size_t<span class="enscript-keyword">&lt;/strong&gt;</span>                           <span class="enscript-keyword">&lt;var&gt;</span>stack_size<span class="enscript-keyword">&lt;/var&gt;</span>,
                 <span class="enscript-keyword">&lt;strong&gt;</span>thread_act_t<span class="enscript-keyword">&lt;/strong&gt;</span>                      <span class="enscript-keyword">&lt;var&gt;</span>thread_act_t<span class="enscript-keyword">&lt;/var&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>);<span class="enscript-keyword">&lt;/strong&gt;</span>
<span class="enscript-keyword">&lt;/pre&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>PARAMETERS<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;dl&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>task<span class="enscript-keyword">&lt;/var&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
[in task send right] The port for the task that is to contain the new 
thread activation.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>RPC_port<span class="enscript-keyword">&lt;/var&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
[in receive right] A receive right held by the task, or a port set in the 
task.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>user_stack<span class="enscript-keyword">&lt;/var&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
[in scalar] The virtual address in the task to be used as the starting ad-
dress of the user-level stack.
<span class="enscript-keyword">&lt;p&gt;</span>
<span class="enscript-keyword">&lt;dt&gt;</span> <span class="enscript-keyword">&lt;var&gt;</span>new_act<span class="enscript-keyword">&lt;/var&gt;</span>
<span class="enscript-keyword">&lt;dd&gt;</span>
[out thread send right] The kernel-assigned name for the new thread ac-
tivation.
<span class="enscript-keyword">&lt;/dl&gt;</span>
<span class="enscript-keyword">&lt;h3&gt;</span>DESCRIPTION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
The thread_activation_create function creates a thread activation, or
&quot;empty thread&quot;, into which a client thread shuttle can migrate during
RPC.  The RPC_port must name ei- ther a receive right held by the
task, or a port set in the task.  The new thread activation will be
added to a pool of activations attached to this port (or port set).
Incoming RPC's targeted at the port (or one of the ports in the set)
can use any of the activations in the pool.  That is, the client
thread shuttle will migrate into the specified server task, take one
of the thread activations out of the pool, and join up with it for the
duration of the RPC.  The shuttle will migrate back to the original
client activation at the end of the RPC.  If no thread activations are
in the pool, RPC will be blocked until one is created in the pool, or
an existing one finishes its RPC and returns to the pool.
The new thread activation will begin each RPC using the stack pointer
specified by user_stack.  The kernel neither knows nor cares how big
the specified stack is.
When a short-circuited RPC (or mach_rpc) is invoked on a port created
with mach_port_allocate_subsystem, the RPC will begin execution in the
subsystem server at the work function address specified by the port
and routine number and looked up in the associated subsystem data.
<span class="enscript-keyword">&lt;h3&gt;</span>NOTES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
The following calls targeted at a thread_act port may _not_ be called
on an empty thread_act (and will return KERN_INVALID_ARGUMENT if
they are called with one):
thread_abort
thread_abort_safely
thread_depress_abort
thread_info
thread_wire
In addition, if thread_switch is called with an empty thread_act as
its first argument, the argument will be ignored (i.e., the function
will behave as if a zero-valued argument had been given).
<span class="enscript-keyword">&lt;h3&gt;</span>RETURN VALUES<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
Only generic errors apply.
<span class="enscript-keyword">&lt;h3&gt;</span>RELATED INFORMATION<span class="enscript-keyword">&lt;/h3&gt;</span>
<span class="enscript-keyword">&lt;p&gt;</span>
Functions:
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;task_create.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>task_create<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
<span class="enscript-keyword">&lt;a href=</span><span class="enscript-string">&quot;MP_allocate_subsystem.html&quot;</span><span class="enscript-keyword">&gt;</span><span class="enscript-keyword">&lt;strong&gt;</span>mach_port_allocate_subsystem<span class="enscript-keyword">&lt;/strong&gt;</span><span class="enscript-keyword">&lt;/a&gt;</span>,
</pre>
<hr />
</body></html>