<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>buffer.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">buffer.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2011 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

<span class="enscript-comment">/* wrapper around kdebug */</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/kdebug.h&gt;</span>

<span class="enscript-comment">/* KDEBUG codes */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_CODE</span>(SubClass, code) KDBG_CODE(DBG_PERF, SubClass, code)

<span class="enscript-comment">/* broad sub-classes */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_GENERIC</span>    (0) 
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_THREADINFO</span> (1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CALLSTACK</span>  (2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TIMER</span>      (3)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET</span>        (4)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_AST</span>        (5)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC</span>        (6)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KDBG</span>       (7)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CSWITCH</span>    (8)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_SIGNPOST</span>   (9)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_MEMINFO</span>    (10)

<span class="enscript-comment">/* sub-class codes */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_GEN_CODE</span>(code) PERF_CODE(PERF_GENERIC, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_GEN_EVENT</span>      PERF_GEN_CODE(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_TI_CODE</span>(code) PERF_CODE(PERF_THREADINFO, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TI_SAMPLE</span>     PERF_TI_CODE(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TI_DATA</span>       PERF_TI_CODE(1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TI_XSAMPLE</span>    PERF_TI_CODE(2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TI_XPEND</span>      PERF_TI_CODE(3)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TI_XDATA</span>      PERF_TI_CODE(4)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TI_CSWITCH</span>    PERF_TI_CODE(5)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_CS_CODE</span>(code) PERF_CODE(PERF_CALLSTACK, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_KSAMPLE</span>    PERF_CS_CODE(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_UPEND</span>      PERF_CS_CODE(1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_USAMPLE</span>    PERF_CS_CODE(2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_KDATA</span>      PERF_CS_CODE(3)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_UDATA</span>      PERF_CS_CODE(4)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_KHDR</span>       PERF_CS_CODE(5)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_UHDR</span>       PERF_CS_CODE(6)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CS_ERROR</span>      PERF_CS_CODE(7)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_TM_CODE</span>(code) PERF_CODE(PERF_TIMER, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TM_ASCHED</span>     PERF_TM_CODE(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TM_SCHED</span>      PERF_TM_CODE(1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_TM_HNDLR</span>      PERF_TM_CODE(2)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_PET_CODE</span>(code) PERF_CODE(PERF_PET, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_THREAD</span>     PERF_PET_CODE(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_ERROR</span>      PERF_PET_CODE(1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_RUN</span>        PERF_PET_CODE(2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_PAUSE</span>      PERF_PET_CODE(3)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_IDLE</span>       PERF_PET_CODE(4)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_SAMPLE</span>     PERF_PET_CODE(5)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_SCHED</span>      PERF_PET_CODE(6)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_PET_END</span>        PERF_PET_CODE(7)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_AST_CODE</span>(code) PERF_CODE(PERF_AST, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_AST_HNDLR</span>      PERF_AST_CODE(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_AST_ERROR</span>      PERF_AST_CODE(1)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_KPC_CODE</span>(code)    PERF_CODE(PERF_KPC, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_HNDLR</span>         PERF_KPC_CODE(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_FCOUNTER</span>      PERF_KPC_CODE(1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_COUNTER</span>       PERF_KPC_CODE(2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_DATA</span>          PERF_KPC_CODE(3)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_CONFIG</span>        PERF_KPC_CODE(4)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_CFG_REG</span>       PERF_KPC_CODE(5)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_DATA32</span>        PERF_KPC_CODE(6)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_CFG_REG32</span>     PERF_KPC_CODE(7)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_DATA_THREAD</span>   PERF_KPC_CODE(8)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KPC_DATA_THREAD32</span> PERF_KPC_CODE(9)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_KDBG_CODE</span>(code) PERF_CODE(PERF_KDBG, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_KDBG_HNDLR</span>      PERF_KDBG_CODE(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_CSWITCH_CODE</span>(code) PERF_CODE(PERF_CSWITCH, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_CSWITCH_HNDLR</span>      PERF_CSWITCH_CODE(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_SIGNPOST_CODE</span>(code) PERF_CODE(PERF_SIGNPOST, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_SIGNPOST_HNDLR</span>      PERF_SIGNPOST_CODE(0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">PERF_MI_CODE</span>(code) PERF_CODE(PERF_MEMINFO, code)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_MI_SAMPLE</span>     PERF_MI_CODE(0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PERF_MI_DATA</span>       PERF_MI_CODE(1)

<span class="enscript-comment">/* error sub-codes for trace data */</span>
<span class="enscript-type">enum</span>
{
	ERR_TASK,
	ERR_THREAD,
	ERR_PID,
	ERR_FRAMES,
	ERR_GETSTACK,
	ERR_NOMEM,
};

<span class="enscript-comment">/* level of trace debug */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPERF_DEBUG_DATA</span>    0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPERF_DEBUG_INFO</span>    1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPERF_DEBUG_VERBOSE</span> 2
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> kperf_debug_level;

<span class="enscript-comment">/* for logging information / debugging -- optional */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_INFO</span>( id, a0, a1, a2, a3) if (kperf_debug_level &gt;= KPERF_DEBUG_INFO) KERNEL_DEBUG_CONSTANT_IST(~KDEBUG_ENABLE_PPT, id,a0,a1,a2,a3,0)

#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_INFO1</span>( id, a0 )         BUF_INFO(id, a0,  0,  0,  0 )
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_INFO2</span>( id, a0, a1 )     BUF_INFO(id, a0, a1,  0,  0 )
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_INFO3</span>( id, a0, a1, a2 ) BUF_INFO(id, a0, a1, a2,  0 )

<span class="enscript-comment">/* for logging actual data -- never compiled out */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_DATA</span>( id, a0, a1, a2, a3) KERNEL_DEBUG_CONSTANT_IST(~KDEBUG_ENABLE_PPT, id,a0,a1,a2,a3,0)

<span class="enscript-comment">/* code neatness */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_DATA1</span>( id, a0 )         BUF_DATA(id, a0, 0, 0, 0 )
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_DATA2</span>( id, a0, a1 )     BUF_DATA(id, a0, a1, 0, 0 )
#<span class="enscript-reference">define</span> <span class="enscript-function-name">BUF_DATA3</span>( id, a0, a1, a2 ) BUF_DATA(id, a0, a1, a2, 0 )
</pre>
<hr />
</body></html>