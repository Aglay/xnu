<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>clock_types.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">clock_types.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*
 * @OSF_COPYRIGHT@
 */</span>
<span class="enscript-comment">/*
 *	File:		clock_types.h
 *	Purpose:	Clock facility header definitions. These
 *				definitons are needed by both kernel and
 *				user-level software.
 */</span>

<span class="enscript-comment">/*
 *	All interfaces defined here are obsolete.
 */</span>

#<span class="enscript-reference">ifndef</span>	<span class="enscript-variable-name">_MACH_CLOCK_TYPES_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_MACH_CLOCK_TYPES_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;stdint.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/time_value.h&gt;</span>

<span class="enscript-comment">/*
 * Type definitions.
 */</span>
<span class="enscript-type">typedef</span>	<span class="enscript-type">int</span>	alarm_type_t;		<span class="enscript-comment">/* alarm time type */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">int</span>	sleep_type_t;		<span class="enscript-comment">/* sleep time type */</span>
<span class="enscript-type">typedef</span>	<span class="enscript-type">int</span>	clock_id_t;			<span class="enscript-comment">/* clock identification type */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">int</span>	clock_flavor_t;		<span class="enscript-comment">/* clock flavor type */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">int</span>	*clock_attr_t;		<span class="enscript-comment">/* clock attribute type */</span>
<span class="enscript-type">typedef</span> <span class="enscript-type">int</span>	clock_res_t;		<span class="enscript-comment">/* clock resolution type */</span>

<span class="enscript-comment">/*
 * Normal time specification used by the kernel clock facility.
 */</span>
<span class="enscript-type">struct</span> mach_timespec {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	tv_sec;			<span class="enscript-comment">/* seconds */</span>
	clock_res_t		tv_nsec;		<span class="enscript-comment">/* nanoseconds */</span>
};
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> mach_timespec	mach_timespec_t;

<span class="enscript-comment">/*
 * Reserved clock id values for default clocks.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SYSTEM_CLOCK</span>		0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CALENDAR_CLOCK</span>		1

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">REALTIME_CLOCK</span>		0

<span class="enscript-comment">/*
 * Attribute names.
 */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">CLOCK_GET_TIME_RES</span>	1	<span class="enscript-comment">/* get_time call resolution */</span>
<span class="enscript-comment">/*							2	 * was map_time call resolution */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CLOCK_ALARM_CURRES</span>	3	<span class="enscript-comment">/* current alarm resolution */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CLOCK_ALARM_MINRES</span>	4	<span class="enscript-comment">/* minimum alarm resolution */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CLOCK_ALARM_MAXRES</span>	5	<span class="enscript-comment">/* maximum alarm resolution */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NSEC_PER_USEC</span>	1000ull		<span class="enscript-comment">/* nanoseconds per microsecond */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">USEC_PER_SEC</span>	1000000ull	<span class="enscript-comment">/* microseconds per second */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NSEC_PER_SEC</span>	1000000000ull	<span class="enscript-comment">/* nanoseconds per second */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">NSEC_PER_MSEC</span>	1000000ull	<span class="enscript-comment">/* nanoseconds per millisecond */</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">BAD_MACH_TIMESPEC</span>(t)						\
	((t)-&gt;tv_nsec &lt; 0 || (t)-&gt;tv_nsec &gt;= (<span class="enscript-type">long</span>)NSEC_PER_SEC)

<span class="enscript-comment">/* t1 &lt;=&gt; t2, also (t1 - t2) in nsec with max of +- 1 sec */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">CMP_MACH_TIMESPEC</span>(t1, t2)					\
	((t1)-&gt;tv_sec &gt; (t2)-&gt;tv_sec ? (<span class="enscript-type">long</span>) +NSEC_PER_SEC :	\
	((t1)-&gt;tv_sec &lt; (t2)-&gt;tv_sec ? (<span class="enscript-type">long</span>) -NSEC_PER_SEC :	\
			(t1)-&gt;tv_nsec - (t2)-&gt;tv_nsec))

<span class="enscript-comment">/* t1  += t2 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">ADD_MACH_TIMESPEC</span>(t1, t2)								\
  <span class="enscript-keyword">do</span> {															\
	<span class="enscript-keyword">if</span> (((t1)-&gt;tv_nsec += (t2)-&gt;tv_nsec) &gt;= (<span class="enscript-type">long</span>) NSEC_PER_SEC) {		\
		(t1)-&gt;tv_nsec -= (<span class="enscript-type">long</span>) NSEC_PER_SEC;							\
		(t1)-&gt;tv_sec  += 1;										\
	}															\
	(t1)-&gt;tv_sec += (t2)-&gt;tv_sec;								\
  } <span class="enscript-keyword">while</span> (0)

<span class="enscript-comment">/* t1  -= t2 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">SUB_MACH_TIMESPEC</span>(t1, t2)								\
  <span class="enscript-keyword">do</span> {															\
	<span class="enscript-keyword">if</span> (((t1)-&gt;tv_nsec -= (t2)-&gt;tv_nsec) &lt; 0) {					\
		(t1)-&gt;tv_nsec += (<span class="enscript-type">long</span>) NSEC_PER_SEC;							\
		(t1)-&gt;tv_sec  -= 1;										\
	}															\
	(t1)-&gt;tv_sec -= (t2)-&gt;tv_sec;								\
  } <span class="enscript-keyword">while</span> (0)

<span class="enscript-comment">/*
 * Alarm parameter defines.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">ALRMTYPE</span>			0xff		<span class="enscript-comment">/* type (8-bit field)	*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TIME_ABSOLUTE</span>		0x00		<span class="enscript-comment">/* absolute time */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">TIME_RELATIVE</span>		0x01		<span class="enscript-comment">/* relative time */</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">BAD_ALRMTYPE</span>(t)		(((t) &amp;~ TIME_RELATIVE) != 0)

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _MACH_CLOCK_TYPES_H_ */</span>
</pre>
<hr />
</body></html>