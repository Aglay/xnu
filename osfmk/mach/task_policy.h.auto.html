<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>task_policy.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">task_policy.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_MACH_TASK_POLICY_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_MACH_TASK_POLICY_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/mach_types.h&gt;</span>

<span class="enscript-comment">/*
 * These are the calls for accessing the policy parameters
 * of a particular task.
 *
 * The extra 'get_default' parameter to the second call is
 * IN/OUT as follows:
 * 1) if asserted on the way in it indicates that the default
 * values should be returned, not the ones currently set, in
 * this case 'get_default' will always be asserted on return;
 * 2) if unasserted on the way in, the current settings are
 * desired and if still unasserted on return, then the info
 * returned reflects the current settings, otherwise if
 * 'get_default' returns asserted, it means that there are no
 * current settings due to other parameters taking precedence,
 * and the default ones are being returned instead.
 */</span>

<span class="enscript-type">typedef</span> natural_t	task_policy_flavor_t;
<span class="enscript-type">typedef</span> integer_t	*task_policy_t;

<span class="enscript-comment">/*
kern_return_t	task_policy_set(
					task_t					task,
					task_policy_flavor_t	flavor,
					task_policy_t			policy_info,
					mach_msg_type_number_t	count);

kern_return_t	task_policy_get(
					task_t					task,
					task_policy_flavor_t	flavor,
					task_policy_t			policy_info,
					mach_msg_type_number_t	*count,
					boolean_t				*get_default);
*/</span>

<span class="enscript-comment">/*
 * Defined flavors.
 */</span>
<span class="enscript-comment">/*
 * TASK_CATEGORY_POLICY:
 *
 * This provides information to the kernel about the role
 * of the task in the system.
 *
 * Parameters:
 *
 * role: Enumerated as follows:
 *
 * TASK_UNSPECIFIED is the default, since the role is not
 * inherited from the parent.
 *
 * TASK_FOREGROUND_APPLICATION should be assigned when the
 * task is a normal UI application in the foreground from
 * the HI point of view.
 * **N.B. There may be more than one of these at a given time.
 *
 * TASK_BACKGROUND_APPLICATION should be assigned when the
 * task is a normal UI application in the background from
 * the HI point of view.
 *
 * TASK_CONTROL_APPLICATION should be assigned to the unique
 * UI application which implements the pop-up application dialog.
 * There can only be one task at a time with this designation,
 * which is assigned FCFS.
 *
 * TASK_GRAPHICS_SERVER should be assigned to the graphics
 * management (window) server.  There can only be one task at
 * a time with this designation, which is assigned FCFS.
 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_CATEGORY_POLICY</span>		1

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_SUPPRESSION_POLICY</span>		3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_POLICY_STATE</span>		4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_BASE_QOS_POLICY</span>		8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_OVERRIDE_QOS_POLICY</span>	9
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_BASE_LATENCY_QOS_POLICY</span>	10
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_BASE_THROUGHPUT_QOS_POLICY</span>	11


<span class="enscript-type">enum</span> task_role {
	TASK_RENICED = -1,
	TASK_UNSPECIFIED = 0,
	TASK_FOREGROUND_APPLICATION,
	TASK_BACKGROUND_APPLICATION,
	TASK_CONTROL_APPLICATION,
	TASK_GRAPHICS_SERVER,
	TASK_THROTTLE_APPLICATION,
	TASK_NONUI_APPLICATION,
	TASK_DEFAULT_APPLICATION
};

<span class="enscript-type">typedef</span> integer_t	task_role_t;

<span class="enscript-type">struct</span> task_category_policy {
	task_role_t		role;
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> task_category_policy		task_category_policy_data_t;
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> task_category_policy		*task_category_policy_t;

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_CATEGORY_POLICY_COUNT</span>	((mach_msg_type_number_t) \
	(<span class="enscript-keyword">sizeof</span> (task_category_policy_data_t) / <span class="enscript-keyword">sizeof</span> (integer_t)))


<span class="enscript-type">enum</span> task_latency_qos {
	LATENCY_QOS_TIER_UNSPECIFIED = 0x0,
	LATENCY_QOS_TIER_0 = ((0xFF&lt;&lt;16) | 1),
	LATENCY_QOS_TIER_1 = ((0xFF&lt;&lt;16) | 2),
	LATENCY_QOS_TIER_2 = ((0xFF&lt;&lt;16) | 3),
	LATENCY_QOS_TIER_3 = ((0xFF&lt;&lt;16) | 4),
	LATENCY_QOS_TIER_4 = ((0xFF&lt;&lt;16) | 5),
	LATENCY_QOS_TIER_5 = ((0xFF&lt;&lt;16) | 6)

};
<span class="enscript-type">typedef</span> integer_t	task_latency_qos_t;
<span class="enscript-type">enum</span> task_throughput_qos {
	THROUGHPUT_QOS_TIER_UNSPECIFIED = 0x0,
	THROUGHPUT_QOS_TIER_0 = ((0xFE&lt;&lt;16) | 1),
	THROUGHPUT_QOS_TIER_1 = ((0xFE&lt;&lt;16) | 2),
	THROUGHPUT_QOS_TIER_2 = ((0xFE&lt;&lt;16) | 3),
	THROUGHPUT_QOS_TIER_3 = ((0xFE&lt;&lt;16) | 4),
	THROUGHPUT_QOS_TIER_4 = ((0xFE&lt;&lt;16) | 5),
	THROUGHPUT_QOS_TIER_5 = ((0xFE&lt;&lt;16) | 6),
};

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">LATENCY_QOS_LAUNCH_DEFAULT_TIER</span> LATENCY_QOS_TIER_3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">THROUGHPUT_QOS_LAUNCH_DEFAULT_TIER</span> THROUGHPUT_QOS_TIER_3

<span class="enscript-type">typedef</span> integer_t	task_throughput_qos_t;

<span class="enscript-type">struct</span> task_qos_policy {
	task_latency_qos_t task_latency_qos_tier;
	task_throughput_qos_t task_throughput_qos_tier;
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> task_qos_policy *task_qos_policy_t;
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_QOS_POLICY_COUNT</span>	((mach_msg_type_number_t) \
	(<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> task_qos_policy) / <span class="enscript-keyword">sizeof</span> (integer_t)))

<span class="enscript-comment">/* These should be removed - they belong in proc_info.h */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_DARWINBG</span>           0x8000    <span class="enscript-comment">/* process in darwin background */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_EXT_DARWINBG</span>		 0x10000   <span class="enscript-comment">/* process in darwin background - external enforcement */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_IOS_APPLEDAEMON</span>    0x20000   <span class="enscript-comment">/* process is apple ios daemon */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_IOS_IMPPROMOTION</span>   0x80000   <span class="enscript-comment">/* process is apple ios daemon */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_ADAPTIVE</span>           0x100000  <span class="enscript-comment">/* Process is adaptive */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_ADAPTIVE_IMPORTANT</span> 0x200000  <span class="enscript-comment">/* Process is adaptive, and is currently important */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_IMPORTANCE_DONOR</span>   0x400000  <span class="enscript-comment">/* Process is marked as an importance donor */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_SUPPRESSED</span>         0x800000  <span class="enscript-comment">/* Process is suppressed */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_APPLICATION</span>        0x1000000 <span class="enscript-comment">/* Process is an application */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">PROC_FLAG_IOS_APPLICATION</span> PROC_FLAG_APPLICATION <span class="enscript-comment">/* Process is an application */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>

<span class="enscript-type">struct</span> task_requested_policy {
	<span class="enscript-comment">/* Task and thread policy (inherited) */</span>
	uint64_t        int_darwinbg        :1,     <span class="enscript-comment">/* marked as darwinbg via setpriority */</span>
	                ext_darwinbg        :1,
	                int_iotier          :2,     <span class="enscript-comment">/* IO throttle tier */</span>
	                ext_iotier          :2,
	                int_iopassive       :1,     <span class="enscript-comment">/* should IOs cause lower tiers to be throttled */</span>
	                ext_iopassive       :1,
	                bg_iotier           :2,     <span class="enscript-comment">/* what IO throttle tier should apply to me when I'm darwinbg? (pushed to threads) */</span>
	                terminated          :1,     <span class="enscript-comment">/* all throttles should be removed for quick exit or SIGTERM handling */</span>

	<span class="enscript-comment">/* Thread only policy */</span>
	                th_pidbind_bg       :1,     <span class="enscript-comment">/* thread only: task i'm bound to is marked 'watchbg' */</span>
	                th_workq_bg         :1,     <span class="enscript-comment">/* thread only: currently running a background priority workqueue */</span>
	                thrp_qos            :3,     <span class="enscript-comment">/* thread only: thread qos class */</span>
	                thrp_qos_relprio    :4,     <span class="enscript-comment">/* thread only: thread qos relative priority (store as inverse, -10 -&gt; 0xA) */</span>
	                thrp_qos_override   :3,     <span class="enscript-comment">/* thread only: thread qos class override */</span>

	<span class="enscript-comment">/* Task only policy */</span>
	                t_apptype           :3,     <span class="enscript-comment">/* What apptype did launchd tell us this was (inherited) */</span>
	                t_boosted           :1,     <span class="enscript-comment">/* Has a non-zero importance assertion count */</span>
	                t_int_gpu_deny      :1,     <span class="enscript-comment">/* don't allow access to GPU */</span>
	                t_ext_gpu_deny      :1,
	                t_role              :3,     <span class="enscript-comment">/* task's system role */</span>
	                t_tal_enabled       :1,     <span class="enscript-comment">/* TAL mode is enabled */</span>
	                t_base_latency_qos  :3,     <span class="enscript-comment">/* Timer latency QoS */</span>
	                t_over_latency_qos  :3,     <span class="enscript-comment">/* Timer latency QoS override */</span>
	                t_base_through_qos  :3,     <span class="enscript-comment">/* Computation throughput QoS */</span>
	                t_over_through_qos  :3,     <span class="enscript-comment">/* Computation throughput QoS override */</span>
	                t_sfi_managed       :1,     <span class="enscript-comment">/* SFI Managed task */</span>
	                t_qos_clamp         :3,     <span class="enscript-comment">/* task qos clamp */</span>

	<span class="enscript-comment">/* Task only: suppression policies (non-embedded only) */</span>
	                t_sup_active        :1,     <span class="enscript-comment">/* Suppression is on */</span>
	                t_sup_lowpri_cpu    :1,     <span class="enscript-comment">/* Wants low priority CPU (MAXPRI_THROTTLE) */</span>
	                t_sup_timer         :3,     <span class="enscript-comment">/* Wanted timer throttling QoS tier */</span>
	                t_sup_disk          :1,     <span class="enscript-comment">/* Wants disk throttling */</span>
	                t_sup_cpu_limit     :1,     <span class="enscript-comment">/* Wants CPU limit (not hooked up yet)*/</span>
	                t_sup_suspend       :1,     <span class="enscript-comment">/* Wants to be suspended */</span>
	                t_sup_throughput    :3,     <span class="enscript-comment">/* Wants throughput QoS tier */</span>
	                t_sup_cpu           :1,     <span class="enscript-comment">/* Wants suppressed CPU priority (MAXPRI_SUPPRESSED) */</span>
	                t_sup_bg_sockets    :1,     <span class="enscript-comment">/* Wants background sockets */</span>

	                reserved            :2;
};

<span class="enscript-type">struct</span> task_effective_policy {
	<span class="enscript-comment">/* Task and thread policy */</span>
	uint64_t        darwinbg            :1,     <span class="enscript-comment">/* marked as 'background', and sockets are marked bg when created */</span>
	                lowpri_cpu          :1,     <span class="enscript-comment">/* cpu priority == MAXPRI_THROTTLE */</span>
	                io_tier             :2,     <span class="enscript-comment">/* effective throttle tier */</span>
	                io_passive          :1,     <span class="enscript-comment">/* should IOs cause lower tiers to be throttled */</span>
	                all_sockets_bg      :1,     <span class="enscript-comment">/* All existing sockets in process are marked as bg (thread: all created by thread) */</span>
	                new_sockets_bg      :1,     <span class="enscript-comment">/* Newly created sockets should be marked as bg */</span>
	                bg_iotier           :2,     <span class="enscript-comment">/* What throttle tier should I be in when darwinbg is set? */</span>
	                terminated          :1,     <span class="enscript-comment">/* all throttles have been removed for quick exit or SIGTERM handling */</span>
	                qos_ui_is_urgent    :1,     <span class="enscript-comment">/* bump UI-Interactive QoS up to the urgent preemption band */</span>

	<span class="enscript-comment">/* Thread only policy */</span>
	                thep_qos            :3,     <span class="enscript-comment">/* thread only: thread qos class */</span>
	                thep_qos_relprio    :4,     <span class="enscript-comment">/* thread only: thread qos relative priority (store as inverse, -10 -&gt; 0xA) */</span>

	<span class="enscript-comment">/* Task only policy */</span>
	                t_gpu_deny          :1,     <span class="enscript-comment">/* not allowed to access GPU */</span>
	                t_tal_engaged       :1,     <span class="enscript-comment">/* TAL mode is in effect */</span>
	                t_suspended         :1,     <span class="enscript-comment">/* task_suspend-ed due to suppression */</span>
	                t_watchers_bg       :1,     <span class="enscript-comment">/* watchers are BG-ed */</span>
	                t_latency_qos       :3,     <span class="enscript-comment">/* Timer latency QoS level */</span>
	                t_through_qos       :3,     <span class="enscript-comment">/* Computation throughput QoS level */</span>
	                t_sup_active        :1,     <span class="enscript-comment">/* suppression behaviors are in effect */</span>
	                t_role              :3,     <span class="enscript-comment">/* task's system role */</span>
	                t_suppressed_cpu    :1,     <span class="enscript-comment">/* cpu priority == MAXPRI_SUPPRESSED (trumped by lowpri_cpu) */</span>
	                t_sfi_managed       :1,     <span class="enscript-comment">/* SFI Managed task */</span>
	                t_live_donor        :1,     <span class="enscript-comment">/* task is a live importance boost donor */</span>
	                t_qos_clamp         :3,     <span class="enscript-comment">/* task qos clamp (applies to qos-disabled threads too) */</span>
	                t_qos_ceiling       :3,     <span class="enscript-comment">/* task qos ceiling (applies to only qos-participating threads) */</span>

	                reserved            :23;
};

<span class="enscript-type">struct</span> task_pended_policy {
	uint64_t        t_updating_policy   :1,     <span class="enscript-comment">/* Busy bit for task to prevent concurrent 'complete' operations */</span>

	<span class="enscript-comment">/* Task and thread policy */</span>
	                update_sockets      :1,

	<span class="enscript-comment">/* Task only policy */</span>
	                t_update_timers     :1,
	                t_update_watchers   :1,

	                reserved            :60;
};

#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">MACH_KERNEL_PRIVATE</span>

<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> task_requested_policy default_task_requested_policy;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> task_effective_policy default_task_effective_policy;
<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">struct</span> task_pended_policy    default_task_pended_policy;

<span class="enscript-type">extern</span> kern_return_t
<span class="enscript-function-name">qos_latency_policy_validate</span>(task_latency_qos_t);

<span class="enscript-type">extern</span> kern_return_t
<span class="enscript-function-name">qos_throughput_policy_validate</span>(task_throughput_qos_t);

<span class="enscript-type">extern</span> uint32_t
<span class="enscript-function-name">qos_extract</span>(uint32_t);

<span class="enscript-type">extern</span> uint32_t
<span class="enscript-function-name">qos_latency_policy_package</span>(uint32_t);
<span class="enscript-type">extern</span> uint32_t
<span class="enscript-function-name">qos_throughput_policy_package</span>(uint32_t);

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* MACH_KERNEL_PRIVATE */</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">PRIVATE</span>

<span class="enscript-comment">/*
 * Control structure for applying suppression behaviors to tasks
 */</span>
<span class="enscript-type">struct</span> task_suppression_policy {
	integer_t active;
	integer_t lowpri_cpu;  <span class="enscript-comment">/* priority MAXPRI_THROTTLE cpu */</span>
	integer_t timer_throttle;
	integer_t disk_throttle;
	integer_t cpu_limit;
	integer_t suspend;
	integer_t throughput_qos;
	integer_t suppressed_cpu; <span class="enscript-comment">/* priority MAXPRI_SUPPRESSED cpu */</span>
	integer_t background_sockets;
	integer_t reserved[7];
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> task_suppression_policy *task_suppression_policy_t;

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_SUPPRESSION_POLICY_COUNT</span>	((mach_msg_type_number_t) \
	(<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> task_suppression_policy) / <span class="enscript-keyword">sizeof</span> (integer_t)))

<span class="enscript-type">struct</span> task_policy_state {
	uint64_t requested;
	uint64_t effective;
	uint64_t pending;
	uint32_t imp_assertcnt;
	uint32_t imp_externcnt;
	uint64_t flags;
	uint64_t imp_transitions;
	uint64_t reserved[2];
};

<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> task_policy_state *task_policy_state_t;

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_POLICY_STATE_COUNT</span>	((mach_msg_type_number_t) \
	(<span class="enscript-keyword">sizeof</span> (<span class="enscript-type">struct</span> task_policy_state) / <span class="enscript-keyword">sizeof</span> (integer_t)))


<span class="enscript-comment">/*
 * Definitions for munging and unmunging a policy struct
 * Used in task_policy_state and in tracepoints
 *
 * Note: this is tightly bound to the implementation of task policy
 * and the values exported through this API may change or change meaning at any time
 *
 * Do not rely on these values, especially apptype, to decide behaviors at runtime.
 *
 * All per-thread state must be in the first 32 bits of the bitfield.
 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_APPTYPE_NONE</span>                0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_APPTYPE_DAEMON_INTERACTIVE</span>  1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_APPTYPE_DAEMON_STANDARD</span>     2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_APPTYPE_DAEMON_ADAPTIVE</span>     3
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_APPTYPE_DAEMON_BACKGROUND</span>   4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_APPTYPE_APP_DEFAULT</span>         5
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_APPTYPE_APP_TAL</span>             6

<span class="enscript-comment">/* task policy state flags */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_IMP_RECEIVER</span>                    0x00000001
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_IMP_DONOR</span>                       0x00000002
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_IMP_LIVE_DONOR</span>		     0x00000004
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">TASK_DENAP_RECEIVER</span>		     0x00000008

<span class="enscript-comment">/* requested_policy */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_INT_DARWIN_BG</span>             0x00000001
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_EXT_DARWIN_BG</span>             0x00000002
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_INT_IO_TIER_MASK</span>          0x0000000c <span class="enscript-comment">/* 2 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_INT_IO_TIER_SHIFT</span>         2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_EXT_IO_TIER_MASK</span>          0x00000030 <span class="enscript-comment">/* 2 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_EXT_IO_TIER_SHIFT</span>         4
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_INT_PASSIVE_IO</span>            0x00000040
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_EXT_PASSIVE_IO</span>            0x00000080
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_BG_IOTIER_MASK</span>            0x00000300 <span class="enscript-comment">/* 2 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_BG_IOTIER_SHIFT</span>           8

<span class="enscript-comment">/* thread requested policy */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_PIDBIND_BG</span>                0x00000400
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_WORKQ_BG</span>                  0x00000800
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_TH_QOS_MASK</span>               0x07000000 <span class="enscript-comment">/* 3 bits (overlaps with ROLE) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_TH_QOS_SHIFT</span>              24
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_TH_QOS_OVER_MASK</span>          0x70000000 <span class="enscript-comment">/* 3 bits (overlaps with TAL and SFI) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_TH_QOS_OVER_SHIFT</span>         28

<span class="enscript-comment">/* task_requested_policy */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_TERMINATED</span>                0x00001000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_BOOSTED</span>                   0x00002000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_INT_GPU_DENY</span>              0x00004000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_EXT_GPU_DENY</span>              0x00008000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_APPTYPE_MASK</span>              0x00070000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_APPTYPE_SHIFT</span>             16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_BASE_LATENCY_QOS_MASK</span>     0x00700000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_BASE_LATENCY_QOS_SHIFT</span>    20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_ROLE_MASK</span>                 0x07000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_ROLE_SHIFT</span>                24
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_TAL_ENABLED</span>               0x40000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SFI_MANAGED</span>               0x80000000

<span class="enscript-comment">/* requested suppression behaviors (note: clipped off in 32-bit tracepoints) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_ACTIVE</span>                0x0000000100000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_LOWPRI_CPU</span>            0x0000000200000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_CPU</span>                   0x0000000400000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_DISK_THROTTLE</span>         0x0000003000000000 <span class="enscript-comment">/* 2 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_CPU_LIMIT</span>             0x0000004000000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_SUSPEND</span>               0x0000008000000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_OVER_LATENCY_QOS_MASK</span>     0x0000070000000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_OVER_LATENCY_QOS_SHIFT</span>    40
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_BASE_THROUGH_QOS_MASK</span>     0x0000700000000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_BASE_THROUGH_QOS_SHIFT</span>    44
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_OVER_THROUGH_QOS_MASK</span>     0x0007000000000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_OVER_THROUGH_QOS_SHIFT</span>    48
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_TIMER_THROTTLE_MASK</span>   0x0070000000000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_TIMER_THROTTLE_SHIFT</span>  52
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_THROUGHPUT_MASK</span>       0x0700000000000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_THROUGHPUT_SHIFT</span>      56
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_SUP_BG_SOCKETS</span>            0x0800008000000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_QOS_CLAMP_MASK</span>            0x7000000000000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_REQ_QOS_CLAMP_SHIFT</span>           60

<span class="enscript-comment">/* effective policy */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_IO_TIER_MASK</span>              0x00000003 <span class="enscript-comment">/* 2 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_IO_TIER_SHIFT</span>             0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_IO_PASSIVE</span>                0x00000008
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_DARWIN_BG</span>                 0x00000010
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_LOWPRI_CPU</span>                0x00000020
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_ALL_SOCKETS_BG</span>            0x00000040
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_NEW_SOCKETS_BG</span>            0x00000080
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_BG_IOTIER_MASK</span>            0x00000300 <span class="enscript-comment">/* 2 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_BG_IOTIER_SHIFT</span>           8
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_TERMINATED</span>                0x00000400
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_QOS_UI_IS_URGENT</span>          0x80000000

<span class="enscript-comment">/* thread effective policy */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_TH_QOS_MASK</span>               0x00700000 <span class="enscript-comment">/* 3 bits (overlaps with ROLE) */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_TH_QOS_SHIFT</span>              20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_LATENCY_QOS_MASK</span>          0x00070000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_LATENCY_QOS_SHIFT</span>         16
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_THROUGH_QOS_MASK</span>          0x07000000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_THROUGH_QOS_SHIFT</span>         24

<span class="enscript-comment">/* task effective policy */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_GPU_DENY</span>                  0x00001000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_TAL_ENGAGED</span>               0x00002000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_SUSPENDED</span>                 0x00004000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_WATCHERS_BG</span>               0x00008000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_SUP_ACTIVE</span>                0x00080000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_ROLE_MASK</span>                 0x00700000 <span class="enscript-comment">/* 3 bits */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_ROLE_SHIFT</span>                20
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_SUP_CPU</span>                   0x00800000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_SFI_MANAGED</span>               0x08000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_QOS_CEILING_MASK</span>          0x70000000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_EFF_QOS_CEILING_SHIFT</span>         28

<span class="enscript-comment">/* pending policy */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_PEND_UPDATING</span>                 0x00000001
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_PEND_SOCKETS</span>                  0x00000002
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_PEND_TIMERS</span>                   0x00000004
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">POLICY_PEND_WATCHERS</span>                 0x00000008

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* PRIVATE */</span>

#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* _MACH_TASK_POLICY_H_ */</span>
</pre>
<hr />
</body></html>