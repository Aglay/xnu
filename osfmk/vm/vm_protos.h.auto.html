<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>vm_protos.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">vm_protos.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2004-2007 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

#<span class="enscript-reference">ifdef</span>	<span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_VM_VM_PROTOS_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_VM_VM_PROTOS_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;mach/mach_types.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;kern/kern_types.h&gt;</span>

<span class="enscript-comment">/*
 * This file contains various type definitions and routine prototypes
 * that are needed to avoid compilation warnings for VM code (in osfmk,
 * default_pager and bsd).
 * Most of these should eventually go into more appropriate header files.
 *
 * Include it after all other header files since it doesn't include any
 * type definitions and it works around some conflicts with other header
 * files.
 */</span>

<span class="enscript-comment">/*
 * iokit
 */</span>
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_data_action</span>(
	uintptr_t               device_handle, 
	ipc_port_t              device_pager,
	vm_prot_t               protection, 
	vm_object_offset_t      offset, 
	vm_size_t               size);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_close</span>(
	uintptr_t     device_handle);

<span class="enscript-comment">/*
 * default_pager
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">start_def_pager</span>(
	<span class="enscript-type">char</span> *bs_device);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> default_pager_init_flag;

<span class="enscript-comment">/*
 * osfmk
 */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_IPC_IPC_PORT_H_</span>
<span class="enscript-type">extern</span> mach_port_name_t <span class="enscript-function-name">ipc_port_copyout_send</span>(
	ipc_port_t	sright,
	ipc_space_t	space);
<span class="enscript-type">extern</span> task_t <span class="enscript-function-name">port_name_to_task</span>(
	mach_port_name_t name);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _IPC_IPC_PORT_H_ */</span>

<span class="enscript-type">extern</span> ipc_space_t  <span class="enscript-function-name">get_task_ipcspace</span>(
	task_t t);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_JETSAM</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> max_task_footprint_mb;	<span class="enscript-comment">/* Per-task limit on physical memory consumption in megabytes */</span>
#<span class="enscript-reference">endif</span> // <span class="enscript-variable-name">CONFIG_JETSAM</span>

<span class="enscript-comment">/* Some loose-ends VM stuff */</span>

<span class="enscript-type">extern</span> vm_map_t		kalloc_map;
<span class="enscript-type">extern</span> vm_size_t	msg_ool_size_small;
<span class="enscript-type">extern</span> vm_map_t		zone_map;

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">consider_machine_adjust</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> vm_map_offset_t <span class="enscript-function-name">get_map_min</span>(vm_map_t);
<span class="enscript-type">extern</span> vm_map_offset_t <span class="enscript-function-name">get_map_max</span>(vm_map_t);
<span class="enscript-type">extern</span> vm_map_size_t <span class="enscript-function-name">get_vmmap_size</span>(vm_map_t);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">get_vmmap_entries</span>(vm_map_t);

<span class="enscript-type">extern</span> vm_map_offset_t <span class="enscript-function-name">vm_map_page_mask</span>(vm_map_t);

<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">coredumpok</span>(vm_map_t map, vm_offset_t va);

<span class="enscript-comment">/*
 * VM routines that used to be published to
 * user space, and are now restricted to the kernel.
 *
 * They should eventually go away entirely -
 * to be replaced with standard vm_map() and
 * vm_deallocate() calls.
 */</span>

<span class="enscript-type">extern</span> kern_return_t vm_upl_map
(
	vm_map_t target_task,
	upl_t upl,
	vm_address_t *address
);

<span class="enscript-type">extern</span> kern_return_t vm_upl_unmap
(
	vm_map_t target_task,
	upl_t upl
);

<span class="enscript-type">extern</span> kern_return_t vm_region_object_create
(
	vm_map_t target_task,
	vm_size_t size,
	ipc_port_t *object_handle
);

<span class="enscript-type">extern</span> mach_vm_offset_t <span class="enscript-function-name">mach_get_vm_start</span>(vm_map_t);
<span class="enscript-type">extern</span> mach_vm_offset_t <span class="enscript-function-name">mach_get_vm_end</span>(vm_map_t);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_CODE_DECRYPTION</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VM_MAP_DEBUG_APPLE_PROTECT</span>	MACH_ASSERT
<span class="enscript-type">struct</span> pager_crypt_info;
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vm_map_apple_protected</span>(
	vm_map_t		map,
	vm_map_offset_t		start,
	vm_map_offset_t		end,
	vm_object_offset_t	crypto_backing_offset,
	<span class="enscript-type">struct</span> pager_crypt_info *crypt_info);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">apple_protect_pager_bootstrap</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> memory_object_t <span class="enscript-function-name">apple_protect_pager_setup</span>(
	vm_object_t		backing_object,
	vm_object_offset_t	backing_offset,
	vm_object_offset_t	crypto_backing_offset,
	<span class="enscript-type">struct</span> pager_crypt_info *crypt_info,
	vm_object_offset_t	crypto_start,
	vm_object_offset_t	crypto_end);
#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* CONFIG_CODE_DECRYPTION */</span>

<span class="enscript-type">struct</span> vnode;
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">swapfile_pager_bootstrap</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> memory_object_t <span class="enscript-function-name">swapfile_pager_setup</span>(<span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">extern</span> memory_object_control_t <span class="enscript-function-name">swapfile_pager_control</span>(memory_object_t mem_obj);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__arm64__</span> || ((<span class="enscript-variable-name">__ARM_ARCH_7K__</span> &gt;= 2) &amp;&amp; <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">PLATFORM_WatchOS</span>))
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SIXTEENK_PAGE_SIZE</span>	0x4000
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SIXTEENK_PAGE_MASK</span>	0x3FFF
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SIXTEENK_PAGE_SHIFT</span>	14
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __arm64__ || ((__ARM_ARCH_7K__ &gt;= 2) &amp;&amp; defined(PLATFORM_WatchOS)) */</span>


<span class="enscript-comment">/*
 * bsd
 */</span>
<span class="enscript-type">struct</span> vnode;
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_shutdown</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> *<span class="enscript-function-name">upl_get_internal_page_list</span>(
	upl_t upl);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_setswapmount</span>(<span class="enscript-type">struct</span> vnode *);
<span class="enscript-type">extern</span> int64_t <span class="enscript-function-name">vnode_getswappin_avail</span>(<span class="enscript-type">struct</span> vnode *);

<span class="enscript-type">typedef</span> <span class="enscript-type">int</span> pager_return_t;
<span class="enscript-type">extern</span> pager_return_t	vnode_pagein(
	<span class="enscript-type">struct</span> vnode *, upl_t,
	upl_offset_t, vm_object_offset_t,
	upl_size_t, <span class="enscript-type">int</span>, <span class="enscript-type">int</span> *);
<span class="enscript-type">extern</span> pager_return_t	vnode_pageout(
	<span class="enscript-type">struct</span> vnode *, upl_t,
	upl_offset_t, vm_object_offset_t,
	upl_size_t, <span class="enscript-type">int</span>, <span class="enscript-type">int</span> *);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">vnode_trim</span> (<span class="enscript-type">struct</span> vnode *, int64_t offset, <span class="enscript-type">unsigned</span> <span class="enscript-type">long</span> len);
<span class="enscript-type">extern</span> memory_object_t <span class="enscript-function-name">vnode_pager_setup</span>(
	<span class="enscript-type">struct</span> vnode *, memory_object_t);
<span class="enscript-type">extern</span> vm_object_offset_t <span class="enscript-function-name">vnode_pager_get_filesize</span>(
	<span class="enscript-type">struct</span> vnode *);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">vnode_pager_isinuse</span>(
	<span class="enscript-type">struct</span> vnode *);
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">vnode_pager_isSSD</span>(
	<span class="enscript-type">struct</span> vnode *);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_throttle</span>(
	<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">vnode_pager_return_throttle_io_limit</span>(
	<span class="enscript-type">struct</span> vnode *,
	uint32_t     *);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_name</span>(
	<span class="enscript-type">struct</span> vnode	*vp,
	<span class="enscript-type">char</span>		*pathname,
	vm_size_t	pathname_len,
	<span class="enscript-type">char</span>		*filename,
	vm_size_t	filename_len,
	boolean_t	*truncated_path_p);
<span class="enscript-type">struct</span> timespec;
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_mtime</span>(
	<span class="enscript-type">struct</span> vnode	*vp,
	<span class="enscript-type">struct</span> timespec	*mtime,
	<span class="enscript-type">struct</span> timespec	*cs_mtime);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_cs_blobs</span>(
	<span class="enscript-type">struct</span> vnode	*vp,
	<span class="enscript-type">void</span>		**blobs);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_IOSCHED</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_issue_reprioritize_io</span>(
	<span class="enscript-type">struct</span> vnode 	*devvp, 
	uint64_t 	blkno, 
	uint32_t 	len,
	<span class="enscript-type">int</span> 		priority);
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CHECK_CS_VALIDATION_BITMAP</span>	
<span class="enscript-comment">/* used by the vnode_pager_cs_validation_bitmap routine*/</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CS_BITMAP_SET</span>	1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CS_BITMAP_CLEAR</span>	2
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CS_BITMAP_CHECK</span>	3

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* CHECK_CS_VALIDATION_BITMAP */</span>

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_bootstrap</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> kern_return_t
<span class="enscript-function-name">vnode_pager_data_unlock</span>(
	memory_object_t		mem_obj,
	memory_object_offset_t	offset,
	memory_object_size_t		size,
	vm_prot_t		desired_access);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_init</span>(
	memory_object_t, 
	memory_object_control_t, 
	memory_object_cluster_size_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_object_size</span>(
	memory_object_t,
	memory_object_offset_t *);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_IOSCHED</span>
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_object_devvp</span>(
        memory_object_t,
        uintptr_t *);
#<span class="enscript-reference">endif</span>

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_isinuse</span>(
	memory_object_t,
	uint32_t *);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_isSSD</span>(
	memory_object_t,
	boolean_t *);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_throttle_io_limit</span>(
	memory_object_t,
	uint32_t *);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_object_name</span>(
	memory_object_t	mem_obj,
	<span class="enscript-type">char</span>		*pathname,
	vm_size_t	pathname_len,
	<span class="enscript-type">char</span>		*filename,
	vm_size_t	filename_len,
	boolean_t	*truncated_path_p);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_object_mtime</span>(
	memory_object_t	mem_obj,
	<span class="enscript-type">struct</span> timespec *mtime,
	<span class="enscript-type">struct</span> timespec	*cs_mtime);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_get_object_cs_blobs</span>(
	memory_object_t	mem_obj,
	<span class="enscript-type">void</span>		**blobs);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CHECK_CS_VALIDATION_BITMAP</span>	
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_cs_check_validation_bitmap</span>( 
	memory_object_t	mem_obj, 
	memory_object_offset_t	offset,
	<span class="enscript-type">int</span>		optype);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/*CHECK_CS_VALIDATION_BITMAP*/</span>

<span class="enscript-type">extern</span>	kern_return_t ubc_cs_check_validation_bitmap (
	<span class="enscript-type">struct</span> vnode *vp, 
	memory_object_offset_t offset,
	<span class="enscript-type">int</span> optype);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_data_request</span>( 
	memory_object_t, 
	memory_object_offset_t,
	memory_object_cluster_size_t,
	vm_prot_t,
	memory_object_fault_info_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_data_return</span>(
	memory_object_t,
	memory_object_offset_t,
	memory_object_cluster_size_t,
	memory_object_offset_t *,
	<span class="enscript-type">int</span> *,
	boolean_t,
	boolean_t,
	<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_data_initialize</span>(
	memory_object_t,
	memory_object_offset_t,
	memory_object_cluster_size_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_reference</span>(
	memory_object_t		mem_obj);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_synchronize</span>(
	memory_object_t		mem_obj,
	memory_object_offset_t	offset,
	memory_object_size_t		length,
	vm_sync_t		sync_flags);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_map</span>(
	memory_object_t		mem_obj,
	vm_prot_t		prot);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_last_unmap</span>(
	memory_object_t		mem_obj);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_deallocate</span>(
	memory_object_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">vnode_pager_terminate</span>(
	memory_object_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_vrele</span>(
	<span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vnode_pager_release_from_cache</span>(
	<span class="enscript-type">int</span>	*);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span>  <span class="enscript-function-name">ubc_map</span>(
	<span class="enscript-type">struct</span> vnode *vp,
	<span class="enscript-type">int</span> flags);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">ubc_unmap</span>(
	<span class="enscript-type">struct</span> vnode *vp);

<span class="enscript-type">struct</span> vm_map_entry;
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> vm_object *<span class="enscript-function-name">find_vnode_object</span>(<span class="enscript-type">struct</span> vm_map_entry *entry);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span>   <span class="enscript-function-name">dp_memory_object_reference</span>(memory_object_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span>   <span class="enscript-function-name">dp_memory_object_deallocate</span>(memory_object_t);
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_memory_object_server_</span>
<span class="enscript-type">extern</span> kern_return_t   <span class="enscript-function-name">dp_memory_object_init</span>(memory_object_t,
					     memory_object_control_t,
					     memory_object_cluster_size_t);
<span class="enscript-type">extern</span>	kern_return_t dp_memory_object_terminate(memory_object_t);
<span class="enscript-type">extern</span>	kern_return_t   dp_memory_object_data_request(memory_object_t, 
						      memory_object_offset_t,
						      memory_object_cluster_size_t,
						      vm_prot_t,
						      memory_object_fault_info_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">dp_memory_object_data_return</span>(memory_object_t,
						    memory_object_offset_t,
						    memory_object_cluster_size_t,
						    memory_object_offset_t *,
						    <span class="enscript-type">int</span> *,
						    boolean_t,
						    boolean_t,
						    <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">dp_memory_object_data_initialize</span>(memory_object_t,
						      memory_object_offset_t,
						      memory_object_cluster_size_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">dp_memory_object_data_unlock</span>(memory_object_t,
						  memory_object_offset_t,
						  memory_object_size_t,
						  vm_prot_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">dp_memory_object_synchronize</span>(memory_object_t,
						  memory_object_offset_t,
						  memory_object_size_t,
						  vm_sync_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">dp_memory_object_map</span>(memory_object_t,
					  vm_prot_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">dp_memory_object_last_unmap</span>(memory_object_t);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _memory_object_server_ */</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_memory_object_default_server_</span>
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">default_pager_memory_object_create</span>(
	memory_object_default_t,
	vm_size_t,
	memory_object_t *);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _memory_object_default_server_ */</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_FREEZE</span>
<span class="enscript-type">extern</span> <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">default_pager_swap_pages_free</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">struct</span> default_freezer_handle;
<span class="enscript-type">struct</span> vm_page;
__private_extern__ <span class="enscript-type">void</span>	default_freezer_init(<span class="enscript-type">void</span>);
__private_extern__ <span class="enscript-type">struct</span> default_freezer_handle* default_freezer_handle_allocate(<span class="enscript-type">void</span>);
__private_extern__ kern_return_t
<span class="enscript-function-name">default_freezer_handle_init</span>(
	<span class="enscript-type">struct</span>  default_freezer_handle *df_handle);
__private_extern__ <span class="enscript-type">void</span>
<span class="enscript-function-name">default_freezer_handle_deallocate</span>(
	<span class="enscript-type">struct</span> default_freezer_handle *df_handle);
__private_extern__ <span class="enscript-type">void</span>
<span class="enscript-function-name">default_freezer_pageout</span>(
	<span class="enscript-type">struct</span> default_freezer_handle *df_handle);
__private_extern__ kern_return_t
<span class="enscript-function-name">default_freezer_pack</span>(
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>		*purgeable_count,
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>		*wired_count,
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>		*clean_count,
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>		*dirty_count,
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>		dirty_budget,
	boolean_t		*shared,
	vm_object_t		src_object,
	<span class="enscript-type">struct</span> default_freezer_handle *df_handle);
__private_extern__ kern_return_t
<span class="enscript-function-name">default_freezer_unpack</span>(
	<span class="enscript-type">struct</span> default_freezer_handle *df_handle);	
__private_extern__ <span class="enscript-type">void</span>
<span class="enscript-function-name">default_freezer_pack_page</span>(
	<span class="enscript-type">struct</span> vm_page* p,
	<span class="enscript-type">struct</span> default_freezer_handle *df_handle);

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* CONFIG_FREEZE */</span>

<span class="enscript-type">extern</span> <span class="enscript-type">void</span>   <span class="enscript-function-name">device_pager_reference</span>(memory_object_t);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span>   <span class="enscript-function-name">device_pager_deallocate</span>(memory_object_t);
<span class="enscript-type">extern</span> kern_return_t   <span class="enscript-function-name">device_pager_init</span>(memory_object_t,
					 memory_object_control_t,
					 memory_object_cluster_size_t);
<span class="enscript-type">extern</span>	kern_return_t device_pager_terminate(memory_object_t);
<span class="enscript-type">extern</span>	kern_return_t   device_pager_data_request(memory_object_t, 
						  memory_object_offset_t,
						  memory_object_cluster_size_t,
						  vm_prot_t,
						  memory_object_fault_info_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_pager_data_return</span>(memory_object_t,
					      memory_object_offset_t,
					      memory_object_cluster_size_t,
					      memory_object_offset_t *,
					      <span class="enscript-type">int</span> *,
					      boolean_t,
					      boolean_t,
					      <span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_pager_data_initialize</span>(memory_object_t,
						  memory_object_offset_t,
						  memory_object_cluster_size_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_pager_data_unlock</span>(memory_object_t,
					      memory_object_offset_t,
					      memory_object_size_t,
					      vm_prot_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_pager_synchronize</span>(memory_object_t,
					      memory_object_offset_t,
					      memory_object_size_t,
					      vm_sync_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_pager_map</span>(memory_object_t, vm_prot_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_pager_last_unmap</span>(memory_object_t);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">device_pager_populate_object</span>(
	memory_object_t		device,
	memory_object_offset_t	offset,
	ppnum_t			page_num,
	vm_size_t		size);
<span class="enscript-type">extern</span> memory_object_t <span class="enscript-function-name">device_pager_setup</span>(
	memory_object_t,
	uintptr_t,
	vm_size_t,
	<span class="enscript-type">int</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">device_pager_bootstrap</span>(<span class="enscript-type">void</span>);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">pager_map_to_phys_contiguous</span>(
	memory_object_control_t	object,
	memory_object_offset_t	offset,
	addr64_t		base_vaddr,
	vm_size_t		size);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">memory_object_create_named</span>(
	memory_object_t	pager,
	memory_object_offset_t	size,
	memory_object_control_t		*control);

<span class="enscript-type">struct</span> macx_triggers_args;
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">mach_macx_triggers</span>(
	<span class="enscript-type">struct</span> macx_triggers_args	*args);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">macx_swapinfo</span>(
	memory_object_size_t	*total_p,
	memory_object_size_t	*avail_p,
	vm_size_t		*pagesize_p,
	boolean_t		*encrypted_p);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">log_stack_execution_failure</span>(addr64_t vaddr, vm_prot_t prot);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">log_unnest_badness</span>(vm_map_t, vm_map_offset_t, vm_map_offset_t);

<span class="enscript-type">struct</span> proc;
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">cs_allow_invalid</span>(<span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">cs_invalid_page</span>(addr64_t vaddr);

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CS_VALIDATE_TAINTED</span>	0x00000001
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">CS_VALIDATE_NX</span>		0x00000002
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">cs_validate_page</span>(<span class="enscript-type">void</span> *blobs,
				  memory_object_t pager,
				  memory_object_offset_t offset, 
				  <span class="enscript-type">const</span> <span class="enscript-type">void</span> *data,
				  <span class="enscript-type">unsigned</span> *result);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">mach_memory_entry_purgable_control</span>(
	ipc_port_t	entry_port,
	vm_purgable_t	control,
	<span class="enscript-type">int</span>		*state);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">mach_memory_entry_get_page_counts</span>(
	ipc_port_t	entry_port,
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	*resident_page_count,
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	*dirty_page_count);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">mach_memory_entry_page_op</span>(
	ipc_port_t		entry_port,
	vm_object_offset_t	offset,
	<span class="enscript-type">int</span>			ops,
	ppnum_t			*phys_entry,
	<span class="enscript-type">int</span>			*flags);

<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">mach_memory_entry_range_op</span>(
	ipc_port_t		entry_port,
	vm_object_offset_t	offset_beg,
	vm_object_offset_t	offset_end,
	<span class="enscript-type">int</span>                     ops,
	<span class="enscript-type">int</span>                     *range);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">mach_memory_entry_port_release</span>(ipc_port_t port);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">mach_destroy_memory_entry</span>(ipc_port_t port);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">mach_memory_entry_allocate</span>(
	<span class="enscript-type">struct</span> vm_named_entry **user_entry_p,
	ipc_port_t *user_handle_p);

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vm_paging_map_init</span>(<span class="enscript-type">void</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">macx_backing_store_compaction</span>(<span class="enscript-type">int</span> flags);
<span class="enscript-type">extern</span> <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">mach_vm_ctl_page_free_wanted</span>(<span class="enscript-type">void</span>);

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">no_paging_space_action</span>(<span class="enscript-type">void</span>);

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VM_TOGGLE_CLEAR</span>		0
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VM_TOGGLE_SET</span>		1
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">VM_TOGGLE_GETVALUE</span>	999
<span class="enscript-type">int</span> <span class="enscript-function-name">vm_toggle_entry_reuse</span>(<span class="enscript-type">int</span>, <span class="enscript-type">int</span>*);

#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SWAP_WRITE</span>		0x00000000	<span class="enscript-comment">/* Write buffer (pseudo flag). */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SWAP_READ</span>		0x00000001	<span class="enscript-comment">/* Read buffer. */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">SWAP_ASYNC</span>		0x00000002	<span class="enscript-comment">/* Start I/O, do not wait. */</span>

<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">vm_compressor_pager_init</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> kern_return_t <span class="enscript-function-name">compressor_memory_object_create</span>(
	memory_object_size_t,
	memory_object_t *);

<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">vm_compressor_low_on_space</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span>	 vm_swap_low_on_space(<span class="enscript-type">void</span>);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_JETSAM</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">proc_get_memstat_priority</span>(<span class="enscript-type">struct</span> proc*, boolean_t);
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* CONFIG_JETSAM */</span>

<span class="enscript-comment">/* the object purger. purges the next eligible object from memory. */</span>
<span class="enscript-comment">/* returns TRUE if an object was purged, otherwise FALSE. */</span>
boolean_t <span class="enscript-function-name">vm_purgeable_object_purge_one_unlocked</span>(<span class="enscript-type">int</span> force_purge_below_group);
<span class="enscript-type">void</span> <span class="enscript-function-name">vm_purgeable_disown</span>(task_t task);

<span class="enscript-type">struct</span> trim_list {
	uint64_t	tl_offset;
	uint64_t	tl_length;
	<span class="enscript-type">struct</span> trim_list *tl_next;
};

u_int32_t <span class="enscript-function-name">vnode_trim_list</span>(<span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> trim_list *tl, boolean_t route_only);

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">MAX_SWAPFILENAME_LEN</span>	1024
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">SWAPFILENAME_INDEX_LEN</span>	2	<span class="enscript-comment">/* Doesn't include the terminating NULL character */</span>

<span class="enscript-type">extern</span> <span class="enscript-type">char</span>	swapfilename[MAX_SWAPFILENAME_LEN + 1];

<span class="enscript-type">struct</span> vm_counters {
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	do_collapse_compressor;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	do_collapse_compressor_pages;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	do_collapse_terminate;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	do_collapse_terminate_failure;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	should_cow_but_wired;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	create_upl_extra_cow;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	create_upl_extra_cow_pages;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	create_upl_lookup_failure_write;
	<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>	create_upl_lookup_failure_copy;
};
<span class="enscript-type">extern</span> <span class="enscript-type">struct</span> vm_counters vm_counters;

#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* _VM_VM_PROTOS_H_ */</span>

#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* XNU_KERNEL_PRIVATE */</span>
</pre>
<hr />
</body></html>