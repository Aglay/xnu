<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>kpc.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">kpc.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2012 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">__KERN_KPC_H__</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__KERN_KPC_H__</span>

<span class="enscript-comment">/* Kernel interfaces to KPC PMC infrastructure. */</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;machine/machine_kpc.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;kern/thread.h&gt;</span> <span class="enscript-comment">/* thread_* */</span>

<span class="enscript-comment">/* cross-platform class constants */</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_FIXED</span>         (0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_CONFIGURABLE</span>  (1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_POWER</span>         (2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_RAWPMU</span>        (3)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_FIXED_MASK</span>         (1u &lt;&lt; KPC_CLASS_FIXED)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_CONFIGURABLE_MASK</span>  (1u &lt;&lt; KPC_CLASS_CONFIGURABLE)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_POWER_MASK</span>         (1u &lt;&lt; KPC_CLASS_POWER)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_CLASS_RAWPMU_MASK</span>        (1u &lt;&lt; KPC_CLASS_RAWPMU)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_PMU_ERROR</span>     (0)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_PMU_INTEL_V3</span>  (1)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_PMU_ARM_APPLE</span> (2)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_PMU_INTEL_V2</span>  (3)
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_PMU_ARM_V2</span>    (4)

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">KPC_ALL_CPUS</span> (1u &lt;&lt; 31)

<span class="enscript-comment">/* action id setters/getters */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">FIXED_ACTIONID</span>(ctr)			(kpc_actionid[(ctr)])
#<span class="enscript-reference">define</span> <span class="enscript-function-name">CONFIGURABLE_ACTIONID</span>(ctr)		(kpc_actionid[(ctr) + kpc_fixed_count()])

<span class="enscript-comment">/* reload counter setters/getters */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">FIXED_RELOAD</span>(ctr)			(current_cpu_datap()-&gt;cpu_kpc_reload[(ctr)])
#<span class="enscript-reference">define</span> <span class="enscript-function-name">FIXED_RELOAD_CPU</span>(cpu, ctr)		(cpu_datap(cpu)-&gt;cpu_kpc_reload[(ctr)])
#<span class="enscript-reference">define</span> <span class="enscript-function-name">CONFIGURABLE_RELOAD</span>(ctr)		(current_cpu_datap()-&gt;cpu_kpc_reload[(ctr) + kpc_fixed_count()])
#<span class="enscript-reference">define</span> <span class="enscript-function-name">CONFIGURABLE_RELOAD_CPU</span>(cpu, ctr)	(cpu_datap(cpu)-&gt;cpu_kpc_reload[(ctr) + kpc_fixed_count()])

<span class="enscript-comment">/* shadow counter setters/getters */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">FIXED_SHADOW</span>(ctr)			(current_cpu_datap()-&gt;cpu_kpc_shadow[(ctr)])
#<span class="enscript-reference">define</span> <span class="enscript-function-name">FIXED_SHADOW_CPU</span>(cpu, ctr)		(cpu_datap(cpu)-&gt;cpu_kpc_shadow[(ctr)])
#<span class="enscript-reference">define</span> <span class="enscript-function-name">CONFIGURABLE_SHADOW</span>(ctr) 		(current_cpu_datap()-&gt;cpu_kpc_shadow[(ctr) + kpc_fixed_count()])
#<span class="enscript-reference">define</span> <span class="enscript-function-name">CONFIGURABLE_SHADOW_CPU</span>(cpu, ctr) 	(cpu_datap(cpu)-&gt;cpu_kpc_shadow[(ctr) + kpc_fixed_count()])

<span class="enscript-comment">/**
 * Callback for notification when PMCs are acquired/released by a task. The
 * argument is equal to TRUE if the Power Manager (PM) can use its reserved PMCs.
 * Otherwise, the argument is equal to FALSE.
 */</span>
<span class="enscript-type">typedef</span> <span class="enscript-function-name">void</span> (*kpc_pm_handler_t)(boolean_t);

<span class="enscript-comment">/*
 * Register a CPU to kpc and allocate its buffers.
 *
 * @param cpu_data
 * CPU data associated to the CPU being registered.
 *
 * @return
 * TRUE if buffers are correctly allocated, FALSE otherwise.
 */</span>
<span class="enscript-type">struct</span> cpu_data;
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_register_cpu</span>(<span class="enscript-type">struct</span> cpu_data *cpu_data);

<span class="enscript-comment">/* bootstrap */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_init</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* common initialization */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_common_init</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* Architecture specific initialisation */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_arch_init</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* Thread counting initialization */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_thread_init</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* Get the bitmask of available classes */</span>
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_get_classes</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* Get the bitmask of currently running counter classes  */</span>
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_get_running</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* Get the version of KPC that's being run */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_pmu_version</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/* Set the bitmask of currently running counter classes. Specify
 * classes = 0 to stop counters
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_running</span>(uint32_t classes);

<span class="enscript-comment">/* Read CPU counters */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_cpu_counters</span>(boolean_t all_cpus, uint32_t classes, 
                                <span class="enscript-type">int</span> *curcpu, uint64_t *buf);

<span class="enscript-comment">/* Read shadow counters */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_shadow_counters</span>( boolean_t all_cpus, uint32_t classes,
                                    <span class="enscript-type">int</span> *curcpu, uint64_t *buf );

<span class="enscript-comment">/* Read current thread's counter accumulations */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_curthread_counters</span>(uint32_t *inoutcount, uint64_t *buf);

<span class="enscript-comment">/* Given a config, how many counters and config registers there are */</span>
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_get_counter_count</span>(uint32_t classes);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_get_config_count</span>(uint32_t classes);

<span class="enscript-comment">/* enable/disable thread counting */</span>
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_get_thread_counting</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span>      <span class="enscript-function-name">kpc_set_thread_counting</span>(uint32_t classes);

<span class="enscript-comment">/* get and set config registers */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_config</span>(uint32_t classes, kpc_config_t *current_config);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_config</span>(uint32_t classes, kpc_config_t *new_config);

<span class="enscript-comment">/* get and set PMI period */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_period</span>(uint32_t classes, uint64_t *period);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_period</span>(uint32_t classes, uint64_t *period);

<span class="enscript-comment">/* get and set kperf actionid */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_actionid</span>(uint32_t classes, uint32_t *actionid);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_actionid</span>(uint32_t classes, uint32_t *actionid);

<span class="enscript-comment">/* hooks on thread create and delete */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_thread_create</span>(thread_t thread);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_thread_destroy</span>(thread_t thread);

<span class="enscript-comment">/* allocate a buffer big enough for all counters */</span>
<span class="enscript-type">extern</span> uint64_t *<span class="enscript-function-name">kpc_counterbuf_alloc</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span>      <span class="enscript-function-name">kpc_counterbuf_free</span>(uint64_t*);

<span class="enscript-comment">/* whether we're currently accounting into threads */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> kpc_threads_counting;

<span class="enscript-comment">/* AST callback for KPC */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_thread_ast_handler</span>( thread_t thread );

<span class="enscript-comment">/* context switch accounting between two threads */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_switch_context</span>( thread_t old_thread, thread_t new_thread );

<span class="enscript-comment">/* acquire/release the counters used by the Power Manager */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_force_all_ctrs</span>( task_t task, <span class="enscript-type">int</span> val );
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_force_all_ctrs</span>( <span class="enscript-type">void</span> );

<span class="enscript-comment">/* arch-specific routine for acquire/release the counters used by the Power Manager */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_force_all_ctrs_arch</span>( task_t task, <span class="enscript-type">int</span> val );

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_sw_inc</span>( uint32_t mask );

<span class="enscript-comment">/* disable/enable whitelist of allowed events */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_whitelist_disabled</span>( <span class="enscript-type">void</span> );
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_disable_whitelist</span>( <span class="enscript-type">int</span> val );

<span class="enscript-comment">/*
 * Register the Power Manager as a PMCs user.
 *
 * This is a deprecated function used by old Power Managers, new Power Managers
 * should use the @em kpc_reserve_pm_counters() function. This function actually
 * calls @em kpc_reserve_pm_counters() with the following arguments:
 * 	- handler	= handler
 * 	- pmc_mask	= 0x83
 * 	- custom_config	= TRUE
 *
 * See @em kpc_reserve_pm_counters() for more details about the return value.
 */</span>
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_register_pm_handler</span>(<span class="enscript-type">void</span> (*handler)(boolean_t));

<span class="enscript-comment">/*
 * Register the Power Manager as a PMCs user.
 *
 * @param handler
 * Notification callback to use when PMCs are acquired/released by a task.
 *
 * @param pmc_mask
 * Bitmask of the configurable PMCs used by the Power Manager. The number of bits
 * set must less or equal than the number of configurable counters
 * available on the SoC.
 *
 * @param custom_config
 * If custom_config=TRUE, the legacy sharing mode is enabled, otherwise the
 * Modern Sharing mode is enabled. These modes are explained in more details in
 * the kperf documentation.
 *
 * @return
 * FALSE if a task has acquired all the PMCs, otherwise TRUE and the Power
 * Manager can start using the reserved PMCs.
 */</span>
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_reserve_pm_counters</span>(uint64_t pmc_mask, kpc_pm_handler_t handler,
                                         boolean_t custom_config);

<span class="enscript-comment">/*
 * Unregister the Power Manager as a PMCs user, and release the previously
 * reserved counters.
 */</span>
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_release_pm_counters</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/*
 * Is the PMU used by both the power manager and userspace?
 *
 * This is true when the power manager has been registered. It disables certain
 * counter configurations (like RAWPMU) that are incompatible with sharing
 * counters.
 */</span>
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_multiple_clients</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/*
 * Is kpc controlling the fixed counters?
 *
 * This returns false when the power manager has requested custom configuration
 * control.
 */</span>
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_controls_fixed_counters</span>(<span class="enscript-type">void</span>);

<span class="enscript-comment">/*
 * Is kpc controlling a specific PMC ?
 */</span>
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_controls_counter</span>(uint32_t ctr);


<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_idle</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_idle_exit</span>(<span class="enscript-type">void</span>);


<span class="enscript-comment">/*
 * KPC PRIVATE
 */</span>

<span class="enscript-type">extern</span> uint32_t kpc_actionid[KPC_MAX_COUNTERS];

<span class="enscript-comment">/* handler for mp operations */</span>
<span class="enscript-type">struct</span> kpc_config_remote {
	uint32_t classes;
	kpc_config_t *configv;
	uint64_t pmc_mask;
};

<span class="enscript-comment">/* handler for mp operations */</span>
<span class="enscript-type">struct</span> kpc_running_remote {
	uint32_t	classes;		<span class="enscript-comment">/* classes to run */</span>
	uint64_t	cfg_target_mask;	<span class="enscript-comment">/* configurable counters selected */</span>
	uint64_t	cfg_state_mask;		<span class="enscript-comment">/* configurable counters new state */</span>
};

<span class="enscript-comment">/* handler for mp operations */</span>
<span class="enscript-type">struct</span> kpc_get_counters_remote {
	uint32_t classes;
	uint32_t nb_counters;
	uint32_t buf_stride;
	uint64_t *buf;
};

<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_all_cpus_counters</span>(uint32_t classes, <span class="enscript-type">int</span> *curcpu, uint64_t *buf);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_curcpu_counters</span>(uint32_t classes, <span class="enscript-type">int</span> *curcpu, uint64_t *buf);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_fixed_counters</span>(uint64_t *counterv);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_configurable_counters</span>(uint64_t *counterv, uint64_t pmc_mask);
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_is_running_fixed</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> boolean_t <span class="enscript-function-name">kpc_is_running_configurable</span>(uint64_t pmc_mask);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_fixed_count</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_configurable_count</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_fixed_config_count</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_configurable_config_count</span>(uint64_t pmc_mask);
<span class="enscript-type">extern</span> uint32_t <span class="enscript-function-name">kpc_rawpmu_config_count</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_fixed_config</span>(kpc_config_t *configv);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_configurable_config</span>(kpc_config_t *configv, uint64_t pmc_mask);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_get_rawpmu_config</span>(kpc_config_t *configv);
<span class="enscript-type">extern</span> uint64_t <span class="enscript-function-name">kpc_fixed_max</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> uint64_t <span class="enscript-function-name">kpc_configurable_max</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_config_arch</span>(<span class="enscript-type">struct</span> kpc_config_remote *mp_config);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_period_arch</span>(<span class="enscript-type">struct</span> kpc_config_remote *mp_config);
<span class="enscript-type">extern</span> <span class="enscript-type">void</span> <span class="enscript-function-name">kpc_sample_kperf</span>(uint32_t actionid);
<span class="enscript-type">extern</span> <span class="enscript-type">int</span> <span class="enscript-function-name">kpc_set_running_arch</span>(<span class="enscript-type">struct</span> kpc_running_remote *mp_config);


<span class="enscript-comment">/*
 * Helpers
 */</span>

<span class="enscript-comment">/* count the number of bits set */</span>
<span class="enscript-type">extern</span> uint8_t <span class="enscript-function-name">kpc_popcount</span>(uint64_t value);

<span class="enscript-comment">/* for a set of classes, retrieve the configurable PMCs mask */</span>
<span class="enscript-type">extern</span> uint64_t <span class="enscript-function-name">kpc_get_configurable_pmc_mask</span>(uint32_t classes);


<span class="enscript-comment">/* Interface for kexts to publish a kpc interface */</span>
<span class="enscript-type">struct</span> kpc_driver
{
	uint32_t (*get_classes)(<span class="enscript-type">void</span>);
	uint32_t (*get_running)(<span class="enscript-type">void</span>);
	<span class="enscript-type">int</span>      (*set_running)(uint32_t classes);
	<span class="enscript-type">int</span>      (*get_cpu_counters)(boolean_t all_cpus, uint32_t classes, 
	                             <span class="enscript-type">int</span> *curcpu, uint64_t *buf);
	<span class="enscript-type">int</span>      (*get_curthread_counters)(uint32_t *inoutcount, uint64_t *buf);
	uint32_t (*get_counter_count)(uint32_t classes);
	uint32_t (*get_config_count)(uint32_t classes);
	<span class="enscript-type">int</span>      (*get_config)(uint32_t classes, kpc_config_t *current_config);
	<span class="enscript-type">int</span>      (*set_config)(uint32_t classes, kpc_config_t *new_config);
	<span class="enscript-type">int</span>      (*get_period)(uint32_t classes, uint64_t *period);
	<span class="enscript-type">int</span>      (*set_period)(uint32_t classes, uint64_t *period);
};

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __KERN_KPC_H__ */</span>
</pre>
<hr />
</body></html>