<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>mac_framework.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">mac_framework.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 2007 Apple Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*-
 * Copyright (c) 1999-2002 Robert N. M. Watson
 * Copyright (c) 2001-2005 Networks Associates Technology, Inc.
 * Copyright (c) 2005-2007 SPARTA, Inc.
 * All rights reserved.
 *
 * This software was developed by Robert Watson for the TrustedBSD Project.
 *
 * This software was developed for the FreeBSD Project in part by Network
 * Associates Laboratories, the Security Research Division of Network
 * Associates, Inc. under DARPA/SPAWAR contract N66001-01-C-8035 (&quot;CBOSS&quot;),
 * as part of the DARPA CHATS research program.
 *
 * This software was enhanced by SPARTA ISSO under SPAWAR contract
 * N66001-04-C-6019 (&quot;SEFOS&quot;).
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 * $FreeBSD: src/sys/sys/mac.h,v 1.40 2003/04/18 19:57:37 rwatson Exp $
 *
 */</span>
<span class="enscript-comment">/*
 * Kernel interface for Mandatory Access Control -- how kernel services
 * interact with the TrustedBSD MAC Framework.
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_SECURITY_MAC_FRAMEWORK_H_</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_SECURITY_MAC_FRAMEWORK_H_</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">error</span> <span class="enscript-string">&quot;no user-serviceable parts inside&quot;</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">PRIVATE</span>
#<span class="enscript-reference">warning</span> <span class="enscript-string">&quot;MAC policy is not KPI, see Technical Q&amp;A QA1574, this header will be removed in next version&quot;</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-type">struct</span> attrlist;
<span class="enscript-type">struct</span> auditinfo;
<span class="enscript-type">struct</span> bpf_d;
<span class="enscript-type">struct</span> componentname;
<span class="enscript-type">struct</span> devnode;
<span class="enscript-type">struct</span> flock;
<span class="enscript-type">struct</span> fdescnode;
<span class="enscript-type">struct</span> fileglob;
<span class="enscript-type">struct</span> fileproc;
<span class="enscript-type">struct</span> ifnet;
<span class="enscript-type">struct</span> ifreq;
<span class="enscript-type">struct</span> image_params;
<span class="enscript-type">struct</span> inpcb;
<span class="enscript-type">struct</span> ipc_port;
<span class="enscript-type">struct</span> ipq;
<span class="enscript-type">struct</span> knote;
<span class="enscript-type">struct</span> m_tag;
<span class="enscript-type">struct</span> mac;
<span class="enscript-type">struct</span> mac_module_data;
<span class="enscript-type">struct</span> mbuf;
<span class="enscript-type">struct</span> msg;
<span class="enscript-type">struct</span> msqid_kernel;
<span class="enscript-type">struct</span> mount;
<span class="enscript-type">struct</span> pipe;
<span class="enscript-type">struct</span> proc;
<span class="enscript-type">struct</span> pseminfo;
<span class="enscript-type">struct</span> pshminfo;
<span class="enscript-type">struct</span> semid_kernel;
<span class="enscript-type">struct</span> shmid_kernel;
<span class="enscript-type">struct</span> sockaddr;
<span class="enscript-type">struct</span> sockopt;
<span class="enscript-type">struct</span> socket;
<span class="enscript-type">struct</span> task;
<span class="enscript-type">struct</span> thread;
<span class="enscript-type">struct</span> timespec;
<span class="enscript-type">struct</span> tty;
<span class="enscript-type">struct</span> ucred;
<span class="enscript-type">struct</span> uio;
<span class="enscript-type">struct</span> uthread;
<span class="enscript-type">struct</span> vfs_attr;
<span class="enscript-type">struct</span> vfs_context;
<span class="enscript-type">struct</span> vnode;
<span class="enscript-type">struct</span> vnode_attr;
<span class="enscript-type">struct</span> vop_setlabel_args;

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/kauth.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/kernel_types.h&gt;</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_MACF</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">__IOKIT_PORTS_DEFINED__</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__IOKIT_PORTS_DEFINED__</span>
#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__cplusplus</span>
class OSObject;
<span class="enscript-type">typedef</span> OSObject *io_object_t;
#<span class="enscript-reference">else</span>
<span class="enscript-type">struct</span> OSObject;
<span class="enscript-type">typedef</span> <span class="enscript-type">struct</span> OSObject *io_object_t;
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __IOKIT_PORTS_DEFINED__ */</span>

<span class="enscript-comment">/*@ macros */</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">VNODE_LABEL_CREATE</span>	1

<span class="enscript-comment">/*@ === */</span>
<span class="enscript-type">int</span>	mac_audit_check_postselect(kauth_cred_t cred, <span class="enscript-type">unsigned</span> <span class="enscript-type">short</span> syscode,
	    <span class="enscript-type">void</span> *args, <span class="enscript-type">int</span> error, <span class="enscript-type">int</span> retval, <span class="enscript-type">int</span> mac_forced);
<span class="enscript-type">int</span>	mac_audit_check_preselect(kauth_cred_t cred, <span class="enscript-type">unsigned</span> <span class="enscript-type">short</span> syscode,
	    <span class="enscript-type">void</span> *args);
<span class="enscript-type">int</span>	mac_bpfdesc_check_receive(<span class="enscript-type">struct</span> bpf_d *bpf_d, <span class="enscript-type">struct</span> ifnet *ifp);
<span class="enscript-type">void</span>	mac_bpfdesc_label_destroy(<span class="enscript-type">struct</span> bpf_d *bpf_d);
<span class="enscript-type">void</span>	mac_bpfdesc_label_init(<span class="enscript-type">struct</span> bpf_d *bpf_d);
<span class="enscript-type">void</span>	mac_bpfdesc_label_associate(kauth_cred_t cred, <span class="enscript-type">struct</span> bpf_d *bpf_d);
<span class="enscript-type">int</span>	mac_cred_check_label_update(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> label *newlabel);
<span class="enscript-type">int</span>	mac_cred_check_label_update_execve(vfs_context_t ctx,
	    <span class="enscript-type">struct</span> vnode *vp, off_t offset, <span class="enscript-type">struct</span> vnode *scriptvp,
	    <span class="enscript-type">struct</span> label *scriptvnodelabel, <span class="enscript-type">struct</span> label *execlabel,
	    proc_t proc, <span class="enscript-type">void</span> *macextensions);
<span class="enscript-type">int</span>	mac_cred_check_visible(kauth_cred_t u1, kauth_cred_t u2);
<span class="enscript-type">struct</span> label	*mac_cred_label_alloc(<span class="enscript-type">void</span>);
<span class="enscript-type">void</span>	mac_cred_label_associate(kauth_cred_t cred_parent,
	    kauth_cred_t cred_child);
<span class="enscript-type">void</span>	mac_cred_label_associate_fork(kauth_cred_t cred, proc_t child);
<span class="enscript-type">void</span>	mac_cred_label_associate_kernel(kauth_cred_t cred);
<span class="enscript-type">void</span>	mac_cred_label_associate_user(kauth_cred_t cred);
<span class="enscript-type">void</span>	mac_cred_label_destroy(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_cred_label_externalize_audit(proc_t p, <span class="enscript-type">struct</span> mac *mac);
<span class="enscript-type">void</span>	mac_cred_label_free(<span class="enscript-type">struct</span> label *label);
<span class="enscript-type">void</span>	mac_cred_label_init(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_cred_label_compare(<span class="enscript-type">struct</span> label *a, <span class="enscript-type">struct</span> label *b);
<span class="enscript-type">void</span>	mac_cred_label_update(kauth_cred_t cred, <span class="enscript-type">struct</span> label *newlabel);
<span class="enscript-type">void</span>	mac_cred_label_update_execve(vfs_context_t ctx, kauth_cred_t newcred,
	    <span class="enscript-type">struct</span> vnode *vp, off_t offset, <span class="enscript-type">struct</span> vnode *scriptvp,
	    <span class="enscript-type">struct</span> label *scriptvnodelabel, <span class="enscript-type">struct</span> label *execlabel, u_int *csflags,
	    <span class="enscript-type">void</span> *macextensions, <span class="enscript-type">int</span> *disjoint, <span class="enscript-type">int</span> *labelupdateerror);
<span class="enscript-type">void</span>	mac_devfs_label_associate_device(dev_t dev, <span class="enscript-type">struct</span> devnode *de,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *fullpath);
<span class="enscript-type">void</span>	mac_devfs_label_associate_directory(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *dirname, <span class="enscript-type">int</span> dirnamelen,
	    <span class="enscript-type">struct</span> devnode *de, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *fullpath);
<span class="enscript-type">void</span>	mac_devfs_label_copy(<span class="enscript-type">struct</span> label *, <span class="enscript-type">struct</span> label *label);
<span class="enscript-type">void</span>	mac_devfs_label_destroy(<span class="enscript-type">struct</span> devnode *de);
<span class="enscript-type">void</span>	mac_devfs_label_init(<span class="enscript-type">struct</span> devnode *de);
<span class="enscript-type">void</span>	mac_devfs_label_update(<span class="enscript-type">struct</span> mount *mp, <span class="enscript-type">struct</span> devnode *de,
	    <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_execve_enter(user_addr_t mac_p, <span class="enscript-type">struct</span> image_params *imgp);
<span class="enscript-type">int</span>	mac_file_check_change_offset(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg);
<span class="enscript-type">int</span>	mac_file_check_create(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_file_check_dup(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg, <span class="enscript-type">int</span> newfd);
<span class="enscript-type">int</span>	mac_file_check_fcntl(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg, <span class="enscript-type">int</span> cmd,
	    user_long_t arg);
<span class="enscript-type">int</span>	mac_file_check_get(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg,
	    <span class="enscript-type">char</span> *elements, <span class="enscript-type">int</span> len);
<span class="enscript-type">int</span>	mac_file_check_get_offset(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg);
<span class="enscript-type">int</span>	mac_file_check_inherit(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg);
<span class="enscript-type">int</span>	mac_file_check_ioctl(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg,
	    <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_file_check_lock(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg, <span class="enscript-type">int</span> op,
	    <span class="enscript-type">struct</span> flock *fl);
<span class="enscript-type">int</span>	mac_file_check_mmap(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg,
	    <span class="enscript-type">int</span> prot, <span class="enscript-type">int</span> flags, uint64_t file_pos, <span class="enscript-type">int</span> *maxprot);
<span class="enscript-type">void</span>	mac_file_check_mmap_downgrade(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg,
	    <span class="enscript-type">int</span> *prot);
<span class="enscript-type">int</span>	mac_file_check_receive(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg);
<span class="enscript-type">int</span>	mac_file_check_set(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg,
	    <span class="enscript-type">char</span> *bufp, <span class="enscript-type">int</span> buflen);
<span class="enscript-type">void</span>	mac_file_label_associate(kauth_cred_t cred, <span class="enscript-type">struct</span> fileglob *fg);
<span class="enscript-type">void</span>	mac_file_label_destroy(<span class="enscript-type">struct</span> fileglob *fg);
<span class="enscript-type">void</span>	mac_file_label_init(<span class="enscript-type">struct</span> fileglob *fg);
<span class="enscript-type">int</span>	mac_ifnet_check_transmit(<span class="enscript-type">struct</span> ifnet *ifp, <span class="enscript-type">struct</span> mbuf *mbuf,
	    <span class="enscript-type">int</span> family, <span class="enscript-type">int</span> type);
<span class="enscript-type">void</span>	mac_ifnet_label_associate(<span class="enscript-type">struct</span> ifnet *ifp);
<span class="enscript-type">void</span>	mac_ifnet_label_destroy(<span class="enscript-type">struct</span> ifnet *ifp);
<span class="enscript-type">int</span>	mac_ifnet_label_get(kauth_cred_t cred, <span class="enscript-type">struct</span> ifreq *ifr,
	    <span class="enscript-type">struct</span> ifnet *ifp);
<span class="enscript-type">void</span>	mac_ifnet_label_init(<span class="enscript-type">struct</span> ifnet *ifp);
<span class="enscript-type">void</span>	mac_ifnet_label_recycle(<span class="enscript-type">struct</span> ifnet *ifp);
<span class="enscript-type">int</span>	mac_ifnet_label_set(kauth_cred_t cred, <span class="enscript-type">struct</span> ifreq *ifr,
	    <span class="enscript-type">struct</span> ifnet *ifp);
<span class="enscript-type">int</span>	mac_inpcb_check_deliver(<span class="enscript-type">struct</span> inpcb *inp, <span class="enscript-type">struct</span> mbuf *mbuf,
	    <span class="enscript-type">int</span> family, <span class="enscript-type">int</span> type);
<span class="enscript-type">void</span>	mac_inpcb_label_associate(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> inpcb *inp);
<span class="enscript-type">void</span>	mac_inpcb_label_destroy(<span class="enscript-type">struct</span> inpcb *inp);
<span class="enscript-type">int</span>	mac_inpcb_label_init(<span class="enscript-type">struct</span> inpcb *inp, <span class="enscript-type">int</span> flag);
<span class="enscript-type">void</span>	mac_inpcb_label_recycle(<span class="enscript-type">struct</span> inpcb *inp);
<span class="enscript-type">void</span>	mac_inpcb_label_update(<span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">int</span>	mac_iokit_check_device(<span class="enscript-type">char</span> *devtype, <span class="enscript-type">struct</span> mac_module_data *mdata);
<span class="enscript-type">int</span>	mac_iokit_check_open(kauth_cred_t cred, io_object_t user_client, <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> user_client_type);
<span class="enscript-type">int</span>	mac_iokit_check_set_properties(kauth_cred_t cred, io_object_t registry_entry, io_object_t properties);
<span class="enscript-type">int</span>	mac_iokit_check_filter_properties(kauth_cred_t cred, io_object_t registry_entry);
<span class="enscript-type">int</span>	mac_iokit_check_get_property(kauth_cred_t cred, io_object_t registry_entry, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_iokit_check_hid_control(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_iokit_check_nvram_delete(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_iokit_check_nvram_get(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_iokit_check_nvram_set(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name, io_object_t value);
<span class="enscript-type">void</span>	mac_ipq_label_associate(<span class="enscript-type">struct</span> mbuf *fragment, <span class="enscript-type">struct</span> ipq *ipq);
<span class="enscript-type">int</span>	mac_ipq_label_compare(<span class="enscript-type">struct</span> mbuf *fragment, <span class="enscript-type">struct</span> ipq *ipq);
<span class="enscript-type">void</span>	mac_ipq_label_destroy(<span class="enscript-type">struct</span> ipq *ipq);
<span class="enscript-type">int</span>	mac_ipq_label_init(<span class="enscript-type">struct</span> ipq *ipq, <span class="enscript-type">int</span> flag);
<span class="enscript-type">void</span>	mac_ipq_label_update(<span class="enscript-type">struct</span> mbuf *fragment, <span class="enscript-type">struct</span> ipq *ipq);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_bpfdesc(<span class="enscript-type">struct</span> bpf_d *bpf_d, <span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_ifnet(<span class="enscript-type">struct</span> ifnet *ifp, <span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_inpcb(<span class="enscript-type">struct</span> inpcb *inp, <span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_ipq(<span class="enscript-type">struct</span> ipq *ipq, <span class="enscript-type">struct</span> mbuf *mbuf);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_linklayer(<span class="enscript-type">struct</span> ifnet *ifp, <span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_multicast_encap(<span class="enscript-type">struct</span> mbuf *oldmbuf,
	    <span class="enscript-type">struct</span> ifnet *ifp, <span class="enscript-type">struct</span> mbuf *newmbuf);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_netlayer(<span class="enscript-type">struct</span> mbuf *oldmbuf,
	    <span class="enscript-type">struct</span> mbuf *newmbuf);
<span class="enscript-type">void</span>	mac_mbuf_label_associate_socket(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">void</span>	mac_mbuf_label_copy(<span class="enscript-type">struct</span> mbuf *m_from, <span class="enscript-type">struct</span> mbuf *m_to);
<span class="enscript-type">void</span>	mac_mbuf_label_destroy(<span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">int</span>	mac_mbuf_label_init(<span class="enscript-type">struct</span> mbuf *m, <span class="enscript-type">int</span> flag);
<span class="enscript-type">void</span>	mac_mbuf_tag_copy(<span class="enscript-type">struct</span> m_tag *m, <span class="enscript-type">struct</span> m_tag *mtag);
<span class="enscript-type">void</span>	mac_mbuf_tag_destroy(<span class="enscript-type">struct</span> m_tag *mtag);
<span class="enscript-type">int</span>	mac_mbuf_tag_init(<span class="enscript-type">struct</span> m_tag *, <span class="enscript-type">int</span> how);
<span class="enscript-type">int</span>	mac_mount_check_fsctl(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp,
	    <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_mount_check_getattr(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp,
	    <span class="enscript-type">struct</span> vfs_attr *vfa);
<span class="enscript-type">int</span>	mac_mount_check_label_update(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp);
<span class="enscript-type">int</span>	mac_mount_check_mount(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> componentname *cnp, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *vfc_name);
<span class="enscript-type">int</span>	mac_mount_check_remount(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp);
<span class="enscript-type">int</span>	mac_mount_check_setattr(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp,
	    <span class="enscript-type">struct</span> vfs_attr *vfa);
<span class="enscript-type">int</span>	mac_mount_check_stat(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp);
<span class="enscript-type">int</span>	mac_mount_check_umount(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp);
<span class="enscript-type">void</span>	mac_mount_label_associate(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp);
<span class="enscript-type">void</span>	mac_mount_label_destroy(<span class="enscript-type">struct</span> mount *mp);
<span class="enscript-type">int</span>	mac_mount_label_externalize(<span class="enscript-type">struct</span> label *label, <span class="enscript-type">char</span> *elements,
	    <span class="enscript-type">char</span> *outbuf, size_t outbuflen);
<span class="enscript-type">int</span>	mac_mount_label_get(<span class="enscript-type">struct</span> mount *mp, user_addr_t mac_p);
<span class="enscript-type">void</span>	mac_mount_label_init(<span class="enscript-type">struct</span> mount *);
<span class="enscript-type">int</span>	mac_mount_label_internalize(<span class="enscript-type">struct</span> label *, <span class="enscript-type">char</span> *string);
<span class="enscript-type">void</span>	mac_netinet_fragment(<span class="enscript-type">struct</span> mbuf *datagram, <span class="enscript-type">struct</span> mbuf *fragment);
<span class="enscript-type">void</span>	mac_netinet_icmp_reply(<span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">void</span>	mac_netinet_tcp_reply(<span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">int</span>	mac_pipe_check_ioctl(kauth_cred_t cred, <span class="enscript-type">struct</span> pipe *cpipe,
	    <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_pipe_check_kqfilter(kauth_cred_t cred, <span class="enscript-type">struct</span> knote *kn,
	    <span class="enscript-type">struct</span> pipe *cpipe);
<span class="enscript-type">int</span>	mac_pipe_check_read(kauth_cred_t cred, <span class="enscript-type">struct</span> pipe *cpipe);
<span class="enscript-type">int</span>	mac_pipe_check_select(kauth_cred_t cred, <span class="enscript-type">struct</span> pipe *cpipe,
	    <span class="enscript-type">int</span> which);
<span class="enscript-type">int</span>	mac_pipe_check_stat(kauth_cred_t cred, <span class="enscript-type">struct</span> pipe *cpipe);
<span class="enscript-type">int</span>	mac_pipe_check_write(kauth_cred_t cred, <span class="enscript-type">struct</span> pipe *cpipe);
<span class="enscript-type">struct</span> label	*mac_pipe_label_alloc(<span class="enscript-type">void</span>);
<span class="enscript-type">void</span>	mac_pipe_label_associate(kauth_cred_t cred, <span class="enscript-type">struct</span> pipe *cpipe);
<span class="enscript-type">void</span>	mac_pipe_label_copy(<span class="enscript-type">struct</span> label *src, <span class="enscript-type">struct</span> label *dest);
<span class="enscript-type">void</span>	mac_pipe_label_destroy(<span class="enscript-type">struct</span> pipe *cpipe);
<span class="enscript-type">void</span>	mac_pipe_label_free(<span class="enscript-type">struct</span> label *label);
<span class="enscript-type">void</span>	mac_pipe_label_init(<span class="enscript-type">struct</span> pipe *cpipe);
<span class="enscript-type">int</span>	mac_pipe_label_update(kauth_cred_t cred, <span class="enscript-type">struct</span> pipe *cpipe,
	    <span class="enscript-type">struct</span> label *label);
<span class="enscript-type">void</span>    <span class="enscript-function-name">mac_policy_initbsd</span>(<span class="enscript-type">void</span>);
<span class="enscript-type">int</span>	mac_posixsem_check_create(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_posixsem_check_open(kauth_cred_t cred, <span class="enscript-type">struct</span> pseminfo *psem);
<span class="enscript-type">int</span>	mac_posixsem_check_post(kauth_cred_t cred, <span class="enscript-type">struct</span> pseminfo *psem);
<span class="enscript-type">int</span>	mac_posixsem_check_unlink(kauth_cred_t cred, <span class="enscript-type">struct</span> pseminfo *psem,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_posixsem_check_wait(kauth_cred_t cred, <span class="enscript-type">struct</span> pseminfo *psem);
<span class="enscript-type">void</span>	mac_posixsem_vnode_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> pseminfo *psem, <span class="enscript-type">struct</span> label *plabel,
	    vnode_t vp, <span class="enscript-type">struct</span> label *vlabel);
<span class="enscript-type">void</span>	mac_posixsem_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> pseminfo *psem, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">void</span>	mac_posixsem_label_destroy(<span class="enscript-type">struct</span> pseminfo *psem);
<span class="enscript-type">void</span>	mac_posixsem_label_init(<span class="enscript-type">struct</span> pseminfo *psem);
<span class="enscript-type">int</span>	mac_posixshm_check_create(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_posixshm_check_mmap(kauth_cred_t cred, <span class="enscript-type">struct</span> pshminfo *pshm,
	    <span class="enscript-type">int</span> prot, <span class="enscript-type">int</span> flags);
<span class="enscript-type">int</span>	mac_posixshm_check_open(kauth_cred_t cred, <span class="enscript-type">struct</span> pshminfo *pshm,
	    <span class="enscript-type">int</span> fflags);
<span class="enscript-type">int</span>	mac_posixshm_check_stat(kauth_cred_t cred, <span class="enscript-type">struct</span> pshminfo *pshm);
<span class="enscript-type">int</span>	mac_posixshm_check_truncate(kauth_cred_t cred, <span class="enscript-type">struct</span> pshminfo *pshm,
	    off_t s);
<span class="enscript-type">int</span>	mac_posixshm_check_unlink(kauth_cred_t cred, <span class="enscript-type">struct</span> pshminfo *pshm,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">void</span>	mac_posixshm_vnode_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> pshminfo *pshm, <span class="enscript-type">struct</span> label *plabel,
	    vnode_t vp, <span class="enscript-type">struct</span> label *vlabel);
<span class="enscript-type">void</span>	mac_posixshm_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> pshminfo *pshm, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">void</span>	mac_posixshm_label_destroy(<span class="enscript-type">struct</span> pshminfo *pshm);
<span class="enscript-type">void</span>	mac_posixshm_label_init(<span class="enscript-type">struct</span> pshminfo *pshm);
<span class="enscript-type">int</span>	mac_priv_check(kauth_cred_t cred, <span class="enscript-type">int</span> priv);
<span class="enscript-type">int</span>	mac_priv_grant(kauth_cred_t cred, <span class="enscript-type">int</span> priv);
<span class="enscript-type">int</span>	mac_proc_check_debug(proc_t proc1, proc_t proc2);
<span class="enscript-type">int</span>	mac_proc_check_cpumon(proc_t curp);
<span class="enscript-type">int</span>	mac_proc_check_proc_info(proc_t curp, proc_t target, <span class="enscript-type">int</span> callnum, <span class="enscript-type">int</span> flavor);
<span class="enscript-type">int</span>	mac_proc_check_fork(proc_t proc);
<span class="enscript-type">int</span>	mac_proc_check_suspend_resume(proc_t proc, <span class="enscript-type">int</span> sr);
<span class="enscript-type">int</span>	mac_proc_check_get_task_name(kauth_cred_t cred, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">int</span>	mac_proc_check_get_task(kauth_cred_t cred, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">int</span>	mac_proc_check_expose_task(kauth_cred_t cred, <span class="enscript-type">struct</span> proc *p);
<span class="enscript-type">int</span>	mac_proc_check_inherit_ipc_ports(<span class="enscript-type">struct</span> proc *p, <span class="enscript-type">struct</span> vnode *cur_vp, off_t cur_offset, <span class="enscript-type">struct</span> vnode *img_vp, off_t img_offset, <span class="enscript-type">struct</span> vnode *scriptvp);
<span class="enscript-type">int</span>	mac_proc_check_getaudit(proc_t proc);
<span class="enscript-type">int</span>	mac_proc_check_getauid(proc_t proc);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_proc_check_getlcid</span>(proc_t proc1, proc_t proc2,
	    pid_t pid);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_proc_check_ledger</span>(proc_t curp, proc_t target, <span class="enscript-type">int</span> op);
<span class="enscript-type">int</span>	mac_proc_check_map_anon(proc_t proc, user_addr_t u_addr,
	    user_size_t u_size, <span class="enscript-type">int</span> prot, <span class="enscript-type">int</span> flags, <span class="enscript-type">int</span> *maxprot);
<span class="enscript-type">int</span>	mac_proc_check_mprotect(proc_t proc,
	    user_addr_t addr, user_size_t size, <span class="enscript-type">int</span> prot);
<span class="enscript-type">int</span>	mac_proc_check_run_cs_invalid(proc_t proc);
<span class="enscript-type">int</span>	mac_proc_check_sched(proc_t proc, proc_t proc2);
<span class="enscript-type">int</span>	mac_proc_check_setaudit(proc_t proc, <span class="enscript-type">struct</span> auditinfo_addr *ai);
<span class="enscript-type">int</span>	mac_proc_check_setauid(proc_t proc, uid_t auid);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_proc_check_setlcid</span>(proc_t proc1, proc_t proc2,
	    pid_t pid1, pid_t pid2);
<span class="enscript-type">int</span>	mac_proc_check_signal(proc_t proc1, proc_t proc2,
	    <span class="enscript-type">int</span> signum);
<span class="enscript-type">int</span>	mac_proc_check_wait(proc_t proc1, proc_t proc2);
<span class="enscript-type">void</span>	mac_proc_set_enforce(proc_t p, <span class="enscript-type">int</span> enforce_flags);
<span class="enscript-type">int</span>	mac_setsockopt_label(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> mac *extmac);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_socket_check_accept</span>(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_socket_check_accepted</span>(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">int</span>	mac_socket_check_bind(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> sockaddr *addr);
<span class="enscript-type">int</span>	mac_socket_check_connect(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> sockaddr *addr);
<span class="enscript-type">int</span>	mac_socket_check_create(kauth_cred_t cred, <span class="enscript-type">int</span> domain,
	    <span class="enscript-type">int</span> type, <span class="enscript-type">int</span> protocol);
<span class="enscript-type">int</span>	mac_socket_check_deliver(<span class="enscript-type">struct</span> socket *so, <span class="enscript-type">struct</span> mbuf *m);
<span class="enscript-type">int</span>	mac_socket_check_kqfilter(kauth_cred_t cred, <span class="enscript-type">struct</span> knote *kn,
	    <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">int</span>	mac_socket_check_listen(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">int</span>	mac_socket_check_receive(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">int</span>	mac_socket_check_received(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so, 
	    <span class="enscript-type">struct</span> sockaddr *saddr);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_socket_check_select</span>(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">int</span> which);
<span class="enscript-type">int</span>	mac_socket_check_send(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> sockaddr *addr);
<span class="enscript-type">int</span>	mac_socket_check_getsockopt(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> sockopt *sopt);
<span class="enscript-type">int</span>	mac_socket_check_setsockopt(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> sockopt *sopt);
<span class="enscript-type">int</span>	mac_socket_check_stat(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">void</span>	mac_socket_label_associate(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">void</span>	mac_socket_label_associate_accept(<span class="enscript-type">struct</span> socket *oldsocket,
	    <span class="enscript-type">struct</span> socket *newsocket);
<span class="enscript-type">void</span>	mac_socket_label_copy(<span class="enscript-type">struct</span> label *from, <span class="enscript-type">struct</span> label *to);
<span class="enscript-type">void</span>	mac_socket_label_destroy(<span class="enscript-type">struct</span> socket *);
<span class="enscript-type">int</span>	mac_socket_label_get(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> mac *extmac);
<span class="enscript-type">int</span>	mac_socket_label_init(<span class="enscript-type">struct</span> socket *, <span class="enscript-type">int</span> waitok);
<span class="enscript-type">void</span>	mac_socketpeer_label_associate_mbuf(<span class="enscript-type">struct</span> mbuf *m, <span class="enscript-type">struct</span> socket *so);
<span class="enscript-type">void</span>	mac_socketpeer_label_associate_socket(<span class="enscript-type">struct</span> socket *peersocket,
	    <span class="enscript-type">struct</span> socket *socket_to_modify);
<span class="enscript-type">int</span>	mac_socketpeer_label_get(kauth_cred_t cred, <span class="enscript-type">struct</span> socket *so,
	    <span class="enscript-type">struct</span> mac *extmac);
<span class="enscript-type">int</span>	mac_system_check_acct(kauth_cred_t cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_system_check_audit(kauth_cred_t cred, <span class="enscript-type">void</span> *record, <span class="enscript-type">int</span> length);
<span class="enscript-type">int</span>	mac_system_check_auditctl(kauth_cred_t cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_system_check_auditon(kauth_cred_t cred, <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_system_check_chud(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_system_check_host_priv(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_system_check_info(kauth_cred_t, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *info_type);
<span class="enscript-type">int</span>	mac_system_check_nfsd(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_system_check_reboot(kauth_cred_t cred, <span class="enscript-type">int</span> howto);
<span class="enscript-type">int</span>	mac_system_check_settime(kauth_cred_t cred);
<span class="enscript-type">int</span>	mac_system_check_swapoff(kauth_cred_t cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_system_check_swapon(kauth_cred_t cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_system_check_sysctlbyname(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *namestring, <span class="enscript-type">int</span> *name,
				      u_int namelen, user_addr_t oldctl, size_t oldlen,
				      user_addr_t newctl, size_t newlen);
<span class="enscript-type">int</span>	mac_system_check_kas_info(kauth_cred_t cred, <span class="enscript-type">int</span> selector);
<span class="enscript-type">void</span>	mac_sysvmsg_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> msqid_kernel *msqptr, <span class="enscript-type">struct</span> msg *msgptr);
<span class="enscript-type">void</span>	mac_sysvmsg_label_init(<span class="enscript-type">struct</span> msg *msgptr);
<span class="enscript-type">void</span>	mac_sysvmsg_label_recycle(<span class="enscript-type">struct</span> msg *msgptr);
<span class="enscript-type">int</span>	mac_sysvmsq_check_enqueue(kauth_cred_t cred, <span class="enscript-type">struct</span> msg *msgptr,
	    <span class="enscript-type">struct</span> msqid_kernel *msqptr);
<span class="enscript-type">int</span>	mac_sysvmsq_check_msgrcv(kauth_cred_t cred, <span class="enscript-type">struct</span> msg *msgptr);
<span class="enscript-type">int</span>	mac_sysvmsq_check_msgrmid(kauth_cred_t cred, <span class="enscript-type">struct</span> msg *msgptr);
<span class="enscript-type">int</span>	mac_sysvmsq_check_msqctl(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> msqid_kernel *msqptr, <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_sysvmsq_check_msqget(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> msqid_kernel *msqptr);
<span class="enscript-type">int</span>	mac_sysvmsq_check_msqrcv(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> msqid_kernel *msqptr);
<span class="enscript-type">int</span>	mac_sysvmsq_check_msqsnd(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> msqid_kernel *msqptr);
<span class="enscript-type">void</span>	mac_sysvmsq_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> msqid_kernel *msqptr);
<span class="enscript-type">void</span> 	mac_sysvmsq_label_init(<span class="enscript-type">struct</span> msqid_kernel *msqptr);
<span class="enscript-type">void</span> 	mac_sysvmsq_label_recycle(<span class="enscript-type">struct</span> msqid_kernel *msqptr);
<span class="enscript-type">int</span>	mac_sysvsem_check_semctl(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> semid_kernel *semakptr, <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_sysvsem_check_semget(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> semid_kernel *semakptr);
<span class="enscript-type">int</span>	mac_sysvsem_check_semop(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> semid_kernel *semakptr, size_t accesstype);
<span class="enscript-type">void</span>	mac_sysvsem_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> semid_kernel *semakptr);
<span class="enscript-type">void</span>	mac_sysvsem_label_destroy(<span class="enscript-type">struct</span> semid_kernel *semakptr);
<span class="enscript-type">void</span>	mac_sysvsem_label_init(<span class="enscript-type">struct</span> semid_kernel *semakptr);
<span class="enscript-type">void</span>	mac_sysvsem_label_recycle(<span class="enscript-type">struct</span> semid_kernel *semakptr);
<span class="enscript-type">int</span>	mac_sysvshm_check_shmat(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> shmid_kernel *shmsegptr, <span class="enscript-type">int</span> shmflg);
<span class="enscript-type">int</span>	mac_sysvshm_check_shmctl(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> shmid_kernel *shmsegptr, <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_sysvshm_check_shmdt(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> shmid_kernel *shmsegptr);
<span class="enscript-type">int</span>	mac_sysvshm_check_shmget(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> shmid_kernel *shmsegptr, <span class="enscript-type">int</span> shmflg);
<span class="enscript-type">void</span>	mac_sysvshm_label_associate(kauth_cred_t cred,
	    <span class="enscript-type">struct</span> shmid_kernel *shmsegptr);
<span class="enscript-type">void</span>	mac_sysvshm_label_destroy(<span class="enscript-type">struct</span> shmid_kernel *shmsegptr);
<span class="enscript-type">void</span>	mac_sysvshm_label_init(<span class="enscript-type">struct</span> shmid_kernel* shmsegptr);
<span class="enscript-type">void</span>	mac_sysvshm_label_recycle(<span class="enscript-type">struct</span> shmid_kernel *shmsegptr);
<span class="enscript-type">int</span>	mac_vnode_check_access(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">int</span> acc_mode);
<span class="enscript-type">int</span>	mac_vnode_check_chdir(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp);
<span class="enscript-type">int</span>	mac_vnode_check_chroot(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp,
	    <span class="enscript-type">struct</span> componentname *cnp);
<span class="enscript-type">int</span>	mac_vnode_check_create(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp,
	    <span class="enscript-type">struct</span> componentname *cnp, <span class="enscript-type">struct</span> vnode_attr *vap);
<span class="enscript-type">int</span>	mac_vnode_check_deleteextattr(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_vnode_check_exchangedata(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *v1,
	    <span class="enscript-type">struct</span> vnode *v2);
<span class="enscript-type">int</span>	mac_vnode_check_exec(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> image_params *imgp);
<span class="enscript-type">int</span>	mac_vnode_check_fsgetpath(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_signature(<span class="enscript-type">struct</span> vnode *vp, off_t macho_offset,
	    <span class="enscript-type">unsigned</span> <span class="enscript-type">char</span> *sha1, <span class="enscript-type">const</span> <span class="enscript-type">void</span> * signature, size_t size, 
	    <span class="enscript-type">int</span> flags, <span class="enscript-type">int</span> *is_platform_binary);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_vnode_check_getattrlist</span>(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> attrlist *alist);
<span class="enscript-type">int</span>	mac_vnode_check_getextattr(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name, <span class="enscript-type">struct</span> uio *uio);
<span class="enscript-type">int</span>	mac_vnode_check_ioctl(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> cmd);
<span class="enscript-type">int</span>	mac_vnode_check_kqfilter(vfs_context_t ctx,
	    kauth_cred_t file_cred, <span class="enscript-type">struct</span> knote *kn, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_label_update(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> label *newlabel);
<span class="enscript-type">int</span>	mac_vnode_check_link(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp,
	    <span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> componentname *cnp);
<span class="enscript-type">int</span>	mac_vnode_check_listextattr(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_lookup(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp,
	    <span class="enscript-type">struct</span> componentname *cnp);
<span class="enscript-type">int</span>	mac_vnode_check_open(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">int</span> acc_mode);
<span class="enscript-type">int</span>	mac_vnode_check_read(vfs_context_t ctx,
	    kauth_cred_t file_cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_readdir(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_readlink(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_rename(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp,
	    <span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> componentname *cnp, <span class="enscript-type">struct</span> vnode *tdvp,
	    <span class="enscript-type">struct</span> vnode *tvp, <span class="enscript-type">struct</span> componentname *tcnp);
<span class="enscript-type">int</span>	mac_vnode_check_revoke(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_searchfs(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> attrlist *alist);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_vnode_check_select</span>(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">int</span> which);
<span class="enscript-type">int</span>     <span class="enscript-function-name">mac_vnode_check_setattrlist</span>(vfs_context_t ctxd, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> attrlist *alist);
<span class="enscript-type">int</span>	mac_vnode_check_setextattr(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name, <span class="enscript-type">struct</span> uio *uio);
<span class="enscript-type">int</span>	mac_vnode_check_setflags(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    u_long flags);
<span class="enscript-type">int</span>	mac_vnode_check_setmode(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    mode_t mode);
<span class="enscript-type">int</span>	mac_vnode_check_setowner(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    uid_t uid, gid_t gid);
<span class="enscript-type">int</span>	mac_vnode_check_setutimes(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> timespec atime, <span class="enscript-type">struct</span> timespec mtime);
<span class="enscript-type">int</span>	mac_vnode_check_stat(vfs_context_t ctx,
	    kauth_cred_t file_cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_truncate(vfs_context_t ctx,
	    kauth_cred_t file_cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_uipc_bind(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp,
	    <span class="enscript-type">struct</span> componentname *cnp, <span class="enscript-type">struct</span> vnode_attr *vap);
<span class="enscript-type">int</span>	mac_vnode_check_uipc_connect(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_check_unlink(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *dvp,
	    <span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> componentname *cnp);
<span class="enscript-type">int</span>	mac_vnode_check_write(vfs_context_t ctx,
	    kauth_cred_t file_cred, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">struct</span> label	*mac_vnode_label_alloc(<span class="enscript-type">void</span>);
<span class="enscript-type">int</span>	mac_vnode_label_associate(<span class="enscript-type">struct</span> mount *mp, <span class="enscript-type">struct</span> vnode *vp,
	    vfs_context_t ctx);
<span class="enscript-type">void</span>	mac_vnode_label_associate_devfs(<span class="enscript-type">struct</span> mount *mp, <span class="enscript-type">struct</span> devnode *de,
	    <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_label_associate_extattr(<span class="enscript-type">struct</span> mount *mp, <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_label_associate_fdesc(<span class="enscript-type">struct</span> mount *mp, <span class="enscript-type">struct</span> fdescnode *fnp,
	    <span class="enscript-type">struct</span> vnode *vp, vfs_context_t ctx);
<span class="enscript-type">void</span>	mac_vnode_label_associate_singlelabel(<span class="enscript-type">struct</span> mount *mp,
	    <span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">void</span>	mac_vnode_label_copy(<span class="enscript-type">struct</span> label *l1, <span class="enscript-type">struct</span> label *l2);
<span class="enscript-type">void</span>	mac_vnode_label_destroy(<span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_label_externalize_audit(<span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> mac *mac);
<span class="enscript-type">void</span>	mac_vnode_label_free(<span class="enscript-type">struct</span> label *label);
<span class="enscript-type">void</span>	mac_vnode_label_init(<span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">int</span>	mac_vnode_label_init_needed(<span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">void</span>	mac_vnode_label_recycle(<span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">void</span>	mac_vnode_label_update(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> label *newlabel);
<span class="enscript-type">void</span>	mac_vnode_label_update_extattr(<span class="enscript-type">struct</span> mount *mp, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">const</span> <span class="enscript-type">char</span> *name);
<span class="enscript-type">int</span>	mac_vnode_notify_create(vfs_context_t ctx, <span class="enscript-type">struct</span> mount *mp,
	    <span class="enscript-type">struct</span> vnode *dvp, <span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> componentname *cnp);
<span class="enscript-type">void</span>	mac_vnode_notify_rename(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> vnode *dvp, <span class="enscript-type">struct</span> componentname *cnp);
<span class="enscript-type">void</span>	mac_vnode_notify_open(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">int</span> acc_flags);
<span class="enscript-type">void</span>	mac_vnode_notify_link(vfs_context_t ctx, <span class="enscript-type">struct</span> vnode *vp,
			      <span class="enscript-type">struct</span> vnode *dvp, <span class="enscript-type">struct</span> componentname *cnp);
<span class="enscript-type">int</span>	mac_vnode_find_sigs(<span class="enscript-type">struct</span> proc *p, <span class="enscript-type">struct</span> vnode *vp, off_t offsetInMacho);
<span class="enscript-type">int</span>	vnode_label(<span class="enscript-type">struct</span> mount *mp, <span class="enscript-type">struct</span> vnode *dvp, <span class="enscript-type">struct</span> vnode *vp,
	    <span class="enscript-type">struct</span> componentname *cnp, <span class="enscript-type">int</span> flags, vfs_context_t ctx);
<span class="enscript-type">void</span>	vnode_relabel(<span class="enscript-type">struct</span> vnode *vp);
<span class="enscript-type">void</span>	mac_pty_notify_grant(proc_t p, <span class="enscript-type">struct</span> tty *tp, dev_t dev, <span class="enscript-type">struct</span> label *label);
<span class="enscript-type">void</span>	mac_pty_notify_close(proc_t p, <span class="enscript-type">struct</span> tty *tp, dev_t dev, <span class="enscript-type">struct</span> label *label);
<span class="enscript-type">int</span>	mac_kext_check_load(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *identifier);
<span class="enscript-type">int</span>	mac_kext_check_unload(kauth_cred_t cred, <span class="enscript-type">const</span> <span class="enscript-type">char</span> *identifier);
<span class="enscript-type">int</span>	mac_kext_check_query(kauth_cred_t cred);

<span class="enscript-type">void</span> <span class="enscript-function-name">psem_label_associate</span>(<span class="enscript-type">struct</span> fileproc *fp, <span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> vfs_context *ctx);
<span class="enscript-type">void</span> <span class="enscript-function-name">pshm_label_associate</span>(<span class="enscript-type">struct</span> fileproc *fp, <span class="enscript-type">struct</span> vnode *vp, <span class="enscript-type">struct</span> vfs_context *ctx);

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">CONFIG_MACF_NET</span>
<span class="enscript-type">struct</span> label *<span class="enscript-function-name">mac_bpfdesc_label_get</span>(<span class="enscript-type">struct</span> bpf_d *d);
<span class="enscript-type">void</span> <span class="enscript-function-name">mac_bpfdesc_label_set</span>(<span class="enscript-type">struct</span> bpf_d *d, <span class="enscript-type">struct</span> label *label);
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">endif</span>	<span class="enscript-comment">/* CONFIG_MACF */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !_SECURITY_MAC_FRAMEWORK_H_ */</span>
</pre>
<hr />
</body></html>