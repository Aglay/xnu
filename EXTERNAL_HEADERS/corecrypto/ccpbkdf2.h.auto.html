<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>ccpbkdf2.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">ccpbkdf2.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 *  ccpbkdf2.h
 *  corecrypto
 *
 *  Created on 12/15/2010
 *
 *  Copyright (c) 2010,2011,2012,2015 Apple Inc. All rights reserved.
 *
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_CORECRYPTO_CCPBKDF2_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_CORECRYPTO_CCPBKDF2_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;corecrypto/ccdigest.h&gt;</span>

<span class="enscript-comment">/*! @function ccpbkdf2_hmac
    @abstract perform a pbkdf2 using HMAC(di) for the PRF (see PKCS#5 for specification)
    @discussion This performs a standard PBKDF2 transformation of password and salt through 
an HMAC PRF of the callers slection (any Digest, typically SHA-1) returning dkLen bytes
containing the entropy.

Considerations:
The salt used should be at least 8 bytes long. Each session should use it's own salt.
We use the password as the key for the HMAC and the running data as the text for the HMAC to make a PRF.
SHA-1 is a good hash to use for the core of the HMAC PRF.
    @param di           digest info defining the digest type to use in the PRF.
    @param passwordLen  amount of data to be fed in
    @param password     data to be fed into the PBKDF
    @param saltLen      length of the salt
    @param salt         salt to be used in pbkdf
    @param iterations   itrations to go
    @param dkLen        length of the results
    @param dk           buffer for the results of the PBKDF tranformation, must be dkLen big
 
 */</span>
<span class="enscript-type">int</span> <span class="enscript-function-name">ccpbkdf2_hmac</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccdigest_info *di,
                   <span class="enscript-type">unsigned</span> <span class="enscript-type">long</span> passwordLen, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *password,
                   <span class="enscript-type">unsigned</span> <span class="enscript-type">long</span> saltLen, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *salt,
                   <span class="enscript-type">unsigned</span> <span class="enscript-type">long</span> iterations,
                   <span class="enscript-type">unsigned</span> <span class="enscript-type">long</span> dkLen, <span class="enscript-type">void</span> *dk);

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _CORECRYPTO_CCPBKDF2_H_ */</span>
</pre>
<hr />
</body></html>