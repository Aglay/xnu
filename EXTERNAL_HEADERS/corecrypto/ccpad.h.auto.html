<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>ccpad.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">ccpad.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 *  ccpad.h
 *  corecrypto
 *
 *  Created on 12/07/2010
 *
 *  Copyright (c) 2010,2011,2012,2014,2015 Apple Inc. All rights reserved.
 *
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_CORECRYPTO_CCPAD_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_CORECRYPTO_CCPAD_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;corecrypto/ccmode.h&gt;</span>

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts_decrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts_encrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts1_decrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts1_encrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);
<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts2_decrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts2_encrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);
<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts3_decrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_cts3_encrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is nbytes is non zero and a multiple of block_size. Furthermore in is nbytes long and out is nbytes long.  Returns number of bytes written to out (technically we always write nbytes to out but the returned value is the number of bytes decrypted after removal of padding.

    To be safe we remove the entire offending block if the pkcs7 padding checks failed.  However we purposely don't report the failure to decode the padding since any use of this error leads to potential security exploits.  So currently there is no way to distinguish between a full block of padding and bad padding.
 */</span>
size_t <span class="enscript-function-name">ccpad_pkcs7_decrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                           size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is in is nbytes long.  Writes (nbytes / block_size) + 1 times block_size to out.  In other words, out must be nbytes rounded down to the closest multiple of block_size plus block_size bytes. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_pkcs7_encrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_cbc *cbc, cccbc_ctx *ctx, cccbc_iv *iv,
                         size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is 'don't break CommonCrypto functionality that allows PKCS7 padding with ECB mode'.  This is basically the same routines above, without an IV, because calling
   crypt with an IV makes ecb cry (and crash) */</span>

size_t <span class="enscript-function-name">ccpad_pkcs7_ecb_decrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_ecb *ecb, ccecb_ctx *ecb_key,
                               size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_pkcs7_ecb_encrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_ecb *ecb, ccecb_ctx *ctx,
                             size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Function common to ccpad_pkcs7_ecb_decrypt and ccpad_pkcs7_decrypt */</span>
size_t <span class="enscript-function-name">ccpad_pkcs7_decode</span>(<span class="enscript-type">const</span> size_t block_size, <span class="enscript-type">const</span> uint8_t* last_block);

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_xts_decrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_xts *xts, ccxts_ctx *ctx, ccxts_tweak *tweak,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

<span class="enscript-comment">/* Contract is nbytes is at least 1 block + 1 byte.  Also in is nbytes long out is nbytes long. */</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">ccpad_xts_encrypt</span>(<span class="enscript-type">const</span> <span class="enscript-type">struct</span> ccmode_xts *xts, ccxts_ctx *ctx, ccxts_tweak *tweak,
                       size_t nbytes, <span class="enscript-type">const</span> <span class="enscript-type">void</span> *in, <span class="enscript-type">void</span> *out);

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _CORECRYPTO_CCPAD_H_ */</span>
</pre>
<hr />
</body></html>