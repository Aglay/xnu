<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>ccasn1.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">ccasn1.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 *  ccasn1.h
 *  corecrypto
 *
 *  Created on 11/16/2010
 *
 *  Copyright (c) 2010,2011,2012,2015 Apple Inc. All rights reserved.
 *
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_CORECRYPTO_CCASN1_H_</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">_CORECRYPTO_CCASN1_H_</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;corecrypto/cc.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;stdbool.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;string.h&gt;</span>

<span class="enscript-comment">/* ASN.1 types for on the fly ASN.1 BER/DER encoding/decoding. Don't use
   these with the ccder interface, use the CCDER_ types instead. */</span>
<span class="enscript-type">enum</span> {
    CCASN1_EOL               = 0x00,
    CCASN1_BOOLEAN           = 0x01,
    CCASN1_INTEGER           = 0x02,
    CCASN1_BIT_STRING        = 0x03,
    CCASN1_OCTET_STRING      = 0x04,
    CCASN1_NULL              = 0x05,
    CCASN1_OBJECT_IDENTIFIER = 0x06,
    CCASN1_OBJECT_DESCRIPTOR = 0x07,
    <span class="enscript-comment">/* External or instance-of 0x08 */</span>
    CCASN1_REAL              = 0x09,
    CCASN1_ENUMERATED        = 0x0a,
    CCASN1_EMBEDDED_PDV      = 0x0b,
    CCASN1_UTF8_STRING       = 0x0c,
    <span class="enscript-comment">/*                         0x0d */</span>
    <span class="enscript-comment">/*                         0x0e */</span>
    <span class="enscript-comment">/*                         0x0f */</span>
    CCASN1_SEQUENCE          = 0x10,
    CCASN1_SET               = 0x11,
    CCASN1_NUMERIC_STRING    = 0x12,
    CCASN1_PRINTABLE_STRING  = 0x13,
    CCASN1_T61_STRING        = 0x14,
    CCASN1_VIDEOTEX_STRING   = 0x15,
    CCASN1_IA5_STRING        = 0x16,
    CCASN1_UTC_TIME          = 0x17,
    CCASN1_GENERALIZED_TIME  = 0x18,
    CCASN1_GRAPHIC_STRING    = 0x19,
    CCASN1_VISIBLE_STRING    = 0x1a,
    CCASN1_GENERAL_STRING    = 0x1b,
    CCASN1_UNIVERSAL_STRING  = 0x1c,
    <span class="enscript-comment">/*                         0x1d */</span>
    CCASN1_BMP_STRING        = 0x1e,
    CCASN1_HIGH_TAG_NUMBER   = 0x1f,
    CCASN1_TELETEX_STRING    = CCASN1_T61_STRING,

    CCASN1_TAG_MASK			 = 0xff,
    CCASN1_TAGNUM_MASK		 = 0x1f,

    CCASN1_METHOD_MASK		 = 0x20,
    CCASN1_PRIMITIVE		 = 0x00,
    CCASN1_CONSTRUCTED		 = 0x20,

    CCASN1_CLASS_MASK		 = 0xc0,
    CCASN1_UNIVERSAL		 = 0x00,
    CCASN1_APPLICATION		 = 0x40,
    CCASN1_CONTEXT_SPECIFIC	 = 0x80,
    CCASN1_PRIVATE			 = 0xc0,

    CCASN1_CONSTRUCTED_SET = CCASN1_SET | CCASN1_CONSTRUCTED,
    CCASN1_CONSTRUCTED_SEQUENCE = CCASN1_SEQUENCE | CCASN1_CONSTRUCTED,
};

<span class="enscript-type">typedef</span> <span class="enscript-type">union</span> {
    <span class="enscript-type">const</span> <span class="enscript-type">unsigned</span> <span class="enscript-type">char</span> *oid;
} ccoid_t __attribute__((transparent_union));

<span class="enscript-comment">/* Returns *der iff *der points to a DER encoded oid that fits within *der_len. */</span>
ccoid_t <span class="enscript-function-name">ccoid_for_der</span>(size_t *der_len, <span class="enscript-type">const</span> uint8_t **der);

<span class="enscript-comment">/* Returns the size of an oid including it's tag and length. */</span>
CC_INLINE CC_PURE <span class="enscript-function-name">CC_NONNULL_TU</span>((1))
size_t <span class="enscript-function-name">ccoid_size</span>(ccoid_t oid) {
    <span class="enscript-keyword">return</span> 2 + oid.oid[1];
}

CC_INLINE CC_PURE <span class="enscript-function-name">CC_NONNULL_TU</span>((1)) CC_NONNULL_TU((2))
bool <span class="enscript-function-name">ccoid_equal</span>(ccoid_t oid1, ccoid_t oid2) {
    <span class="enscript-keyword">return</span>(ccoid_size(oid1) == ccoid_size(oid2) &amp;&amp; memcmp(oid1.oid, oid2.oid, ccoid_size(oid1))== 0);
}

<span class="enscript-type">extern</span> <span class="enscript-type">const</span> <span class="enscript-type">unsigned</span> <span class="enscript-type">char</span> *ccsha1_oid;

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* _CORECRYPTO_CCASN1_H_ */</span>
</pre>
<hr />
</body></html>