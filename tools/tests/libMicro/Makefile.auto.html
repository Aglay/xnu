<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Makefile</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">Makefile&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">#
</span><span class="enscript-comment"># CDDL HEADER START
</span><span class="enscript-comment">#
</span><span class="enscript-comment"># The contents of this file are subject to the terms
</span><span class="enscript-comment"># of the Common Development and Distribution License
</span><span class="enscript-comment"># (the &quot;License&quot;).  You may not use this file except
</span><span class="enscript-comment"># in compliance with the License.
</span><span class="enscript-comment">#
</span><span class="enscript-comment"># You can obtain a copy of the license at
</span><span class="enscript-comment"># src/OPENSOLARIS.LICENSE
</span><span class="enscript-comment"># or <a href="http://www.opensolaris.org/os/licensing.">http://www.opensolaris.org/os/licensing.</a>
</span><span class="enscript-comment"># See the License for the specific language governing
</span><span class="enscript-comment"># permissions and limitations under the License.
</span><span class="enscript-comment">#
</span><span class="enscript-comment"># When distributing Covered Code, include this CDDL
</span><span class="enscript-comment"># HEADER in each file and include the License file at
</span><span class="enscript-comment"># usr/src/OPENSOLARIS.LICENSE.  If applicable,
</span><span class="enscript-comment"># add the following below this CDDL HEADER, with the
</span><span class="enscript-comment"># fields enclosed by brackets &quot;[]&quot; replaced with your
</span><span class="enscript-comment"># own identifying information: Portions Copyright [yyyy]
</span><span class="enscript-comment"># [name of copyright owner]
</span><span class="enscript-comment">#
</span><span class="enscript-comment"># CDDL HEADER END
</span><span class="enscript-comment">#
</span>
<span class="enscript-comment">#
</span><span class="enscript-comment"># Copyright 2005 Sun Microsystems, Inc.  All rights reserved.
</span><span class="enscript-comment"># Use is subject to license terms.
</span><span class="enscript-comment">#
</span>

include Makefile.benchmarks

ARCH = i386

BINS=		$(<span class="enscript-reference">ALL:%=bin-$(ARCH)/%</span>) bin-$(<span class="enscript-reference">ARCH</span>)/tattle

<span class="enscript-comment"># TARBALL_CONTENTS = 	\
</span>	Makefile.benchmarks \
	Makefile.SunOS 	\
	Makefile.Linux 	\
	Makefile.Aix 	\
	Makefile.com 	\
	Makefile	\
	$(<span class="enscript-reference">ALL:%=%.c</span>)	\
	elided.c	\
	exec_bin.c	\
	libmicro.c	\
	libmicro_main.c	\
	libmicro.h	\
	recurse2.c	\
	benchmark_finibatch.c 	\
	benchmark_initbatch.c	\
	benchmark_optswitch.c	\
	benchmark_fini.c	\
	benchmark_init.c	\
	benchmark_result.c	\
	benchmark_finirun.c	\
	benchmark_initrun.c	\
	benchmark_initworker.c	\
	benchmark_finiworker.c	\
	bench		\
	bench.sh	\
	coreos_bench	\
	coreos_bench.sh	\
	mk_tarball	\
	multiview	\
	multiview.sh	\
	OPENSOLARIS.LICENSE	\
	tattle.c	\
	wrapper		\
	wrapper.sh	\
	README

ifeq <span class="enscript-string">&quot;$(Embedded)&quot;</span> <span class="enscript-string">&quot;YES&quot;</span>
SEMOP_FLAG= 
endif

default $(<span class="enscript-reference">ALL</span>) run cstyle lint tattle: $(<span class="enscript-reference">BINS</span>)
	@cp bench.sh bench
	@cp coreos_bench.sh coreos_bench
	@cp embd_bench.sh embd_bench
	@cp multiview.sh multiview
	@cp wrapper.sh wrapper
	@cp create_stuff.sh create_stuff
	@cp benchDS.sh benchDS
	@cp od_account_create.sh od_account_create
	@cp od_account_delete.sh od_account_delete
	@chmod +x bench coreos_bench embd_bench create_stuff multiview wrapper benchDS od_account_create od_account_delete
	@mkdir -p bin-$(<span class="enscript-reference">ARCH</span>); cd bin-$(<span class="enscript-reference">ARCH</span>); MACH=$(<span class="enscript-reference">ARCH</span>) $(<span class="enscript-reference">MAKE</span>) -f ../Makefile.<span class="enscript-string">`uname -s`</span> ARCH=$(<span class="enscript-reference">ARCH</span>) UNAME_RELEASE=<span class="enscript-string">`uname -r | sed 's/\./_/g'`</span> $@
	@echo <span class="enscript-string">&quot;code signing all the binaries under bin-$(ARCH) and apple/bin-$(ARCH)&quot;</span>
	@for file in $(<span class="enscript-reference">abspath bin-$(ARCH)/*</span>) $(<span class="enscript-reference">abspath apple/bin-$(ARCH)/*</span>);do        \
		if test -x $$file;then  \
			codesign -s - $$file 1&gt;&amp; /dev/null ;    \
		fi;     \
	done;
	@echo <span class="enscript-string">&quot;done&quot;</span>
	
<span class="enscript-keyword">.PHONY:</span> clean clean_subdirs clean_$(<span class="enscript-reference">SUBDIRS</span>)

<span class="enscript-keyword">clean:</span> clean_subdirs
	rm -rf bin bin-* wrapper multiview create_stuff bench tattle benchDS od_account_create od_account_delete coreos_bench embd_bench

<span class="enscript-keyword">clean_subdirs:</span>
	for dir in $(<span class="enscript-reference">SUBDIRS</span>); do $(<span class="enscript-reference">MAKE</span>) -C $$dir clean; done

<span class="enscript-keyword">bin:</span>	
	@mkdir -p bin-$(<span class="enscript-reference">ARCH</span>)

<span class="enscript-keyword">$(BINS):</span> bin
	@cp wrapper.sh wrapper
	@chmod +x wrapper
	@ln -sf ../wrapper $@

<span class="enscript-comment"># commenting the lbMicro.tar as it is not being used.
</span><span class="enscript-comment"># libMicro.tar:	FORCE
</span><span class="enscript-comment">#	@chmod +x ./mk_tarball wrapper
</span><span class="enscript-comment">#	@./mk_tarball $(TARBALL_CONTENTS) 
</span> 
<span class="enscript-comment"># FORCE:
</span>
</pre>
<hr />
</body></html>