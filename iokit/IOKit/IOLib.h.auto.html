<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>IOLib.h</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">IOLib.h&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 1998-2011 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>
<span class="enscript-comment">/*
 * Copyright (c) 1998 Apple Computer, Inc.  All rights reserved. 
 *
 * HISTORY
 *
 */</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">__IOKIT_IOLIB_H</span>
#<span class="enscript-reference">define</span> <span class="enscript-variable-name">__IOKIT_IOLIB_H</span>

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">KERNEL</span>
#<span class="enscript-reference">error</span> <span class="enscript-variable-name">IOLib</span>.<span class="enscript-variable-name">h</span> <span class="enscript-variable-name">is</span> <span class="enscript-variable-name">for</span> <span class="enscript-variable-name">kernel</span> <span class="enscript-variable-name">use</span> <span class="enscript-variable-name">only</span>
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;stdarg.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/cdefs.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;sys/appleapiopts.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/system.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/IOReturn.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/IOTypes.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/IOLocks.h&gt;</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;libkern/OSAtomic.h&gt;</span>

__BEGIN_DECLS

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;kern/thread_call.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;kern/clock.h&gt;</span>

<span class="enscript-comment">/*
 * min/max macros.
 */</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">min</span>(a,b) ((a) &lt; (b) ? (a) : (b))
#<span class="enscript-reference">define</span> <span class="enscript-function-name">max</span>(a,b) ((a) &gt; (b) ? (a) : (b))

<span class="enscript-comment">/*
 * These are opaque to the user.
 */</span>
<span class="enscript-type">typedef</span> thread_t IOThread;
<span class="enscript-type">typedef</span> <span class="enscript-function-name">void</span> (*IOThreadFunc)(<span class="enscript-type">void</span> *argument);

<span class="enscript-comment">/*
 * Memory allocation functions.
 */</span>

<span class="enscript-comment">/*! @function IOMalloc
    @abstract Allocates general purpose, wired memory in the kernel map.
    @discussion This is a general purpose utility to allocate memory in the kernel. There are no alignment guarantees given on the returned memory, and alignment may vary depending on the kernel configuration. This function may block and so should not be called from interrupt level or while a simple lock is held.
    @param size Size of the memory requested.
    @result Pointer to the allocated memory, or zero on failure. */</span>

<span class="enscript-type">void</span> * <span class="enscript-function-name">IOMalloc</span>(vm_size_t size);

<span class="enscript-comment">/*! @function IOFree
    @abstract Frees memory allocated with IOMalloc.
    @discussion This function frees memory allocated with IOMalloc, it may block and so should not be called from interrupt level or while a simple lock is held.
    @param address Pointer to the allocated memory. Must be identical to result
    @of a prior IOMalloc.
    @param size Size of the memory allocated. Must be identical to size of
    @the corresponding IOMalloc */</span>

<span class="enscript-type">void</span>   <span class="enscript-function-name">IOFree</span>(<span class="enscript-type">void</span> * address, vm_size_t size);

<span class="enscript-comment">/*! @function IOMallocAligned
    @abstract Allocates wired memory in the kernel map, with an alignment restriction.
    @discussion This is a utility to allocate memory in the kernel, with an alignment restriction which is specified as a byte count. This function may block and so should not be called from interrupt level or while a simple lock is held.
    @param size Size of the memory requested.
    @param alignment Byte count of the alignment for the memory. For example, pass 256 to get memory allocated at an address with bit 0-7 zero.
    @result Pointer to the allocated memory, or zero on failure. */</span>

<span class="enscript-type">void</span> * <span class="enscript-function-name">IOMallocAligned</span>(vm_size_t size, vm_offset_t alignment);

<span class="enscript-comment">/*! @function IOFreeAligned
    @abstract Frees memory allocated with IOMallocAligned.
    @discussion This function frees memory allocated with IOMallocAligned, it may block and so should not be called from interrupt level or while a simple lock is held.
    @param address Pointer to the allocated memory.
    @param size Size of the memory allocated. */</span>

<span class="enscript-type">void</span>   <span class="enscript-function-name">IOFreeAligned</span>(<span class="enscript-type">void</span> * address, vm_size_t size);

<span class="enscript-comment">/*! @function IOMallocContiguous
    @abstract Deprecated - use IOBufferMemoryDescriptor. Allocates wired memory in the kernel map, with an alignment restriction and physically contiguous.
    @discussion This is a utility to allocate memory in the kernel, with an alignment restriction which is specified as a byte count, and will allocate only physically contiguous memory. The request may fail if memory is fragmented, and may cause large amounts of paging activity. This function may block and so should not be called from interrupt level or while a simple lock is held.
    @param size Size of the memory requested.
    @param alignment Byte count of the alignment for the memory. For example, pass 256 to get memory allocated at an address with bits 0-7 zero.
    @param physicalAddress IOMallocContiguous returns the physical address of the allocated memory here, if physicalAddress is a non-zero pointer. The physicalAddress argument is deprecated and should be passed as NULL. To obtain the physical address for a memory buffer, use the IODMACommand class in conjunction with the IOMemoryDescriptor or IOBufferMemoryDescriptor classes.
    @result Virtual address of the allocated memory, or zero on failure. */</span>

<span class="enscript-type">void</span> * <span class="enscript-function-name">IOMallocContiguous</span>(vm_size_t size, vm_size_t alignment,
			   IOPhysicalAddress * physicalAddress) __attribute__((deprecated));

<span class="enscript-comment">/*! @function IOFreeContiguous
    @abstract Deprecated - use IOBufferMemoryDescriptor. Frees memory allocated with IOMallocContiguous.
    @discussion This function frees memory allocated with IOMallocContiguous, it may block and so should not be called from interrupt level or while a simple lock is held.
    @param address Virtual address of the allocated memory.
    @param size Size of the memory allocated. */</span>

<span class="enscript-type">void</span>   <span class="enscript-function-name">IOFreeContiguous</span>(<span class="enscript-type">void</span> * address, vm_size_t size) __attribute__((deprecated));


<span class="enscript-comment">/*! @function IOMallocPageable
    @abstract Allocates pageable memory in the kernel map.
    @discussion This is a utility to allocate pageable memory in the kernel. This function may block and so should not be called from interrupt level or while a simple lock is held.
    @param size Size of the memory requested.
    @param alignment Byte count of the alignment for the memory. For example, pass 256 to get memory allocated at an address with bits 0-7 zero.
    @result Pointer to the allocated memory, or zero on failure. */</span>

<span class="enscript-type">void</span> * <span class="enscript-function-name">IOMallocPageable</span>(vm_size_t size, vm_size_t alignment);

<span class="enscript-comment">/*! @function IOFreePageable
    @abstract Frees memory allocated with IOMallocPageable.
    @discussion This function frees memory allocated with IOMallocPageable, it may block and so should not be called from interrupt level or while a simple lock is held.
    @param address Virtual address of the allocated memory.
    @param size Size of the memory allocated. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOFreePageable</span>(<span class="enscript-type">void</span> * address, vm_size_t size);

<span class="enscript-comment">/*
 * Typed memory allocation macros. Both may block.
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IONew</span>(type,number) \
( ((number) != 0 &amp;&amp; ((vm_size_t) ((<span class="enscript-keyword">sizeof</span>(type) * (number) / (number))) != <span class="enscript-keyword">sizeof</span>(type)) <span class="enscript-comment">/* overflow check 20847256 */</span> \
  ? 0 \
  : ((type*)IOMalloc(<span class="enscript-keyword">sizeof</span>(type) * (number)))) )

#<span class="enscript-reference">define</span> <span class="enscript-function-name">IODelete</span>(ptr,type,number) IOFree( (ptr) , sizeof(type) * (number) )

<span class="enscript-comment">/////////////////////////////////////////////////////////////////////////////
</span><span class="enscript-comment">//
</span><span class="enscript-comment">//
</span><span class="enscript-comment">//	These functions are now implemented in IOMapper.cpp
</span><span class="enscript-comment">//
</span><span class="enscript-comment">//
</span><span class="enscript-comment">/////////////////////////////////////////////////////////////////////////////
</span>
<span class="enscript-comment">/*! @function IOMappedRead8
    @abstract Read one byte from the desired &quot;Physical&quot; IOSpace address.
    @discussion Read one byte from the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to read an address returned from any memory descriptor's getPhysicalSegment routine.  It can then be used by segmenting a physical page slightly to tag the physical page with its kernel space virtual address.  
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @result Data contained at that location */</span>

UInt8 <span class="enscript-function-name">IOMappedRead8</span>(IOPhysicalAddress address);

<span class="enscript-comment">/*! @function IOMappedRead16
    @abstract Read two bytes from the desired &quot;Physical&quot; IOSpace address.
    @discussion Read two bytes from the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to read an address returned from any memory descriptor's getPhysicalSegment routine.  It can then be used by segmenting a physical page slightly to tag the physical page with its kernel space virtual address.  
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @result Data contained at that location */</span>

UInt16 <span class="enscript-function-name">IOMappedRead16</span>(IOPhysicalAddress address);

<span class="enscript-comment">/*! @function IOMappedRead32
    @abstract Read four bytes from the desired &quot;Physical&quot; IOSpace address.
    @discussion Read four bytes from the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to read an address returned from any memory descriptor's getPhysicalSegment routine.  It can then be used by segmenting a physical page slightly to tag the physical page with its kernel space virtual address.  
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @result Data contained at that location */</span>

UInt32 <span class="enscript-function-name">IOMappedRead32</span>(IOPhysicalAddress address);

<span class="enscript-comment">/*! @function IOMappedRead64
    @abstract Read eight bytes from the desired &quot;Physical&quot; IOSpace address.
    @discussion Read eight bytes from the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to read an address returned from any memory descriptor's getPhysicalSegment routine.  It can then be used by segmenting a physical page slightly to tag the physical page with its kernel space virtual address.  
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @result Data contained at that location */</span>

UInt64 <span class="enscript-function-name">IOMappedRead64</span>(IOPhysicalAddress address);

<span class="enscript-comment">/*! @function IOMappedWrite8
    @abstract Write one byte to the desired &quot;Physical&quot; IOSpace address.
    @discussion Write one byte to the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to write to an address returned from any memory descriptor's getPhysicalSegment routine.
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @param value Data to be writen to the desired location */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOMappedWrite8</span>(IOPhysicalAddress address, UInt8 value);

<span class="enscript-comment">/*! @function IOMappedWrite16
    @abstract Write two bytes to the desired &quot;Physical&quot; IOSpace address.
    @discussion Write two bytes to the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to write to an address returned from any memory descriptor's getPhysicalSegment routine.
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @param value Data to be writen to the desired location */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOMappedWrite16</span>(IOPhysicalAddress address, UInt16 value);

<span class="enscript-comment">/*! @function IOMappedWrite32
    @abstract Write four bytes to the desired &quot;Physical&quot; IOSpace address.
    @discussion Write four bytes to the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to write to an address returned from any memory descriptor's getPhysicalSegment routine.
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @param value Data to be writen to the desired location */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOMappedWrite32</span>(IOPhysicalAddress address, UInt32 value);

<span class="enscript-comment">/*! @function IOMappedWrite64
    @abstract Write eight bytes to the desired &quot;Physical&quot; IOSpace address.
    @discussion Write eight bytes to the desired &quot;Physical&quot; IOSpace address.  This function allows the developer to write to an address returned from any memory descriptor's getPhysicalSegment routine.
    @param address The desired address, as returned by IOMemoryDescriptor::getPhysicalSegment.
    @param value Data to be writen to the desired location */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOMappedWrite64</span>(IOPhysicalAddress address, UInt64 value);

<span class="enscript-comment">/* This function is deprecated. Cache settings may be set for allocated memory with the IOBufferMemoryDescriptor api. */</span>

IOReturn <span class="enscript-function-name">IOSetProcessorCacheMode</span>( task_t task, IOVirtualAddress address,
				  IOByteCount length, IOOptionBits cacheMode ) __attribute__((deprecated));

<span class="enscript-comment">/*! @function IOFlushProcessorCache
    @abstract Flushes the processor cache for mapped memory.
    @discussion This function flushes the processor cache of an already mapped memory range. Note in most cases it is preferable to use IOMemoryDescriptor::prepare and complete to manage cache coherency since they are aware of the architecture's requirements. Flushing the processor cache is not required for coherency in most situations.
    @param task Task the memory is mapped into.
    @param address Virtual address of the memory.
    @param length Length of the range to set.
    @result An IOReturn code. */</span>

IOReturn <span class="enscript-function-name">IOFlushProcessorCache</span>( task_t task, IOVirtualAddress address,
				  IOByteCount length );

<span class="enscript-comment">/*! @function IOThreadSelf
    @abstract Returns the osfmk identifier for the currently running thread.
    @discussion This function returns the current thread (a pointer to the currently active osfmk thread_shuttle). */</span>

#<span class="enscript-reference">define</span> <span class="enscript-function-name">IOThreadSelf</span>() (current_thread())

<span class="enscript-comment">/*! @function IOCreateThread
    @abstract Deprecated function - use kernel_thread_start(). Create a kernel thread.
    @discussion This function creates a kernel thread, and passes the caller supplied argument to the new thread.  Warning: the value returned by this function is not 100% reliable.  There is a race condition where it is possible that the new thread has already terminated before this call returns.  Under that circumstance the IOThread returned will be invalid.  In general there is little that can be done with this value except compare it against 0.  The thread itself can call IOThreadSelf() 100% reliably and that is the prefered mechanism to manipulate the IOThreads state.
    @param function A C-function pointer where the thread will begin execution.
    @param argument Caller specified data to be passed to the new thread.
    @result An IOThread identifier for the new thread, equivalent to an osfmk thread_t. */</span>

IOThread <span class="enscript-function-name">IOCreateThread</span>(IOThreadFunc function, <span class="enscript-type">void</span> *argument) __attribute__((deprecated));

<span class="enscript-comment">/*! @function IOExitThread
    @abstract Deprecated function - use thread_terminate(). Terminate execution of current thread.
    @discussion This function destroys the currently running thread, and does not return. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOExitThread</span>(<span class="enscript-type">void</span>) __attribute__((deprecated));

<span class="enscript-comment">/*! @function IOSleep
    @abstract Sleep the calling thread for a number of milliseconds.
    @discussion This function blocks the calling thread for at least the number of specified milliseconds, giving time to other processes.
    @param milliseconds The integer number of milliseconds to wait. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOSleep</span>(<span class="enscript-type">unsigned</span> milliseconds);

<span class="enscript-comment">/*! @function IOSleepWithLeeway
    @abstract Sleep the calling thread for a number of milliseconds, with a specified leeway the kernel may use for timer coalescing.
    @discussion This function blocks the calling thread for at least the number of specified milliseconds, giving time to other processes.  The kernel may also coalesce any timers involved in the delay, using the leeway given as a guideline.
    @param intervalMilliseconds The integer number of milliseconds to wait.
    @param leewayMilliseconds The integer number of milliseconds to use as a timer coalescing guideline. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOSleepWithLeeway</span>(<span class="enscript-type">unsigned</span> intervalMilliseconds, <span class="enscript-type">unsigned</span> leewayMilliseconds);

<span class="enscript-comment">/*! @function IODelay
    @abstract Spin delay for a number of microseconds.
    @discussion This function spins to delay for at least the number of specified microseconds. Since the CPU is busy spinning no time is made available to other processes; this method of delay should be used only for short periods. Also, the AbsoluteTime based APIs of kern/clock.h provide finer grained and lower cost delays.
    @param microseconds The integer number of microseconds to spin wait. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IODelay</span>(<span class="enscript-type">unsigned</span> microseconds);

<span class="enscript-comment">/*! @function IOPause
    @abstract Spin delay for a number of nanoseconds.
    @discussion This function spins to delay for at least the number of specified nanoseconds. Since the CPU is busy spinning no time is made available to other processes; this method of delay should be used only for short periods.
    @param microseconds The integer number of nanoseconds to spin wait. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPause</span>(<span class="enscript-type">unsigned</span> nanoseconds);

<span class="enscript-comment">/*! @function IOLog
    @abstract Log a message to console in text mode, and /var/log/system.log.
    @discussion This function allows a driver to log diagnostic information to the screen during verbose boots, and to a log file found at /var/log/system.log. IOLog should not be called from interrupt context.
    @param format A printf() style format string (see printf(3) documentation).
    @param other arguments described by the format string. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOLog</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *format, ...)
<span class="enscript-function-name">__attribute__</span>((format(printf, 1, 2)));

<span class="enscript-comment">/*! @function IOLogv
    @abstract Log a message to console in text mode, and /var/log/system.log.
    @discussion This function allows a driver to log diagnostic information to the screen during verbose boots, and to a log file found at /var/log/system.log. IOLogv should not be called from interrupt context.
    @param format A printf() style format string (see printf(3) documentation).
    @param ap stdarg(3) style variable arguments. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOLogv</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *format, va_list ap);

#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_FN_KPRINTF</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_FN_KPRINTF</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">kprintf</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *format, ...);
#<span class="enscript-reference">endif</span>
#<span class="enscript-reference">ifndef</span> <span class="enscript-variable-name">_FN_KPRINTF_DECLARED</span>
#<span class="enscript-reference">define</span>	<span class="enscript-variable-name">_FN_KPRINTF_DECLARED</span>
#<span class="enscript-reference">endif</span>

<span class="enscript-comment">/*
 * Convert a integer constant (typically a #define or enum) to a string
 * via an array of IONamedValue.
 */</span>
<span class="enscript-type">const</span> <span class="enscript-type">char</span> *<span class="enscript-function-name">IOFindNameForValue</span>(<span class="enscript-type">int</span> value, 
	<span class="enscript-type">const</span> IONamedValue *namedValueArray);

<span class="enscript-comment">/*
 * Convert a string to an int via an array of IONamedValue. Returns
 * kIOReturnSuccess of string found, else returns kIOReturnBadArgument.
 */</span>
IOReturn <span class="enscript-function-name">IOFindValueForName</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *string, 
	<span class="enscript-type">const</span> IONamedValue *regValueArray,
	<span class="enscript-type">int</span> *value);				<span class="enscript-comment">/* RETURNED */</span>

<span class="enscript-comment">/*! @function Debugger
    @abstract Enter the kernel debugger.
    @discussion This function freezes the kernel and enters the builtin debugger. It may not be possible to exit the debugger without a second machine.
    @param reason A C-string to describe why the debugger is being entered. */</span>
 
<span class="enscript-type">void</span> <span class="enscript-function-name">Debugger</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> * reason);
#<span class="enscript-reference">if</span> <span class="enscript-variable-name">__LP64__</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IOPanic</span>(reason) panic(<span class="enscript-string">&quot;%s&quot;</span>, reason)
#<span class="enscript-reference">else</span>
<span class="enscript-type">void</span> <span class="enscript-function-name">IOPanic</span>(<span class="enscript-type">const</span> <span class="enscript-type">char</span> *reason) __attribute__((deprecated));
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__cplusplus</span>
class OSDictionary;
#<span class="enscript-reference">endif</span>

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__cplusplus</span>
OSDictionary *
#<span class="enscript-reference">else</span>
<span class="enscript-type">struct</span> OSDictionary *
#<span class="enscript-reference">endif</span>
<span class="enscript-function-name">IOBSDNameMatching</span>( <span class="enscript-type">const</span> <span class="enscript-type">char</span> * name );

#<span class="enscript-reference">ifdef</span> <span class="enscript-variable-name">__cplusplus</span>
OSDictionary *
#<span class="enscript-reference">else</span>
<span class="enscript-type">struct</span> OSDictionary *
#<span class="enscript-reference">endif</span>
<span class="enscript-function-name">IOOFPathMatching</span>( <span class="enscript-type">const</span> <span class="enscript-type">char</span> * path, <span class="enscript-type">char</span> * buf, <span class="enscript-type">int</span> maxLen ) __attribute__((deprecated));

<span class="enscript-comment">/*
 * Convert between size and a power-of-two alignment.
 */</span>
IOAlignment <span class="enscript-function-name">IOSizeToAlignment</span>(<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> size);
<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">IOAlignmentToSize</span>(IOAlignment align);

<span class="enscript-comment">/*
 * Multiply and divide routines for IOFixed datatype.
 */</span>

<span class="enscript-type">static</span> inline IOFixed <span class="enscript-function-name">IOFixedMultiply</span>(IOFixed a, IOFixed b)
{
    <span class="enscript-keyword">return</span> (IOFixed)((((SInt64) a) * ((SInt64) b)) &gt;&gt; 16);
}

<span class="enscript-type">static</span> inline IOFixed <span class="enscript-function-name">IOFixedDivide</span>(IOFixed a, IOFixed b)
{
    <span class="enscript-keyword">return</span> (IOFixed)((((SInt64) a) &lt;&lt; 16) / ((SInt64) b));
}

<span class="enscript-comment">/*
 * IORound and IOTrunc convenience functions, in the spirit
 * of vm's round_page() and trunc_page().
 */</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">IORound</span>(value,multiple) \
        ((((value) + (multiple) - 1) / (multiple)) * (multiple))

#<span class="enscript-reference">define</span> <span class="enscript-function-name">IOTrunc</span>(value,multiple) \
        (((value) / (multiple)) * (multiple));


#<span class="enscript-reference">if</span> <span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__APPLE_API_OBSOLETE</span>)

<span class="enscript-comment">/* The following API is deprecated */</span>

<span class="enscript-comment">/* The API exported by kern/clock.h
   should be used for high resolution timing. */</span>

<span class="enscript-type">void</span> <span class="enscript-function-name">IOGetTime</span>( mach_timespec_t * clock_time) __attribute__((deprecated));

#<span class="enscript-reference">if</span> !<span class="enscript-reference">defined</span>(<span class="enscript-variable-name">__LP64__</span>)

#<span class="enscript-reference">undef</span> <span class="enscript-variable-name">eieio</span>
#<span class="enscript-reference">define</span> <span class="enscript-function-name">eieio</span>() \
    OSSynchronizeIO()

<span class="enscript-type">extern</span> mach_timespec_t IOZeroTvalspec;

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !defined(__LP64__) */</span>

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* __APPLE_API_OBSOLETE */</span>

#<span class="enscript-reference">if</span> <span class="enscript-variable-name">XNU_KERNEL_PRIVATE</span>
vm_tag_t
<span class="enscript-function-name">IOMemoryTag</span>(vm_map_t map);
#<span class="enscript-reference">endif</span>

__END_DECLS

#<span class="enscript-reference">endif</span> <span class="enscript-comment">/* !__IOKIT_IOLIB_H */</span>
</pre>
<hr />
</body></html>