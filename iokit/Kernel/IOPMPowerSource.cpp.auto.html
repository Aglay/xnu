<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>IOPMPowerSource.cpp</title>
<style type="text/css">
.enscript-comment { font-style: italic; color: rgb(178,34,34); }
.enscript-function-name { font-weight: bold; color: rgb(0,0,255); }
.enscript-variable-name { font-weight: bold; color: rgb(184,134,11); }
.enscript-keyword { font-weight: bold; color: rgb(160,32,240); }
.enscript-reference { font-weight: bold; color: rgb(95,158,160); }
.enscript-string { font-weight: bold; color: rgb(188,143,143); }
.enscript-builtin { font-weight: bold; color: rgb(218,112,214); }
.enscript-type { font-weight: bold; color: rgb(34,139,34); }
.enscript-highlight { text-decoration: underline; color: 0; }
</style>
</head>
<body id="top">
<h1 style="margin:8px;" id="f1">IOPMPowerSource.cpp&nbsp;&nbsp;&nbsp;<span style="font-weight: normal; font-size: 0.5em;">[<a href="?txt">plain text</a>]</span></h1>
<hr/>
<div></div>
<pre>
<span class="enscript-comment">/*
 * Copyright (c) 1998-2005 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
 * 
 * This file contains Original Code and/or Modifications of Original Code
 * as defined in and that are subject to the Apple Public Source License
 * Version 2.0 (the 'License'). You may not use this file except in
 * compliance with the License. The rights granted to you under the License
 * may not be used to create, or enable the creation or redistribution of,
 * unlawful or unlicensed copies of an Apple operating system, or to
 * circumvent, violate, or enable the circumvention or violation of, any
 * terms of an Apple operating system software license agreement.
 * 
 * Please obtain a copy of the License at
 * <a href="http://www.opensource.apple.com/apsl/">http://www.opensource.apple.com/apsl/</a> and read it before using this file.
 * 
 * The Original Code and all software distributed under the License are
 * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
 * Please see the License for the specific language governing rights and
 * limitations under the License.
 * 
 * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
 */</span>

#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/pwr_mgt/IOPMPowerSource.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/pwr_mgt/IOPM.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/IOMessage.h&gt;</span>
#<span class="enscript-reference">include</span> <span class="enscript-string">&lt;IOKit/IOLib.h&gt;</span>

#<span class="enscript-reference">define</span> <span class="enscript-variable-name">super</span> IOService

<span class="enscript-function-name">OSDefineMetaClassAndStructors</span>(IOPMPowerSource, IOService)

<span class="enscript-comment">// *****************************************************************************
</span><span class="enscript-comment">// powerSource
</span><span class="enscript-comment">//
</span><span class="enscript-comment">// Static initializer for IOPMPowerSource. Returns a new instance of the class
</span><span class="enscript-comment">// which the caller must attach to the power plane.
</span><span class="enscript-comment">// *****************************************************************************
</span>
IOPMPowerSource *<span class="enscript-function-name">IOPMPowerSource::powerSource</span>(<span class="enscript-type">void</span>)
{
    IOPMPowerSource *ps = <span class="enscript-keyword">new</span> IOPMPowerSource;    

    <span class="enscript-keyword">if</span>(ps) {
        ps-&gt;init();
        <span class="enscript-keyword">return</span> ps;
    }    
    <span class="enscript-keyword">return</span> NULL;
}

<span class="enscript-comment">// *****************************************************************************
</span><span class="enscript-comment">// init
</span><span class="enscript-comment">//
</span><span class="enscript-comment">// *****************************************************************************
</span><span class="enscript-type">bool</span> <span class="enscript-function-name">IOPMPowerSource::init</span> (<span class="enscript-type">void</span>)
{
    <span class="enscript-keyword">if</span> (!super::init()) {
        <span class="enscript-keyword">return</span> false;
    }

    nextInList = NULL;

    properties = OSDictionary::withCapacity(10);
    <span class="enscript-keyword">if</span>(!properties) <span class="enscript-keyword">return</span> false;
    properties-&gt;setCapacityIncrement(1);

    externalConnectedKey = OSSymbol::withCString(kIOPMPSExternalConnectedKey);
    externalChargeCapableKey = OSSymbol::withCString(kIOPMPSExternalChargeCapableKey);
    batteryInstalledKey = OSSymbol::withCString(kIOPMPSBatteryInstalledKey);
    chargingKey = OSSymbol::withCString(kIOPMPSIsChargingKey);
    warnLevelKey = OSSymbol::withCString(kIOPMPSAtWarnLevelKey);
    criticalLevelKey = OSSymbol::withCString(kIOPMPSAtCriticalLevelKey);
    currentCapacityKey = OSSymbol::withCString(kIOPMPSCurrentCapacityKey);
    maxCapacityKey = OSSymbol::withCString(kIOPMPSMaxCapacityKey);
    timeRemainingKey = OSSymbol::withCString(kIOPMPSTimeRemainingKey);
    amperageKey = OSSymbol::withCString(kIOPMPSAmperageKey);
    voltageKey = OSSymbol::withCString(kIOPMPSVoltageKey);
    cycleCountKey = OSSymbol::withCString(kIOPMPSCycleCountKey);
    adapterInfoKey = OSSymbol::withCString(kIOPMPSAdapterInfoKey);
    locationKey = OSSymbol::withCString(kIOPMPSLocationKey);
    errorConditionKey = OSSymbol::withCString(kIOPMPSErrorConditionKey);
    manufacturerKey = OSSymbol::withCString(kIOPMPSManufacturerKey);
    modelKey = OSSymbol::withCString(kIOPMPSModelKey);
    serialKey = OSSymbol::withCString(kIOPMPSSerialKey);
    batteryInfoKey = OSSymbol::withCString(kIOPMPSLegacyBatteryInfoKey);

    <span class="enscript-keyword">return</span> true;
}

<span class="enscript-comment">// *****************************************************************************
</span><span class="enscript-comment">// free
</span><span class="enscript-comment">//
</span><span class="enscript-comment">// *****************************************************************************
</span><span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::free</span>(<span class="enscript-type">void</span>)
{
    <span class="enscript-keyword">if</span>(properties) properties-&gt;release();
    <span class="enscript-keyword">if</span>(externalConnectedKey) externalConnectedKey-&gt;release();
    <span class="enscript-keyword">if</span>(externalChargeCapableKey) externalChargeCapableKey-&gt;release();
    <span class="enscript-keyword">if</span>(batteryInstalledKey) batteryInstalledKey-&gt;release();
    <span class="enscript-keyword">if</span>(chargingKey) chargingKey-&gt;release();
    <span class="enscript-keyword">if</span>(warnLevelKey) warnLevelKey-&gt;release();
    <span class="enscript-keyword">if</span>(criticalLevelKey) criticalLevelKey-&gt;release();
    <span class="enscript-keyword">if</span>(currentCapacityKey) currentCapacityKey-&gt;release();
    <span class="enscript-keyword">if</span>(maxCapacityKey) maxCapacityKey-&gt;release();
    <span class="enscript-keyword">if</span>(timeRemainingKey) timeRemainingKey-&gt;release();
    <span class="enscript-keyword">if</span>(amperageKey) amperageKey-&gt;release();
    <span class="enscript-keyword">if</span>(voltageKey) voltageKey-&gt;release();
    <span class="enscript-keyword">if</span>(cycleCountKey) cycleCountKey-&gt;release();
    <span class="enscript-keyword">if</span>(adapterInfoKey) adapterInfoKey-&gt;release();
    <span class="enscript-keyword">if</span>(errorConditionKey) errorConditionKey-&gt;release();
    <span class="enscript-keyword">if</span>(manufacturerKey) manufacturerKey-&gt;release();
    <span class="enscript-keyword">if</span>(modelKey) modelKey-&gt;release();
    <span class="enscript-keyword">if</span>(serialKey) serialKey-&gt;release();
    <span class="enscript-keyword">if</span>(locationKey) locationKey-&gt;release();
    <span class="enscript-keyword">if</span>(batteryInfoKey) batteryInfoKey-&gt;release();
}

<span class="enscript-comment">// *****************************************************************************
</span><span class="enscript-comment">// updateStatus
</span><span class="enscript-comment">//
</span><span class="enscript-comment">// Update power source state in IORegistry and message interested clients
</span><span class="enscript-comment">// notifying them of our change.
</span><span class="enscript-comment">// *****************************************************************************
</span><span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::updateStatus</span> (<span class="enscript-type">void</span>)
{
    OSCollectionIterator            *iterator;
    OSObject                        *iteratorKey;
    OSObject                        *obj;

    <span class="enscript-comment">// do nothing if settings haven't changed
</span>    <span class="enscript-keyword">if</span>(!settingsChangedSinceUpdate) <span class="enscript-keyword">return</span>;

    iterator = OSCollectionIterator::withCollection(properties);
    <span class="enscript-keyword">if</span>(!iterator) <span class="enscript-keyword">return</span>;

    <span class="enscript-keyword">while</span> ((iteratorKey = iterator-&gt;getNextObject())) {
        OSSymbol *key;
    
        key = OSDynamicCast(OSSymbol, iteratorKey);
        <span class="enscript-keyword">if</span> (!key) <span class="enscript-keyword">continue</span>;
        obj = properties-&gt;getObject(key);
        <span class="enscript-keyword">if</span>(!obj) <span class="enscript-keyword">continue</span>;
        setProperty(key, obj);
    }
    iterator-&gt;release();

    settingsChangedSinceUpdate = false;

    <span class="enscript-comment">// And up goes the flare
</span>    messageClients(kIOPMMessageBatteryStatusHasChanged);
}


<span class="enscript-comment">/*******************************************************************************
 *
 * PROTECTED Accessors. All the setters! Yay!
 *
 ******************************************************************************/</span>
 
<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setPSProperty</span>(<span class="enscript-type">const</span> OSSymbol *key, OSObject *val)
{
    OSObject    *lastVal;

    <span class="enscript-keyword">if</span>(!key || !val) <span class="enscript-keyword">return</span>;

    <span class="enscript-comment">// Compare new setting with existing setting; update 
</span>    <span class="enscript-comment">// 'settingsChangedSinceUpdate' if the setting has changed.
</span>    <span class="enscript-comment">// If values are OSNumbers, do equality comparison.
</span>    <span class="enscript-comment">// Otherwise, just compare pointers.
</span>    
    <span class="enscript-keyword">if</span>( (lastVal = properties-&gt;getObject(key)) ) {
	<span class="enscript-keyword">if</span>(val-&gt;isEqualTo(lastVal)) {
	    <span class="enscript-comment">// settings didn't change
</span>	} <span class="enscript-keyword">else</span> {
	    <span class="enscript-comment">// num val is not equal to last val
</span>	    settingsChangedSinceUpdate = true;
	}
    } <span class="enscript-keyword">else</span> {
        <span class="enscript-comment">// new setting; no last value
</span>        settingsChangedSinceUpdate = true;
    }
    
    <span class="enscript-comment">// here's the part where we go crazy.
</span>    properties-&gt;setObject(key, val);
}


 
<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setExternalConnected</span>(<span class="enscript-type">bool</span> b) {
    setPSProperty(externalConnectedKey,
            b ? kOSBooleanTrue : kOSBooleanFalse);    
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setExternalChargeCapable</span>(<span class="enscript-type">bool</span> b) {
    setPSProperty(externalChargeCapableKey,
            b ? kOSBooleanTrue : kOSBooleanFalse);    
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setBatteryInstalled</span>(<span class="enscript-type">bool</span> b) {
    setPSProperty(batteryInstalledKey,
            b ? kOSBooleanTrue : kOSBooleanFalse);    
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setIsCharging</span>(<span class="enscript-type">bool</span> b) {
    setPSProperty(chargingKey,
            b ? kOSBooleanTrue : kOSBooleanFalse);    
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setAtWarnLevel</span>(<span class="enscript-type">bool</span> b) {
    setPSProperty(warnLevelKey,
            b ? kOSBooleanTrue : kOSBooleanFalse);    
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setAtCriticalLevel</span>(<span class="enscript-type">bool</span> b) {
    setPSProperty(criticalLevelKey,
            b ? kOSBooleanTrue : kOSBooleanFalse);    
}


<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setCurrentCapacity</span>(<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(currentCapacityKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setMaxCapacity</span>(<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(maxCapacityKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setTimeRemaining</span>(<span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(timeRemainingKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setAmperage</span>(<span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(amperageKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setVoltage</span>(<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(voltageKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setCycleCount</span>(<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(cycleCountKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setAdapterInfo</span>(<span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(adapterInfoKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setLocation</span>(<span class="enscript-type">int</span> val) {
    OSNumber *n = OSNumber::withNumber(val, 32);
    setPSProperty(locationKey, n);
    n-&gt;release();
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setErrorCondition</span>(OSSymbol *s) {
    setPSProperty(errorConditionKey, s);
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setManufacturer</span>(OSSymbol *s) {
    setPSProperty(manufacturerKey, s);
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setModel</span>(OSSymbol *s) {
    setPSProperty(modelKey, s);
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setSerial</span>(OSSymbol *s) {
    setPSProperty(serialKey, s);
}

<span class="enscript-type">void</span> <span class="enscript-function-name">IOPMPowerSource::setLegacyIOBatteryInfo</span>(OSDictionary *d) {
    setPSProperty(batteryInfoKey, d);
}




<span class="enscript-comment">/*******************************************************************************
 *
 * PUBLIC Accessors. All the getters! Boo!
 *
 ******************************************************************************/</span>

OSObject *<span class="enscript-function-name">IOPMPowerSource::getPSProperty</span>(<span class="enscript-type">const</span> OSSymbol *symmie) {
    <span class="enscript-keyword">if</span>(!symmie) <span class="enscript-keyword">return</span> NULL;
    <span class="enscript-keyword">return</span> properties-&gt;getObject(symmie);
}

<span class="enscript-type">bool</span> <span class="enscript-function-name">IOPMPowerSource::externalConnected</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> (kOSBooleanTrue == properties-&gt;getObject(externalConnectedKey));
}

<span class="enscript-type">bool</span> <span class="enscript-function-name">IOPMPowerSource::externalChargeCapable</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> (kOSBooleanTrue == properties-&gt;getObject(externalChargeCapableKey));
}

<span class="enscript-type">bool</span> <span class="enscript-function-name">IOPMPowerSource::batteryInstalled</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> (kOSBooleanTrue == properties-&gt;getObject(batteryInstalledKey));
}

<span class="enscript-type">bool</span> <span class="enscript-function-name">IOPMPowerSource::isCharging</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> (kOSBooleanTrue == properties-&gt;getObject(chargingKey));
}

<span class="enscript-type">bool</span> <span class="enscript-function-name">IOPMPowerSource::atWarnLevel</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> (kOSBooleanTrue == properties-&gt;getObject(warnLevelKey));
}

<span class="enscript-type">bool</span> <span class="enscript-function-name">IOPMPowerSource::atCriticalLevel</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> (kOSBooleanTrue == properties-&gt;getObject(criticalLevelKey));
}

<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::currentCapacity</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(currentCapacityKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::maxCapacity</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(maxCapacityKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::capacityPercentRemaining</span>(<span class="enscript-type">void</span>) 
{
    <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> _currentCapacity = currentCapacity();
    <span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> _maxCapacity = maxCapacity();
    <span class="enscript-keyword">if</span>(0 == _maxCapacity) {
        <span class="enscript-keyword">return</span> 0;
    } <span class="enscript-keyword">else</span> {
        <span class="enscript-keyword">return</span> ((100*_currentCapacity) / _maxCapacity);
    }
}

<span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::timeRemaining</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(timeRemainingKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

<span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::amperage</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(amperageKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::voltage</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(voltageKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::cycleCount</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(cycleCountKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

<span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::adapterInfo</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(adapterInfoKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

<span class="enscript-type">int</span> <span class="enscript-function-name">IOPMPowerSource::location</span>(<span class="enscript-type">void</span>) {
    OSNumber        *n;
    n = OSDynamicCast(OSNumber, properties-&gt;getObject(locationKey));
    <span class="enscript-keyword">if</span>(!n) <span class="enscript-keyword">return</span> 0;
    <span class="enscript-keyword">else</span> <span class="enscript-keyword">return</span> (<span class="enscript-type">unsigned</span> <span class="enscript-type">int</span>)n-&gt;unsigned32BitValue();
}

OSSymbol *<span class="enscript-function-name">IOPMPowerSource::errorCondition</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> OSDynamicCast(OSSymbol, properties-&gt;getObject(errorConditionKey));
}

OSSymbol *<span class="enscript-function-name">IOPMPowerSource::manufacturer</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> OSDynamicCast(OSSymbol, properties-&gt;getObject(manufacturerKey));
}

OSSymbol *<span class="enscript-function-name">IOPMPowerSource::model</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> OSDynamicCast(OSSymbol, properties-&gt;getObject(modelKey));
}

OSSymbol *<span class="enscript-function-name">IOPMPowerSource::serial</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> OSDynamicCast(OSSymbol, properties-&gt;getObject(serialKey));
}

OSDictionary *<span class="enscript-function-name">IOPMPowerSource::legacyIOBatteryInfo</span>(<span class="enscript-type">void</span>) {
    <span class="enscript-keyword">return</span> OSDynamicCast(OSDictionary, properties-&gt;getObject(batteryInfoKey));
}
</pre>
<hr />
</body></html>